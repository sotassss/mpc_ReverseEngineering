000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             KHT41410.
000060 AUTHOR.                 Rc  _V
000070*
000080*----------------------------------------------------------------*
000090*         ͂p SzvZvO@
000100*         MED = 
000110* PSNPOgpJn
000120* RΖQSA҂PCQS̑ΉB
000130*
000140* VlSƏ 500~~2 ̑Ή(v̂݌vZ) /20061120
000150*
000151* ̓ꕉS͈ȉ̂ݑΉB
000152* S敪:6,8,14 (zA񐔂𕉒S)
000153*          13  (zA񐔂𕉒SiPO~Pʁj)
000154*
000155* S敪:5,16,17Ή(2014.11.05)
000156*
000160*----------------------------------------------------------------*
000170 DATE-WRITTEN.           2004-08-31
000180 DATE-COMPILED.          2004-08-31
000190*----------------------------------------------------------------*
000200******************************************************************
000210*            ENVIRONMENT         DIVISION                        *
000220******************************************************************
000230 ENVIRONMENT             DIVISION.
000240 CONFIGURATION           SECTION.
000250 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000260 OBJECT-COMPUTER.        FMV-DESKPOWER.
000270 SPECIAL-NAMES.          CONSOLE  IS  CONS
000280                         SYSERR   IS  MSGBOX.
000290 INPUT-OUTPUT            SECTION.
000300 FILE-CONTROL.
000310* EXTERNALp
000320     SELECT  ی҃}X^    ASSIGN      TO        HOKENSL
000330                             ORGANIZATION             IS  INDEXED
000340                             ACCESS MODE              IS  DYNAMIC
000350                             RECORD KEY               IS  ہ|ی
000360                                                          ہ|یҔԍ
000370                             ALTERNATE RECORD KEY     IS  ہ|ی
000380                                                          ہ|یҖ
000390                                                          ہ|یҔԍ
000400                             FILE STATUS              IS  ԃL[
000410                             LOCK        MODE         IS  AUTOMATIC.
000420     SELECT  S}X^    ASSIGN      TO        HUTANRIL
000430                             ORGANIZATION             IS  INDEXED
000440                             ACCESS MODE              IS  DYNAMIC
000450                             RECORD KEY               IS  |ی
000460                                                          |JnaN
000470                             FILE STATUS              IS  ԃL[
000480                             LOCK        MODE         IS  AUTOMATIC.
000490     SELECT  fҏe    ASSIGN      TO        JUSINJL
000500                             ORGANIZATION             IS  INDEXED
000510                             ACCESS MODE              IS  DYNAMIC
000520                             RECORD KEY               IS  |{paN
000530                                                          |҃R[h
000540                             ALTERNATE RECORD KEY     IS  |{paN
000550                                                          |҃Ji
000560                                                          |҃R[h
000570                             ALTERNATE RECORD KEY     IS  |҃R[h
000580                                                          |{paN
000590                             ALTERNATE RECORD KEY     IS  |{paN
000600                                                          |ی
000610                                                          |یҔԍ
000620                                                          |҃R[h
000630                             ALTERNATE RECORD KEY     IS  |{paN
000640                                                          |
000650                                                          |pSҔԍ
000660                                                          |҃R[h
000670                             ALTERNATE RECORD KEY     IS  |{paN
000680                                                          |
000690                                                          |pSҔԍ
000700                                                          |҃R[h
000710                             ALTERNATE RECORD KEY     IS  |aN
000720                                                          |{paN
000730                                                          |҃R[h
000740                             FILE STATUS              IS  ԃL[
000750                             LOCK        MODE         IS  AUTOMATIC.
000760     SELECT  s}X^    ASSIGN      TO        SITYOSNL
000770                             ORGANIZATION             IS  INDEXED
000780                             ACCESS MODE              IS  DYNAMIC
000790                             RECORD KEY               IS  s|
000800                                                          s|sԍ
000810                             ALTERNATE RECORD KEY     IS  s|
000820                                                          s|s
000830                                                          s|sԍ
000840                             FILE STATUS              IS  ԃL[
000850                             LOCK        MODE         IS  AUTOMATIC.
000860*
000861**
000870     SELECT  یғʕS}X^   ASSIGN      TO     HOKENTKL
000871                             ORGANIZATION          IS  INDEXED
000872                             ACCESS MODE           IS  DYNAMIC
000873                             RECORD KEY            IS  ۓ|ی
000874                                                       ۓ|یҔԍ
000875                                                       ۓ|JnaN
000876                             FILE STATUS           IS  ԃL[
000877                             LOCK        MODE      IS  AUTOMATIC.
000520     SELECT  dwfҏe    ASSIGN      TO        JUSINJL
000530                             ORGANIZATION             IS  INDEXED
000540                             ACCESS MODE              IS  DYNAMIC
000550                             RECORD KEY               IS  d|{paN
000560                                                          d|҃R[h
000570                             ALTERNATE RECORD KEY     IS  d|{paN
000580                                                          d|҃Ji
000590                                                          d|҃R[h
000600                             ALTERNATE RECORD KEY     IS  d|҃R[h
000610                                                          d|{paN
000620                             ALTERNATE RECORD KEY     IS  d|{paN
000630                                                          d|ی
000640                                                          d|یҔԍ
000650                                                          d|҃R[h
000660                             ALTERNATE RECORD KEY     IS  d|{paN
000670                                                          d|
000680                                                          d|pSҔԍ
000690                                                          d|҃R[h
000700                             ALTERNATE RECORD KEY     IS  d|{paN
000710                                                          d|
000720                                                          d|pSҔԍ
000730                                                          d|҃R[h
000740                             ALTERNATE RECORD KEY     IS  d|aN
000750                                                          d|{paN
000760                                                          d|҃R[h
000770                             FILE STATUS              IS  ԃL[
000780                             LOCK        MODE         IS  AUTOMATIC.
000878**
001570     SELECT  gvf[^e  ASSIGN      TO        HNIKEIL
001580                             ORGANIZATION             IS  INDEXED
001590                             ACCESS MODE              IS  DYNAMIC
001600                             RECORD KEY               IS  g|{p敪
001610                                                          g|{paN
001620                                                          g|҃R[h
001630                             ALTERNATE RECORD KEY     IS  g|{p敪
001640                                                          g|҃R[h
001650                                                          g|{paN
001660                             ALTERNATE RECORD KEY     IS  g|{paN
001670                                                          g|o^
001680                             FILE STATUS              IS  ԃL[
001690                             LOCK        MODE         IS  AUTOMATIC.
001700*
000879******************************************************************
000880*                      DATA DIVISION                             *
000890******************************************************************
000900 DATA                    DIVISION.
000910 FILE                    SECTION.
000920*-----------------------------------------------------------------------*
000930** EXTERNALp
000940 FD  fҏe IS EXTERNAL   BLOCK   CONTAINS   1   RECORDS.
000950     COPY JUSINJ     OF  XFDLIB  JOINING      AS  PREFIX.
000960 FD  ی҃}X^ IS EXTERNAL   BLOCK   CONTAINS   1   RECORDS.
000970     COPY HOKENS     OF  XFDLIB  JOINING      AS  PREFIX.
000980 FD  S}X^ IS EXTERNAL   BLOCK   CONTAINS   1   RECORDS.
000990     COPY HUTANRI    OF  XFDLIB  JOINING    AS  PREFIX.
001000 FD  s}X^ IS EXTERNAL   BLOCK   CONTAINS   1   RECORDS.
001010     COPY SITYOSN    OF  XFDLIB  JOINING   s   AS  PREFIX.
001011 FD  یғʕS}X^  IS EXTERNAL BLOCK   CONTAINS   1   RECORDS.
001012     COPY HOKENTK    OF  XFDLIB  JOINING   ۓ AS PREFIX.
001620*                           mqk  RQOn
001630 FD  dwfҏe  IS EXTERNAL      BLOCK   CONTAINS   1   RECORDS.
001640     COPY JUSINJ     OF  XFDLIB  JOINING   d   AS  PREFIX.
003060*                           mqk  TPQn
003070 FD  gvf[^e      BLOCK   CONTAINS   1   RECORDS.
003080     COPY H_NIKEI    OF  XFDLIB  JOINING   g   AS  PREFIX.
001020*
001030*-----------------------------------------------------------------------//
001040
001050*----------------------------------------------------------------*
001060******************************************************************
001070*                WORKING-STORAGE SECTION                         *
001080******************************************************************
001090 WORKING-STORAGE         SECTION.
001100 01 L[                           PIC X    VALUE SPACE.
001110 01 ԃL[                           PIC X(2) VALUE SPACE.
001120 01 ItO                         PIC X(3) VALUE SPACE.
001130 01 t@Cv                       PIC N(2) VALUE SPACE.
001140*/G[\̏C
001150 01 G[\e                       PIC 9(1) VALUE ZERO.
001160*/SzƐzUɏC0311
001170 01 Szv                           PIC 9(6) VALUE ZERO.
001180 01 SzvQ                         PIC 9(6) VALUE ZERO.
001190 01 SzvPO                       PIC 9(6)V9 VALUE ZERO.
001200 01 zv                           PIC 9(6) VALUE ZERO.
001210 01 Sv                           PIC 9(3) VALUE ZERO.
001220 01 SԌʂv                   PIC 9V9(3) VALUE ZERO.
001230 01 v                               PIC 9(4) VALUE ZERO.
001240 01 ]v                             PIC 9(4) VALUE ZERO.
001170 01 SzSv                         PIC 9(6) VALUE ZERO.
001250*/
001260 01 Szv                     PIC 9(6) VALUE ZERO.
001270 01 S敪v                         PIC 9(2) VALUE ZERO.
001280 01 S񐔂v                     PIC 9(2) VALUE ZERO.
001290*/m̓c̑Ή0109
001300 01 Sv                       PIC 9(3) VALUE ZERO.
001310 01 Szv                       PIC 9(5) VALUE ZERO.
001320 01 Szv                       PIC 9(6) VALUE ZERO.
001330 01 SzvQ                     PIC 9(6) VALUE ZERO.
001340*
001350*/0506Ɍ̉170701
001360 01 萔v                       PIC 9(4) VALUE ZERO.
001370*/SƏ̏Ă/050629
001380 01 SƏv                   PIC 9    VALUE ZERO.
001390*
001400 01 sԍVlv.
001410   03 @ʔԍVlv                   PIC X(2) VALUE SPACE.
001420   03 یVl.
001430     05 {Vl                       PIC X(2) VALUE SPACE.
001440     05 ԘVl                       PIC X(3) VALUE SPACE.
001450     05 bcVl                     PIC X    VALUE SPACE.
001460   03 FILLER                           PIC X(2) VALUE SPACE.
001470*
001480 01 sԍv.
001490   03 @ʔԍv                   PIC X(2) VALUE SPACE.
001500   03 یv.
001510     05 {v                     PIC X(2) VALUE SPACE.
001520     05 ԏv                     PIC X(3) VALUE SPACE.
001530     05 bcv                   PIC X    VALUE SPACE.
001540   03 FILLER                           PIC X(2) VALUE SPACE.
001550*
001560*/SPVlp̃[N0101
001570 01 SzSPv                       PIC 9(5)V9(3) VALUE ZERO.
001580 01 SzRv                         PIC 9(5) VALUE ZERO.
001590*
001591*
001592 01 xzPv                         PIC 9(5) VALUE ZERO.
001593 01 xzQv                         PIC 9(5) VALUE ZERO.
001594 01 xzRv                         PIC 9(5) VALUE ZERO.
001595 01 vZxzv                       PIC 9(5) VALUE ZERO.
001596 01 vZp݌vzv                     PIC 9(5) VALUE ZERO.
001597 01 Szvv                   PIC 9(6) VALUE ZERO.
001598**
001600*
      */}Ԃ̗݌vz擾/20240424
002090 01 ItOR                       PIC X(3) VALUE SPACE.
002700 01 }ԃtO                         PIC X(3) VALUE SPACE.
003200 01 ҃R[hv.
003210     03 Ҕԍv                     PIC 9(6).
003220     03 }Ԃv                         PIC X.
003370 01 {paNv.
003380     03 {pav                     PIC 9    VALUE ZERO.
003390     03 {pNv.
003400        05 {pNv                    PIC 9(2) VALUE ZERO.
003410        05 {pv                    PIC 9(2) VALUE ZERO.
003440 01 ʂvR                       PIC 9(2) VALUE ZERO.
003450 01 pSҔԍvR             PIC X(8) VALUE SPACE.
002380 01 v                           PIC 9(2) VALUE ZERO.
003240 01 ҃R[hbv.
003250     03 Ҕԍbv                   PIC 9(6).
003260     03 }Ԃbv                       PIC X.
003270*
003280 01 {paNbv.
003290   03 {paNbv.
003300     05 {pabv                   PIC 9.
003310     05 {pNbv.
003320        07 {pNbv                  PIC 9(2).
003330        07 {pbv                  PIC 9(2).
003340   03 {pbv                       PIC 9(2).
002710 01 ʂv                         PIC 9(2) VALUE ZERO.
002720 01 ʂv                         PIC 9(2) VALUE ZERO.
002730 01 ʂvQ                       PIC 9(2) VALUE ZERO.
002740 01 ʂvQ                       PIC 9(2) VALUE ZERO.
002750 01 fÔNbv                   PIC X(7) VALUE ZERO.
       01 O݌vzv                       PIC 9(6) VALUE ZERO.
      */}Ԃ̗݌vz擾/20240424
001610*****************************************************************
001620*                          A                             *
001630*****************************************************************
001640*
001650* vZAgL[
001660 01 gAvZ|L[ IS EXTERNAL.
001670* / inp^ /
001680   03 gAvZ|{p敪                   PIC 9.
001690   03 gAvZ|{paN.
001700      05 gAvZ|{paN.
001710        07 gAvZ|{pa              PIC 9.
001720        07 gAvZ|{pN.
001730          09 gAvZ|{pN              PIC 9(2).
001740          09 gAvZ|{p              PIC 9(2).
001750      05 gAvZ|{p                  PIC 9(2).
001760   03 gAvZ|҃R[h.
001770      05 gAvZ|Ҕԍ                PIC 9(6).
001780      05 gAvZ|}                    PIC X.
001790   03 gAvZ|ی                   PIC 9(2).
001800* / p^/
001810   03 gAvZ|p^.
001820      05 gAvZ|SvZ敪          PIC 9.
001830      05 gAvZ|pz                  PIC 9(6).
001840*  "YES"(S敪1,2,3,4)
001850      05 gAvZ|tO            PIC X(3).
001860*  ̏Ȃ"YES"(S敪5)
001870      05 gAvZ|fÃtO            PIC X(3).
001880*  ̋z]L(S敪1)
001890      05 gAvZ|                  PIC 9(4).
001900*  ̓܂ł̎(}Ԃ܂)(S敪6,8,13)
001910      05 gAvZ|                  PIC 9(2).
001920*  ÉcpB̕ŜȂ  OFȂ@PF (S敪7)
001930      05 gAvZ|̑vZ敪P        PIC 9.
001940*  out
001950      05 gAvZ|Sz                  PIC 9(6).
001960      05 gAvZ|z                  PIC 9(6).
001970      05 gAvZ|Sz              PIC 9(5).
001980      05 gAvZ|z              PIC 9(5).
001990      05 gAvZ|S                  PIC 9(3).
002000*
      */ẑUver/20231117
001980  01 gAvZ|zQ                PIC 9(6) IS EXTERNAL.
      *
      */vSz͏ȉʂľܓ/20220601
006460 01 gAvZQ|L[ IS EXTERNAL.
006620      05 gAvZQ|v敪              PIC 9.
002010*
      */Sz؂グp/20221125
001660 01 gAvZR|L[ IS EXTERNAL.
001950    03 gAvZR|Sz                  PIC 9(6).
001970    03 gAvZR|Sz              PIC 9(5).
002020*---------------------------------------------------------*
002030* ۏ؃tOp
002040 01 gAvZ|L[ IS EXTERNAL.
002050   03 gAvZ|ۏ؃tO         PIC X(3).
002060*
002070*---------------------------------------------------------*
002080*
002090* zvZAgL[
002100 01 gAvZ|L[ IS EXTERNAL.
002110   03 gAvZ|S敪               PIC 9(2).
002120*
002121*---------------------------------------------------------*
002122* rp
002123 01 gAvZr|L[ IS EXTERNAL.
002124   03 gAvZr|rJn   PIC 9(2).
002125*---------------------------------------------------------*
002126*
002128*---------------------------------------------------------*
002129* ݌vp
002130 01 gAvZ݌vz|Sz       PIC 9(6) IS EXTERNAL.
002131 01 gAvZ݌vz|SƏ   PIC 9 IS EXTERNAL.
002132*---------------------------------------------------------*
002134*
002135*-------------------------------------------------------*
002140* S擾p14/10`
002150 01 A|S擾L[ IS EXTERNAL.
002160    03 A|{paN.
002170       05 A|{pa               PIC 9.
002180       05 A|{pN.
002190          07 A|{pN              PIC 9(2).
002200          07 A|{p              PIC 9(2).
002210    03 A|҃R[h.
002220       05 A|Ҕԍ               PIC 9(6).
002230       05 A|}                   PIC X.
002240    03 A|ەS                PIC 9(3).
002250    03 A|ۖ{̕S            PIC 9(3).
002260    03 A|ەS                PIC 9(3).
002270    03 A|QVVS              PIC 9(3).
002280    03 A|S                PIC 9(3).
002290    03 A|ʗpS              PIC 9(3).
002300*
002310*
002320* mFbZ[Wp (Qs)
002330 01 AV|L[ IS EXTERNAL.
002340    03  AV|bZ[WP             PIC X(40).
002350    03  AV|bZ[WQ             PIC X(40).
002360*
      */S敪QQ({30N4`)/20180306
004887* 01 AvZ݌vz|SzPO   PIC 9(6) IS EXTERNAL.
004887 01 A|SzPfv               PIC 9(6) IS EXTERNAL.
004887 01 A|SzPOfv             PIC 9(6) IS EXTERNAL.
004887 01 A|SzPfvQ             PIC 9(6) IS EXTERNAL.
004887 01 A|vZe                     PIC 9    IS EXTERNAL.
      */㏕F̏1xzȂꍇA{̂̕SzƍĂȂ/20220830
       01 SzҕSe                     PIC X(3) IS EXTERNAL.
002370******************************************************************
002380*                      PROCEDURE  DIVISION                       *
002390******************************************************************
002400 PROCEDURE               DIVISION.
002410************
002420*           *
002430*    *
002440*           *
002450************
002460     PERFORM .
002470     PERFORM S擾.
002480     PERFORM fҏ擾.
002490     IF | NOT = ZERO
002500         PERFORM vZ擾
002510     END-IF.
002520*
002530************
002540*           *
002550* 又     *
002560*           *
002570************
002580*    /outiS͏Ȃj
002590     MOVE ZERO TO gAvZ|Sz.
002600     MOVE ZERO TO gAvZ|z.
002610     MOVE ZERO TO gAvZ|Sz.
002620     MOVE ZERO TO gAvZ|z.
      */Sz؂グp/20221125
001660     MOVE ZERO TO gAvZR|Sz gAvZR|Sz.
      */ẑUver/20240607
001980     MOVE ZERO TO gAvZ|zQ.
001980     INITIALIZE   gAvZ|zQ.
      *
002630*
002631*    /یؖY/
002632     IF |ی = 91
002633        PERFORM SzvZ
002635     ELSE
002640        EVALUATE TRUE
002650        WHEN (| = 05) 
002660*   /27VlAVl+
002670            PERFORM VlSzvZ
002680        WHEN (| = 51)
002690        WHEN (| NOT = ZERO) AND (S敪v = 09 OR 10)
002700*   /41VlA41ɏ鏕
002710            PERFORM SzvZ
002720            PERFORM VlSzvZ
002730        WHEN (| NOT = ZERO)
002740*   /(41VlA41ɏ鏕͏ŌvZς)
002750            PERFORM SzvZ
002760            PERFORM SzvZ
002770        WHEN OTHER
002780*   /ۂ̂
002790            PERFORM SzvZ
002800        END-EVALUATE
002801     END-IF.
002810*
002812*
002813*----------------------------------------------------------*
002814*    / Szpz傫ꍇ͔pzɂ/ 
002815     IF gAvZ|Sz > gAvZ|pz
002816        MOVE gAvZ|pz TO gAvZ|Sz
002817     END-IF.
002818*----------------------------------------------------------*
002819*
002820*----------------------------------------------------------*
002821* vŏr̎AɂȂȑÓA{̕Sz𕉒SzփZbg
002822     IF ( gAvZ|{p NOT = ZERO ) AND ( gAvZr|rJn NOT = ZERO ) AND
002823        ( gAvZ|{p < gAvZr|rJn )
002824         MOVE gAvZ|Sz TO gAvZ|Sz
002829         MOVE ZERO             TO gAvZ|z
002830     END-IF.
002831*----------------------------------------------------------*
002832*
002835************
002836*           *
002840* I   *
002850*           *
002860************
002870*
HILO  *     DISPLAY "HKT41410 " gAvZ|{paN " pz Sz z     RS R".
HILO  *     DISPLAY "HKT41410 " gAvZ|{paN " " gAvZ|pz " " gAvZ|Sz " " gAvZ|z " " gAvZ|Sz " " gAvZ|z " " gAvZR|Sz " " gAvZR|Sz.
002880     PERFORM I.
002890     MOVE 1 TO PROGRAM-STATUS.
002900     EXIT PROGRAM.
002910*
002920*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
002930*================================================================*
002940  SECTION.
002950*
002960* EXTERNAL-FILE OPENȂ
002970*
002980*
002990*
003000*================================================================*
003010 I[v`FbN SECTION.
003020*
003030     IF ԃL[  NOT =  "00"
003040         DISPLAY t@Cv NC"eI[vG[" UPON CONS
003050         DISPLAY NC"ԃL[F" ԃL[           UPON CONS
003060         DISPLAY NC"P͂dmsdqL[Ă"
003070                                                   UPON CONS
003071*-----------------------------------------*
003072         CALL "actcshm"  WITH C LINKAGE
003073*-----------------------------------------*
003080         ACCEPT  L[ FROM CONS
003090         PERFORM t@C
003100         MOVE ZERO TO PROGRAM-STATUS
003110         EXIT PROGRAM.
003120*================================================================*
003130 t@C SECTION.
003140*
003150*
003160*================================================================*
003170 I SECTION.
003180*
003190     PERFORM t@C.
003200*================================================================*
003210 G[\ SECTION.
003220*
003230     DISPLAY t@Cv NC"t@CG["   UPON CONS.
003240     DISPLAY NC"ԃL[F" ԃL[               UPON CONS.
003250     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
003260     DISPLAY NC"P͂dmsdqL[Ă"
003270                                                   UPON CONS.
003271*-----------------------------------------*
003272     CALL "actcshm"  WITH C LINKAGE.
003273*-----------------------------------------*
003280     ACCEPT  L[ FROM CONS.
003290     PERFORM t@C.
003300     MOVE ZERO TO PROGRAM-STATUS
003310     EXIT PROGRAM.
003320*================================================================*
003330 S擾 SECTION.
003340*/S͌Ăԕ̂ofŃZbgς݁B
003350*
003360*     MOVE SPACE TO A|S擾L[.
003370*     INITIALIZE    A|S擾L[.
003380*     MOVE gAvZ|{paN TO A|{paN.
003390*     MOVE gAvZ|҃R[h   TO A|҃R[h.
003400**
003410*     CALL   "HUTANRIT".
003420*     CANCEL "HUTANRIT".
003430*
003440     MOVE A|ۖ{̕S TO Sv gAvZ|S.
003450*
003460*================================================================*
003470*================================================================*
003480 SzvZ SECTION.
003490*******************************************************************
003500* Ӂ
003510* vEJéAŜP~̈ʂľܓiPO~Pʁj
003520* ZvǵAS̏_Pʂ؂グ
003530******************************************************************
003540*
003550     MOVE ZERO TO Szv.
003560     MOVE ZERO TO zv.
003570****************************************************************
003580* SvZ@̎w  SvZ敪  pEz   Sz  *
003590* @@@@@@@@@@@@@@O@@@@@P~P    P~P *
003600*              @@@@ @@@P@@@@PO~P             *
003610*              @@@@@@@ Q@@@@@P~P  PO~P *
003620*----------------------------*
003630* ہv͂QAv͂O
003640*----------------------------*
003650****************************************************************
003660*****************************************
003670* SzPO~PʁiP~̈ʂľܓj*
003680*****************************************
003690     EVALUATE gAvZ|SvZ敪
003700     WHEN 2
003710* SźA_ȉPʂ؂グ
003720         COMPUTE SԌʂv =  Sv / 100
003730         COMPUTE SzvPO = gAvZ|pz * SԌʂv
003740         COMPUTE Szv = SzvPO * 10
003750         DIVIDE  Szv BY 10 GIVING    v
003760                                  REMAINDER ]v
003770         END-DIVIDE
003780         IF ]v = ZERO
003790             COMPUTE SԌʂv =  Sv / 100
003800             COMPUTE Szv = gAvZ|pz * SԌʂv
003810*
003820* SzvP~Pʂ̏ԂŐzvZ
003830             COMPUTE zv = gAvZ|pz - Szv
003840*
003850             COMPUTE SzvQ ROUNDED = Szv / 10
003860             COMPUTE Szv = SzvQ * 10
003870         ELSE
003880             COMPUTE SԌʂv =  Sv / 100
003890             COMPUTE Szv = gAvZ|pz * SԌʂv
003900* _ȉPʂꍇAɂP؂グ
003910*/v̏ꍇSz؂グzP͎
003920*             COMPUTE Szv = Szv + 1
003930* SzvP~Pʂ̏ԂŐzvZ
003940             COMPUTE zv = gAvZ|pz - Szv - 1
003950*
003960             COMPUTE SzvQ ROUNDED = Szv / 10
003970             COMPUTE Szv = SzvQ * 10
003980         END-IF
003990*
004003******************
004010* SzP~P *
004020******************
004030     WHEN ZERO
004040         COMPUTE SԌʂv = ( Sv / 100 )
004050         COMPUTE SzvPO = gAvZ|pz * SԌʂv
004060         COMPUTE Szv = SzvPO * 10
004070         DIVIDE  Szv BY 10 GIVING    v
004080                                REMAINDER ]v
004090         END-DIVIDE
004100         IF ]v = ZERO
004110             COMPUTE SԌʂv =  Sv / 100
004120             COMPUTE Szv = gAvZ|pz * SԌʂv
004130             COMPUTE zv = gAvZ|pz - Szv
      */Sz؂グo[WɑΉ/20221124
004170             COMPUTE SzSv  = gAvZ|pz * SԌʂv + 0.9
004140         ELSE
      */vSz͏ȉʂľܓ/20220601
006620             IF gAvZQ|v敪 = 1
004160                 COMPUTE SԌʂv =  Sv / 100
004170                 COMPUTE Szv ROUNDED = gAvZ|pz * SԌʂv
      */Sz؂グo[WɑΉ/20221124
004170                 COMPUTE SzSv  = gAvZ|pz * SԌʂv + 0.9
006620*                 MOVE ZERO TO gAvZQ|v敪
                   ELSE
      */vSz͏ȉʂľܓ/20220601
004150* ꕔS̒[؂グ
004160                 COMPUTE SԌʂv =  Sv / 100
004170                 COMPUTE Szv = gAvZ|pz * SԌʂv
004180* DEBUG
004190*     DISPLAY NC"Szv|P" Szv UPON MSGBOX
004200*
004210                 COMPUTE Szv = Szv + 1
004220* DEBUG
004230*     DISPLAY NC"Szv|Q" Szv UPON MSGBOX
004240*
      */Sz؂グo[WɑΉ/20221202
004170                 MOVE Szv TO SzSv
                   END-IF
004250             COMPUTE zv = gAvZ|pz - Szv
004260         END-IF
004270     WHEN OTHER
004280*/G[\̏C
004290         PERFORM R\[G[mF
004300         DISPLAY "SvZ敪w肳Ă܂"
004310                 " f҇="   gAvZ|҃R[h
004320                 " {pN="   gAvZ|{pN gAvZ|{p UPON CONS
004330*         DISPLAY NC"SvZ敪w肳Ă܂" UPON MSGBOX
004340         PERFORM t@C
004350         MOVE ZERO TO PROGRAM-STATUS
004360         EXIT PROGRAM
004370     END-EVALUATE.
004380*
004390*****
004400     MOVE Szv TO gAvZ|Sz.
004410     MOVE zv TO gAvZ|z.
      */Sz؂グo[WɑΉ/20221202
004170     MOVE SzSv TO gAvZR|Sz.
004420****
004430*
004440*================================================================*
004450 R\[G[mF SECTION.
004460*
004470     IF G[\e = ZERO
004480         MOVE  "G[̂ŃR\[ʂ̓e" TO AV|bZ[WP
004490         MOVE  "mFACĂB"             TO AV|bZ[WQ
004500         CALL   "MSG007"
004510         CANCEL "MSG007"
004520     END-IF.
004530     MOVE 1 TO G[\e.
004540*================================================================*
004550 fҏ擾 SECTION.
004560*
004570     MOVE gAvZ|{pa TO |{pa.
004580     MOVE gAvZ|{pN   TO |{pN.
004590     MOVE gAvZ|{p   TO |{p.
004600     MOVE gAvZ|Ҕԍ TO |Ҕԍ.
004610     MOVE gAvZ|}     TO |}.
004620     READ fҏe
004630     INVALID KEY
004640*/G[\̏C
004650         PERFORM R\[G[mF
004660         DISPLAY "{p̎fҏ񂪂܂"
004670                 " f҇=" gAvZ|҃R[h
004680                 " {pN=" gAvZ|{pN gAvZ|{p UPON CONS
004690         PERFORM t@C
004700         MOVE ZERO TO PROGRAM-STATUS
004710         EXIT PROGRAM
004720     NOT INVALID KEY
004730         MOVE |SƏ TO SƏv
004740     END-READ.
004750*================================================================*
004760  SzvZ SECTION.
004770*
004780     EVALUATE TRUE
004790*/iؖ̑Ή/*((ہۑgȊO)܂͑ސE)iؖ敪P̎͑SzҕS
004800     WHEN (((|ی = 01)  AND (|یҔԍ(3:1) NOT = "3")) OR
004810           ( |ی = 08)) AND
004820           ( |iؖ敪 = 1)
004830         MOVE gAvZ|Sz TO gAvZ|Sz
004840         MOVE ZERO             TO gAvZ|z
004850* 
004860     WHEN (( |ی >= 01 ) AND ( |ی <= 09 )) AND
004870          ( |یҔԍ         NOT = SPACE ) AND
004880          ( |               = ZERO  ) AND
004890          ( |pSҔԍ         = SPACE ) AND
004900          ( | >= 50 AND | <= 60 ) AND
004910          ( |pSҔԍ NOT = SPACE )
004920         PERFORM Z菈
004930* ےP
004940     WHEN ( |ی               = ZERO  ) AND
004950          ( |یҔԍ             = SPACE ) AND
004960          ( |               = ZERO  ) AND
004970          ( |pSҔԍ         = SPACE ) AND
004980          ( |               = 50    ) AND
004990          ( |pSҔԍ NOT = SPACE )
005000         PERFORM Z菈
005010     WHEN OTHER
005020*/G[\̏C
005030         PERFORM R\[G[mF
005040         DISPLAY "ZĂ܂"
005050                 " f҇=" |҃R[h
005060                 " {pN=" |{pN |{p UPON CONS
005070     END-EVALUATE.
005080*================================================================*
005090 vZ擾 SECTION.
005100*
005110     MOVE |           TO s|.
005120     MOVE |pSҔԍ TO s|sԍ.
005130     READ s}X^
005140     INVALID KEY
005150*/G[\̏C
005160         PERFORM R\[G[mF
005170         DISPLAY "sԍo^Ă܂"
005180                 " f҇="   |҃R[h
005190                 " {pN="   |{pN |{p
005200                 " ="   |
005210                 " sԍ=" |pSҔԍ UPON CONS
005220         PERFORM t@C
005230         MOVE ZERO TO PROGRAM-STATUS
005240         EXIT PROGRAM
005250     NOT INVALID KEY
005714*******
005715         MOVE ZERO   TO S敪v
005716         MOVE ZERO   TO Szv
005717         MOVE ZERO   TO S񐔂v
005718         MOVE ZERO   TO Sv
005719         MOVE ZERO   TO 萔v
005720**
005721* ʕS
005722         MOVE |           TO ۓ|ی
005723         MOVE |pSҔԍ TO ۓ|یҔԍ
005724         MOVE gAvZ|{pa     TO ۓ|Jna
005725         MOVE gAvZ|{pN       TO ۓ|JnN
005726         MOVE gAvZ|{p       TO ۓ|Jn
005727         START یғʕS}X^ KEY IS <= ۓ|ی 
005728                                              ۓ|یҔԍ
005729                                              ۓ|JnaN
005730                                              REVERSED
005731         END-START
005732         IF ԃL[ = "00" 
005733             READ یғʕS}X^ NEXT
005734             NOT AT END
005735                 IF ( ۓ|ی   = | ) AND
005736                    ( ۓ|یҔԍ = |pSҔԍ )
005737                    MOVE ۓ|S敪       TO S敪v
005738                    MOVE ۓ|Sz   TO Szv
005739                    MOVE ۓ|S   TO S񐔂v
005740                    MOVE ۓ|SP       TO Sv
005741                    MOVE ۓ|萔     TO 萔v
005749                    MOVE ۓ|xzP       TO xzPv
005750                    MOVE ۓ|xzQ       TO xzQv
005751                    MOVE ۓ|xzR       TO xzRv
005754                 END-IF
005755             END-READ
005756         END-IF
005757*******
005758     END-READ.
005759*
005760*================================================================*
005761 Z菈 SECTION.
005762* mn
005763******************************************************************
005764* ̔pz̐eیSes̏ZsB
005765******************************************************************
005766*
005767*     PERFORM vZ擾.
005768*/SƏ̔B_ł͕SvZPG̑OɂĂ邪A͂ł͂ōsȂB/0506
005769*     PERFORM SZ.
005770     IF SƏv NOT = 1
005771         PERFORM SZ
005772     ELSE
005780         MOVE ZERO             TO gAvZ|Sz
005790         MOVE gAvZ|Sz TO gAvZ|z
005800     END-IF.
005810*
005820*================================================================*
005830 SZ SECTION.
005840*
005850* 
005860     EVALUATE S敪v
005870*@OFʏ퐿iSzSj
005880     WHEN ZERO
005890         MOVE ZERO             TO gAvZ|Sz
005900         MOVE gAvZ|Sz TO gAvZ|z
      */ẑUver/20231117
005900         MOVE gAvZ|Sz TO gAvZ|zQ
005910*@PF()ɑ΂镉S
005920     WHEN 1
005930*
005940         IF gAvZ|tO NOT = SPACE
005950*             MOVE |{pa TO A|{pa
005960*             MOVE |{pN   TO A|{pN
005970*             MOVE |{p   TO A|{p
005980*             MOVE |Ҕԍ TO A|Ҕԍ
005990*             MOVE |}     TO A|}
006000*             CALL   "HUTANRIT"
006010*             CANCEL "HUTANRIT"
006020             MOVE A|ۖ{̕S TO Sv
006030             PERFORM SzvZ
006040         ELSE
006050             MOVE ZERO             TO gAvZ|Sz
006060             MOVE gAvZ|Sz TO gAvZ|z
006070         END-IF
006080*@QF()ɑ΂z
006090     WHEN 2
006100         IF gAvZ|tO NOT = SPACE
006110             MOVE Szv TO gAvZ|Sz
006120             COMPUTE zv     = gAvZ|Sz - Szv
006130             MOVE zv       TO gAvZ|z
006140         ELSE
006150             MOVE ZERO             TO gAvZ|Sz
006160             MOVE gAvZ|Sz TO gAvZ|z
006170         END-IF
006180*@RF(̔)̔pz̖{̕Sɑ΂镉S
006190     WHEN 3
006200         IF gAvZ|tO NOT = SPACE
006210*             MOVE |{pa TO A|{pa
006220*             MOVE |{pN   TO A|{pN
006230*             MOVE |{p   TO A|{p
006240*             MOVE |Ҕԍ TO A|Ҕԍ
006250*             MOVE |}     TO A|}
006260*             CALL   "HUTANRIT"
006270*             CANCEL "HUTANRIT"
006280             MOVE A|ۖ{̕S TO Sv
006290* r̕ŚAP~Pʂ̂܂܁ǍvZsB
006300* ̔pz̖{̕SvZB
006310             PERFORM SzvZ
006320         ELSE
006330             MOVE ZERO             TO gAvZ|Sz
006340             MOVE gAvZ|Sz TO gAvZ|z
006350         END-IF
006360*@SF(̔)̔pz̖{̕Sɑ΂z
006370     WHEN 4
006380         IF gAvZ|tO NOT = SPACE
006390* r̕ŚAP~Pʂ̂܂܁ǍvZsB
006400             IF Szv >= gAvZ|Sz
006410                 MOVE gAvZ|Sz TO gAvZ|Sz
006420                 MOVE ZERO             TO gAvZ|z
006430             ELSE
006440                 MOVE Szv   TO gAvZ|Sz
006450                 COMPUTE zv = gAvZ|Sz - Szv
006460                 MOVE zv         TO gAvZ|z
006470             END-IF
006480         ELSE
006490             MOVE ZERO             TO gAvZ|Sz
006500             MOVE gAvZ|Sz TO gAvZ|z
006510         END-IF
006520*@TFz𕉒Sivł͌̏ɊZHj
006530* 
006540     WHEN 5
006542         PERFORM ꕔSZOT
006543*
006630*@UFzA񐔂𕉒S
006640* 
006650     WHEN 6
006660     WHEN 8
006670         PERFORM ꕔSZ
006680*@VFw肵̔pz̖{̕Sɑ΂z
006690* 
006700     WHEN 7
006710*         PERFORM {pL^e擾
006720         IF gAvZ|̑vZ敪P = 1
006730             IF Szv >= gAvZ|Sz
006740                 MOVE gAvZ|Sz TO gAvZ|Sz
006750                 MOVE ZERO             TO gAvZ|z
006760             ELSE
006770                 MOVE Szv  TO gAvZ|Sz
006780                 COMPUTE zv      = gAvZ|Sz - Szv
006790                 MOVE zv        TO gAvZ|z
006800             END-IF
006810         ELSE
006820             MOVE ZERO             TO gAvZ|Sz
006830             MOVE gAvZ|Sz TO gAvZ|z
006840         END-IF
006850*/m̓c̑Ή0109
006860* PPF̔pzɑ΂镉S
006870     WHEN 11
006880         PERFORM SzvZPP
006890*
006900         MOVE Szv TO gAvZ|Sz
006910         COMPUTE gAvZ|z = gAvZ|Sz - gAvZ|Sz
006920* PQF{̕SzSzS030717
006930     WHEN 12
006940         MOVE gAvZ|Sz TO gAvZ|Sz
006950         MOVE ZERO             TO gAvZ|z
006960* PRFzA񐔂𕉒SiPO~Pʁj
006970     WHEN 13
006980         PERFORM ꕔSZPO
006990*/0506Ɍ̉170701
007000* PSFz񐔂܂ŕSi萔ᏊҗpSzƂj
007010     WHEN 14
007020         PERFORM ꕔSZPS
007021*
007022*/w蕉SŖz܂ŕSij
007023     WHEN 16
007024         PERFORM ꕔSZPU
007025*
007026*/_ˎsΉ/
007027* PVFw芄z܂ň񐔕S
007028     WHEN 17
007029         PERFORM ꕔSZPV
007030*
      */{Ή/20180306
      * 22Fzň񐔂xz܂ŕS(P~P)
012130     WHEN 22
012140         PERFORM ꕔSZQQ
007030*
      */\聫
      ** 23Fzň񐔂xz܂ŕS(PO~P)
012130*     WHEN 23
012140*         PERFORM ꕔSZQR
      */\聪
007030*
007031     WHEN OTHER
007040         MOVE ZERO             TO gAvZ|Sz
007050         MOVE gAvZ|Sz TO gAvZ|z
007060     END-EVALUATE.
007070*
007080*================================================================*
007090 SzvZ SECTION.
007100******************************************************************
007110* Ӂ
007120* vEJéAŜP~̈ʂľܓiPO~Pʁj
007130* ZvǵAS̏_Pʂ؂グ
007140******************************************************************
007150*
007160* SzPO~PʁiP~̈ʂľܓj
007170     EVALUATE gAvZ|SvZ敪
007180     WHEN 2
007190         COMPUTE SԌʂv = Sv / 100
007200         COMPUTE Szv = gAvZ| * SԌʂv
007210
007220         COMPUTE zv = gAvZ|Sz - Szv
007230         COMPUTE SzvQ ROUNDED = Szv / 10
007240         COMPUTE Szv = SzvQ * 10
007250*
007260     WHEN ZERO
007270         COMPUTE SԌʂv = Sv / 100
007280         COMPUTE SzvPO = gAvZ| * SԌʂv
007290         COMPUTE Szv = SzvPO * 10
007300         DIVIDE  Szv BY 10 GIVING    v
007310                                  REMAINDER ]v
007320         END-DIVIDE
007330         IF ]v = ZERO
007340             COMPUTE SԌʂv = Sv / 100
007350             COMPUTE Szv = gAvZ| * SԌʂv
007360             COMPUTE zv = gAvZ|Sz - Szv
007370         ELSE
007380* ꕔS̒[؂グ
007390             COMPUTE SԌʂv = Sv / 100
007400             COMPUTE Szv = gAvZ| * SԌʂv
007410             COMPUTE Szv = Szv + 1
007420             COMPUTE zv = gAvZ|Sz - Szv
007430         END-IF
007440     WHEN OTHER
007450*/G[\̏C
007460         PERFORM R\[G[mF
007470         DISPLAY "SZ敪w肳Ă܂"
007480                 " f҇="   |҃R[h
007490                 " {pN="   |{pN |{p UPON CONS
007500*         DISPLAY NC"SvZ敪w肳Ă܂" UPON MSGBOX
007510         PERFORM t@C
007520         MOVE ZERO TO PROGRAM-STATUS
007530         EXIT PROGRAM
007540     END-EVALUATE.
007550*
007560     MOVE Szv TO gAvZ|Sz.
007570     MOVE zv TO gAvZ|z.
007580*
007590*================================================================*
007600 SzvZ SECTION.
007610******************************************************************
007620* Ӂ
007630* vEJéAŜP~̈ʂľܓiPO~Pʁj
007640* ZvǵAS̏_Pʂ؂グ
007650******************************************************************
007660*
007670* SzPO~PʁiP~̈ʂľܓj
007680     EVALUATE gAvZ|SvZ敪
007690     WHEN 2
007700         COMPUTE SԌʂv = Sv / 100
007710         COMPUTE SzvPO = gAvZ|pz * SԌʂv
007720         COMPUTE Szv = SzvPO * 10
007730         DIVIDE  Szv BY 10 GIVING    v
007740                                  REMAINDER ]v
007750         END-DIVIDE
007760         IF ]v = ZERO
007770             COMPUTE Szv = gAvZ|pz * SԌʂv
007780             COMPUTE SzvQ ROUNDED = Szv / 10
007790             COMPUTE Szv = SzvQ * 10
007800             MOVE Szv TO gAvZ|Sz
007810             MOVE ZERO         TO gAvZ|z
007820         ELSE
007830             COMPUTE Szv = gAvZ|pz * SԌʂv
007840* _ȉPʂꍇAɂP؂グ
007850*/͎
007860*             COMPUTE Szv = Szv + 1
007870             COMPUTE SzvQ ROUNDED = Szv / 10
007880             COMPUTE Szv = SzvQ * 10
007890             MOVE Szv TO gAvZ|Sz
007900             MOVE ZERO         TO gAvZ|z
007910         END-IF
007920     WHEN ZERO
007930         COMPUTE SԌʂv = Sv / 100
007940         COMPUTE SzvPO = gAvZ|pz * SԌʂv
007950         COMPUTE Szv = SzvPO * 10
007960         DIVIDE  Szv BY 10 GIVING    v
007970                                  REMAINDER ]v
007980         END-DIVIDE
007990         IF ]v = ZERO
008000             COMPUTE Szv = gAvZ|pz * SԌʂv
008010             MOVE Szv     TO gAvZ|Sz
008020             MOVE ZERO         TO gAvZ|z
008030         ELSE
008040* ꕔS̒[؂グ
008050             COMPUTE Szv = gAvZ|pz * SԌʂv
008060             COMPUTE Szv = Szv + 1
008070             MOVE Szv TO gAvZ|Sz
008080             MOVE ZERO         TO gAvZ|z
008090         END-IF
008100     WHEN OTHER
008110*/G[\̏C
008120         PERFORM R\[G[mF
008130         DISPLAY "SZ敪w肳Ă܂"
008140                 " f҇="   |҃R[h
008150                 " {pN="   |{pN |{p UPON CONS
008160         PERFORM t@C
008170         MOVE ZERO TO PROGRAM-STATUS
008180         EXIT PROGRAM
008190     END-EVALUATE.
008200*
008210*================================================================*
008220 ꕔSZ SECTION.
008230* mn
008240******************************************************************
008250* ̔pz̐eیSVlꕔŜ݂ҕSB
008260*iɍőAv`|VlS񐔕j
008270* ꌎŏĂAی؂ւĂVlS񐔕
008280* JEgB
008290******************************************************************
008300*
008310* eی̓rŕςA}ԏsꍇlAOeی
008320* fÂ󂯌p
008330*
008340***     PERFORM fÉ񐔎擾.
008350*
008360*  / Z(v)́AƂ̏vZSzWvPGCALL. ĂяoꂽPGŁA
008370*    Sz,zZbg /
008380     IF gAvZ|{p = ZERO
008390        PERFORM ꕉSvZďo
008400     ELSE
008410        IF (gAvZ| > S񐔂v) OR
008420           (gAvZ| = ZERO)
008430            MOVE ZERO             TO gAvZ|Sz
008440            MOVE gAvZ|Sz TO gAvZ|z
008450        ELSE
008460*
008470            IF gAvZ|Sz <= Szv
008480                EVALUATE gAvZ|SvZ敪
008490                WHEN ZERO
008500                    MOVE gAvZ|Sz TO gAvZ|Sz
008510                    MOVE ZERO             TO gAvZ|z
      */()Sz؂グo[WɑΉ/20221124
                          IF |pSҔԍ(3:2) = "27"
008500                        MOVE gAvZR|Sz TO gAvZR|Sz
                          END-IF
      */()Sz؂グo[WɑΉ/20221124
008520*
008530                WHEN 2
008540                    COMPUTE SzvQ ROUNDED = gAvZ|Sz / 10
008550                    COMPUTE Szv = SzvQ * 10
008560                    MOVE Szv TO gAvZ|Sz
008570                    MOVE ZERO     TO gAvZ|z
008580                WHEN OTHER
008590*/G[\̏C
008600                    PERFORM R\[G[mF
008610                    DISPLAY "SZ敪w肳Ă܂"
008620                            " f҇="   |҃R[h
008630                            " {pN="   |{pN |{p UPON CONS
008640                    PERFORM t@C
008650                    MOVE ZERO TO PROGRAM-STATUS
008660                    EXIT PROGRAM
008670                END-EVALUATE
008680*
008690            ELSE
008700                EVALUATE gAvZ|SvZ敪
008710                WHEN ZERO
008720* ݂́AVlꕔSATOO~̂߁APO~PʂɂKvȂ
008730                WHEN 2
008740                    MOVE Szv TO gAvZ|Sz
008750                    COMPUTE zv     = gAvZ|Sz - Szv
008760                    MOVE zv       TO gAvZ|z
      */()Sz؂グo[WɑΉ/20230228
                          IF |pSҔԍ(3:2) = "27"
008740                        MOVE Szv TO gAvZR|Sz
                          END-IF
      */()Sz؂グo[WɑΉ/20230228
008770*
008780                WHEN OTHER
008790*/G[\̏C
008800                    PERFORM R\[G[mF
008810                    DISPLAY "SZ敪w肳Ă܂"
008820                            " f҇="   |҃R[h
008830                            " {pN="   |{pN |{p UPON CONS
008840                    PERFORM t@C
008850                    MOVE ZERO TO PROGRAM-STATUS
008860                    EXIT PROGRAM
008870                END-EVALUATE
008880            END-IF
008890        END-IF
008900     END-IF.
HILO  *     IF gAvZ|{p = ZERO DISPLAY "ꕔSZ " gAvZ|Sz " " gAvZ|z.
008910*
008920*================================================================*
008930 SzvZPP SECTION.
008940*
008950* PPF̔pzɑ΂镉S
008960****************************************************************
008970* SvZ@̎w  SvZ敪  pEz   Sz  *
008980* @@@@@@@@@@@@@@O@@@@@P~P    P~P *
008990*              @@@@ @@@P@@@@PO~P             *
009000*              @@@@@@@ Q@@@@@P~P  PO~P *
009010****************************************************************
009020*
009030     EVALUATE gAvZ|SvZ敪
009040     WHEN ZERO
009050*/ʂľܓĂP̈ʂ܂ŌvZ
009060         COMPUTE SԌʂv     =  Sv / 100
009070         COMPUTE Szv ROUNDED = gAvZ|pz * SԌʂv
009080     WHEN 2
009090*/P̈ʂľܓĂPÖʂ܂ŌvZ
009100         COMPUTE SԌʂv = Sv / 100
009110         COMPUTE Szv     = gAvZ|pz * SԌʂv
009120*       /*P̈ʂľܓĂPO~Pʂɂ
009130         COMPUTE Szv ROUNDED = Szv / 10
009140         COMPUTE Szv         = Szv * 10
009150     END-EVALUATE.
009160*
009170*================================================================*
009180 VlSzvZ SECTION.
009190*
009200     MOVE |pSҔԍ     TO sԍVlv.
009210     MOVE |pSҔԍ TO sԍv.
009220*
009230     EVALUATE TRUE
009240* QVVl
009250     WHEN (( |ی >= 01 ) AND ( |ی <= 09 )) AND
009260          ( |یҔԍ     NOT = SPACE ) AND
009270          ( |           = 05    ) AND
009280          ( |pSҔԍ NOT = SPACE ) AND
009290          ( @ʔԍVlv         = "27"  ) AND
009300          ( |           = ZERO  ) AND
009310          ( |pSҔԍ = SPACE )
009320*//0801
009330     WHEN (( |ی >= 01 ) AND ( |ی <= 09 )) AND
009340          ( |یҔԍ     NOT = SPACE ) AND
009350          ( |           = 05    ) AND
009360          ( |pSҔԍ NOT = SPACE ) AND
009370          ( |           = ZERO  ) AND
009380          ( |pSҔԍ = SPACE ) AND
009390          ( |{paN      >= 42004 )
009400         PERFORM 藦VlSZ
009410*/iؖ̑Ή/*SPVlƂSPɏ鏕)
009420*/QVVlłȂ((ہۑgȊO)܂͑ސE)iؖ敪P̎͑SzҕS
009430     WHEN (((|ی = 01)  AND (|یҔԍ(3:1) NOT = "3")) OR
009440           ( |ی = 08)) AND
009450           ( |iؖ敪 = 1) AND
009460           ( | NOT = 05)
009470         MOVE gAvZ|Sz TO gAvZ|Sz
009480         MOVE ZERO             TO gAvZ|z
009490* SPVl
009500     WHEN (( |ی >= 01 ) AND ( |ی <= 09 )) AND
009510          ( |یҔԍ         NOT = SPACE ) AND
009520          ( |               = ZERO  ) AND
009530          ( |pSҔԍ         = SPACE ) AND
009540          ( |               = 51    ) AND
009550          ( |pSҔԍ NOT = SPACE )
009560* SPVɏ鏕̑Ή
009570     WHEN ( | NOT = ZERO ) AND (S敪v = 09 OR 10) AND
009580* 27+41lĂȂB2727̃WbNցB(S̓[)
009590          ( |       = ZERO ) AND
009600          ( |pSҔԍ = SPACE)
009610         PERFORM 藦VlSZ
009620* QVVl{gE픚
009630     WHEN (( |ی >= 01 ) AND ( |ی <= 09 )) AND
009640          ( |یҔԍ     NOT = SPACE ) AND
009650          ( |           = 05    ) AND
009660          ( |pSҔԍ NOT = SPACE ) AND
009670          ( @ʔԍVlv         = "27"  ) AND
009680          ( | >= 50 AND | <= 60 ) AND
009690          ( |pSҔԍ NOT = SPACE )
009700*//0801
009710     WHEN (( |ی >= 01 ) AND ( |ی <= 09 )) AND
009720          ( |یҔԍ     NOT = SPACE ) AND
009730          ( |           = 05    ) AND
009740          ( |pSҔԍ NOT = SPACE ) AND
009750          ( | >= 50 AND | <= 60 ) AND
009760          ( |pSҔԍ NOT = SPACE ) AND
009770          ( |{paN      >= 42004 )
009780         PERFORM VlSZ
009790     WHEN OTHER
009800*/G[\̏C
009810         PERFORM R\[G[mF
009820         DISPLAY "VlZĂ܂"
009830                 " f҇=" |҃R[h
009840                 " {pN=" |{pN |{p UPON CONS
009850         PERFORM t@C
009860         MOVE ZERO TO PROGRAM-STATUS
009870         EXIT PROGRAM
009880     END-EVALUATE.
009890*
009900*================================================================*
009910 藦VlSZ SECTION.
009920* mQVVln
009930******************************************************************
009940* ̔pzVl̕SҕS
009950******************************************************************
009960*     MOVE Av|pz TO Av|pzVl.
009970     MOVE ZERO         TO Szv.
009980     MOVE ZERO         TO zv.
009990*
010000**     PERFORM VlS擾.
010010     MOVE A|QVVS TO Sv.
010020******************************************************************
010030*Ӂ
010040*vEJéAŜP~̈ʂľܓiPO~Pʁj
010050*ZvǵAS̏_Pʂ؂グ
010060******************************************************************
010070*
010080****************************************************************
010090* SvZ@̎w  SvZ敪  pEz   Sz  *
010100* @@@@@@@@@@@@@@O@@@@@P~P    P~P *
010110*              @@@@ @@@P@@@@PO~P             *
010120*              @@@@@@@ Q@@@@@P~P  PO~P *
010130****************************************************************
010140*****************************************
010150* SzPO~PʁiP~̈ʂľܓj*
010160*****************************************
010170     EVALUATE gAvZ|SvZ敪
010180     WHEN 2
010190*     SźA_ȉPʂ؂グ
010200         COMPUTE SԌʂv =  Sv / 100
010210         COMPUTE SzvPO = gAvZ|pz * SԌʂv
010220         COMPUTE Szv = SzvPO * 10
010230         DIVIDE  Szv BY 10 GIVING    v
010240                                  REMAINDER ]v
010250         END-DIVIDE
010260         IF ]v = ZERO
010270             COMPUTE SԌʂv =  Sv / 100
010280             COMPUTE Szv = gAvZ|pz * SԌʂv
010290*
010300             COMPUTE SzvQ ROUNDED = Szv / 10
010310             COMPUTE Szv = SzvQ * 10
010320*
010330*     SzvPO~Pʂ̏ԂŐzvZ
010340             COMPUTE zv = gAvZ|pz - Szv
010350         ELSE
010360             COMPUTE SԌʂv =  Sv / 100
010370             COMPUTE Szv = gAvZ|pz * SԌʂv
010380*
010390             COMPUTE SzvQ ROUNDED = Szv / 10
010400             COMPUTE Szv = SzvQ * 10
010410*
010420*     SzvPO~Pʂ̏ԂŐzvZ
010430             COMPUTE zv = gAvZ|pz - Szv
010440         END-IF
010450*
010460*    *****************
010470*     SzP~P *
010480*    *****************
010490     WHEN ZERO
010500         COMPUTE SԌʂv = ( Sv / 100 )
010510         COMPUTE SzvPO = gAvZ|pz * SԌʂv
010520         COMPUTE Szv = SzvPO * 10
010530         DIVIDE  Szv BY 10 GIVING    v
010540                                REMAINDER ]v
010550         END-DIVIDE
010560         IF ]v = ZERO
010570             COMPUTE SԌʂv =  Sv / 100
010580             COMPUTE Szv = gAvZ|pz * SԌʂv
010590             COMPUTE zv = gAvZ|pz - Szv
      */Sz؂グo[WɑΉ/20230131
004170             COMPUTE SzSv  = gAvZ|pz * SԌʂv + 0.9
010600         ELSE
      */vSz͏ȉʂľܓ/20220607
006620             IF gAvZQ|v敪 = 1
004160                 COMPUTE SԌʂv =  Sv / 100
004170                 COMPUTE Szv ROUNDED = gAvZ|pz * SԌʂv
006620*                 MOVE ZERO TO gAvZQ|v敪
      */Sz؂グo[WɑΉ/20221129
004170                 COMPUTE SzSv  = gAvZ|pz * SԌʂv + 0.9
      */̕Sz̐؂グ߂遫/20240612  *>HILO TEST
                       MOVE Szv TO SzSv
      */̕Sz̐؂グ߂遪/20240612  *>HILO TEST
                   ELSE
      */vSz͏ȉʂľܓ/20220607
010610*     ꕔS̒[؂グ
010620                 COMPUTE SԌʂv =  Sv / 100
010630                 COMPUTE Szv = gAvZ|pz * SԌʂv
010640*
010650                 COMPUTE Szv = Szv + 1
      */Sz؂グo[WɑΉ/20221129
004170                 MOVE Szv TO SzSv
010660*
                   END-IF
010670             COMPUTE zv = gAvZ|pz - Szv
010680         END-IF
010690     WHEN OTHER
010700*    /G[\̏C
010710         PERFORM R\[G[mF
010720         DISPLAY "SvZ敪w肳Ă܂"
010730                 " f҇="   |҃R[h
010740                 " {pN="   |{pN |{p UPON CONS
010750         PERFORM t@C
010760         MOVE ZERO TO PROGRAM-STATUS
010770         EXIT PROGRAM
010780     END-EVALUATE.
010790*
010800     MOVE Szv TO gAvZ|Sz.
010810     MOVE zv TO gAvZ|z.
      */Sz؂グo[WɑΉ/20221129
004170     MOVE SzSv TO gAvZR|Sz.
010820*
010830*----------------------------------------------------------------------------------*
010840*/VlSƏ 500~~2 ̑Ή(v̂݌vZ)/061120
010850     IF ( gAvZ|{p NOT = ZERO ) AND ( gAvZ|ۏ؃tO = "YES" )
010860          MOVE 500 TO Szv
010870          MOVE 2   TO S񐔂v
010880          PERFORM 㕉SƏQV
010890     END-IF.
010900*/VlSƏ 500~~2 ̑Ή(v̂݌vZ)/061120
010910*----------------------------------------------------------------------------------*
010920*
010930*
010940*================================================================*
010950 藦VlSZ SECTION.
010960*
010970* mSPVln
010980*/̕Sz
010990*/	X̔pzɂSPVlSPĂPށB
011000*/	[N͏_ȉRʂ܂ŎƂB
011010*/̕Sz
011020*/	̔pzɂSPVlSPĂP̂炢ľܓB
011030*
011040*     MOVE Av|pz TO Av|pz.
011050     MOVE ZERO         TO SzSPv.
011060     MOVE ZERO         TO Szv.
011070     MOVE ZERO         TO zv.
011080     MOVE ZERO         TO SzRv.
011090*
011100*     PERFORM S擾.
011110     MOVE A|S TO Sv.
011120******************************************************************
011130*Ӂ
011140*vEJéAŜP~̈ʂľܓiPO~Pʁj
011150*ZvǵAS̏_Pʂ؂グ
011160******************************************************************
011170*
011180****************************************************************
011190* SvZ@̎w  SvZ敪  pEz   Sz  *
011200* @@@@@@@@@@@@@@O@@@@@P~P    P~P *
011210*              @@@@ @@@P@@@@PO~P             *
011220*              @@@@@@@ Q@@@@@P~P  PO~P *
011230****************************************************************
011240*****************************************
011250* SzPO~PʁiP~̈ʂľܓj*
011260*****************************************
011270*/0101Vl̕Sz͓X̂PO~Pʂ̋z̍v
011280     EVALUATE gAvZ|SvZ敪
011290     WHEN 2
011300*     SźA_ȉPʂ؂グ
011310         COMPUTE SԌʂv =  Sv / 100
011320         COMPUTE SzvPO = gAvZ|pz * SԌʂv
011330         COMPUTE SzSPv = SzvPO * 10
011340         DIVIDE  SzSPv BY 10 GIVING    v
011350                                  REMAINDER ]v
011360         END-DIVIDE
011370         IF ]v = ZERO
011380             COMPUTE SԌʂv =  Sv / 100
011390             COMPUTE SzSPv = gAvZ|pz * SԌʂv
011400*
011410             COMPUTE SzvQ ROUNDED = SzSPv / 10
011420             COMPUTE SzSPv = SzvQ * 10
011430*
011440*     SzvPO~Pʂ̏ԂŐzvZ
011450             COMPUTE zv = gAvZ|Sz - SzSPv
011460         ELSE
011470             COMPUTE SԌʂv =  Sv / 100
011480             COMPUTE SzSPv = gAvZ|pz * SԌʂv
011490*
011500             COMPUTE SzvQ ROUNDED = SzSPv / 10
011510             COMPUTE SzSPv = SzvQ * 10
011520*
011530*     SzvPO~Pʂ̏ԂŐzvZ
011540             COMPUTE zv = gAvZ|Sz - SzSPv
011550         END-IF
011560*
011570*    *****************SPVľv̕Sz͓̔pz~S
011580*     SzP~P *̂܂ܑށBɂ͐؂グȂ
011590*    *****************̍v̏_ȉ͐؂グB
011600     WHEN ZERO
011610         COMPUTE SԌʂv = ( Sv / 100 )
011620         COMPUTE SzSPv = gAvZ|pz * SԌʂv
011630*
011640*/̍vɕSA_ȉ؂グB
011650*       */؂グ
011660         IF SzSPv(6:3) NOT = ZERO
011670             COMPUTE SzSPv = SzSPv + 1
011680             MOVE ZERO TO SzSPv(6:3)
011690         END-IF
011700         COMPUTE zv   = gAvZ|Sz - SzSPv
011710*
011720     WHEN OTHER
011730*    /G[\̏C
011740         PERFORM R\[G[mF
011750         DISPLAY "SvZ敪w肳Ă܂"
011760                 " f҇="   |҃R[h
011770                 " {pN="   |{pN |{p UPON CONS
011780         PERFORM t@C
011790         MOVE ZERO TO PROGRAM-STATUS
011800         EXIT PROGRAM
011810     END-EVALUATE.
011820*
011830     MOVE SzSPv TO gAvZ|Sz.
011840     MOVE zv     TO gAvZ|z.
011850*
011860*----------------------------------------------------------------------------------*
011870*/VlSƏ 500~~2 ̑Ή(v̂݌vZ)/061120
011880     IF ( gAvZ|{p NOT = ZERO ) AND ( gAvZ|ۏ؃tO = "YES" )
011890          MOVE 500 TO Szv
011900          MOVE 2   TO S񐔂v
011910          PERFORM 㕉SƏSP
011920     END-IF.
011930*/VlSƏ 500~~2 ̑Ή(v̂݌vZ)/061120
011940*----------------------------------------------------------------------------------*
011950*
011960*
011970*================================================================*
011980 VlSZ SECTION.
011990*
012000* mQVVl{n
012010*
012020     PERFORM 藦VlSZ.
012030*/QV{̏ꍇ͊ҕS͂O~ƂB
012040*/R`̐g͕SB
012050     IF |SƏ   NOT = 1
012060         PERFORM SZ
012070     ELSE
012080         MOVE ZERO             TO gAvZ|Sz
012090         MOVE gAvZ|Sz TO gAvZ|z
012100     END-IF.
012110*
012120*================================================================*
012130 ꕔSZPO SECTION.
012140* mn
012150******************************************************************
012160* ̔pz̐eیS珕ꕔŜ݂ҕSB
012170*iɍőAv`|VlS񐔕j
012180* ꌎŏĂAی؂ւĂS񐔕
012190* JEgB
012200******************************************************************
012210*
012220* eی̓rŕςA}ԏsꍇlAOeی
012230* fÂ󂯌p
012240*
012250***     PERFORM fÉ񐔎擾.
012260*
012270*  / Z(v)́AƂ̏vZSzWvPGCALL. ĂяoꂽPGŁA
012280*    Sz,zZbg /
012290     IF gAvZ|{p = ZERO
012300        PERFORM ꕉSvZďo
012310     ELSE
012320        IF (gAvZ| > S񐔂v) OR
012330           (gAvZ| = ZERO)
012340            MOVE ZERO             TO gAvZ|Sz
012350            MOVE gAvZ|Sz TO gAvZ|z
012360        ELSE
012370*
012380            IF gAvZ|Sz <= Szv
012390                EVALUATE gAvZ|SvZ敪
012400*/X̕Sz̍v̕SzƂB(ľܓz̍v)
012410                WHEN ZERO
012420                WHEN 2
012430                    COMPUTE SzvQ ROUNDED = gAvZ|Sz / 10
012440                    COMPUTE Szv = SzvQ * 10
012450                    MOVE Szv TO gAvZ|Sz
012460                    MOVE ZERO     TO gAvZ|z
012470                WHEN OTHER
012480*/G[\̏C
012490                    PERFORM R\[G[mF
012500                    DISPLAY "SZ敪w肳Ă܂"
012510                            " f҇="   |҃R[h
012520                            " {pN="   |{pN |{p UPON CONS
012530                    PERFORM t@C
012540                    MOVE ZERO TO PROGRAM-STATUS
012550                    EXIT PROGRAM
012560                END-EVALUATE
012570*
012580            ELSE
012590                EVALUATE gAvZ|SvZ敪
012600                WHEN ZERO
012610*/ ݒ肳ꂽẑ܂ܓ]LB
012620                WHEN 2
012630                    MOVE Szv TO gAvZ|Sz
012640                    COMPUTE zv     = gAvZ|Sz - Szv
012650                    MOVE zv       TO gAvZ|z
012660*
012670                WHEN OTHER
012680*/G[\̏C
012690                    PERFORM R\[G[mF
012700                    DISPLAY "SZ敪w肳Ă܂"
012710                            " f҇="   |҃R[h
012720                            " {pN="   |{pN |{p UPON CONS
012730                    PERFORM t@C
012740                    MOVE ZERO TO PROGRAM-STATUS
012750                    EXIT PROGRAM
012760                END-EVALUATE
012770            END-IF
012780        END-IF
012790     END-IF.
012800*
012810*================================================================*
012820 ꕉSvZďo SECTION.
012830*
012840* zvZAgL[֕S敪Zbg
012850     INITIALIZE gAvZ|L[.
012860     MOVE S敪v TO gAvZ|S敪.
012870*
012880     CALL   "KHTJYOS".
012890     CANCEL "KHTJYOS".
012900*
012910*================================================================*
012920 G[\q SECTION.
012930*
012940     DISPLAY t@Cv NC"t@CǍG["     UPON CONS.
012950     DISPLAY NC"ԃL[F" ԃL[                 UPON CONS.
012960     DISPLAY NC"VXeǗ҂ɘAĂ"    UPON CONS.
012970     DISPLAY NC"P͂dmsdqL[Ă"
012980                                                     UPON CONS.
012981*-----------------------------------------*
012982     CALL "actcshm"  WITH C LINKAGE.
012983*-----------------------------------------*
012990     ACCEPT  L[ FROM CONS.
013000     PERFORM t@C.
013010     MOVE ZERO TO PROGRAM-STATUS
013020     EXIT PROGRAM.
013030*================================================================*
013040 ꕔSZPS SECTION.
013050* mn
013060******************************************************************
013070* ̔pz̐eیSVlꕔŜ݂ҕSB
013080*iɍőAv`|VlS񐔕j
013090* ꌎŏĂAی؂ւĂVlS񐔕
013100* JEgB
013110******************************************************************
013120*
013130* eی̓rŕςA}ԏsꍇlAOeی
013140* fÂ󂯌p
013150*
013160***     PERFORM fÉ񐔎擾.
013170*
013180*  / Z(v)́AƂ̏vZSzWvPGCALL. ĂяoꂽPGŁA
013190*    Sz,zZbg /
013200     IF gAvZ|{p = ZERO
013210        PERFORM ꕉSvZďo
013220     ELSE
013230*
013240*/SƏFX ȂAᏊҗp̕Szg
013250         MOVE gAvZ|{pa TO |{pa
013260         MOVE gAvZ|{pN   TO |{pN
013270         MOVE gAvZ|{p   TO |{p
013280         MOVE gAvZ|Ҕԍ TO |Ҕԍ
013290         MOVE gAvZ|}     TO |}
013300         READ fҏe
013310         INVALID KEY
013320*/G[\̏C
013330             PERFORM R\[G[mF
013340             DISPLAY "{p̎fҏ񂪂܂"
013350                     " f҇=" gAvZ|҃R[h
013360                     " {pN=" gAvZ|{pN gAvZ|{p UPON CONS
013370             PERFORM t@C
013380             MOVE ZERO TO PROGRAM-STATUS
013390             EXIT PROGRAM
013400         NOT INVALID KEY
013431             IF |SƏ = 9
013432                 MOVE 萔v TO Szv
013433             END-IF
013434*----------------------------------------------*
013435*/21N7oߑ[u(QN)090630
013436             IF |SƏ = 8
013437                 EVALUATE |
013438                 WHEN 52
013439                 WHEN 53
013440                     MOVE  900 TO Szv
013441                 WHEN 55
013442                     MOVE 1200 TO Szv
013443                 END-EVALUATE
013444             END-IF
013445*----------------------------------------------*
013450         END-READ
013451*
013460        IF (gAvZ| > S񐔂v) OR
013470           (gAvZ| = ZERO)
013480            MOVE ZERO             TO gAvZ|Sz
013490            MOVE gAvZ|Sz TO gAvZ|z
013500        ELSE
013510*
013520            IF gAvZ|Sz <= Szv
013530                EVALUATE gAvZ|SvZ敪
013540                WHEN ZERO
      *S敪14ׂ͂ďȉ؂グSz(gAvZR|Sz)gp/20221223
013550*                    MOVE gAvZ|Sz TO gAvZ|Sz
013550                    MOVE gAvZR|Sz TO gAvZ|Sz
013560                    MOVE ZERO             TO gAvZ|z
013570*
013580                WHEN 2
013590                    COMPUTE SzvQ ROUNDED = gAvZ|Sz / 10
013600                    COMPUTE Szv = SzvQ * 10
013610                    MOVE Szv TO gAvZ|Sz
013620                    MOVE ZERO     TO gAvZ|z
013630                WHEN OTHER
013640*/G[\̏C
013650                    PERFORM R\[G[mF
013660                    DISPLAY "SZ敪w肳Ă܂"
013670                            " f҇="   |҃R[h
013680                            " {pN="   |{pN |{p UPON CONS
013690                    PERFORM t@C
013700                    MOVE ZERO TO PROGRAM-STATUS
013710                    EXIT PROGRAM
013720                END-EVALUATE
013730*
013740            ELSE
013750                EVALUATE gAvZ|SvZ敪
013760                WHEN ZERO
013770* ݂́AVlꕔSATOO~̂߁APO~PʂɂKvȂ
013780                WHEN 2
013790                    MOVE Szv TO gAvZ|Sz
013800                    COMPUTE zv     = gAvZ|Sz - Szv
013810                    MOVE zv       TO gAvZ|z
013820*
013830                WHEN OTHER
013840*/G[\̏C
013850                    PERFORM R\[G[mF
013860                    DISPLAY "SZ敪w肳Ă܂"
013870                            " f҇="   |҃R[h
013880                            " {pN="   |{pN |{p UPON CONS
013890                    PERFORM t@C
013900                    MOVE ZERO TO PROGRAM-STATUS
013910                    EXIT PROGRAM
013920                END-EVALUATE
013930            END-IF
013940        END-IF
013950     END-IF.
013960*
013970*================================================================*
013980 㕉SƏQV SECTION.
013990*
014000*
014010* eی̓rŕςA}ԏsꍇlAOeی
014020* fÂ󂯌p
014030*
014040*     PERFORM fÉ񐔎擾.
014050*
014060     IF (gAvZ| > S񐔂v) OR
014070        (gAvZ| = ZERO)
014080         MOVE ZERO             TO gAvZ|Sz
014090         MOVE gAvZ|pz TO gAvZ|z
014100     ELSE
014110*
014120         IF gAvZ|Sz <= Szv
014130             EVALUATE gAvZ|SvZ敪
014140             WHEN ZERO
014150                 CONTINUE
014160             WHEN 2
014170                 COMPUTE SzvQ ROUNDED = gAvZ|Sz / 10
014180                 COMPUTE Szv = SzvQ * 10
014190                 MOVE Szv TO gAvZ|Sz
014200                 COMPUTE gAvZ|z = gAvZ|pz - gAvZ|Sz
014210             WHEN OTHER
014220*/G[\̏C
014230                 PERFORM R\[G[mF
014240                 DISPLAY "SZ敪w肳Ă܂"
014250                         " f҇="   gAvZ|҃R[h
014260                         " {pN="   gAvZ|{pN gAvZ|{p UPON CONS
014270                 PERFORM t@C
014280                 MOVE ZERO TO PROGRAM-STATUS
014290                 EXIT PROGRAM
014300             END-EVALUATE
014310*
014320         ELSE
014330             EVALUATE gAvZ|SvZ敪
014340             WHEN ZERO
014350             WHEN 2
014360                 MOVE    Szv TO gAvZ|Sz
014370                 COMPUTE zv        = gAvZ|pz - Szv
014380                 MOVE    zv       TO gAvZ|z
014390*
014400             WHEN OTHER
014410*/G[\̏C
014420                 PERFORM R\[G[mF
014430                 DISPLAY "SZ敪w肳Ă܂"
014440                         " f҇="   gAvZ|҃R[h
014450                         " {pN="   gAvZ|{pN gAvZ|{p UPON CONS
014460                 PERFORM t@C
014470                 MOVE ZERO TO PROGRAM-STATUS
014480                 EXIT PROGRAM
014490             END-EVALUATE
014500         END-IF
014510     END-IF.
014520*
014530*================================================================*
014540 㕉SƏSP SECTION.
014550*
014560* eی̓rŕςA}ԏsꍇlAOeی
014570* fÂ󂯌p
014580*
014590*     PERFORM fÉ񐔎擾.
014600*
014610     IF (gAvZ| > S񐔂v) OR
014620        (gAvZ| = ZERO)
014630         MOVE ZERO             TO gAvZ|Sz
014640         MOVE gAvZ|Sz TO gAvZ|z
014650     ELSE
014660*
014670         IF gAvZ|Sz <= Szv
014680             EVALUATE gAvZ|SvZ敪
014690             WHEN ZERO
014700                 CONTINUE
014710             WHEN 2
014720                 COMPUTE SzvQ ROUNDED = gAvZ|Sz / 10
014730                 COMPUTE Szv = SzvQ * 10
014740                 MOVE Szv TO gAvZ|Sz
014750                 MOVE ZERO     TO gAvZ|z
014760             WHEN OTHER
014770*/G[\̏C
014780                 PERFORM R\[G[mF
014790                 DISPLAY "SZ敪w肳Ă܂"
014800                         " f҇="   gAvZ|҃R[h
014810                         " {pN="   gAvZ|{pN gAvZ|{p UPON CONS
014820                 PERFORM t@C
014830                 MOVE ZERO TO PROGRAM-STATUS
014840                 EXIT PROGRAM
014850             END-EVALUATE
014860*
014870         ELSE
014880             EVALUATE gAvZ|SvZ敪
014890             WHEN ZERO
014900             WHEN 2
014910                 MOVE    Szv TO gAvZ|Sz
014920                 COMPUTE zv        = gAvZ|Sz - Szv
014930                 MOVE    zv       TO gAvZ|z
014940*
014950             WHEN OTHER
014960*/G[\̏C
014970                 PERFORM R\[G[mF
014980                 DISPLAY "SZ敪w肳Ă܂"
014990                         " f҇="   gAvZ|҃R[h
015000                         " {pN="   gAvZ|{pN gAvZ|{p UPON CONS
015010                 PERFORM t@C
015020                 MOVE ZERO TO PROGRAM-STATUS
015030                 EXIT PROGRAM
015040             END-EVALUATE
015050         END-IF
015060     END-IF.
015070*
015080*================================================================*
015081*================================================================*
015082 ꕔSZOT SECTION.
015083* mn
015084*
015085* SzvɏPiႢzjA萔vɏQizjĂB
015086*
015087*
015088*  / Z(v)́AƂ̏vZSzWvPGCALL. ĂяoꂽPGŁA
015089*    Sz,zZbg /
015090     IF gAvZ|{p = ZERO
015091        PERFORM ꕉSvZďo
015092     ELSE
015096*
015097*       / SƏFX ȂA萔̕Szg
015098        EVALUATE gAvZ݌vz|SƏ
015099        WHEN ZERO
015100            MOVE Szv TO vZxzv
015101        WHEN 1
015102            MOVE ZERO           TO vZxzv
015103        WHEN 9
015104            MOVE 萔v   TO vZxzv
015105        WHEN OTHER
015106            MOVE Szv TO vZxzv
015107        END-EVALUATE
015108*
015110*       / v /
015111        IF gAvZ݌vz|Sz >= vZxzv
015115            MOVE ZERO             TO gAvZ|Sz
015116            MOVE gAvZ|Sz TO gAvZ|z
015119        ELSE
015120*
015121             EVALUATE gAvZ|SvZ敪
015122             WHEN ZERO
015123                 MOVE gAvZ|Sz TO gAvZ|Sz  Szv
015124                 MOVE ZERO             TO gAvZ|z
015125*
015126                 COMPUTE vZp݌vzv = gAvZ݌vz|Sz + Szv
015127                 IF  vZp݌vzv > vZxzv
015128                     COMPUTE gAvZ|Sz = vZxzv - gAvZ݌vz|Sz
015129                     COMPUTE gAvZ|z = Szv - gAvZ|Sz
015130                 END-IF
015135             WHEN 2
015136                 COMPUTE SzvQ ROUNDED = gAvZ|Sz / 10
015137                 COMPUTE Szv = SzvQ * 10
015138                 MOVE Szv TO gAvZ|Sz
015139                 MOVE ZERO     TO gAvZ|z
015140*
015141                 COMPUTE vZp݌vzv = gAvZ݌vz|Sz + Szv
015142                 IF  vZp݌vzv > vZxzv
015143                     COMPUTE gAvZ|Sz = vZxzv - gAvZ݌vz|Sz
015144                     COMPUTE gAvZ|z = Szv - gAvZ|Sz
015145                 END-IF
015146             END-EVALUATE
015147        END-IF
015193*
015203     END-IF.
015241*
015242*================================================================*
015243 ꕔSZPU SECTION.
015244* mn
015245*
015246* xzPvAxzQvAxzRvɋz̍ɓĂBB
015256*
015257*
015258*  / Z(v)́AƂ̏vZSzWvPGCALL. ĂяoꂽPGŁA
015259*    Sz,zZbg /
015260     IF gAvZ|{p = ZERO
015261        PERFORM ꕉSvZďo
015262     ELSE
015263*
015264*       / SƏFX ȂA萔̕Szg
015265        EVALUATE gAvZ݌vz|SƏ
015278         WHEN ZERO
015279             MOVE xzPv TO vZxzv
015280         WHEN 1
015281             MOVE ZERO       TO vZxzv
015282         WHEN 8
015283             MOVE xzQv TO vZxzv
015284         WHEN 9
015285             MOVE xzRv TO vZxzv
015286         WHEN OTHER
015287             MOVE xzPv TO vZxzv
015288         END-EVALUATE
015289*
015290**
015291*       / v /
015292        IF gAvZ݌vz|Sz >= vZxzv
015293            MOVE ZERO             TO gAvZ|Sz
015294            MOVE gAvZ|Sz TO gAvZ|z
015295        ELSE
015296*
015297             EVALUATE gAvZ|SvZ敪
015298             WHEN ZERO
015302                 MOVE ZERO TO Szvv
015303                 COMPUTE SԌʂv =  Sv / 100
015304                 COMPUTE Szvv = gAvZ|pz * SԌʂv
015306                 MOVE Szvv TO gAvZ|Sz  Szv
015307                 MOVE ZERO     TO gAvZ|z
015309*
015310                 COMPUTE vZp݌vzv = gAvZ݌vz|Sz + Szv
015311                 IF  vZp݌vzv > vZxzv
015312                     COMPUTE gAvZ|Sz = vZxzv - gAvZ݌vz|Sz
015313                     COMPUTE gAvZ|z = Szv - gAvZ|Sz
015314                 END-IF
015315             WHEN 2
015316                 MOVE ZERO TO Szvv
015317                 COMPUTE SԌʂv =  Sv / 100
015318                 COMPUTE Szvv = gAvZ|pz * SԌʂv
015319                 COMPUTE SzvQ ROUNDED = Szvv / 10
015320                 COMPUTE Szv = SzvQ * 10
015321                 MOVE Szv TO gAvZ|Sz
015322                 MOVE ZERO     TO gAvZ|z
015323*
015324                 COMPUTE vZp݌vzv = gAvZ݌vz|Sz + Szv
015325                 IF  vZp݌vzv > vZxzv
015326                     COMPUTE gAvZ|Sz = vZxzv - gAvZ݌vz|Sz
015327                     COMPUTE gAvZ|z = Szv - gAvZ|Sz
015328                 END-IF
015329             END-EVALUATE
015330        END-IF
015342*
015392     END-IF.
015393*
015394*================================================================*
015395*================================================================*
015396 ꕔSZPV SECTION.
015397* mn
015407*
015409*  / Z(v)́AƂ̏vZSzWvPGCALL. ĂяoꂽPGŁA
015410*    Sz,zZbg /
015411     IF gAvZ|{p = ZERO
015412        PERFORM ꕉSvZďo
015413     ELSE
015414        IF (gAvZ| > S񐔂v) OR
015415           (gAvZ| = ZERO)
015416            MOVE ZERO             TO gAvZ|Sz
015417            MOVE gAvZ|Sz TO gAvZ|z
015418        ELSE
015419*
015422*           / SƏFX ȂA萔̕Szg
015423            IF gAvZ݌vz|SƏ = 9
015424               MOVE 萔v TO Szv
015425            END-IF
015426*
015427***
015428             EVALUATE gAvZ|SvZ敪
015429             WHEN ZERO
015430                 MOVE ZERO TO Szvv
015431                 COMPUTE SԌʂv =  Sv / 100
015432                 COMPUTE Szvv = gAvZ|pz * SԌʂv
015433                 MOVE Szvv TO  Szv
015434**
015435                 IF Szv <= Szv
015436                    MOVE Szv TO gAvZ|Sz
015437                    MOVE ZERO     TO gAvZ|z
015438                 ELSE
015439                    MOVE Szv TO gAvZ|Sz
015440                    COMPUTE zv     = gAvZ|Sz - Szv
015441                    MOVE zv       TO gAvZ|z
015442                 END-IF
015444             WHEN 2
015446                 MOVE ZERO TO Szvv
015447                 COMPUTE SԌʂv =  Sv / 100
015448                 COMPUTE Szvv = gAvZ|pz * SԌʂv
015449                 COMPUTE SzvQ ROUNDED = Szvv / 10
015450                 COMPUTE Szv = SzvQ * 10
015451**
015452                 IF Szv <= Szv
015453                    MOVE Szv TO gAvZ|Sz
015454                    MOVE ZERO     TO gAvZ|z
015455                 ELSE
015456                    MOVE Szv TO gAvZ|Sz
015457                    COMPUTE zv     = gAvZ|Sz - Szv
015458                    MOVE zv       TO gAvZ|z
015459                 END-IF
015463             END-EVALUATE
015465**
015474        END-IF
015475     END-IF.
015566*
015567*================================================================*
008220 ꕔSZQQ SECTION.
008230* mn
008240******************************************************************
008250* ̔pz̐eیSVlꕔŜ݂ҕSB
008260*iɍőAv`|VlS񐔕j
008270* ꌎŏĂAی؂ւĂVlS񐔕
008280* JEgB
008290******************************************************************
008300*
008310* eی̓rŕςA}ԏsꍇlAOeی
008320* fÂ󂯌p
008330*
008340***     PERFORM fÉ񐔎擾.
      */}Ԃ̗݌vz擾/20240424
013583        PERFORM }ԋz擾.
008350*
008360*  / Z(v)́AƂ̏vZSzWvPGCALL. ĂяoꂽPGŁA
008370*    Sz,zZbg /
008380     IF gAvZ|{p = ZERO
008390        PERFORM ꕉSvZďo
008400     ELSE
015263*
015264*       / SƏFX ȂA萔̕Szg
015265        EVALUATE gAvZ݌vz|SƏ
015278         WHEN ZERO
015279             MOVE xzPv TO vZxzv
015280         WHEN 1
015281             MOVE ZERO       TO vZxzv
015282         WHEN 8
015283             MOVE xzQv TO vZxzv
015284         WHEN 9
015285             MOVE xzRv TO vZxzv
015286         WHEN OTHER
015287             MOVE xzPv TO vZxzv
015288         END-EVALUATE
015289*
      *}ԂꍇO̎}ԂŕSz/20240424
013970        IF }ԃtO NOT = SPACE
                  COMPUTE vZxzv = vZxzv - O݌vzv
              END-IF
      *}ԂꍇO̎}ԂŕSz/20240424
008410        IF (gAvZ| > S񐔂v) OR
008420           (gAvZ| = ZERO)
008430            MOVE ZERO             TO gAvZ|Sz
008440            MOVE gAvZ|Sz TO gAvZ|z
      */()Sz؂グo[WɑΉ/20221129
                  IF |pSҔԍ(3:2) = "27"
008430                MOVE ZERO               TO gAvZR|Sz
008440                MOVE gAvZR|Sz TO gAvZ|z
                  END-IF
      */()Sz؂グo[WɑΉ/20221129
008450        ELSE
008460*
008470            IF gAvZ|Sz <= Szv
008480                EVALUATE gAvZ|SvZ敪
008490                WHEN ZERO
008500                    MOVE gAvZ|Sz TO gAvZ|Sz
008510                    MOVE ZERO             TO gAvZ|z
      */()Sz؂グo[WɑΉ/20221128
                          IF |pSҔԍ(3:2) = "27"
008500                        MOVE gAvZR|Sz TO gAvZR|Sz
                          END-IF
      */()Sz؂グo[WɑΉ/20221128
                          IF A|vZe = ZERO
      */݌vxz𒴂܂ŕS(1~P)
      */()Sz؂グo[WɑΉ/20221129
                              IF |pSҔԍ(3:2) NOT = "27"
                              IF A|SzPfv + gAvZ|Sz > vZxzv
                                  COMPUTE gAvZ|Sz = vZxzv - A|SzPfv
      */㏕F̏1xzȂꍇA{̂̕SzƍĂȂ/20220830
                                  MOVE SPACE TO SzҕSe
      *
                              END-IF
                              COMPUTE A|SzPfv = A|SzPfv + gAvZ|Sz
                              COMPUTE gAvZ|z = gAvZ|Sz - gAvZ|Sz
      */()Sz؂グo[WɑΉ/20221129
                              ELSE
      */݌vxz𒴂܂ŕS(1~P)
                                  IF A|SzPfv + gAvZR|Sz > vZxzv
                                      COMPUTE gAvZR|Sz = vZxzv - A|SzPfv
      */㏕F̏1xzȂꍇA{̂̕SzƍĂȂ/20220830
                                      MOVE SPACE TO SzҕSe
      *
                                  END-IF
                                  COMPUTE A|SzPfv = A|SzPfv + gAvZR|Sz
                                  COMPUTE gAvZ|z = gAvZR|Sz - gAvZR|Sz
                              END-IF
      */()Sz؂グo[WɑΉ/20221129
                          ELSE
      */()Sz؂グo[WɑΉ/20221129
                              IF |pSҔԍ(3:2) NOT = "27"
      */݌vxz𒴂܂ŕS(1~P(Zvgp))
                              IF A|SzPfvQ + gAvZ|Sz > vZxzv
      */㏕F̏1xzȂꍇA{̂̕SzƍĂȂ/20220830
                                  MOVE SPACE TO SzҕSe
      *
                                  COMPUTE gAvZ|Sz = vZxzv - A|SzPfvQ
                              END-IF
                              COMPUTE A|SzPfvQ = A|SzPfvQ + gAvZ|Sz
                              COMPUTE gAvZ|z   = gAvZ|Sz - gAvZ|Sz
      */()Sz؂グo[WɑΉ/20221129
                              ELSE
      */݌vxz𒴂܂ŕS(1~P(Zvgp))
                                  IF A|SzPfvQ + gAvZR|Sz > vZxzv
      */㏕F̏1xzȂꍇA{̂̕SzƍĂȂ/20220830
                                      MOVE SPACE TO SzҕSe
      *
                                      COMPUTE gAvZR|Sz = vZxzv - A|SzPfvQ
                                  END-IF
                                  COMPUTE A|SzPfvQ = A|SzPfvQ + gAvZR|Sz
                                  COMPUTE gAvZ|z   = gAvZR|Sz - gAvZR|Sz
                              END-IF
      */()Sz؂グo[WɑΉ/20221129
                          END-IF
008520*
008530                WHEN 2
008540                    COMPUTE SzvQ ROUNDED = gAvZ|Sz / 10
008550                    COMPUTE Szv = SzvQ * 10
008560                    MOVE Szv TO gAvZ|Sz
008570                    MOVE ZERO     TO gAvZ|z
      */݌vxz𒴂܂ŕS(10~P)
                          IF A|SzPOfv + gAvZ|Sz > vZxzv
      */㏕F̏1xzȂꍇA{̂̕SzƍĂȂ/20220830
                              MOVE SPACE TO SzҕSe
      *
                              COMPUTE gAvZ|Sz = vZxzv - A|SzPOfv
                          END-IF
                          COMPUTE A|SzPOfv = A|SzPOfv + gAvZ|Sz
                          COMPUTE gAvZ|z = gAvZ|Sz - gAvZ|Sz
008580                WHEN OTHER
008590*/G[\̏C
008600                    PERFORM R\[G[mF
008610                    DISPLAY "SZ敪w肳Ă܂"
008620                            " f҇="   |҃R[h
008630                            " {pN="   |{pN |{p UPON CONS
008640                    PERFORM t@C
008650                    MOVE ZERO TO PROGRAM-STATUS
008660                    EXIT PROGRAM
008670                END-EVALUATE
008680*
008690            ELSE
      */㏕F̏1xzȂꍇA{̂̕SzƍĂȂ/20220830
                      MOVE SPACE TO SzҕSe
      *
008700                EVALUATE gAvZ|SvZ敪
008710                WHEN ZERO
008720* ݂́AVlꕔSATOO~̂߁APO~PʂɂKvȂ
008730                WHEN 2
008740                    MOVE Szv TO gAvZ|Sz
008750                    COMPUTE zv     = gAvZ|Sz - Szv
008760                    MOVE zv       TO gAvZ|z
      */()Sz؂グo[WɑΉ/20221129
008740                    MOVE Szv TO gAvZR|Sz
      */()Sz؂グo[WɑΉ/20221129
                          IF |pSҔԍ(3:2) NOT = "27"
      */݌vxz𒴂܂ŕS((Zvgp)(1~P)(10~P)ꂼɗ݌v)
                          IF gAvZ|SvZ敪 = ZERO
      */1~P
                              IF A|vZe = ZERO
                                  IF A|SzPfv + gAvZ|Sz > vZxzv
                                      COMPUTE gAvZ|Sz = vZxzv - A|SzPfv
                                  END-IF
                                  COMPUTE A|SzPfv = A|SzPfv + gAvZ|Sz
                                  COMPUTE gAvZ|z = gAvZ|Sz - gAvZ|Sz
                              ELSE
      */Zvgp
                                  IF A|SzPfvQ + gAvZ|Sz > vZxzv
                                      COMPUTE gAvZ|Sz = vZxzv - A|SzPfvQ
                                  END-IF
                                  COMPUTE A|SzPfvQ = A|SzPfvQ + gAvZ|Sz
                                  COMPUTE gAvZ|z   = gAvZ|Sz - gAvZ|Sz
                              END-IF
                          ELSE
      */10~P
                              IF A|SzPOfv + gAvZ|Sz > vZxzv
                                  COMPUTE gAvZ|Sz = vZxzv - A|SzPOfv
                              END-IF
                              COMPUTE A|SzPOfv = A|SzPOfv + gAvZ|Sz
                              COMPUTE gAvZ|z = gAvZ|Sz - gAvZ|Sz
                          END-IF
      */()Sz؂グo[WɑΉ/20221130
                          ELSE
      */݌vxz𒴂܂ŕS((Zvgp)(1~P)(10~P)ꂼɗ݌v)
                              IF gAvZ|SvZ敪 = ZERO
      */1~P
                                  IF A|vZe = ZERO
                                      IF A|SzPfv + gAvZR|Sz > vZxzv
                                          COMPUTE gAvZR|Sz = vZxzv - A|SzPfv
                                      END-IF
                                      COMPUTE A|SzPfv = A|SzPfv + gAvZR|Sz
                                      COMPUTE gAvZ|z = gAvZR|Sz - gAvZR|Sz
                                  ELSE
      */Zvgp
                                      IF A|SzPfvQ + gAvZR|Sz > vZxzv
                                          COMPUTE gAvZR|Sz = vZxzv - A|SzPfvQ
                                      END-IF
                                      COMPUTE A|SzPfvQ = A|SzPfvQ + gAvZR|Sz
                                      COMPUTE gAvZ|z   = gAvZR|Sz - gAvZR|Sz
                                  END-IF
                              ELSE
      */10~P
                                  IF A|SzPOfv + gAvZR|Sz > vZxzv
                                      COMPUTE gAvZR|Sz = vZxzv - A|SzPOfv
                                  END-IF
                                  COMPUTE A|SzPOfv = A|SzPOfv + gAvZR|Sz
                                  COMPUTE gAvZ|z = gAvZR|Sz - gAvZR|Sz
                              END-IF
                          END-IF
      */()Sz؂グo[WɑΉ/20221130
008770*
008780                WHEN OTHER
008790*/G[\̏C
008800                    PERFORM R\[G[mF
008810                    DISPLAY "SZ敪w肳Ă܂"
008820                            " f҇="   |҃R[h
008830                            " {pN="   |{pN |{p UPON CONS
008840                    PERFORM t@C
008850                    MOVE ZERO TO PROGRAM-STATUS
008860                    EXIT PROGRAM
008870                END-EVALUATE
008880            END-IF
008890        END-IF
008900     END-IF.
HILO  *     DISPLAY "410-1 " gAvZ|{paN " " gAvZ|Sz " " gAvZ|Sz
HILO  *             " " gAvZ|z
HILO  *             "         " A|SzPfv  " " A|SzPOfv " " A|SzPfvQ " " gAvZ|SvZ敪.
008910*
015568*================================================================*







014820*================================================================*
014830 gvf[^eǍ SECTION.
014840*
014850     READ gvf[^e NEXT
014860     AT END
014870         MOVE "YES" TO ItOR
014880     END-READ.
014890*================================================================*
014361*================================================================*
014362 fҏeǍ SECTION.
014363*
014364     READ dwfҏe NEXT
014370     AT END
014380         MOVE "YES" TO ItOR
014390     END-READ.
014400*================================================================*
013591*================================================================*
013592 }ԋz擾 SECTION.
013593*
013594* یύXɂȂ̏ꍇA̒œҔԍ̎JEg
013595*

005580     OPEN INPUT dwfҏe.
005590         MOVE NC"d" TO t@Cv.
005600         PERFORM I[v`FbN.
005580     OPEN INPUT gvf[^e.
005590         MOVE NC"gv" TO t@Cv.
005600         PERFORM I[v`FbN.

013600* w茎Ŏ}Ԃ݂邩̔
013601*     MOVE Av|Ҕԍ TO |Ҕԍ.
013602*     MOVE Av|}     TO |}.
013610*     MOVE Av|{pa TO |{pa.
013620*     MOVE Av|{pN   TO |{pN.
013630*     MOVE Av|{p   TO |{p.
001700     MOVE gAvZ|{paN TO d|{paN.
001760     MOVE gAvZ|҃R[h   TO d|҃R[h
013670     START dwfҏe KEY IS >= d|{paN d|҃R[h
013680     END-START.
013690     IF ԃL[ = "00"
013700         MOVE SPACE TO ItOR
013710         MOVE SPACE TO }ԃtO
013720         MOVE gAvZ|Ҕԍ     TO Ҕԍv
013740         MOVE gAvZ|{paN TO {paNv
013750         MOVE |           TO ʂvR
013760         MOVE |pSҔԍ TO pSҔԍvR
013780         PERFORM fҏeǍ
013790         PERFORM UNTIL ( ItOR   NOT = SPACE        ) OR 
013800                       ( Ҕԍv     NOT = d|Ҕԍ ) OR
013820                       ( {paNv NOT = d|{paN)
013830             IF (d|}           NOT = SPACE       ) AND
013840                (d|p敪           = ZERO        ) AND
013860                (d|           = ʂvR) AND
013870                (d|pSҔԍ = pSҔԍvR)
013890                 MOVE "YES" TO }ԃtO
013900                 MOVE "YES" TO ItOR
013910             END-IF
013920             PERFORM fҏeǍ
013930         END-PERFORM
013940     END-IF.
013950*
013960     MOVE ZERO  TO v.
           MOVE ZERO  TO O݌vzv.
013970     IF }ԃtO NOT = SPACE
013980         PERFORM O擾
013990*         IF v <= S񐔂v
014000*             PERFORM 擾
014010*         END-IF
014020*     ELSE
014030*         PERFORM 擾
014040     END-IF.
014050*

005580     CLOSE  dwfҏe gvf[^e.

014060*================================================================*
014410*================================================================*
014420 O擾 SECTION.
014430*
014440     PERFORM fÓ擾.
014450*
014460     MOVE gAvZ|{pa  TO  g|{pa {pabv.
014470     MOVE gAvZ|{pN    TO  g|{pN   {pNbv.
014480     MOVE gAvZ|{p    TO  g|{p   {pbv.  
014490     MOVE 1                   TO  g|{p.
014500     MOVE gAvZ|Ҕԍ  TO  g|Ҕԍ Ҕԍbv.
014510     MOVE SPACE               TO  g|}.
014520*
014530     MOVE gAvZ|}      TO  }Ԃbv.
           MOVE gAvZ|{p敪  TO  g|{p敪.
014540*
014550     START gvf[^e KEY IS >= g|{p敪 g|҃R[h g|{paN
014560     END-START.
014570*
014580     IF ԃL[ = "00"
014590         MOVE SPACE TO ItOR
014600         PERFORM gvf[^eǍ
014610         PERFORM UNTIL ( g|Ҕԍ NOT = Ҕԍbv ) OR
014640                       ( ItOR   NOT = SPACE        )
014650             PERFORM Vlʎ擾Q
014660             IF ( g|҃R[h NOT = ҃R[hbv ) AND
014670                ( g|Ҕԍ       = Ҕԍbv   ) AND
014680                ( g|{paN < fÔNbv ) AND
014700                ( g|{paN  = {paNbv ) AND
014710                ( ( ʂv = ʂvQ ) OR 
014720                  ( ʂv = ʂvQ )         )
      */}Ԃ̔肩AxEhEaEJr/160709
                   AND (g|} NOT = "x" AND "h" AND "a" AND "r")
014730                 COMPUTE v = v + 1
                       COMPUTE O݌vzv = O݌vzv + g|ꕔS
014740             END-IF
014750             PERFORM gvf[^eǍ
014760         END-PERFORM
014770     END-IF.
014780*
HILO  *     DISPLAY "KHT-3 v=" v  " O݌vzv=" O݌vzv. 
014820*================================================================*
014900*================================================================*
014910 fÓ擾 SECTION.
014920*
014930* QDEҔԍEVlی̏ꍇieی̕ύXj
014940* @@Ŋ҃R[hύXꍇA̎̕JEgB
014950*
014960     PERFORM Vlʎ擾.
014970     MOVE gAvZ|{pa  TO  g|{pa {pabv.
014980     MOVE gAvZ|{pN    TO  g|{pN   {pNbv.  
014990     MOVE gAvZ|{p    TO  g|{p   {pbv.  
015000     MOVE 1                   TO  g|{p.
015010     MOVE gAvZ|Ҕԍ  TO  g|Ҕԍ Ҕԍbv.
015020     MOVE gAvZ|}      TO  g|}     }Ԃbv.
           MOVE gAvZ|{p敪  TO  g|{p敪.
015030*
014550     START gvf[^e KEY IS >= g|{p敪 g|҃R[h g|{paN
015050     END-START.
015060*
015070     IF ԃL[ = "00"
015080         PERFORM gvf[^eǍ
015090         MOVE g|{paN TO fÔNbv
015100     END-IF.
015110*
015120*================================================================*
015120*================================================================*
015130 Vlʎ擾 SECTION.
015140*
015150     MOVE gAvZ|{pa   TO d|{pa.
015160     MOVE gAvZ|{pN     TO d|{pN.
015170     MOVE gAvZ|{p     TO d|{p.
015180     MOVE gAvZ|Ҕԍ   TO d|Ҕԍ.
015190     MOVE gAvZ|}       TO d|}.
015200     READ dwfҏe
015210     INVALID KEY
015220         MOVE NC"f" TO t@Cv
015230     NOT INVALID KEY
015240         MOVE d| TO ʂv
015250         MOVE d| TO ʂv
015260     END-READ.
015270*
015280*================================================================*
015290 Vlʎ擾Q SECTION.
015300*
015310     MOVE g|{pa   TO d|{pa.
015320     MOVE g|{pN     TO d|{pN.
015330     MOVE g|{p     TO d|{p.
015340     MOVE g|Ҕԍ   TO d|Ҕԍ.
015350     MOVE g|}       TO d|}.
015360     READ dwfҏe
015370     INVALID KEY
015380         MOVE NC"f" TO t@Cv
015390     NOT INVALID KEY
015400         MOVE d| TO ʂvQ
015410         MOVE d| TO ʂvQ
015420     END-READ.
015430*
015440*================================================================*
015569******************************************************************
015570 END PROGRAM KHT41410.
015571******************************************************************
