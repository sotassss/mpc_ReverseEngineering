000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             KARIKEI.
000060 AUTHOR.                 Rc _V
000070*
000080*----------------------------------------------------------------*
000090*         vZp pzvZ
000100*         MED = 
000110*----------------------------------------------------------------*
000120* ҂Pl̎{p̔pzZoB
000130* 
000140*----------------------------------------------------------------*
000150 DATE-WRITTEN.           2010-07-06
000160 DATE-COMPILED.          2010-07-06
000170*----------------------------------------------------------------*
000180******************************************************************
000190*            ENVIRONMENT         DIVISION                        *
000200******************************************************************
000210 ENVIRONMENT             DIVISION.
000220 CONFIGURATION           SECTION.
000230 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000240 OBJECT-COMPUTER.        FMV-DESKPOWER.
000250 SPECIAL-NAMES.          CONSOLE  IS  CONS
000260                         SYSERR   IS  MSGBOX.
000270 INPUT-OUTPUT            SECTION.
000280 FILE-CONTROL.
000290     SELECT  fҏe    ASSIGN      TO        JUSINJL
000300                             ORGANIZATION             IS  INDEXED
000310                             ACCESS MODE              IS  DYNAMIC
000320                             RECORD KEY               IS  |{paN
000330                                                          |҃R[h
000340                             ALTERNATE RECORD KEY     IS  |{paN
000350                                                          |҃Ji
000360                                                          |҃R[h
000370                             ALTERNATE RECORD KEY     IS  |҃R[h
000380                                                          |{paN
000390                             ALTERNATE RECORD KEY     IS  |{paN
000400                                                          |ی
000410                                                          |یҔԍ
000420                                                          |҃R[h
000430                             ALTERNATE RECORD KEY     IS  |{paN
000440                                                          |
000450                                                          |pSҔԍ
000460                                                          |҃R[h
000470                             ALTERNATE RECORD KEY     IS  |{paN
000480                                                          |
000490                                                          |pSҔԍ
000500                                                          |҃R[h
000510                             ALTERNATE RECORD KEY     IS  |aN
000520                                                          |{paN
000530                                                          |҃R[h
000540                             FILE STATUS              IS  ԃL[
000550                             LOCK        MODE         IS  AUTOMATIC.
000560     SELECT  {pL^e      ASSIGN      TO        SEKIROKL
000570                             ORGANIZATION             IS  INDEXED
000580                             ACCESS MODE              IS  DYNAMIC
000590                             RECORD KEY           IS {L|{paN
000600                                                     {L|҃R[h
000610                             ALTERNATE RECORD KEY IS {L|҃R[h
000620                                                     {L|{paN
000630                             FILE STATUS              IS  ԃL[
000640                             LOCK        MODE         IS  AUTOMATIC.
000650     SELECT  f[^e    ASSIGN      TO        HUSYOUL
000660                             ORGANIZATION             IS  INDEXED
000670                             ACCESS MODE              IS  DYNAMIC
000680                             RECORD KEY               IS |{paN
000690                                                         |҃R[h
000700                             ALTERNATE RECORD KEY     IS |҃R[h
000710                                                         |{paN
000720                             FILE STATUS              IS  ԃL[
000730                             LOCK        MODE         IS  AUTOMATIC.
000740     SELECT  vZ}X^      ASSIGN      TO        KEISANL
000750                             ORGANIZATION             IS  INDEXED
000760                             ACCESS MODE              IS  DYNAMIC
000770                             RECORD KEY               IS  v|敪
000780                                                          v|JnaN
000790                             FILE STATUS              IS  ԃL[
000800                             LOCK        MODE         IS  AUTOMATIC.
000810     SELECT  }X^      ASSIGN      TO        GENGOUL
000820                             ORGANIZATION             IS  INDEXED
000830                             ACCESS MODE              IS  DYNAMIC
000840                             RECORD KEY               IS  |敪
000850                             FILE STATUS              IS  ԃL[
000860                             LOCK        MODE         IS  AUTOMATIC.
000870     SELECT  }X^      ASSIGN      TO        RYOUKINL
000880                             ORGANIZATION             IS  INDEXED
000890                             ACCESS MODE              IS  DYNAMIC
000900                             RECORD KEY               IS  |敪R[h
000910                                                          |ʃR[h
000920                                                          |JnaN
000930                             FILE STATUS              IS  ԃL[
000940                             LOCK        MODE         IS  AUTOMATIC.
000950******************************************************************
000960*                      DATA DIVISION                             *
000970******************************************************************
000980 DATA                    DIVISION.
000990 FILE                    SECTION.
001000*                           mqk  RQOn
001010 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
001020     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
001030** EXTERNALp
001040*                           mqk  QTUn
001050 FD  {pL^e  IS EXTERNAL        BLOCK   CONTAINS   1   RECORDS.
001060     COPY SEKIROK    OF  XFDLIB  JOINING   {L AS  PREFIX.
001070*                           mqk  PQWn
001080 FD  f[^e IS EXTERNAL       BLOCK   CONTAINS   1   RECORDS.
001090     COPY HUSYOU     OF  XFDLIB  JOINING      AS  PREFIX.
001100*                           mqk  QTUn
001110 FD  vZ}X^  IS EXTERNAL        BLOCK   CONTAINS   1   RECORDS.
001120     COPY KEISAN          OF  XFDLIB  JOINING   v   AS  PREFIX.
001130     COPY KEISANA         OF  XFDLIB  JOINING   v` AS  PREFIX.
001140*                           mqk  PQWn
001150 FD  }X^  IS EXTERNAL         BLOCK   CONTAINS   1   RECORDS.
001160     COPY GENGOU     OF  XFDLIB  JOINING      AS  PREFIX.
001170*                           mqk  RQOn
001180 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001190     COPY RYOUKIN         OF  XFDLIB  JOINING      AS  PREFIX.
001200     COPY RYOUKNA         OF  XFDLIB  JOINING   ` AS  PREFIX.
001210     COPY RYOUKNB         OF  XFDLIB  JOINING   a AS  PREFIX.
001220     COPY RYOUKNC         OF  XFDLIB  JOINING   b AS  PREFIX.
001230     COPY RYOUKND         OF  XFDLIB  JOINING   c AS  PREFIX.
001240     COPY RYOUKNE         OF  XFDLIB  JOINING   d AS  PREFIX.
001250     COPY RYOUKNF         OF  XFDLIB  JOINING   e AS  PREFIX.
001260*----------------------------------------------------------------*
001270******************************************************************
001280*                WORKING-STORAGE SECTION                         *
001290******************************************************************
001300 WORKING-STORAGE         SECTION.
001310 01 L[                           PIC X    VALUE SPACE.
001320 01 ԃL[                           PIC X(2) VALUE SPACE.
001330 01 t@C                         PIC N(6) VALUE SPACE.
001340 01 ޔڂfv.
001350   03 Zvgނv                   PIC X(4) VALUE SPACE.
001360   03 Zvgނfv                 PIC X(4) VALUE SPACE.
001370   03 Zvgʂfv                 PIC 9(2) VALUE ZERO.
001380 01 ꕔSvq                     PIC 9(5) VALUE ZERO.
001390*
001400 01 ČtO                   PIC X(3) VALUE SPACE.
001410 01 JE^                       PIC 9(4) VALUE ZERO.
001420 01 ItO                         PIC X(3) VALUE SPACE.
001430 01 ItOQ                       PIC X(3) VALUE SPACE.
001440 01 ItOR                       PIC X(3) VALUE SPACE.
001450 01 ČtO                 PIC X(3) VALUE SPACE.
001460 01 ʂbms                         PIC 9(2) VALUE ZERO.
001470 01 IaNbv.
001480   03 IaNbv.
001490     05 Iabv                   PIC 9    VALUE ZERO.
001500     05 INbv.
001510       07 INbv                   PIC 9(2) VALUE ZERO.
001520       07 Ibv                   PIC 9(2) VALUE ZERO.
001530   03 Ibv                       PIC 9(2) VALUE ZERO.
001540 01 {paNbv.
001550   03 {paNbv.
001560     05 {pabv                   PIC 9    VALUE ZERO.
001570     05 {pNbv.
001580       07 {pNbv                   PIC 9(2) VALUE ZERO.
001590       07 {pbv                   PIC 9(2) VALUE ZERO.
001600   03 {pbv                       PIC 9(2) VALUE ZERO.
001610 01 Βlv                       PIC 9(6) VALUE ZERO.
001620 01 {pΒlv                       PIC 9(6) VALUE ZERO.
001630 01 oߓv                       PIC 9(4) VALUE ZERO.
001640 01 㪓܂v                     PIC 9(2) VALUE ZERO.
001650 01 㪓EPv                     PIC 9(2) VALUE ZERO.
001660 01 㪓Ŗov                     PIC 9(2) VALUE ZERO.
001670 01 㪑ҋ@܂v                     PIC 9(2) VALUE ZERO.
001680 01 㪑ҋ@EPv                     PIC 9(2) VALUE ZERO.
001690 01 Nv                           PIC 9(4) VALUE ZERO.
001700 01 vZaNv.
001710     03 vZav                     PIC 9    VALUE ZERO.
001720     03 vZNv.
001730        05 vZNv                    PIC 9(2) VALUE ZERO.
001740        05 vZv                    PIC 9(2) VALUE ZERO.
001750     03 vZv                       PIC 9(2) VALUE ZERO.
001760 01 ZNv                           PIC 9(4) VALUE ZERO.
001770 01 [N񐔂v                         PIC 9(2) VALUE ZERO.
001780 01 ʏN񐔂v                       PIC 9(2) VALUE ZERO.
001790 01 Nv                         PIC 9(2) VALUE ZERO.
001800 01 ʏNΒlv                     PIC 9(6) VALUE ZERO.
001810 01 [NΒlv                       PIC 9(6) VALUE ZERO.
001820 01 NΒlv                         PIC 9(6) VALUE ZERO.
001830 01 v                               PIC 9(4) VALUE ZERO.
001840 01 ]v                             PIC 9(4) VALUE ZERO.
001850 01 Βlv                         PIC 9(3) VALUE ZERO.
001860 01 ΒlvQ                       PIC 9(3) VALUE ZERO.
001870 01 Βlv                           PIC 9(6) VALUE ZERO.
001880 01 }ԃ`FbNtO                 PIC X(3) VALUE SPACE.
001890 01 bms                         PIC 9(2) VALUE ZERO.
001900 01 OtO                         PIC X(3)  VALUE SPACE.
001910 01 vZNQv.
001920    03 vZaQv                    PIC 9(1)   VALUE ZERO.
001930    03 vZNQv                      PIC S9(2)  VALUE ZERO.
001940    03 vZQv                      PIC S9(2)  VALUE ZERO.
001950    03 vZQv                      PIC S9(2)  VALUE ZERO.
001960 01 JnNQv.
001970    03 JnaQv                    PIC 9(1)  VALUE ZERO.
001980    03 JnNQv                      PIC 9(2)  VALUE ZERO.
001990    03 JnQv                      PIC 9(2)  VALUE ZERO.
002000    03 JnQv                      PIC 9(2)  VALUE ZERO.
002010    03 JnNQv                  PIC S9(4) VALUE ZERO.
002020 01 INQv.
002030    03 IaQv                    PIC 9(1)  VALUE ZERO.
002040    03 INQv                      PIC 9(2)  VALUE ZERO.
002050    03 IQv                      PIC 9(2)  VALUE ZERO.
002060    03 IQv                      PIC 9(2)  VALUE ZERO.
002070    03 INQv                  PIC S9(4) VALUE ZERO.
002080*
002090 01 ҃R[hbv.
002100     03 Ҕԍbv                   PIC 9(6).
002110     03 }Ԃbv                       PIC X.
002120*
002130 01 ʍvvP                   PIC 9(6) VALUE ZERO.
002140 01 ʍvvQ                   PIC 9(6) VALUE ZERO.
002150 01 ʍvvR                   PIC 9(6) VALUE ZERO.
002160 01 ʍvvRP                 PIC 9(6) VALUE ZERO.
002170 01 ʍvvS                   PIC 9(6) VALUE ZERO.
002180 01 ʍvvSP                 PIC 9(6) VALUE ZERO.
002190 01 ʍvvSQ                 PIC 9(6) VALUE ZERO.
002200 01 ʍvvT                   PIC 9(6) VALUE ZERO.
002210 01 ʍvvTP                 PIC 9(6) VALUE ZERO.
002220 01 ʍvvTQ                 PIC 9(6) VALUE ZERO.
002230 01 ʍvvTR                 PIC 9(6) VALUE ZERO.
002240*
002250 01 fv                         PIC 9(5) VALUE ZERO.
002260 01 Zfv                     PIC 9(6) VALUE ZERO.
002270 01 񏈒ufv                     PIC 9(5) VALUE ZERO.
002280 01 Čfv                         PIC 9(5) VALUE ZERO.
002290 01 ×fv                         PIC 9(6) VALUE ZERO.
002300 01 ÉZfv                     PIC 9(6) VALUE ZERO.
002310 01 É񐔂fv                       PIC 9(2) VALUE ZERO.
002320 01 ×fv                         PIC 9(6) VALUE ZERO.
002330 01 㪖@fv                       PIC 9(4) VALUE ZERO.
002340 01 㪖@fv                       PIC 9(4) VALUE ZERO.
002350 01 d×fv                         PIC 9(4) VALUE ZERO.
002360 01 qfv                     PIC 9(5) VALUE ZERO.
002370 01 {p񋟗fv                 PIC 9(5) VALUE ZERO.
002380*
002390 01 rjv.
002400   03 jv  OCCURS 9.
002410     05 ʒjv               PIC 9(3) VALUE ZERO.
002420* ʖ̑ʒʖ̃[Nivpj
002430* Pʖ
002440 01 ×Pov                       PIC 9(5) VALUE ZERO.
002450 01 㪖@Pov                     PIC 9(4) VALUE ZERO.
002460 01 㪖@Pov                     PIC 9(4) VALUE ZERO.
002470 01 d×Pov                       PIC 9(4) VALUE ZERO.
002480 01 vPov                         PIC 9(6) VALUE ZERO.
002490* Qʖ
002500 01 ×Qov                       PIC 9(5) VALUE ZERO.
002510 01 㪖@Qov                     PIC 9(4) VALUE ZERO.
002520 01 㪖@Qov                     PIC 9(4) VALUE ZERO.
002530 01 d×Qov                       PIC 9(4) VALUE ZERO.
002540* Rʖ
002550 01 ×Rov                       PIC 9(5) VALUE ZERO.
002560 01 㪖@Rov                     PIC 9(4) VALUE ZERO.
002570 01 㪖@Rov                     PIC 9(4) VALUE ZERO.
002580 01 d×Rov                       PIC 9(4) VALUE ZERO.
002590* RʖځiJj
002600 01 ×RPov                     PIC 9(5) VALUE ZERO.
002610 01 㪖@RPov                   PIC 9(4) VALUE ZERO.
002620 01 㪖@RPov                   PIC 9(4) VALUE ZERO.
002630 01 d×RPov                     PIC 9(4) VALUE ZERO.
002640* Sʖ
002650 01 ×Sov                       PIC 9(5) VALUE ZERO.
002660 01 㪖@Sov                     PIC 9(4) VALUE ZERO.
002670 01 㪖@Sov                     PIC 9(4) VALUE ZERO.
002680 01 d×Sov                       PIC 9(4) VALUE ZERO.
002690* SʖځiJPj
002700 01 ×SPov                     PIC 9(5) VALUE ZERO.
002710 01 㪖@SPov                   PIC 9(4) VALUE ZERO.
002720 01 㪖@SPov                   PIC 9(4) VALUE ZERO.
002730 01 d×SPov                     PIC 9(4) VALUE ZERO.
002740* SʖځiJQj
002750 01 ×SQov                     PIC 9(5) VALUE ZERO.
002760 01 㪖@SQov                   PIC 9(4) VALUE ZERO.
002770 01 㪖@SQov                   PIC 9(4) VALUE ZERO.
002780 01 d×SQov                     PIC 9(4) VALUE ZERO.
002790* Tʖ
002800 01 ×Tov                       PIC 9(5) VALUE ZERO.
002810 01 㪖@Tov                     PIC 9(4) VALUE ZERO.
002820 01 㪖@Tov                     PIC 9(4) VALUE ZERO.
002830 01 d×Tov                       PIC 9(4) VALUE ZERO.
002840* TʖځiJPj
002850 01 ×TPov                     PIC 9(5) VALUE ZERO.
002860 01 㪖@TPov                   PIC 9(4) VALUE ZERO.
002870 01 㪖@TPov                   PIC 9(4) VALUE ZERO.
002880 01 d×TPov                     PIC 9(4) VALUE ZERO.
002890* TʖځiJQj
002900 01 ×TQov                     PIC 9(5) VALUE ZERO.
002910 01 㪖@TQov                   PIC 9(4) VALUE ZERO.
002920 01 㪖@TQov                   PIC 9(4) VALUE ZERO.
002930 01 d×TQov                     PIC 9(4) VALUE ZERO.
002940* TʖځiJRj
002950 01 ×TRov                     PIC 9(5) VALUE ZERO.
002960 01 㪖@TRov                   PIC 9(4) VALUE ZERO.
002970 01 㪖@TRov                   PIC 9(4) VALUE ZERO.
002980 01 d×TRov                     PIC 9(4) VALUE ZERO.
002990*
003000 01 ԊOv                       PIC 9 VALUE ZERO.
003010 01 xv                         PIC 9 VALUE ZERO.
003020 01 [v                         PIC 9 VALUE ZERO.
003030*
003040 01 v                           PIC 9(4) VALUE ZERO.
003050 01 Zv                       PIC 9(5) VALUE ZERO.
003060 01 Čv                           PIC 9(4) VALUE ZERO.
003070 01 ×v                           PIC 9(5) VALUE ZERO.
003080 01 ÉZv                       PIC 9(6) VALUE ZERO.
003090 01 ×v                           PIC 9(5) VALUE ZERO.
003100 01 㪖@v                         PIC 9(4) VALUE ZERO.
003110 01 㪖@v                         PIC 9(4) VALUE ZERO.
003120 01 d×v                           PIC 9(4) VALUE ZERO.
003130*
003140 01 ʐv                           PIC 9(2) VALUE ZERO.
003150 01 pʐv                       PIC 9(2) VALUE ZERO.
003160 01 ʃJE^                       PIC 9(2)    VALUE ZERO.
003170 01 ʃJE^Q                     PIC 9(2)    VALUE ZERO.
003180*
003190 01 JnaNv.
003200   03 JnaNv.
003210     05 Jnav                     PIC 9.
003220     05 JnNv.
003230        07 JnNv                    PIC 9(2).
003240        07 Jnv                    PIC 9(2).
003250   03 Jnv                         PIC 9(2).
003260*
003270 01 IaNv.
003280   03 IaNv.
003290     05 Iav                     PIC 9.
003300     05 INv.
003310        07 INv                    PIC 9(2).
003320        07 Iv                    PIC 9(2).
003330   03 Iv                         PIC 9(2).
003340* {
003350 01 `v                         PIC 9(4) VALUE ZERO.
003360 01 ԊO`v                         PIC 9(4) VALUE ZERO.
003370 01 x`v                           PIC 9(4) VALUE ZERO.
003380 01 [`v                           PIC 9(4) VALUE ZERO.
003390 01 Ê{`v                   PIC 9(4) VALUE ZERO.
003400 01 Òǉ`v                   PIC 9(4) VALUE ZERO.
003410 01 ÉZ`v                     PIC 9(3) VALUE ZERO.
003420 01 Ð[Z`v                 PIC 9(3) VALUE ZERO.
003430 01 ÓHZ`v                 PIC 9(3) VALUE ZERO.
003440 01 Ö\JZ`v               PIC 9(3) VALUE ZERO.
003450 01 Č`v                         PIC 9(4) VALUE ZERO.
003460 01 㪖@`v                       PIC 9(4) VALUE ZERO.
003470 01 㪖@`v                       PIC 9(4) VALUE ZERO.
003480 01 d×`v                         PIC 9(4) VALUE ZERO.
003490 01 `v                             PIC 9(4) VALUE ZERO.
003500 01 `v                             PIC 9(4) VALUE ZERO.
003510 01 `v                             PIC 9(4) VALUE ZERO.
003520 01 {p񋟗`v                 PIC 9(4) VALUE ZERO.
003530 01 kfv                   PIC 9(5) VALUE ZERO.
003540 01 kv                     PIC 9(4) VALUE ZERO.
003550 01 k`v                   PIC 9(4) VALUE ZERO.
003560*
003570 01 ʃR[hv.
003580    03 ʂv                      PIC 9(2).
003590    03 ʂv                          PIC 9(2).
003600    03 E敪v                      PIC 9.
003610    03 ʒuԍv                  PIC 9(2).
003620* 
003630 01 Sk×av                     PIC 9(5) VALUE ZERO.
003640 01 ×av                         PIC 9(5) VALUE ZERO.
003650 01 av                         PIC 9(5) VALUE ZERO.
003660*
003670 01 ʍvvP                       PIC 9(6) VALUE ZERO.
003680 01 ʍvvQ                       PIC 9(6) VALUE ZERO.
003690 01 ʍvvR                       PIC 9(6) VALUE ZERO.
003700 01 ʍvvRP                     PIC 9(6) VALUE ZERO.
003710 01 ʍvvS                       PIC 9(6) VALUE ZERO.
003720 01 ʍvvSP                     PIC 9(6) VALUE ZERO.
003730 01 ʍvvSQ                     PIC 9(6) VALUE ZERO.
003740 01 ʍvvT                       PIC 9(6) VALUE ZERO.
003750 01 ʍvvTP                     PIC 9(6) VALUE ZERO.
003760 01 ʍvvTQ                     PIC 9(6) VALUE ZERO.
003770 01 ʍvvTR                     PIC 9(6) VALUE ZERO.
003780*
003790 01 敪rv.
003800    03 敪v                      PIC 9(2) OCCURS 9 VALUE ZERO.
003810*
003820 01 񏈒urv.
003830   03 񏈒unv OCCURS 9.
003840     05 񏈒unv                 PIC 9(5) VALUE ZERO.
003850*
003860 01 ÒPrv.
003870   03 ÒPnvP OCCURS 9.
003880     05 ÒPnv                   PIC 9(4) VALUE ZERO.
003890*
003900 01 ×POOrv.
003910   03 ×POOvP OCCURS 9.
003920     05 ×POOv                 PIC 9(5) OCCURS 9 VALUE ZERO.
003930*
003940 01 d×POOrv.
003950   03 d×POOvP OCCURS 9.
003960     05 d×POOv                 PIC 9(5) OCCURS 9 VALUE ZERO.
003970*
003980 01 㪖@POOrv.
003990   03 㪖@POOvP OCCURS 9.
004000     05 㪖@POOv               PIC 9(5) OCCURS 9 VALUE ZERO.
004010*
004020 01 㪖@POOrv.
004030   03 㪖@POOvP OCCURS 9.
004040     05 㪖@POOv               PIC 9(5) OCCURS 9 VALUE ZERO.
004050* ʖ̑ʒʖ̃[N
004060* Pʖ
004070 01 É񐔂Pqv                     PIC 9(2) VALUE ZERO.
004080 01 ×Pqv                       PIC 9(5) VALUE ZERO.
004090 01 㪖@񐔂Pqv                   PIC 9(2) VALUE ZERO.
004100 01 㪖@Pqv                     PIC 9(4) VALUE ZERO.
004110 01 㪖@񐔂Pqv                   PIC 9(2) VALUE ZERO.
004120 01 㪖@Pqv                     PIC 9(4) VALUE ZERO.
004130 01 dÉ񐔂Pqv                     PIC 9(2) VALUE ZERO.
004140 01 d×Pqv                       PIC 9(4) VALUE ZERO.
004150 01 vPqv                         PIC 9(6) VALUE ZERO.
004160* Qʖ
004170 01 É񐔂Qqv                     PIC 9(2) VALUE ZERO.
004180 01 ×Qqv                       PIC 9(5) VALUE ZERO.
004190 01 㪖@񐔂Qqv                   PIC 9(2) VALUE ZERO.
004200 01 㪖@Qqv                     PIC 9(4) VALUE ZERO.
004210 01 㪖@񐔂Qqv                   PIC 9(2) VALUE ZERO.
004220 01 㪖@Qqv                     PIC 9(4) VALUE ZERO.
004230 01 dÉ񐔂Qqv                     PIC 9(2) VALUE ZERO.
004240 01 d×Qqv                       PIC 9(4) VALUE ZERO.
004250 01 vQqv                         PIC 9(6) VALUE ZERO.
004260* Rʖ
004270 01 É񐔂Rqv                     PIC 9(2) VALUE ZERO.
004280 01 ×Rqv                       PIC 9(5) VALUE ZERO.
004290 01 㪖@񐔂Rqv                   PIC 9(2) VALUE ZERO.
004300 01 㪖@Rqv                     PIC 9(4) VALUE ZERO.
004310 01 㪖@񐔂Rqv                   PIC 9(2) VALUE ZERO.
004320 01 㪖@Rqv                     PIC 9(4) VALUE ZERO.
004330 01 dÉ񐔂Rqv                     PIC 9(2) VALUE ZERO.
004340 01 d×Rqv                       PIC 9(4) VALUE ZERO.
004350 01 vRqv                         PIC 9(6) VALUE ZERO.
004360* RʖځiJj
004370 01 É񐔂RPqv                   PIC 9(2) VALUE ZERO.
004380 01 ×RPqv                     PIC 9(5) VALUE ZERO.
004390 01 㪖@񐔂RPqv                 PIC 9(2) VALUE ZERO.
004400 01 㪖@RPqv                   PIC 9(4) VALUE ZERO.
004410 01 㪖@񐔂RPqv                 PIC 9(2) VALUE ZERO.
004420 01 㪖@RPqv                   PIC 9(4) VALUE ZERO.
004430 01 dÉ񐔂RPqv                   PIC 9(2) VALUE ZERO.
004440 01 d×RPqv                     PIC 9(4) VALUE ZERO.
004450 01 vRPqv                       PIC 9(6) VALUE ZERO.
004460 01 JnaNRPqv.
004470   03 JnaNRPqv.
004480     05 JnaRPqv           PIC 9 VALUE ZERO.
004490     05 JnNRPqv.
004500       07 JnNRPqv           PIC 9(2) VALUE ZERO.
004510       07 JnRPqv           PIC 9(2) VALUE ZERO.
004520   03 JnRPqv               PIC 9(2) VALUE ZERO.
004530* Sʖ
004540 01 É񐔂Sqv                     PIC 9(2) VALUE ZERO.
004550 01 ×Sqv                       PIC 9(5) VALUE ZERO.
004560 01 㪖@񐔂Sqv                   PIC 9(2) VALUE ZERO.
004570 01 㪖@Sqv                     PIC 9(4) VALUE ZERO.
004580 01 㪖@񐔂Sqv                   PIC 9(2) VALUE ZERO.
004590 01 㪖@Sqv                     PIC 9(4) VALUE ZERO.
004600 01 dÉ񐔂Sqv                     PIC 9(2) VALUE ZERO.
004610 01 d×Sqv                       PIC 9(4) VALUE ZERO.
004620 01 vSqv                         PIC 9(6) VALUE ZERO.
004630* SʖځiJPj
004640 01 É񐔂SPqv                   PIC 9(2) VALUE ZERO.
004650 01 ×SPqv                     PIC 9(5) VALUE ZERO.
004660 01 㪖@񐔂SPqv                 PIC 9(2) VALUE ZERO.
004670 01 㪖@SPqv                   PIC 9(4) VALUE ZERO.
004680 01 㪖@񐔂SPqv                 PIC 9(2) VALUE ZERO.
004690 01 㪖@SPqv                   PIC 9(4) VALUE ZERO.
004700 01 dÉ񐔂SPqv                   PIC 9(2) VALUE ZERO.
004710 01 d×SPqv                     PIC 9(4) VALUE ZERO.
004720 01 vSPqv                       PIC 9(6) VALUE ZERO.
004730 01 JnaNSPqv.
004740   03 JnaNSPqv.
004750     05 JnaSPqv           PIC 9 VALUE ZERO.
004760     05 JnNSPqv.
004770       07 JnNSPqv           PIC 9(2) VALUE ZERO.
004780       07 JnSPqv           PIC 9(2) VALUE ZERO.
004790   03 JnSPqv               PIC 9(2) VALUE ZERO.
004800* SʖځiJQj
004810 01 É񐔂SQqv                   PIC 9(2) VALUE ZERO.
004820 01 ×SQqv                     PIC 9(5) VALUE ZERO.
004830 01 㪖@񐔂SQqv                 PIC 9(2) VALUE ZERO.
004840 01 㪖@SQqv                   PIC 9(4) VALUE ZERO.
004850 01 㪖@񐔂SQqv                 PIC 9(2) VALUE ZERO.
004860 01 㪖@SQqv                   PIC 9(4) VALUE ZERO.
004870 01 dÉ񐔂SQqv                   PIC 9(2) VALUE ZERO.
004880 01 d×SQqv                     PIC 9(4) VALUE ZERO.
004890 01 vSQqv                       PIC 9(6) VALUE ZERO.
004900 01 JnaNSQqv.
004910   03 JnaNSQqv.
004920     05 JnaSQqv           PIC 9 VALUE ZERO.
004930     05 JnNSQqv.
004940       07 JnNSQqv           PIC 9(2) VALUE ZERO.
004950       07 JnSQqv           PIC 9(2) VALUE ZERO.
004960   03 JnSQqv               PIC 9(2) VALUE ZERO.
004970* Tʖ
004980 01 É񐔂Tqv                     PIC 9(2) VALUE ZERO.
004990 01 ×Tqv                       PIC 9(5) VALUE ZERO.
005000 01 㪖@񐔂Tqv                   PIC 9(2) VALUE ZERO.
005010 01 㪖@Tqv                     PIC 9(4) VALUE ZERO.
005020 01 㪖@񐔂Tqv                   PIC 9(2) VALUE ZERO.
005030 01 㪖@Tqv                     PIC 9(4) VALUE ZERO.
005040 01 dÉ񐔂Tqv                     PIC 9(2) VALUE ZERO.
005050 01 d×Tqv                       PIC 9(4) VALUE ZERO.
005060 01 vTqv                         PIC 9(6) VALUE ZERO.
005070* TʖځiJPj
005080 01 É񐔂TPqv                   PIC 9(2) VALUE ZERO.
005090 01 ×TPqv                     PIC 9(5) VALUE ZERO.
005100 01 㪖@񐔂TPqv                 PIC 9(2) VALUE ZERO.
005110 01 㪖@TPqv                   PIC 9(4) VALUE ZERO.
005120 01 㪖@񐔂TPqv                 PIC 9(2) VALUE ZERO.
005130 01 㪖@TPqv                   PIC 9(4) VALUE ZERO.
005140 01 dÉ񐔂TPqv                   PIC 9(2) VALUE ZERO.
005150 01 d×TPqv                     PIC 9(4) VALUE ZERO.
005160 01 vTPqv                       PIC 9(6) VALUE ZERO.
005170 01 JnaNTPqv.
005180   03 JnaNTPqv.
005190     05 JnaTPqv           PIC 9 VALUE ZERO.
005200     05 JnNTPqv.
005210       07 JnNTPqv           PIC 9(2) VALUE ZERO.
005220       07 JnTPqv           PIC 9(2) VALUE ZERO.
005230   03 JnTPqv               PIC 9(2) VALUE ZERO.
005240* TʖځiJQj
005250 01 É񐔂TQqv                   PIC 9(2) VALUE ZERO.
005260 01 ×TQqv                     PIC 9(5) VALUE ZERO.
005270 01 㪖@񐔂TQqv                 PIC 9(2) VALUE ZERO.
005280 01 㪖@TQqv                   PIC 9(4) VALUE ZERO.
005290 01 㪖@񐔂TQqv                 PIC 9(2) VALUE ZERO.
005300 01 㪖@TQqv                   PIC 9(4) VALUE ZERO.
005310 01 dÉ񐔂TQqv                   PIC 9(2) VALUE ZERO.
005320 01 d×TQqv                     PIC 9(4) VALUE ZERO.
005330 01 vTQqv                       PIC 9(6) VALUE ZERO.
005340 01 JnaNTQqv.
005350   03 JnaNTQqv.
005360     05 JnaTQqv           PIC 9 VALUE ZERO.
005370     05 JnNTQqv.
005380       07 JnNTQqv           PIC 9(2) VALUE ZERO.
005390       07 JnTQqv           PIC 9(2) VALUE ZERO.
005400   03 JnTQqv               PIC 9(2) VALUE ZERO.
005410* TʖځiJRj
005420 01 É񐔂TRqv                   PIC 9(2) VALUE ZERO.
005430 01 ×TRqv                     PIC 9(5) VALUE ZERO.
005440 01 㪖@񐔂TRqv                 PIC 9(2) VALUE ZERO.
005450 01 㪖@TRqv                   PIC 9(4) VALUE ZERO.
005460 01 㪖@񐔂TRqv                 PIC 9(2) VALUE ZERO.
005470 01 㪖@TRqv                   PIC 9(4) VALUE ZERO.
005480 01 dÉ񐔂TRqv                   PIC 9(2) VALUE ZERO.
005490 01 d×TRqv                     PIC 9(4) VALUE ZERO.
005500 01 vTRqv                       PIC 9(6) VALUE ZERO.
005510 01 JnaNTRqv.
005520   03 JnaNTRqv.
005530     05 JnaTRqv           PIC 9 VALUE ZERO.
005540     05 JnNTRqv.
005550       07 JnNTRqv           PIC 9(2) VALUE ZERO.
005560       07 JnTRqv           PIC 9(2) VALUE ZERO.
005570   03 JnTRqv               PIC 9(2) VALUE ZERO.
005580*
005590 01 ʓvʂvP                 PIC 9(6) VALUE ZERO.
005600 01 ʓvʂvQ                 PIC 9(6) VALUE ZERO.
005610 01 ʓvʂvR                 PIC 9(6) VALUE ZERO.
005620 01 ʓvʂvRP               PIC 9(6) VALUE ZERO.
005630 01 ʓvʂvS                 PIC 9(6) VALUE ZERO.
005640 01 ʓvʂvSP               PIC 9(6) VALUE ZERO.
005650 01 ʓvʂvT                 PIC 9(6) VALUE ZERO.
005660 01 ʓvʂvTP               PIC 9(6) VALUE ZERO.
005670 01 ʓvʂvTQ               PIC 9(6) VALUE ZERO.
005680 01 ʓvʂvTR               PIC 9(6) VALUE ZERO.
005690*
005700 01 ʍvʂvP                 PIC 9(6) VALUE ZERO.
005710 01 ʍvʂvQ                 PIC 9(6) VALUE ZERO.
005720 01 ʍvʂvR                 PIC 9(6) VALUE ZERO.
005730 01 ʍvʂvRP               PIC 9(6) VALUE ZERO.
005740 01 ʍvʂvS                 PIC 9(6) VALUE ZERO.
005750 01 ʍvʂvSP               PIC 9(6) VALUE ZERO.
005760 01 ʍvʂvT                 PIC 9(6) VALUE ZERO.
005770 01 ʍvʂvTP               PIC 9(6) VALUE ZERO.
005780 01 ʍvʂvTQ               PIC 9(6) VALUE ZERO.
005790 01 ʍvʂvTR               PIC 9(6) VALUE ZERO.
005800*
005810 01 Ԃjv                 PIC 9V9(3) VALUE ZERO.
005820 01 jv                     PIC 9(3) VALUE ZERO.
005830 01 Ejv               PIC 9(2) VALUE ZERO.
005840 01 jv                   PIC 9(2) VALUE ZERO.
005850 01 VlS񐔂jv                   PIC 9(2) VALUE ZERO.
005860 01 Ԍʂv                   PIC 9V9(3) VALUE ZERO.
005870*
005880 01 őo^ʐv                   PIC 9(2) VALUE ZERO.
005890*
005900 01 Szfv                         PIC 9(5) VALUE ZERO.
005910 01 pzVlfv                     PIC 9(6) VALUE ZERO.
005920 01 SzVlfv                     PIC 9(5) VALUE ZERO.
005930 01 zVlfv                     PIC 9(6) VALUE ZERO.
005940 01 Szfv                     PIC 9(6) VALUE ZERO.
005950 01 zfv                     PIC 9(6) VALUE ZERO.
005960*
005970 01 ÖԂv                         PIC 9 VALUE ZERO.
005980 01 ÓHv                         PIC 9 VALUE ZERO.
005990 01 Ö\Jv                       PIC 9 VALUE ZERO.
006000 01 ÎԊOv                       PIC 9 VALUE ZERO.
006010*
006020 01 qv                       PIC 9 VALUE ZERO.
006030 01 qv                       PIC 9 VALUE ZERO.
006040 01 qv                       PIC 9 VALUE ZERO.
006050*
006060* {
006070 01 Ê{jv                   PIC 9(2) VALUE ZERO.
006080 01 É\Z萔jv                 PIC 9(2) VALUE ZERO.
006090*
006100 01 敪v                     PIC 9 VALUE ZERO.
006110 01 ʂbms                       PIC 9(2) VALUE ZERO.
006120 01 qv                       PIC 9(4) VALUE ZERO.
006130 01 񏈒uv                       PIC 9(5) VALUE ZERO.
006140 01 {p񋟗v                   PIC 9(4) VALUE ZERO.
006150*
006160 COPY SEKIROK    OF  XFDLIB  JOINING   ޔ{L AS  PREFIX.
006170*****************************************************************
006180*                          A                             *
006190*****************************************************************
006191*
006193***********************
006194 01 A|P IS EXTERNAL.
006195   03 A|.
006196      05 A|S                 PIC 9(3).
006197      05 A|                 PIC 9(5).
006198      05 A|Z.
006199        07 A|ԊO           PIC 9.
006200        07 A|x             PIC 9.
006201        07 A|[             PIC 9.
006202      05 A|Z             PIC 9(5).
006203   03 A|Č                    PIC 9(5).
006204   03 A|.
006205      05 A|Ë               PIC 9(2)V9.
006206      05 A|É               PIC 9(2).
006207      05 A|×                 PIC 9(6).
006208      05 A|ÉZ             PIC 9(5).
006209      05 A|ÉZ.
006210        07 A|Ö             PIC 9.
006211        07 A|ÓH             PIC 9.
006212        07 A|Ö\J           PIC 9.
006213        07 A|ÎԊO           PIC 9.
006214   03 A|qZ            PIC 9(5).
006215   03 A|q.
006216      05 A|                     PIC 9.
006217      05 A|                     PIC 9.
006218      05 A|                     PIC 9.
006219   03 A|{p񋟗            PIC 9(5).
006220   03 A|v                      PIC 9(7).
006221   03 A|pz                    PIC 9(6).
006222   03 A|ꕔS                PIC 9(6).
006223   03 A|z                    PIC 9(6).
006224   03 A|t                  PIC 9(3).
006225   03 A|󋋎ҕSz              PIC 9(6).
006226   03 A|z              PIC 9(6).
006227*
006228   03 A|󋋎ҕSz   OCCURS  10.
006229      05 A|Sz           PIC 9(4).
006230*
006231*
006232* ʖ̗
006233***********************
006234 01 A|Q IS EXTERNAL.
006235   03 A|񏈒u    OCCURS   9.
006236      05 A|񏈒u             PIC 9(5).
006237   03 A|񏈒uv              PIC 9(6).
006238*
006239* ̗
006240***********************
006241 01 A|R IS EXTERNAL.
006242**********
006243* P *
006244**********
006245   03 A|ʂP.
006246      05 A|ÂP.
006247         07 A|ÒPP          PIC 9(4).
006248         07 A|É񐔂P          PIC 9(2).
006249         07 A|×P            PIC 9(5).
006250      05 A|㪖@P.
006251         07 A|㪖@񐔂P        PIC 9(2).
006252         07 A|㪖@P          PIC 9(4).
006253      05 A|㪖@P.
006254         07 A|㪖@񐔂P        PIC 9(2).
006255         07 A|㪖@P          PIC 9(4).
006256      05 A|dÂP.
006257         07 A|dÉ񐔂P          PIC 9(2).
006258         07 A|d×P            PIC 9(4).
006259      05 A|vP                 PIC 9(6).
006260      05 A|P           PIC 9(3).
006261      05 A|vP           PIC 9(6).
006262**********
006263* Q *
006264**********
006265   03 A|ʂQ.
006266      05 A|ÂQ.
006267         07 A|ÒPQ          PIC 9(4).
006268         07 A|É񐔂Q          PIC 9(2).
006269         07 A|×Q            PIC 9(5).
006270      05 A|㪖@Q.
006271         07 A|㪖@񐔂Q        PIC 9(2).
006272         07 A|㪖@Q          PIC 9(4).
006273      05 A|㪖@Q.
006274         07 A|㪖@񐔂Q        PIC 9(2).
006275         07 A|㪖@Q          PIC 9(4).
006276      05 A|dÂQ.
006277         07 A|dÉ񐔂Q          PIC 9(2).
006278         07 A|d×Q            PIC 9(4).
006279      05 A|vQ                 PIC 9(6).
006280      05 A|Q           PIC 9(3).
006281      05 A|vQ           PIC 9(6).
006282******************
006283* Rʁ^W *
006284******************
006285   03 A|ʂRW.
006286      05 A|ÂRW.
006287         07 A|ÒPRW          PIC 9(4).
006288         07 A|É񐔂RW          PIC 9(2).
006289         07 A|×RW            PIC 9(5).
006290      05 A|㪖@RW.
006291         07 A|㪖@񐔂RW        PIC 9(2).
006292         07 A|㪖@RW          PIC 9(4).
006293      05 A|㪖@RW.
006294         07 A|㪖@񐔂RW        PIC 9(2).
006295         07 A|㪖@RW          PIC 9(4).
006296      05 A|dÂRW.
006297         07 A|dÉ񐔂RW          PIC 9(2).
006298         07 A|d×RW            PIC 9(4).
006299      05 A|vRW                 PIC 9(6).
006300      05 A|ʍvRW         PIC 9(6).
006301      05 A|RW           PIC 9(3).
006302      05 A|vRW           PIC 9(6).
006303******************
006304* Rʁ^PO *
006305******************
006306   03 A|ʂRO.
006307      05 A|JnRO.
006308         07 A|JnRO        PIC 9(2).
006309         07 A|JnRO        PIC 9(2).
006310      05 A|ÂRO.
006311         07 A|ÒPRO          PIC 9(4).
006312         07 A|É񐔂RO          PIC 9(2).
006313         07 A|×RO            PIC 9(5).
006314      05 A|㪖@RO.
006315         07 A|㪖@񐔂RO        PIC 9(2).
006316         07 A|㪖@RO          PIC 9(4).
006317      05 A|㪖@RO.
006318         07 A|㪖@񐔂RO        PIC 9(2).
006319         07 A|㪖@RO          PIC 9(4).
006320      05 A|dÂRO.
006321         07 A|dÉ񐔂RO          PIC 9(2).
006322         07 A|d×RO            PIC 9(4).
006323      05 A|vRO                 PIC 9(6).
006324      05 A|RO           PIC 9(3).
006325      05 A|vRO           PIC 9(6).
006326****************
006327* Sʁ^T *
006328****************
006329   03 A|ʂST.
006330      05 A|ÂST.
006331         07 A|ÒPST          PIC 9(4).
006332         07 A|É񐔂ST          PIC 9(2).
006333         07 A|×ST            PIC 9(5).
006334      05 A|㪖@ST.
006335         07 A|㪖@񐔂ST        PIC 9(2).
006336         07 A|㪖@ST          PIC 9(4).
006337      05 A|㪖@ST.
006338         07 A|㪖@񐔂ST        PIC 9(2).
006339         07 A|㪖@ST          PIC 9(4).
006340      05 A|dÂST.
006341         07 A|dÉ񐔂ST          PIC 9(2).
006342         07 A|d×ST            PIC 9(4).
006343      05 A|vST                 PIC 9(6).
006344      05 A|ʍvST         PIC 9(6).
006345      05 A|ST           PIC 9(3).
006346      05 A|vST           PIC 9(6).
006347****************
006348* Sʁ^W *
006349****************
006350   03 A|ʂSW.
006351      05 A|JnSW.
006352         07 A|JnSW        PIC 9(2).
006353         07 A|JnSW        PIC 9(2).
006354      05 A|ÂSW.
006355         07 A|ÒPSW          PIC 9(4).
006356         07 A|É񐔂SW          PIC 9(2).
006357         07 A|×SW            PIC 9(5).
006358      05 A|㪖@SW.
006359         07 A|㪖@񐔂SW        PIC 9(2).
006360         07 A|㪖@SW          PIC 9(4).
006361      05 A|㪖@SW.
006362         07 A|㪖@񐔂SW        PIC 9(2).
006363         07 A|㪖@SW          PIC 9(4).
006364      05 A|dÂSW.
006365         07 A|dÉ񐔂SW          PIC 9(2).
006366         07 A|d×SW            PIC 9(4).
006367      05 A|vSW                 PIC 9(6).
006368      05 A|ʍvSW         PIC 9(6).
006369      05 A|SW           PIC 9(3).
006370      05 A|vSW           PIC 9(6).
006371******************
006372* Sʁ^PO *
006373******************
006374   03 A|ʂSO.
006375      05 A|JnSO.
006376         07 A|JnSO        PIC 9(2).
006377         07 A|JnSO        PIC 9(2).
006378      05 A|ÂSO.
006379         07 A|ÒPSO          PIC 9(4).
006380         07 A|É񐔂SO          PIC 9(2).
006381         07 A|×SO            PIC 9(5).
006382      05 A|㪖@SO.
006383         07 A|㪖@񐔂SO        PIC 9(2).
006384         07 A|㪖@SO          PIC 9(4).
006385      05 A|㪖@SO.
006386         07 A|㪖@񐔂SO        PIC 9(2).
006387         07 A|㪖@SO          PIC 9(4).
006388      05 A|dÂSO.
006389         07 A|dÉ񐔂SO          PIC 9(2).
006390         07 A|d×SO            PIC 9(4).
006391      05 A|vSO                 PIC 9(6).
006392      05 A|SO           PIC 9(3).
006393      05 A|vSO           PIC 9(6).
006394********************
006395* Tʁ^QDT *
006396********************
006397   03 A|ʂTQ.
006398      05 A|ÂTQ.
006399         07 A|ÒPTQ          PIC 9(4).
006400         07 A|É񐔂TQ          PIC 9(2).
006401         07 A|×TQ            PIC 9(5).
006402      05 A|㪖@TQ.
006403         07 A|㪖@񐔂TQ        PIC 9(2).
006404         07 A|㪖@TQ          PIC 9(4).
006405      05 A|㪖@TQ.
006406         07 A|㪖@񐔂TQ        PIC 9(2).
006407         07 A|㪖@TQ          PIC 9(4).
006408      05 A|dÂTQ.
006409         07 A|dÉ񐔂TQ          PIC 9(2).
006410         07 A|d×TQ            PIC 9(4).
006411      05 A|vTQ                 PIC 9(6).
006412      05 A|ʍvTQ         PIC 9(6).
006413      05 A|TQ           PIC 9(3).
006414      05 A|vTQ           PIC 9(6).
006415****************
006416* Tʁ^T *
006417****************
006418   03 A|ʂTT.
006419      05 A|JnTT.
006420         07 A|JnTT        PIC 9(2).
006421         07 A|JnTT        PIC 9(2).
006422      05 A|ÂTT.
006423         07 A|ÒPTT          PIC 9(4).
006424         07 A|É񐔂TT          PIC 9(2).
006425         07 A|×TT            PIC 9(5).
006426      05 A|㪖@TT.
006427         07 A|㪖@񐔂TT        PIC 9(2).
006428         07 A|㪖@TT          PIC 9(4).
006429      05 A|㪖@TT.
006430         07 A|㪖@񐔂TT        PIC 9(2).
006431         07 A|㪖@TT          PIC 9(4).
006432      05 A|dÂTT.
006433         07 A|dÉ񐔂TT          PIC 9(2).
006434         07 A|d×TT            PIC 9(4).
006435      05 A|vTT                 PIC 9(6).
006436      05 A|ʍvTT         PIC 9(6).
006437      05 A|TT           PIC 9(3).
006438      05 A|vTT           PIC 9(6).
006439****************
006440* Tʁ^W *
006441****************
006442   03 A|ʂTW.
006443      05 A|JnTW.
006444         07 A|JnTW        PIC 9(2).
006445         07 A|JnTW        PIC 9(2).
006446      05 A|ÂTW.
006447         07 A|ÒPTW          PIC 9(4).
006448         07 A|É񐔂TW          PIC 9(2).
006449         07 A|×TW            PIC 9(5).
006450      05 A|㪖@TW.
006451         07 A|㪖@񐔂TW        PIC 9(2).
006452         07 A|㪖@TW          PIC 9(4).
006453      05 A|㪖@TW.
006454         07 A|㪖@񐔂TW        PIC 9(2).
006455         07 A|㪖@TW          PIC 9(4).
006456      05 A|dÂTW.
006457         07 A|dÉ񐔂TW          PIC 9(2).
006458         07 A|d×TW            PIC 9(4).
006459      05 A|vTW                 PIC 9(6).
006460      05 A|ʍvTW         PIC 9(6).
006461      05 A|TW           PIC 9(3).
006462      05 A|vTW           PIC 9(6).
006463******************
006464* Tʁ^PO *
006465******************
006466   03 A|ʂTO.
006467      05 A|JnTO.
006468         07 A|JnTO        PIC 9(2).
006469         07 A|JnTO        PIC 9(2).
006470      05 A|ÂTO.
006471         07 A|ÒPTO          PIC 9(4).
006472         07 A|É񐔂TO          PIC 9(2).
006473         07 A|×TO            PIC 9(5).
006474      05 A|㪖@TO.
006475         07 A|㪖@񐔂TO        PIC 9(2).
006476         07 A|㪖@TO          PIC 9(4).
006477      05 A|㪖@TO.
006478         07 A|㪖@񐔂TO        PIC 9(2).
006479         07 A|㪖@TO          PIC 9(4).
006480      05 A|dÂTO.
006481         07 A|dÉ񐔂TO          PIC 9(2).
006482         07 A|d×TO            PIC 9(4).
006483      05 A|vTO                 PIC 9(6).
006484      05 A|TO           PIC 9(3).
006485      05 A|vTO           PIC 9(6).
006495*
009130*
009140 01 A|L[ IS EXTERNAL.
009150    03 A|ی                  PIC 9(2).
009160*
009170* L[
009180 01 Av|L[ IS EXTERNAL.
009190    03  Av|SvZ敪           PIC 9.
009200    03  Av|{lƑ敪             PIC 9.
009210    03  Av|ی                 PIC 9(2).
009220    03  Av|یҔԍ               PIC X(10).
009230    03  Av|                 PIC 9(2).
009240    03  Av|sԍVl           PIC X(10).
009250    03  Av|                 PIC 9(2).
009260    03  Av|sԍ           PIC X(10).
009270    03  Av|҃R[h.
009280      05  Av|Ҕԍ               PIC 9(6).
009290      05  Av|}                   PIC X.
009300    03  Av|{paN.
009310      05  Av|{paN.
009320        07  Av|{pa             PIC 9.
009330        07  Av|{pN.
009340          09  Av|{pN             PIC 9(2).
009350          09  Av|{p             PIC 9(2).
009360      05  Av|{p                 PIC 9(2).
009370    03  Av|pz                   PIC 9(6).
009380    03  Av|Sz                   PIC 9(6).
009390    03  Av|z                   PIC 9(6).
009400    03  Av|pzVl               PIC 9(6).
009410    03  Av|SzVl               PIC 9(6).
009420    03  Av|zVl               PIC 9(6).
009430    03  Av|pz               PIC 9(6).
009440    03  Av|Sz               PIC 9(5).
009450    03  Av|z               PIC 9(5).
009460    03  Av|                   PIC 9(2).
009470    03  Av|S                   PIC 9(3).
009480    03  Av|S敪               PIC 9.
009490*
009500 01 A|L[ IS EXTERNAL.
009510    03  A|bZ[W                 PIC N(20).
009520*
009530 01 AvZ|L[ IS EXTERNAL.
009540   03 AvZ|҃R[h.
009550     05 AvZ|Ҕԍ                    PIC 9(6).
009560     05 AvZ|}                        PIC X(1).
009570   03 AvZ|{paN.
009580     05 AvZ|{paN.
009590       07 AvZ|{pa                  PIC 9.
009600       07 AvZ|{pN.
009610         09 AvZ|{pN                  PIC 9(2).
009620         09 AvZ|{p                  PIC 9(2).
009630     05 AvZ|{p                      PIC 9(2).
009640   03 AvZ|aN.
009650     05 AvZ|aN.
009660       07 AvZ|a                  PIC 9.
009670       07 AvZ|N.
009680         09 AvZ|N                  PIC 9(2).
009690         09 AvZ|                  PIC 9(2).
009700     05 AvZ|                      PIC 9(2).
009710   03 AvZ|ʐ                        PIC 9(1).
009720   03 AvZ|S                      PIC 9(1).
009730   03 AvZ|pz                        PIC 9(6).
009740   03 AvZ|Sz                        PIC 9(6).
009750*
009760 01 A{|L[ IS EXTERNAL.
009770   03 A{|{L\z敪               PIC 9.
009780   03 A{|{paN.
009790     05 A{|{pa                 PIC 9.
009800     05 A{|{pN.
009810       07 A{|{pN                 PIC 9(2).
009820       07 A{|{p                 PIC 9(2).
009830     05 A{|{p                   PIC 9(2).
009840   03 A{|҃R[h.
009850     05 A{|Ҕԍ                 PIC 9(6).
009860     05 A{|}                     PIC X.
009870   03 A{| OCCURS 5.
009880     05 A{|aN.
009890       07 A{|a               PIC 9.
009900       07 A{|N.
009910         09 A{|N               PIC 9(2).
009920         09 A{|               PIC 9(2).
009930       07 A{|                 PIC 9(2).
009940*
009950 01 Ardjhqnj|L[ IS EXTERNAL.
009960   03 Ardjhqnj|I[v敪   PIC 9.
009970*
009980* f҂e̎}ԃ`FbN
009990 01 Af}Ԃbgj|L[ IS EXTERNAL.
010000    03 Af}Ԃbgj|{paN.
010010       05 Af}Ԃbgj|{pa          PIC 9.
010020       05 Af}Ԃbgj|{pN.
010030          07 Af}Ԃbgj|{pN         PIC 9(2).
010040          07 Af}Ԃbgj|{p         PIC 9(2).
010050    03 Af}Ԃbgj|҃R[h.
010060       05 Af}Ԃbgj|Ҕԍ          PIC 9(6).
010070       05 Af}Ԃbgj|}              PIC X.
010080*   OUTi0:ȂA1:j
010090    03 Af}Ԃbgj|}Ԃ             PIC 9.
010100    03 Af}Ԃbgj|}Ԃ     PIC 9.
010110******************************************************************
010120*                      PROCEDURE  DIVISION                       *
010130******************************************************************
010140 PROCEDURE               DIVISION.
010150************
010160*           *
010170*    *
010180*           *
010190************
010200     PERFORM .
010210************
010220*           *
010230* 又     *
010240*           *
010250************
010260     MOVE AvZ|{paN TO |{paN.
010270     MOVE AvZ|҃R[h   TO |҃R[h.
010280     READ fҏe
010290     INVALID KEY
010300         MOVE  NC"@@@f҂m܂B" TO A|bZ[W
010310         CALL   "MSG001"
010320         CANCEL "MSG001"
010330     NOT INVALID KEY
010340         PERFORM AڃZbg{L
010350*/vZpJn擾vZŃZbgꂽȍ~ŏ̒ʉ@JnƂB
010360         MOVE AvZ|Ҕԍ  TO {L|Ҕԍ
010370         MOVE AvZ|}      TO {L|}
010380         MOVE AvZ|a  TO {L|{pa
010390         MOVE AvZ|N    TO {L|{pN
010400         MOVE AvZ|    TO {L|{p
010410         MOVE AvZ|    TO {L|{p
010420         START {pL^e   KEY IS >= {L|҃R[h
010430                                      {L|{paN
010440         END-START
010450         IF ԃL[ = "00"
010460             READ {pL^e NEXT
010470             NOT AT END
010480                 IF ({L|҃R[h   = AvZ|҃R[h  ) AND
010490                    ({L|{paN = AvZ|{paN)
010500                     MOVE {L|{paN TO A{|aN(1)
010510                 END-IF
010520             END-READ
010530         END-IF
010540*/vZpJn擾
010550*        / I[v敪:0 (I[vj
010560         MOVE ZERO TO Ardjhqnj|I[v敪
010570*/SEKIRECgݍ
010580*         CALL   "SEKIREC"
010590*         CANCEL "SEKIREC"
010600         PERFORM {LR[h쐬
010610     END-READ.
010620*
010630     PERFORM 擾.
010640*
010650     MOVE A|pz TO AvZ|pz
010660     COMPUTE AvZ|Sz = AvZ|pz * AvZ|S / 10
010670* SẑP̈ʂľܓ
010680     COMPUTE AvZ|Sz ROUNDED = AvZ|Sz / 10
010690     COMPUTE AvZ|Sz         = AvZ|Sz * 10
010700************
010710*           *
010720* I   *
010730*           *
010740************
010750     PERFORM I.
010760     MOVE 1 TO PROGRAM-STATUS.
010770     EXIT PROGRAM.
010780*
010790*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
010800*================================================================*
010810  SECTION.
010820*
010830     OPEN INPUT {pL^e
010840         MOVE NC"{L" TO t@C
010850         PERFORM I[v`FbN
010860     OPEN INPUT f[^e
010870         MOVE NC"" TO t@C
010880         PERFORM I[v`FbN
010890     OPEN INPUT vZ}X^
010900         MOVE NC"vZ" TO t@C
010910         PERFORM I[v`FbN
010920     OPEN INPUT }X^
010930         MOVE NC"" TO t@C
010940         PERFORM I[v`FbN
010950     OPEN INPUT fҏe.
010960         MOVE NC"f" TO t@C.
010970         PERFORM I[v`FbN.
010980     OPEN INPUT }X^.
010990         MOVE NC"" TO t@C.
011000         PERFORM I[v`FbN.
011010*================================================================*
011020 I[v`FbN SECTION.
011030*
011040     IF ԃL[  NOT =  "00"
011050         DISPLAY t@C NC"eI[vG[" UPON CONS
011060         DISPLAY NC"ԃL[F" ԃL[         UPON CONS
011070         DISPLAY NC"P͂dmsdqL[Ă" UPON CONS
011071*-----------------------------------------*
011072         CALL "actcshm"  WITH C LINKAGE
011073*-----------------------------------------*
011080         ACCEPT  L[ FROM CONS
011090         PERFORM t@C
011100         EXIT PROGRAM.
011110*================================================================*
011120 I SECTION.
011130*
011140     PERFORM t@C.
011150*================================================================*
011160 t@C SECTION.
011170*
011180     CLOSE fҏe {pL^e f[^e vZ}X^
011190           }X^   }X^.
011200*================================================================*
011210 G[\ SECTION.
011220*
011230     DISPLAY NC"t@CG[F" t@C   UPON CONS.
011240     DISPLAY NC"ԃL[" ԃL[                 UPON CONS.
011250     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
011260     DISPLAY NC"P͂dmsdqL[Ă"                                                                    UPON CONS.
011261*-----------------------------------------*
011262     CALL "actcshm"  WITH C LINKAGE.
011263*-----------------------------------------*
011270     ACCEPT  L[ FROM CONS.
011280*================================================================*
011290 G[\q SECTION.
011300*
011310     DISPLAY t@C NC"t@CǍG["     UPON CONS.
011320     DISPLAY NC"ԃL[F" ԃL[               UPON CONS.
011330     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
011340     DISPLAY NC"P͂dmsdqL[Ă" UPON CONS.
011341*-----------------------------------------*
011342     CALL "actcshm"  WITH C LINKAGE.
011343*-----------------------------------------*
011350     ACCEPT  L[ FROM CONS.
011360     PERFORM t@C.
011370     EXIT PROGRAM.
011380*================================================================*
011390 AڃZbg{L SECTION.
011400*
011410     MOVE SPACE TO A{|L[.
011420     INITIALIZE    A{|L[.
011430*
011440     MOVE ZERO                TO A{|{L\z敪.    
011450     MOVE AvZ|{pa  TO A{|{pa.    
011460     MOVE AvZ|{pN    TO A{|{pN.      
011470     MOVE AvZ|{p    TO A{|{p.      
011480     MOVE AvZ|{p    TO A{|{p.      
011490     MOVE AvZ|Ҕԍ  TO A{|Ҕԍ.
011500     MOVE AvZ|}      TO A{|}.    
011510*
011520*================================================================*
011530 擾 SECTION.
011540*
011550     INITIALIZE A|P
011560                A|Q
011570                A|R.
011580     INITIALIZE ޔڂfv.
011590*
011600*     PERFORM Zvgʎ擾.
011610**
011620*     EVALUATE Zvgނv
011630*         WHEN "KOKU"
011640*         WHEN "SYAH"
011650*         WHEN "SYAK"
011660*         WHEN "KUMH"
011670*         WHEN "KUMK"
011680*         WHEN "KYOH"
011690*         WHEN "KYOK"
011700*         WHEN "TAIS"
011710*         WHEN "JIEI"
011720*             MOVE |ی         TO Zvgʂfv
011730*         WHEN "ROUJ"
011740*             MOVE |         TO Zvgʂfv
011750*         WHEN "JYOS"
011760*             MOVE |         TO Zvgʂfv
011770*     END-EVALUATE.
011780*/ۃf[^ƂČvZ
011790     MOVE 01 TO Zvgʂfv
011800*    ********
011810*    * vZ *
011820*    ********
011830     PERFORM vZAڃZbgQ.
011840     MOVE 2   TO  Av|SvZ敪.
011850*/Zvgc̑g
011860*     CALL   "RESEPTD".
011870*     CANCEL "RESEPTD".
011880     PERFORM pzvZ.
011890*
011900     IF Zvgނv = "JYOS"
011910         MOVE A|󋋎ҕSz TO ꕔSvq
011920     ELSE
011930         MOVE A|ꕔS   TO ꕔSvq
011940     END-IF.
011950*
011960*================================================================*
011970 vZAڃZbgQ SECTION.
011980*
011990     MOVE SPACE TO Av|L[.
012000     INITIALIZE    Av|L[.
012010*
012020     MOVE Zvgʂfv   TO A|ی.
012030     MOVE |Ҕԍ       TO Av|Ҕԍ.
012040     MOVE |}           TO Av|}.
012050     MOVE |{pa       TO Av|{pa.
012060     MOVE |{pN         TO Av|{pN.
012070     MOVE |{p         TO Av|{p.
012080     MOVE AvZ|{p   TO Av|{p.
012090     MOVE ZERO               TO Av|SvZ敪.
012100     MOVE |{lƑ敪   TO Av|{lƑ敪.
012110     MOVE |ی       TO Av|ی.
012120     MOVE 01       TO Av|ی.
012130     MOVE |یҔԍ     TO Av|یҔԍ.
012140     MOVE |       TO Av|.
012150     MOVE |pSҔԍ TO Av|sԍVl.
012160     IF Zvgʂfv NOT = 05
012170         MOVE |           TO Av|      
012180         MOVE |pSҔԍ TO Av|sԍ
012190     END-IF.
012200*
012210*================================================================*
012220* Zvgʎ擾 SECTION.
012230**
012240*     IF |  = ZERO
012250*         EVALUATE TRUE
012260*         WHEN (|ی = 01) AND (| = ZERO)
012270*            MOVE "KOKU"    TO Zvgނv
012280*         WHEN (|ی = 02 OR 06 OR 07) AND (|{lƑ敪 = 1) AND (| = ZERO)
012290*            MOVE "SYAH"    TO Zvgނv
012300*         WHEN (|ی = 02 OR 06 OR 07) AND (|{lƑ敪 = 2) AND (| = ZERO)
012310*            MOVE "SYAK"    TO Zvgނv
012320*         WHEN (|ی = 03) AND (|{lƑ敪 = 1) AND (| = ZERO)
012330*            MOVE "KUMH"    TO Zvgނv
012340*         WHEN (|ی = 03) AND (|{lƑ敪 = 2) AND (| = ZERO)
012350*            MOVE "KUMK"    TO Zvgނv
012360*         WHEN (|ی = 04) AND (|{lƑ敪 = 1) AND (| = ZERO)
012370*            MOVE "KYOH"    TO Zvgނv
012380*         WHEN (|ی = 04) AND (|{lƑ敪 = 2) AND (| = ZERO)
012390*            MOVE "KYOK"    TO Zvgނv
012400*         WHEN | = 05
012410*            MOVE "ROUJ"    TO Zvgނv
012420*         WHEN (|ی = 08) AND (| = ZERO)
012430*            MOVE "TAIS"    TO Zvgނv
012440*         WHEN (|ی = 09) AND (| = ZERO)
012450*            MOVE "JIEI"    TO Zvgނv
012460*         WHEN OTHER
012470*            CONTINUE
012480*         END-EVALUATE
012490*     ELSE
012500*** 鎞
012510*         MOVE "JYOS"    TO Zvgނv
012520*     END-IF.
012530**
012540*================================================================*
012550 {LR[h쐬 SECTION.
012560*
012570*/SEKIREC̑gݍ
012580     MOVE A{|{pa TO |{pa {pabv.
012590     MOVE A{|{pN   TO |{pN   {pNbv.
012600     MOVE A{|{p   TO |{p   {pbv.
012610     MOVE A{|{p   TO              {pbv.
012620     MOVE A{|Ҕԍ TO |Ҕԍ.
012630     MOVE A{|}     TO |}.
012640*
012650     READ f[^e
012660     INVALID KEY
012670         MOVE NC"" TO t@C
012680         PERFORM G[\q
012690     NOT INVALID KEY
012700*
012710*/vZBSʔPÃf[^ƂČvZB
012720         MOVE AvZ|ʐ TO |ʐ
012730         PERFORM VARYING ʂbms FROM 1 BY 1 UNTIL ʂbms > |ʐ
012740             MOVE AvZ|aN TO |aN(ʂbms)
012750             MOVE 01                       TO |      (ʂbms)
012760             MOVE A{|aN(1)  TO |JnaN(ʂbms)
012770         END-PERFORM
012780*
012790* fË敪or̃ZbgƍČ敪̃Zbgs
012800         IF |敪 = 1 OR 2
012810             MOVE SPACE TO ČtO
012820         ELSE
012830             PERFORM ČZbg
012840         END-IF
012850*
012860* iqdvqhsdjɑΉł悤qd`cĂidvj
012870         MOVE A{|{pa TO {L|{pa
012880         MOVE A{|{pN   TO {L|{pN
012890         MOVE A{|{p   TO {L|{p
012900         MOVE A{|{p   TO {L|{p
012910         MOVE A{|Ҕԍ TO {L|Ҕԍ
012920         MOVE A{|}     TO {L|}
012930         READ {pL^e
012940         INVALID KEY
012950             MOVE SPACE TO {L|R[h
012960             INITIALIZE    {L|R[h
012970             MOVE A{|{pa TO {L|{pa
012980             MOVE A{|{pN   TO {L|{pN
012990             MOVE A{|{p   TO {L|{p
013000             MOVE A{|{p   TO {L|{p
013010             MOVE A{|Ҕԍ TO {L|Ҕԍ
013020             MOVE A{|}     TO {L|}
013030         NOT INVALID KEY
013040*
013050* R[h̕ʎZXV
013060             PERFORM CZ񏉊
013070         END-READ
013080* 
013090         MOVE SPACE TO ItO
013100         MOVE 1    TO  {L|fË敪
013110         PERFORM VARYING JE^ FROM 1 BY 1
013120                 UNTIL ( JE^     > 5      ) OR
013130                       ( ItO   NOT = SPACE  )
013140             IF ( A{|a(JE^) = ZERO ) OR
013150                ( A{|N(JE^)   = ZERO ) OR
013160                ( A{|(JE^)   = ZERO ) OR
013170                ( A{|(JE^)   = ZERO )
013180                 MOVE "YES" TO ItO
013190             ELSE
013200                 IF A{|aN(JE^) = A{|{paN
013210                     MOVE 2    TO  {L|fË敪
013220                     IF |敪 = 1 OR 2
013230                         MOVE ZERO TO {L|敪
013240                     ELSE
013250                         MOVE 1    TO {L|敪
013260                     END-IF
013270*----------------------------------------------------------------------------------*
013280*                    / 2008/06 @k敪 0FZ@1FZȂ
013290                     IF |k敪 = 1
013300                         MOVE 1    TO {L|k敪
013310                     ELSE
013320                         MOVE ZERO TO {L|k敪
013330                     END-IF
013340*----------------------------------------------------------------------------------*
013350                     MOVE "YES" TO ItO
013360                 END-IF
013370             END-IF
013380         END-PERFORM
013390*
013400* Č
013410         MOVE SPACE TO ČtO
013420         IF ( ČtO NOT = SPACE ) AND
013430            ( {L|fË敪   NOT = 2     )
013440             MOVE 1     TO {L|Č
013450             MOVE "YES" TO ČtO
013460         ELSE
013470             MOVE ZERO  TO {L|Č
013480             MOVE SPACE TO ČtO
013490         END-IF
013500*
013510         PERFORM VARYING ʂbms FROM 1 BY 1
013520                 UNTIL ʂbms > |ʐ
013530* ȁꍇAȉ̎Z͍sȂB
013540             IF |(ʂbms) NOT = 09
013550                 IF ( |Ia(ʂbms) = ZERO ) OR
013560                    ( |IN(ʂbms)   = ZERO ) OR
013570                    ( |I(ʂbms)   = ZERO ) OR
013580                    ( |I(ʂbms)   = ZERO )
013590                     MOVE "9999999" TO IaNbv
013600                 ELSE
013610                     MOVE |IaN(ʂbms) TO IaNbv
013620                 END-IF
013630*
013640* ʃR[hE]A敪́A{pɊ֌WȂ]LB
013650                 MOVE |ʃR[h(ʂbms) TO {L|ʃR[h(ʂbms)
013660                 MOVE |]A敪(ʂbms)   TO {L|]A敪(ʂbms)
013670*
013680                 IF ( |JnaN(ʂbms) <= {paNbv ) AND
013690                    ( IaNbv             >= {paNbv )
013700                     PERFORM Z擾
013710                     PERFORM 㪖@Z菈
013720                     IF ( |JnaN(ʂbms) = {paNbv ) AND
013730                        ( |Z敪(ʂbms)   NOT = 1  ) AND
013740                        ( |(ʂbms)   NOT = 07 ) AND
013750                        ( |(ʂbms)   NOT = 08 )
013760                         MOVE 1 TO {L|{Ë敪(ʂbms)
013770                     END-IF
013780                     PERFORM ÎZ菈
013790*                    ^ tSk@^
013800                     IF |(ʂbms) = 07 OR 08
013810                         MOVE 1 TO {L|tSk敪(ʂbms)
013820                     END-IF
013830                 END-IF
013840             ELSE
013850* ʃR[hE]A敪́A{pɊ֌WȂ]LB
013860                 MOVE |ʃR[h(ʂbms) TO {L|ʃR[h(ʂbms)
013870             END-IF
013880         END-PERFORM
013890*
013900*/vZpׁ̈A݂ޔB
013910*         PERFORM {LR[h
013920         MOVE {L|R[h TO ޔ{L|R[h
013930*
013940**    / Čȍ~̍Č /
013950*         IF ČtO = "YES"
013960*            PERFORM Č
013970*         END-IF
013980*
013990     END-READ.
014000*================================================================*
014010 㪖@Z菈 SECTION.
014020*
014030     MOVE |a(ʂbms) TO vZav.
014040     MOVE |N(ʂbms)   TO vZNv.
014050     MOVE |(ʂbms)   TO vZv.
014060     MOVE |(ʂbms)   TO vZv.
014070     PERFORM N擾.
014080     PERFORM tΒlvZ.
014090     MOVE Βlv                 TO Βlv.
014100*
014110     MOVE A{|{pa           TO vZav.
014120     MOVE A{|{pN             TO vZNv.
014130     MOVE A{|{p             TO vZv.
014140     MOVE A{|{p             TO vZv.
014150     PERFORM N擾.
014160     PERFORM tΒlvZ.
014170     MOVE Βlv                 TO {pΒlv.
014180*
014190     COMPUTE oߓv = {pΒlv - ( Βlv - 1 ).
014200*
014210     EVALUATE |(ʂbms)
014220* sS܁E܁itSk܂ށj
014230     WHEN 05
014240     WHEN 06
014250     WHEN 07
014260     WHEN 08
014270         IF oߓv <= 㪓܂v
014280             MOVE 1 TO {L|㪖@敪(ʂbms)
014290         END-IF
014300         IF oߓv > 㪑ҋ@܂v
014310* @@@@@ ^@EŒs͉̓㪖@ZłȂ@^
014320             IF ( |Z敪(ʂbms)    NOT = 1  ) AND
014330                ( |(ʂbms)    NOT = 07 ) AND
014340                ( |(ʂbms)    NOT = 08 ) AND
014350                ( |JnaN(ʂbms)  = {paNbv )
014360                 MOVE ZERO TO {L|㪖@敪(ʂbms)
014370                 MOVE ZERO TO {L|dË敪(ʂbms)
014380             ELSE
014390* @@@@@@@@^@Âsꍇ͎Znj@^
014400                 MOVE 2 TO {L|㪖@敪(ʂbms)
014410                 IF |dÐ敪(ʂbms) = ZERO
014420                     MOVE 1 TO {L|dË敪(ʂbms)
014430                 END-IF
014440             END-IF
014450         END-IF
014460* EP
014470     WHEN 04
014480         IF oߓv <= 㪓EPv
014490             MOVE 1 TO {L|㪖@敪(ʂbms)
014500         END-IF
014510         IF oߓv > 㪑ҋ@EPv
014520* @@@@@^@E{Âs͉̓㪖@ZłȂ@^
014530             IF ( |Z敪(ʂbms)    NOT = 1  ) AND
014540                ( |(ʂbms)    NOT = 07 ) AND
014550                ( |(ʂbms)    NOT = 08 ) AND
014560                ( |JnaN(ʂbms)  = {paNbv )
014570                 MOVE ZERO TO {L|㪖@敪(ʂbms)
014580                 MOVE ZERO TO {L|dË敪(ʂbms)
014590             ELSE
014600* @@@@@@@@^@Âsꍇ͎Znj@^
014610                 MOVE 2 TO {L|㪖@敪(ʂbms)
014620                 IF |dÐ敪(ʂbms) NOT = ZERO
014630                     MOVE ZERO TO {L|dË敪(ʂbms)
014640                 ELSE
014650                     MOVE 1 TO {L|dË敪(ʂbms)
014660                 END-IF
014670             END-IF
014680         END-IF
014690* ŖoEPE
014700     WHEN 01
014710     WHEN 02
014720     WHEN 03
014730         IF oߓv <= 㪓Ŗov
014740             EVALUATE oߓv
014750* ̏ꍇ́A㪖@Z
014760             WHEN 1
014770                 MOVE 1 TO {L|㪖@敪(ʂbms)
014780* ̗ꍇ́Âݗ㪖@Z
014790             WHEN 2
014800                 IF |JnaN(ʂbms) = {paNbv
014810                      MOVE 1 TO {L|㪖@敪(ʂbms)
014820                 END-IF
014830             WHEN OTHER
014840                 CONTINUE
014850             END-EVALUATE
014860         END-IF
014870         IF oߓv > 㪑ҋ@EPv
014880* @@@@@^@E{Âs͉̓㪖@ZłȂ@^
014890             IF ( |Z敪(ʂbms)    NOT = 1  ) AND
014900                ( |(ʂbms)    NOT = 07 ) AND
014910                ( |(ʂbms)    NOT = 08 ) AND
014920                ( |JnaN(ʂbms)  = {paNbv )
014930                 MOVE ZERO TO {L|㪖@敪(ʂbms)
014940                 MOVE ZERO TO {L|dË敪(ʂbms)
014950             ELSE
014960* @@@@@@@@^@Âsꍇ͎Znj@^
014970                 MOVE 2 TO {L|㪖@敪(ʂbms)
014980                 IF |dÐ敪(ʂbms) = ZERO
014990                     MOVE 1 TO {L|dË敪(ʂbms)
015000                 END-IF
015010             END-IF
015020         END-IF
015030     WHEN OTHER
015040         CONTINUE
015050     END-EVALUATE.
015060*
015070*================================================================*
015080 N擾 SECTION.
015090*
015100     MOVE vZav TO |敪.
015110     READ }X^
015120     INVALID KEY
015130         DISPLAY NC"wao^Ă܂" UPON CONS
015140         DISPLAY NC"P͂dmsdqL[Ă" UPON CONS
015141*-----------------------------------------*
015142         CALL "actcshm"  WITH C LINKAGE
015143*-----------------------------------------*
015150         ACCEPT  L[ FROM CONS
015160         PERFORM I
015170         EXIT PROGRAM
015180     NOT INVALID KEY
015190         COMPUTE Nv = |JnN + vZNv - 1
015200     END-READ.
015210*
015220*================================================================*
015230 tΒlvZ SECTION.
015240*
015250** 1989NƂAN܂ŉ[N񂠂邩vZ
015260** }X^̐JnNmFB
015270*     COMPUTE Nv   = Nv - 1989 - 1.
015280*     DIVIDE 4 INTO Nv GIVING [N񐔂v
015290*                            REMAINDER ]v
015300*     END-DIVIDE.
015310*/N1989N瓖N܂ł̉[N̉񐔂vZ(N͊܂܂Ȃ)
015320*/n߂̂邤N1992N琔
015330     COMPUTE Nv   = Nv - 1989 - 1.
015340     MOVE 1992 TO ZNv.
015350     MOVE ZERO TO [N񐔂v.
015360     PERFORM UNTIL Nv <= ZNv
015370         COMPUTE ZNv   = ZNv   + 4
015380         COMPUTE [N񐔂v = [N񐔂v + 1
015390     END-PERFORM.
015400*
015410     COMPUTE ʏN񐔂v     = Nv     - [N񐔂v.
015420     COMPUTE ʏNΒlv   = ʏN񐔂v   * 365.
015430     COMPUTE [NΒlv     = [N񐔂v     * 366.
015440     COMPUTE NΒlv       = ʏNΒlv + [NΒlv.
015450* N邤Nǂ𒲂ׂiQ̖vZj
015460*     COMPUTE NQv     = Nv + 1.
015470*     DIVIDE 4 INTO NQv GIVING [N񐔂v
015480*                                REMAINDER ]v
015490*     END-DIVIDE.
015500     DIVIDE 4 INTO Nv GIVING [N񐔂v
015510                            REMAINDER ]v
015520     END-DIVIDE.
015530*
015540     MOVE ZERO TO Βlv.
015550*
015560* O܂ł̐Βl݌v
015570     COMPUTE ΒlvQ = vZv * 30.
015580*
015590     EVALUATE vZv
015600     WHEN 3
015610         COMPUTE Βlv   = ΒlvQ - 1
015620     WHEN 2
015630     WHEN 6
015640     WHEN 7
015650         COMPUTE Βlv   = ΒlvQ + 1
015660     WHEN 8
015670         COMPUTE Βlv   = ΒlvQ + 2
015680     WHEN 9
015690     WHEN 10
015700         COMPUTE Βlv   = ΒlvQ + 3
015710     WHEN 11
015720     WHEN 12
015730         COMPUTE Βlv   = ΒlvQ + 4
015740     WHEN OTHER
015750         MOVE ΒlvQ TO Βlv
015760     END-EVALUATE.
015770*
015780     IF ( ]v = ZERO ) AND
015790        ( vZv > 2  )
015800         COMPUTE Βlv = Βlv + 1
015810     END-IF.
015820*
015830     COMPUTE Βlv   = NΒlv + Βlv + vZv.
015840*
015850*================================================================*
015860 Z擾 SECTION.
015870*
015880* NیFOP
015890*
015900     MOVE 01             TO v|敪.
015910     MOVE A{|{pa TO v|Jna {pabv.
015920     MOVE A{|{pN   TO v|JnN   {pNbv.
015930     MOVE A{|{p   TO v|Jn   {pbv.
015940*
015950     START vZ}X^ KEY IS <= v|敪
015960                                v|JnaN
015970                                REVERSED
015980     END-START.
015990*
016000     IF ԃL[ = "00"
016010*
016020         READ vZ}X^ NEXT
016030         AT END
016040             DISPLAY NC"{pNɑΉZ񂪂݂܂" UPON CONS
016041*-----------------------------------------*
016042             CALL "actcshm"  WITH C LINKAGE
016043*-----------------------------------------*
016050             PERFORM I
016060             EXIT PROGRAM
016070         NOT AT END
016080             IF ( {paNbv >= v`|JnaN ) AND
016090                ( {paNbv <= v`|IaN )
016100*
016110                 MOVE v`|㪓 TO 㪓܂v
016120                 MOVE v`|㪓EP TO 㪓EPv
016130                 MOVE v`|㪓Ŗo TO 㪓Ŗov
016140                 MOVE v`|㪑ҋ@ TO 㪑ҋ@܂v
016150                 MOVE v`|㪑ҋ@EP TO 㪑ҋ@EPv
016160             ELSE
016170                 DISPLAY NC"{pNɑΉZ񂪂݂܂" UPON CONS
016171*-----------------------------------------*
016172                 CALL "actcshm"  WITH C LINKAGE
016173*-----------------------------------------*
016180                 PERFORM I
016190                 EXIT PROGRAM
016200             END-IF
016210         END-READ
016220     END-IF.
016230*
016240*================================================================*
016250* {LR[h SECTION.
016260**
016270*     WRITE {L|R[h
016280*     END-WRITE.
016290**
016300*     EVALUATE ԃL[
016310*     WHEN "00"
016320*         CONTINUE
016330*     WHEN "22"
016340*         REWRITE {L|R[h
016350*         INVALID KEY
016360*             MOVE NC"{L" TO t@C
016370*             PERFORM G[\
016380*         END-REWRITE
016390*     WHEN OTHER
016400*         MOVE NC"{L" TO t@C
016410*         PERFORM G[\
016420*     END-EVALUATE.
016430**
016440*================================================================*
016450 ČZbg SECTION.
016460*
016470******************************************************************
016480* ÓɍČZF̎fÓ𔻒肵A
016490* Č̏ꍇAČtO"YES"āA
016500* {L|ČZbg
016510******************************************************************
016520*
016530     MOVE SPACE TO ČtO.
016540     MOVE SPACE TO }ԃ`FbNtO.
016550*
016560     MOVE A{|{pa TO {L|{pa.
016570     MOVE A{|{pN   TO {L|{pN.
016580     MOVE A{|{p   TO {L|{p.
016590     MOVE A{|{p   TO {L|{p.
016600     MOVE A{|Ҕԍ TO {L|Ҕԍ.
016610     MOVE A{|}     TO {L|}.
016620     START {pL^e KEY IS < {L|҃R[h 
016630                               {L|{paN
016640                               REVERSED
016650     END-START.
016660*
016670     IF ԃL[ = "00"
016680         READ {pL^e NEXT
016690         AT END
016700             MOVE "YES" TO }ԃ`FbNtO
016710         NOT AT END
016720* fË敪FQiZ̓j
016730             IF ( A{|҃R[h = {L|҃R[h ) AND
016740                ( {L|fË敪 = 2                  )
016750*               */OfÓO̎̂/080912
016760                 PERFORM O
016770                 IF (OtO = "YES") OR
016780                   ((A{|{pa = {L|{pa) AND
016790                    (A{|{pN   = {L|{pN  ) AND
016800                    (A{|{p   = {L|{p  ))
016810                     MOVE "YES" TO ČtO
016820                 END-IF
016830             END-IF
016840             IF (A{|҃R[h NOT = {L|҃R[h) OR
016850                (A{|{pa   NOT = {L|{pa  ) OR
016860                (A{|{pN     NOT = {L|{pN    ) OR
016870                (A{|{p     NOT = {L|{p    )
016880                 MOVE "YES" TO }ԃ`FbNtO
016890             END-IF
016900         END-READ
016910     END-IF.
016920*
016930*/ōŏ̒ʉ@̎}Ԃ݂̑𒲂
016940*/Ɏ}ԂO}Ԃ`FbN/080912
016950     IF }ԃ`FbNtO = "YES"
016960         MOVE SPACE TO Af}Ԃbgj|L[
016970         INITIALIZE    Af}Ԃbgj|L[
016980         MOVE A{|{pa TO Af}Ԃbgj|{pa
016990         MOVE A{|{pN   TO Af}Ԃbgj|{pN
017000         MOVE A{|{p   TO Af}Ԃbgj|{p
017010         MOVE A{|Ҕԍ TO Af}Ԃbgj|Ҕԍ
017020         MOVE SPACE          TO Af}Ԃbgj|}
017030         CALL   "EDACHK"
017040         CANCEL "EDACHK"
017050*        i0:ȂA1:j
017060         IF Af}Ԃbgj|}Ԃ = 1
017070             MOVE A{|{pa TO |{pa
017080             MOVE A{|{pN   TO |{pN
017090             MOVE A{|{p   TO |{p
017100             MOVE A{|Ҕԍ TO |Ҕԍ
017110             IF A{|} = SPACE
017120                 MOVE HIGH-VALUE TO |}
017130             ELSE
017140                 MOVE A{|} TO |}
017150             END-IF
017160* 
017170             START fҏe KEY IS < |{paN
017180                                         |҃R[h
017190                                         REVERSED
017200             END-START
017210             IF ԃL[ = "00"
017220                 READ fҏe NEXT
017230                 NOT AT END
017240                     MOVE A{|{pa TO {L|{pa
017250                     MOVE A{|{pN   TO {L|{pN
017260                     MOVE A{|{p   TO {L|{p
017270                     MOVE A{|{p   TO {L|{p
017280                     MOVE |Ҕԍ   TO {L|Ҕԍ
017290                     MOVE |}       TO {L|}
017300                     START {pL^e KEY IS < {L|҃R[h
017310                                               {L|{paN
017320                                               REVERSED
017330                     END-START
017340*
017350                     IF ԃL[ = "00"
017360*/}ԂAOʉ@̎tONAZbgȂ/
017370                         MOVE SPACE TO ČtO
017380                         READ {pL^e NEXT
017390                         NOT AT END
017400* fË敪FQiZ̓j
017410                             IF ( |҃R[h = {L|҃R[h ) AND
017420                                ( {L|fË敪 = 2                )
017430* OfÓO̎̂/080912
017440                                 PERFORM O
017450                                 IF (OtO = "YES") OR
017460                                   ((A{|{pa = {L|{pa) AND
017470                                    (A{|{pN   = {L|{pN  ) AND
017480                                    (A{|{p   = {L|{p  ))
017490                                     MOVE "YES" TO ČtO
017500                                 END-IF
017510                             END-IF
017520                         END-READ
017530                     END-IF
017540                 END-READ
017550             END-IF
017560         END-IF
017570     END-IF.
017580*
017590*================================================================*
017600 fҏeǍ SECTION.
017610*
017620     READ fҏe NEXT
017630     AT END
017640         MOVE "YES" TO ItOQ
017650     END-READ.
017660*================================================================*
017670 CZ񏉊 SECTION.
017680*
017690     MOVE 1    TO {L|fË敪.
017700     MOVE ZERO TO {L|Č.
017710*
017720*/ڂ͕ʐłȂSď悤ɕύXB020423
017730     PERFORM VARYING bms FROM 1 BY 1
017740*             UNTIL   bms > |ʐ
017750             UNTIL   bms > 9
017760         MOVE ZERO TO {L|(bms)
017770         MOVE ZERO TO {L|(bms)
017780         MOVE ZERO TO {L|E敪(bms)
017790         MOVE ZERO TO {L|ʒuԍ(bms)
017800*
017810         MOVE ZERO TO {L|]A敪(bms)
017820         MOVE ZERO TO {L|{Ë敪(bms)
017830         MOVE ZERO TO {L|tSk敪(bms)
017840         MOVE ZERO TO {L|㪖@敪(bms)
017850         MOVE ZERO TO {L|dË敪(bms)
017860         MOVE ZERO TO {L|×敪(bms)
017870     END-PERFORM.
017880*
017890* ڍ׍ڂɂẮAďȂBvZł́AJnI
017900* ĂׁAeȂBJЁE̍ہAČB
017910*
017920*/ꕔύX
017930*/ڂ͕ʐłȂSď悤ɕύXB
017940*/ʐAJnAIŔ肵ĂׁAvZɂ͉eȂ
017950*/Q͕f[^ǂɎ{pL^ê܂܃ZbgׁA
017960*/Q݂̂ŕsoB
017970*================================================================*
017980 ÎZ菈 SECTION.
017990*
018000     EVALUATE {L|fË敪
018010     WHEN 1
018020         IF {L|{Ë敪(ʂbms) = ZERO
018030             MOVE 1    TO {L|×敪(ʂbms)
018040         ELSE
018050             MOVE ZERO TO {L|×敪(ʂbms)
018060         END-IF
018070     WHEN 2
018080         IF {L|{Ë敪(ʂbms) = ZERO
018090             MOVE 1    TO {L|×敪(ʂbms)
018100         ELSE
018110             MOVE ZERO TO {L|×敪(ʂbms)
018120         END-IF
018130     WHEN OTHER
018140         MOVE 1    TO {L|×敪(ʂbms)
018150     END-EVALUATE.
018160*
018170*================================================================*
018180 Č SECTION.
018190*
018200*  / Čȍ~Ŏ̏܂()AČB /
018210*
018220      MOVE A{|Ҕԍ  TO {L|Ҕԍ.
018230      MOVE A{|}      TO {L|}.
018240      MOVE A{|{pa  TO {L|{pa.
018250      MOVE A{|{pN    TO {L|{pN.
018260      MOVE A{|{p    TO {L|{p.
018270      MOVE A{|{p    TO {L|{p.
018280      START {pL^e   KEY IS >  {L|҃R[h
018290                                   {L|{paN
018300      END-START.
018310      IF ԃL[ = "00"
018320             MOVE SPACE TO ItOR
018330             PERFORM {pL^eǍ
018340             PERFORM UNTIL ( {L|{pa   NOT = A{|{pa  ) OR
018350                           ( {L|{pN     NOT = A{|{pN    ) OR
018360                           ( {L|{p     NOT = A{|{p    ) OR
018370                           ( {L|Ҕԍ   NOT = A{|Ҕԍ  ) OR
018380                           ( {L|}       NOT = A{|}      ) OR
018390                           ( {L|fË敪 = 2  )  OR
018400                           ( ItOR     NOT = SPACE )
018410*
018420                  IF {L|Č NOT = ZERO
018430                      MOVE ZERO  TO {L|Č
018440*
018450                      REWRITE {L|R[h
018460                      INVALID KEY
018470                         MOVE NC"{L" TO t@C
018480                         PERFORM G[\
018490                      END-REWRITE
018500                  END-IF
018510*
018520                  PERFORM {pL^eǍ
018530*
018540             END-PERFORM
018550      END-IF.
018560*
018570*================================================================*
018580 {pL^eǍ SECTION.
018590*
018600     READ {pL^e NEXT
018610     AT END
018620         MOVE "YES" TO ItOR
018630     END-READ.
018640*================================================================*
018650 O  SECTION.
018660*------------------------------------------------------------------------------* 
018670*-- ǂݍ񂾎̕f[^̔NAOǂ (N̍ 1 ?) ---*
018680*------------------------------------------------------------------------------* 
018690*
018700      MOVE  SPACE  TO  OtO.
018710      INITIALIZE  vZNQv JnNQv INQv.
018720**
018730*vZ
018740      MOVE A{|{pa    TO IaQv.
018750      MOVE A{|{pN      TO INQv.
018760      MOVE A{|{p      TO IQv.
018770*Oʉ@
018780      MOVE {L|{pa    TO JnaQv.
018790      MOVE {L|{pN      TO JnNQv.
018800      MOVE {L|{p      TO JnQv.
018810*
018820      EVALUATE TRUE
018830       WHEN (JnaQv = IaQv) AND (JnNQv = INQv)
018840            PERFORM  Or
018850       WHEN (JnaQv = IaQv) AND (JnNQv NOT = INQv)
018860            PERFORM  OrN
018870       WHEN  JnaQv NOT = IaQv 
018880            PERFORM  Or
018890      END-EVALUATE.
018900*
018910      IF vZQv = 1
018920         MOVE  "YES"  TO  OtO
018930      END-IF.
018940*
018950*================================================================*
018960 Or  SECTION.
018970*
018980     IF  IQv >  JnQv
018990         COMPUTE vZQv = IQv - JnQv
019000     ELSE
019010        MOVE ZERO TO vZQv
019020     END-IF.
019030*
019040*================================================================*
019050 OrN  SECTION.
019060*
019070     IF  INQv >  JnNQv
019080         COMPUTE vZNQv = INQv - JnNQv
019090         COMPUTE vZQv = (vZNQv * 12 + IQv) - JnQv
019100     ELSE
019110        MOVE ZERO TO vZQv
019120     END-IF.
019130*
019140*================================================================*
019150 Or  SECTION.
019160*
019170     MOVE JnaQv TO |敪.
019180     READ }X^
019190     NOT INVALID KEY
019200         MOVE |JnN TO JnNQv
019210     END-READ.
019220     MOVE IaQv TO |敪.
019230     READ }X^
019240     NOT INVALID KEY
019250         MOVE |JnN TO INQv
019260     END-READ.
019270**
019280     IF (JnNQv NOT = ZERO) AND (INQv NOT = ZERO)
019290        COMPUTE JnNQv = JnNQv + JnNQv - 1
019300        COMPUTE INQv = INQv + INQv - 1
019310*
019320        IF INQv =  JnNQv
019330           PERFORM  Or
019340        ELSE
019350           IF  INQv >  JnNQv
019360               COMPUTE vZNQv = INQv - JnNQv
019370               COMPUTE vZQv = (vZNQv * 12 + IQv) - JnQv
019380           ELSE
019390               MOVE ZERO TO vZQv
019400           END-IF
019410        END-IF
019420     ELSE
019430        MOVE ZERO TO vZQv
019440     END-IF.
019450*
019460*================================================================*
019470* wwwpzvZ SECTION.
019480**
019490**/RESEPTD`pzvZ܂łg
019500**/(RESEPTD͔pzvZPGU蕪邾Ȃ̂ŎpzvẐ)
019510**/
019520*     PERFORM ݌vڏ.
019530*     PERFORM {擾.
019540*     PERFORM vZ擾.
019550**/又
019560*     MOVE Av|{pa TO {L|{pa {pabv.
019570*     MOVE Av|{pN   TO {L|{pN   {pNbv.
019580*     MOVE Av|{p   TO {L|{p   {pbv.
019590*     MOVE Av|{p   TO {L|{p   {pbv.
019600*     MOVE Av|Ҕԍ TO {L|Ҕԍ ҃R[hbv.
019610*     MOVE Av|}     TO {L|}     }Ԃbv.
019620**
019630*     START {pL^e KEY IS >= {L|҃R[h {L|{paN
019640*     END-START.
019650**
019660*     IF ԃL[ = "00"
019670**         MOVE 1     TO VlS񐔂v
019680*         MOVE SPACE TO ItOR
019690*         PERFORM {pL^eǍ
019700**
019710*         PERFORM UNTIL ( {L|҃R[h     NOT = ҃R[hbv   ) OR
019720*                       ( {L|{paN NOT = {paNbv ) OR
019730*                       ( ItOR         NOT = SPACE )
019740**
019750*             PERFORM vڏ
019760**
019770*             PERFORM Z
019780*             PERFORM ČZ
019790**             PERFORM ×Z
019800*             PERFORM ×Z
019810*             PERFORM ̑Z
019820*             PERFORM ݌v
019830**
019840*             PERFORM {pL^eǍ
019850*         END-PERFORM
019860*     END-IF.
019870**
019880******************************************************************
019890** ʊ֘Aڂ̕ʖPOO̍vA悶
019900** z𕔈ʖɎZoB
019910******************************************************************
019920**
019930*     PERFORM ʍv.
019940**
019950** eʖ́iPOŐzɁjiʁEj
019960** 悯zƕʈȊOڂZB
019970**
019980*     COMPUTE Av|pz = ʍvvP + ʍvvQ +
019990*                            ʍvvR + ʍvvRP +
020000*                            ʍvvS + ʍvvSP +
020010*                            ʍvvSQ + ʍvvT + 
020020*                            ʍvvTP + ʍvvTQ + 
020030*                            ʍvvTR + fv + Zfv +
020040*                            Čfv + ×fv + ÉZfv +
020050*                            qfv + 񏈒ufv + {p񋟗fv +
020060*                            kfv.
020070*****************************************************************
020080**     DISPLAY "ʍvvP  " ʍvvP  
020090**     DISPLAY "ʍvvQ  " ʍvvQ  
020100**     DISPLAY "ʍvvR  " ʍvvR  
020110**     DISPLAY "ʍvvRP" ʍvvRP
020120**     DISPLAY "ʍvvS  " ʍvvS  
020130**     DISPLAY "ʍvvSP" ʍvvSP
020140**     DISPLAY "ʍvvSQ" ʍvvSQ
020150**     DISPLAY "ʍvvT  " ʍvvT  
020160**     DISPLAY "ʍvvTP" ʍvvTP
020170**     DISPLAY "ʍvvTQ" ʍvvTQ
020180**     DISPLAY "ʍvvTR" ʍvvTR
020190**     DISPLAY "fv        " fv        
020200**     DISPLAY "Zfv    " Zfv    
020210**     DISPLAY "Čfv        " Čfv        
020220**     DISPLAY "×fv        " ×fv        
020230**     DISPLAY "ÉZfv    " ÉZfv    
020240**     DISPLAY "qfv    " qfv    
020250**     DISPLAY "񏈒ufv    " 񏈒ufv    
020260**     DISPLAY "{p񋟗fv" {p񋟗fv
020270**     DISPLAY "kfv  " kfv  
020280*****************************************************************
020290*     MOVE Av|pz TO A|pz
020300**
020310**           PERFORM AڃZbg.
020320**
020330**/PQNUTʖڂ̌×͎Z肵Ȃ
020340**/Tʖڂ̑ʒŔ肷
020350*     IF ʒjv(5) = ZERO
020360*         MOVE ZERO TO A|ʂTQ
020370*         INITIALIZE   A|ʂTQ
020380*     END-IF.
020390*================================================================*
020400 vڏ SECTION.
020410*
020420     MOVE ZERO TO ×Pov ×Qov
020430                  ×Rov ×RPov
020440                  ×Sov ×SPov ×SQov
020450                  ×Tov ×TPov ×TQov ×TRov.
020460     MOVE ZERO TO 㪖@Pov 㪖@Qov
020470                  㪖@Rov 㪖@RPov
020480                  㪖@Sov 㪖@SPov 㪖@SQov
020490                  㪖@Tov 㪖@TPov 㪖@TQov 㪖@TRov.
020500     MOVE ZERO TO 㪖@Pov 㪖@Qov
020510                  㪖@Rov 㪖@RPov
020520                  㪖@Sov 㪖@SPov 㪖@SQov
020530                  㪖@Tov 㪖@TPov 㪖@TQov 㪖@TRov.
020540     MOVE ZERO TO d×Pov d×Qov
020550                  d×Rov d×RPov
020560                  d×Sov d×SPov d×SQov
020570                  d×Tov d×TPov d×TQov d×TRov.
020580*
020590*================================================================*
020600 Z SECTION.
020610*
020620     MOVE ZERO TO v.
020630     MOVE ZERO TO Zv.
020640     MOVE ZERO TO kv.
020650*
020660     IF ( ޔ{L|fË敪     = 2 ) AND
020670        ( 敪v NOT = 1 ) AND
020680        ( ޔ{L|敪  = 1 )
020690         COMPUTE v = v + `v
020700* Z
020710         EVALUATE ޔ{L|Z
020720         WHEN ZERO
020730             CONTINUE
020740         WHEN 1
020750             MOVE 1 TO ԊOv
020760             COMPUTE Zv = Zv + ԊO`v
020770         WHEN 2
020780             MOVE 1 TO xv
020790             COMPUTE Zv = Zv + x`v
020800         WHEN 3
020810             MOVE 1 TO [v
020820             COMPUTE Zv = Zv + [`v
020830         WHEN OTHER
020840             CONTINUE
020850         END-EVALUATE
020860     END-IF.
020870* k /080527
020880     IF (ޔ{L|fË敪 = 2 ) AND (ޔ{L|k敪 NOT = 1)
020890         COMPUTE kv = kv + k`v
020900     END-IF.
020910*================================================================*
020920 ČZ SECTION.
020930*
020940     MOVE ZERO TO Čv.
020950*
020960     IF ޔ{L|Č  = 1
020970         COMPUTE Čv = Čv + Č`v
020980     END-IF.
020990*
021000*================================================================*
021010 ×Z SECTION.
021020****************************************************************
021030* ֌WF×E㪖@E㪖@܂
021040* pȊOiE~E]㓙jŎŽJLiTʂ܂Łj
021050* Ò̕ʂ̎̃P[XB
021060* ×E㪖@Ed×܂
021070****************************************************************
021080*
021090* pʐṽZbg
021100*     PERFORM pʐZbg.
021110     MOVE AvZ|ʐ TO ʐv pʐv.
021120*
021130     MOVE ZERO TO ×v 㪖@v 㪖@v d×v.
021140*
021150* p̕ʂ̂ݎZ肷
021160* p̕ʂ̂ݕʃJE^JEgto
021170     MOVE 1 TO ʃJE^
021180*
021190* ʃJE^́ApʐƂ̔r̂߂
021200* ̔zʒu擾̂߂̕ϐ
021210     PERFORM VARYING ʃJE^Q FROM 1 BY 1
021220             UNTIL ( ʃJE^ > pʐv   ) OR
021230                   ( ʃJE^ > É\Z萔jv ) OR 
021240                   ( ʃJE^Q > ʐv )
021250*
021260* |IaN͂̏ꍇ́AALL 9 Zbg
021270         PERFORM JnI擾
021280*
021290         IF ( JnaNv <= ޔ{L|{paN ) AND
021300            ( IaNv >= ޔ{L|{paN )
021310*
021320             MOVE ޔ{L|(ʃJE^Q)     TO ʂv
021330             MOVE ޔ{L|(ʃJE^Q)         TO ʂv
021340             MOVE ޔ{L|E敪(ʃJE^Q)     TO E敪v
021350             MOVE ޔ{L|ʒuԍ(ʃJE^Q) TO ʒuԍv
021360             IF ʂv = 01 OR 02 OR 03
021370                 PERFORM P×擾
021380*             ELSE
021390*                 PERFORM ʗ擾
021400             END-IF
021410* ÒP̑ޔ
021420             IF ʂv = 07 OR 08
021430                 MOVE Sk×av TO ÒPnv(ʃJE^Q)
021440             ELSE
021450                 MOVE ×av     TO ÒPnv(ʃJE^Q)
021460             END-IF
021470* Â̎̂ݎZ
021480             IF ( ޔ{L|×敪(ʃJE^Q)   = 1 ) AND 
021490                ( ޔ{L|{Ë敪(ʃJE^Q) NOT = 1 )
021500                 IF ( ޔ{L|tSk敪(ʃJE^Q) = 1 ) AND
021510                    ( ʂv = 07 OR 08                  )
021520* Zvg̑ʒڂ̏oׁ͂̈APOŐz𕔈ʖvB
021530                     MOVE Sk×av TO ×POOv(ʃJE^, ʃJE^Q)
021540                     PERFORM Ñʍڎ擾
021550                     PERFORM Ñʗ݌v
021560                 ELSE
021570                     MOVE ×av TO ×POOv(ʃJE^, ʃJE^Q)
021580                     PERFORM Ñʍڎ擾
021590                     PERFORM Ñʗ݌v
021600                 END-IF
021610             ELSE
021620                 IF ( ޔ{L|×敪(ʃJE^Q)   = 1 ) AND 
021630                    ( ޔ{L|{Ë敪(ʃJE^Q)     = 1 )
021640*/G[\̏C
021650*                     PERFORM R\[G[mF
021660                     DISPLAY "E×͓ɐł܂"
021670                     " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
021671*-----------------------------------------*
021672                     CALL "actcshm"  WITH C LINKAGE
021673*-----------------------------------------*
021680                  END-IF
021690             END-IF
021700*
021710             EVALUATE ޔ{L|㪖@敪(ʃJE^Q)
021720             WHEN 1
021730                 MOVE 㪖@`v TO 㪖@POOv(ʃJE^, ʃJE^Q)
021740                 PERFORM 㪖@ʍڎ擾
021750                 PERFORM 㪖@ʗ݌v
021760*
021770             WHEN 2
021780                 MOVE 㪖@`v TO 㪖@POOv(ʃJE^, ʃJE^Q)
021790                 PERFORM 㪖@ʍڎ擾
021800                 PERFORM 㪖@ʗ݌v
021810             WHEN OTHER
021820                 CONTINUE
021830             END-EVALUATE
021840*
021850             IF ޔ{L|dË敪(ʃJE^Q) = 1
021860                 MOVE d×`v TO d×POOv(ʃJE^, ʃJE^Q)
021870                 PERFORM dÑʍڎ擾
021880                 PERFORM dÑʗ݌v
021890             END-IF
021900*
021910             COMPUTE ʃJE^ = ʃJE^ + 1
021920         END-IF
021930     END-PERFORM.
021940*
021950*================================================================*
021960 ʍv SECTION.
021970*
021980     COMPUTE ʍvvP = ×Pqv + 㪖@Pqv +
021990                            㪖@Pqv + d×Pqv.
022000     COMPUTE ʍvvQ = ×Qqv + 㪖@Qqv +
022010                            㪖@Qqv + d×Qqv.
022020     COMPUTE ʍvvR = ×Rqv + 㪖@Rqv +
022030                            㪖@Rqv + d×Rqv.
022040     COMPUTE ʍvvRP = ×RPqv + 㪖@RPqv +
022050                            㪖@RPqv + d×RPqv.
022060     COMPUTE ʍvvS = ×Sqv + 㪖@Sqv +
022070                            㪖@Sqv + d×Sqv.
022080     COMPUTE ʍvvSP = ×SPqv + 㪖@SPqv +
022090                            㪖@SPqv + d×SPqv.
022100     COMPUTE ʍvvSQ = ×SQqv + 㪖@SQqv +
022110                            㪖@SQqv + d×SQqv.
022120     COMPUTE ʍvvT = ×Tqv + 㪖@Tqv +
022130                            㪖@Tqv + d×Tqv.
022140     COMPUTE ʍvvTP = ×TPqv + 㪖@TPqv +
022150                            㪖@TPqv + d×TPqv.
022160     COMPUTE ʍvvTQ = ×TQqv + 㪖@TQqv +
022170                            㪖@TQqv + d×TQqv.
022180     COMPUTE ʍvvTR = ×TRqv + 㪖@TRqv +
022190                            㪖@TRqv + d×TRqv.
022200*
022210* ʒZ
022220* Rʖڒ
022230     COMPUTE Ԍʂv   = ʒjv(3) / 100
022240     COMPUTE ʍvʂvR ROUNDED = ʍvvR * Ԍʂv
022250*
022260* Sʖڒ@TO
022270     COMPUTE Ԍʂv   = ʒjv(4) / 100
022280     COMPUTE ʍvʂvS ROUNDED = ʍvvS * Ԍʂv
022290*
022300* Sʖڒ@WO
022310     COMPUTE Ԍʂv   = ʒjv(3) / 100
022320     COMPUTE ʍvʂvSP ROUNDED = ʍvvSP * Ԍʂv
022330*
022340* Tʖڒ@QT
022350     COMPUTE Ԍʂv   = ʒjv(5) / 100
022360     COMPUTE ʍvʂvT ROUNDED = ʍvvT * Ԍʂv
022370*
022380* Tʖڒ@TO
022390     COMPUTE Ԍʂv   = ʒjv(4) / 100
022400     COMPUTE ʍvʂvTP ROUNDED = ʍvvTP * Ԍʂv
022410*
022420* Tʖڒ@WO
022430     COMPUTE Ԍʂv   = ʒjv(3) / 100
022440     COMPUTE ʍvʂvTQ ROUNDED = ʍvvTQ * Ԍʂv
022450*
022460* ܂ޕʖ̍vvZ
022470*
022480* Pʁ@POO
022490     IF 敪v(1) = 1
022500         COMPUTE ʍvvP ROUNDED = ʍvvP * Ԃjv
022510     ELSE IF 敪v(1) = ZERO
022520              MOVE ʍvvP TO ʍvvP
022530          END-IF
022540     END-IF.
022550*
022560* Qʁ@POO
022570     IF 敪v(2) = 1
022580         COMPUTE ʍvvQ ROUNDED = ʍvvQ * Ԃjv
022590     ELSE IF 敪v(2) = ZERO
022600              MOVE ʍvvQ TO ʍvvQ
022610          END-IF
022620     END-IF.
022630*
022640* Rʁ@POO
022650     IF 敪v(3) = 1
022660         COMPUTE ʍvvRP ROUNDED = ʍvvRP * Ԃjv
022670     ELSE IF 敪v(3) = ZERO
022680              MOVE ʍvvRP TO ʍvvRP
022690     END-IF.
022700*
022710* Rʁ@WO
022720     IF 敪v(3) = 1
022730         COMPUTE ʍvvR ROUNDED = ʍvʂvR * Ԃjv
022740     ELSE IF 敪v(3) = ZERO
022750             MOVE ʍvʂvR TO ʍvvR
022760          END-IF
022770     END-IF.
022780*
022790* Sʁ@POO
022800     IF 敪v(4) = 1
022810         COMPUTE ʍvvSQ ROUNDED = ʍvvSQ * Ԃjv
022820     ELSE IF 敪v(4) = ZERO
022830              MOVE ʍvvSQ TO ʍvvSQ
022840          END-IF
022850     END-IF.
022860*
022870* Sʁ@WO
022880     IF 敪v(4) = 1
022890         COMPUTE ʍvvSP ROUNDED = ʍvʂvSP * Ԃjv
022900     ELSE IF 敪v(4) = ZERO
022910              MOVE ʍvʂvSP TO ʍvvSP
022920          END-IF
022930     END-IF
022940*
022950* Sʁ@TO
022960     IF 敪v(4) = 1
022970         COMPUTE ʍvvS ROUNDED = ʍvʂvS * Ԃjv
022980     ELSE IF 敪v(4) = ZERO
022990              MOVE ʍvʂvS TO ʍvvS
023000          END-IF
023010     END-IF.
023020*
023030* Tʁ@POO
023040*
023050     IF 敪v(5) = 1
023060         COMPUTE ʍvvTR ROUNDED = ʍvʂvTR * Ԃjv
023070     ELSE IF 敪v(5) = ZERO
023080              MOVE ʍvvTR TO ʍvvTR
023090          END-IF
023100     END-IF.
023110*
023120* Tʁ@WO
023130     IF 敪v(5) = 1
023140         COMPUTE ʍvvTQ ROUNDED = ʍvʂvTQ * Ԃjv
023150     ELSE IF 敪v(5) = ZERO
023160              MOVE ʍvʂvTQ TO ʍvvTQ
023170          END-IF
023180     END-IF.
023190*
023200* Tʁ@TO
023210     IF 敪v(5) = 1
023220         COMPUTE ʍvvTP ROUNDED = ʍvʂvTP * Ԃjv
023230     ELSE IF 敪v(5) = ZERO
023240              MOVE ʍvʂvTP TO ʍvvTP
023250          END-IF
023260     END-IF.
023270*
023280* Tʁ@QT
023290     IF 敪v(5) = 1
023300         COMPUTE ʍvvT ROUNDED = ʍvʂvT * Ԃjv
023310     ELSE IF 敪v(5) = ZERO
023320              MOVE ʍvʂvT TO ʍvvT
023330          END-IF
023340     END-IF.
023350*
023360*================================================================*
023370 ݌vڏ SECTION.
023380*
023390     PERFORM VARYING ʂbms FROM 1 BY 1
023400            UNTIL   ʂbms > őo^ʐv
023410         MOVE ZERO TO 񏈒unv(ʂbms)
023420     END-PERFORM.
023430*
023440     MOVE ZERO TO fv Zfv
023450                  Čfv ×fv ÉZfv É񐔂fv
023460                  ×fv 㪖@fv 㪖@fv d×fv
023470                  qfv
023480                  񏈒ufv {p񋟗fv
023490                  pzVlfv SzVlfv Szfv Szfv
023500                  kfv.
023510*
023520     MOVE ZERO TO ×Pqv ×Qqv
023530                  ×Rqv ×RPqv
023540                  ×Sqv ×SPqv ×SQqv
023550                  ×Tqv ×TPqv ×TQqv ×TRqv.
023560     MOVE ZERO TO 㪖@Pqv 㪖@Qqv
023570                  㪖@Rqv 㪖@RPqv
023580                  㪖@Sqv 㪖@SPqv 㪖@SQqv
023590                  㪖@Tqv 㪖@TPqv 㪖@TQqv 㪖@TRqv.
023600     MOVE ZERO TO 㪖@Pqv 㪖@Qqv
023610                  㪖@Rqv 㪖@RPqv
023620                  㪖@Sqv 㪖@SPqv 㪖@SQqv
023630                  㪖@Tqv 㪖@TPqv 㪖@TQqv 㪖@TRqv.
023640     MOVE ZERO TO d×Pqv d×Qqv
023650                  d×Rqv d×RPqv
023660                  d×Sqv d×SPqv d×SQqv
023670                  d×Tqv d×TPqv d×TQqv d×TRqv.
023680*
023690     MOVE ZERO TO É񐔂Pqv É񐔂Qqv
023700                  É񐔂Rqv É񐔂RPqv
023710                  É񐔂Sqv É񐔂SPqv É񐔂SQqv
023720                  É񐔂Tqv É񐔂TPqv É񐔂TQqv É񐔂TRqv.
023730     MOVE ZERO TO 㪖@񐔂Pqv 㪖@񐔂Qqv
023740                  㪖@񐔂Rqv 㪖@񐔂RPqv
023750                  㪖@񐔂Sqv 㪖@񐔂SPqv 㪖@񐔂SQqv
023760                  㪖@񐔂Tqv 㪖@񐔂TPqv 㪖@񐔂TQqv 㪖@񐔂TRqv.
023770     MOVE ZERO TO 㪖@񐔂Pqv 㪖@񐔂Qqv
023780                  㪖@񐔂Rqv 㪖@񐔂RPqv
023790                  㪖@񐔂Sqv 㪖@񐔂SPqv 㪖@񐔂SQqv
023800                  㪖@񐔂Tqv 㪖@񐔂TPqv 㪖@񐔂TQqv 㪖@񐔂TRqv.
023810     MOVE ZERO TO dÉ񐔂Pqv dÉ񐔂Qqv
023820                  dÉ񐔂Rqv dÉ񐔂RPqv
023830                  dÉ񐔂Sqv dÉ񐔂SPqv dÉ񐔂SQqv
023840                  dÉ񐔂Tqv dÉ񐔂TPqv dÉ񐔂TQqv dÉ񐔂TRqv.
023850*
023860     MOVE ZERO TO ԊOv xv [v 
023870                  ÖԂv ÓHv Ö\Jv ÎԊOv
023880                  qv qv qv.
023890*
023900*================================================================*
023910 {擾 SECTION.
023920*
023930     MOVE 01             TO |敪R[h.
023940     MOVE ZEROS          TO |.
023950     MOVE ZEROS          TO |.
023960     MOVE ZEROS          TO |E敪.
023970     MOVE ZEROS          TO |ʒuԍ.
023980     MOVE Av|{pa TO |Jna {pabv.
023990     MOVE Av|{pN   TO |JnN   {pNbv.
024000     MOVE Av|{p   TO |Jn   {pbv.
024010*
024020     START }X^ KEY IS <= |敪R[h
024030                                |ʃR[h
024040                                |JnaN
024050                                REVERSED
024060     END-START.
024070*
024080     IF ԃL[ = "00"
024090         READ }X^ NEXT
024100         AT END
024110*/G[\̏C
024120*             PERFORM R\[G[mF
024130             DISPLAY "{pNɑΉ݂܂"
024140             " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
024141*-----------------------------------------*
024142             CALL "actcshm"  WITH C LINKAGE
024143*-----------------------------------------*
024150             PERFORM I
024160             MOVE ZERO TO PROGRAM-STATUS
024170             EXIT PROGRAM
024180         NOT AT END
024190*
024200             IF ( {paNbv >= `|JnaN ) AND
024210                ( {paNbv <= `|IaN )
024220                 MOVE `|          TO `v             
024230                 MOVE `|ԊO          TO ԊO`v     
024240                 MOVE `|x            TO x`v       
024250                 MOVE `|[            TO [`v       
024260                 MOVE `|Ê{    TO Ê{`v       
024270                 MOVE `|Òǉ    TO Òǉ`v       
024280                 MOVE `|ÉZ      TO ÉZ`v         
024290                 MOVE `|Č          TO Č`v             
024300                 MOVE `|㪖@        TO 㪖@`v           
024310                 MOVE `|㪖@        TO 㪖@`v           
024320                 MOVE `|d×          TO d×`v             
024330                 MOVE `|              TO `v             
024340                 MOVE `|              TO `v             
024350                 MOVE `|              TO `v             
024360                 MOVE `|{p񋟗  TO {p񋟗`v     
024370                 MOVE `|k    TO k`v
024380             ELSE
024390*/G[\̏C
024400*             PERFORM R\[G[mF
024410             DISPLAY "{pNɑΉ݂܂"
024420                     " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p   UPON CONS
024421*-----------------------------------------*
024422             CALL "actcshm"  WITH C LINKAGE
024423*-----------------------------------------*
024430                 PERFORM I
024440                 MOVE ZERO TO PROGRAM-STATUS
024450                 EXIT PROGRAM
024460             END-IF
024470         END-READ
024480     END-IF.
024490*
024500*================================================================*
024510 vZ擾 SECTION.
024520*
024530* 敪FOP@Nی
024540     MOVE 01             TO v|敪.
024550     MOVE Av|{pa TO v|Jna {pabv.
024560     MOVE Av|{pN   TO v|JnN   {pNbv.
024570     MOVE Av|{p   TO v|Jn   {pbv.
024580*
024590     START vZ}X^ KEY IS <= v|敪
024600                                v|JnaN
024610                                REVERSED
024620     END-START.
024630*
024640     IF ԃL[ = "00"
024650         READ vZ}X^ NEXT
024660         AT END
024670*/G[\̏C
024680*             PERFORM R\[G[mF
024690             DISPLAY "{pNɑΉ݂܂"
024700             " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
024701*-----------------------------------------*
024702             CALL "actcshm"  WITH C LINKAGE
024703*-----------------------------------------*
024710             PERFORM I
024720             MOVE ZERO TO PROGRAM-STATUS
024730             EXIT PROGRAM
024740         NOT AT END
024750             IF ( {paNbv >= v`|JnaN ) AND
024760                ( {paNbv <= v`|IaN )
024770                 MOVE v`|Ê{     TO Ê{jv
024780                 MOVE v`|É\Z萔   TO É\Z萔jv
024790                 PERFORM VARYING ʂbms FROM 1 BY 1
024800                         UNTIL ʂbms > É\Z萔jv
024810                     MOVE v`|ʒ(ʂbms) TO ʒjv(ʂbms)
024820                 END-PERFORM
024830                 MOVE v`|       TO jv
024840                 COMPUTE Ԃjv   = jv / 100
024850                 MOVE v`|E TO Ejv
024860                 MOVE v`|     TO jv
024870                 MOVE v`|VlS     TO VlS񐔂jv
024880             ELSE
024890*/G[\̏C
024900*                 PERFORM R\[G[mF
024910                 DISPLAY "{pNɑΉ݂܂"
024920                 " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
024921*-----------------------------------------*
024922                 CALL "actcshm"  WITH C LINKAGE
024923*-----------------------------------------*
024930                 PERFORM I
024940                 MOVE ZERO TO PROGRAM-STATUS
024950                 EXIT PROGRAM
024960             END-IF
024970         END-READ
024980     END-IF.
024990*
025000     PERFORM 敪擾.
025010*
025020*================================================================*
025030 P×擾 SECTION.
025040*
025050     MOVE 02               TO |敪R[h.
025060     MOVE ʂv       TO |.
025070     MOVE ZERO             TO |.
025080     MOVE ZERO             TO |E敪.
025090     MOVE ZERO             TO |ʒuԍ.
025100     MOVE Av|{pa   TO |Jna {pabv.
025110     MOVE Av|{pN     TO |JnN   {pNbv.
025120     MOVE Av|{p     TO |Jn   {pbv.
025130*
025140     START }X^ KEY IS <= |敪R[h
025150                                |ʃR[h
025160                                |JnaN
025170                                REVERSED
025180     END-START.
025190*
025200     IF ԃL[ = "00"
025210         READ }X^ NEXT
025220         AT END
025230*/G[\̏C
025240*             PERFORM R\[G[mF
025250             DISPLAY "{pNɑΉ݂܂"
025260             " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
025261*-----------------------------------------*
025262             CALL "actcshm"  WITH C LINKAGE
025263*-----------------------------------------*
025270             PERFORM I
025280             MOVE ZERO TO PROGRAM-STATUS
025290             EXIT PROGRAM
025300         NOT AT END
025310             IF ( {paNbv >= a|JnaN ) AND
025320                ( {paNbv <= a|IaN )
025330                 MOVE a|×     TO ×av    
025340                 MOVE a|     TO av    
025350             ELSE
025360*/G[\̏C
025370*                 PERFORM R\[G[mF
025380                 DISPLAY "{pNɑΉ݂܂"
025390                 " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
025400                 PERFORM I
025410                 MOVE ZERO TO PROGRAM-STATUS
025420                 EXIT PROGRAM
025430             END-IF
025440         END-READ
025450     END-IF.
025460*
025470*================================================================*
025480 㪖@ʍڎ擾 SECTION.
025490*
025500     EVALUATE ʃJE^ ALSO ʃJE^Q
025510     WHEN 1 ALSO 1
025520         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Pov
025530*
025540     WHEN 1 ALSO 2
025550     WHEN 2 ALSO 2
025560         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Qov
025570*
025580     WHEN 1 ALSO 3
025590     WHEN 2 ALSO 3
025600         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@RPov
025610     WHEN 3 ALSO 3
025620         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Rov
025630*
025640     WHEN 1 ALSO 4
025650     WHEN 2 ALSO 4
025660         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@SQov
025670     WHEN 3 ALSO 4
025680         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@SPov
025690     WHEN 4 ALSO 4
025700         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Sov
025710*
025720     WHEN 1 ALSO 5
025730     WHEN 2 ALSO 5
025740         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@TRov
025750     WHEN 3 ALSO 5
025760         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@TQov
025770     WHEN 4 ALSO 5
025780         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@TPov
025790     WHEN 5 ALSO 5
025800         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Tov
025810     WHEN OTHER
025820         CONTINUE
025830     END-EVALUATE.
025840*
025850*================================================================*
025860 㪖@ʍڎ擾 SECTION.
025870*
025880     EVALUATE ʃJE^ ALSO ʃJE^Q
025890     WHEN 1 ALSO 1
025900         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Pov
025910*
025920     WHEN 1 ALSO 2
025930     WHEN 2 ALSO 2
025940         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Qov
025950*
025960     WHEN 1 ALSO 3
025970     WHEN 2 ALSO 3
025980         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@RPov
025990     WHEN 3 ALSO 3
026000         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Rov
026010*
026020     WHEN 1 ALSO 4
026030     WHEN 2 ALSO 4
026040         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@SQov
026050     WHEN 3 ALSO 4
026060         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@SPov
026070     WHEN 4 ALSO 4
026080         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Sov
026090*
026100     WHEN 1 ALSO 5
026110     WHEN 2 ALSO 5
026120         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@TRov
026130     WHEN 3 ALSO 5
026140         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@TQov
026150     WHEN 4 ALSO 5
026160         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@TPov
026170     WHEN 5 ALSO 5
026180         MOVE 㪖@POOv(ʃJE^, ʃJE^Q) TO 㪖@Tov
026190     WHEN OTHER
026200         CONTINUE
026210     END-EVALUATE.
026220*
026230*================================================================*
026240 dÑʍڎ擾 SECTION.
026250*
026260     EVALUATE ʃJE^ ALSO ʃJE^Q
026270     WHEN 1 ALSO 1
026280         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×Pov
026290*
026300     WHEN 1 ALSO 2
026310     WHEN 2 ALSO 2
026320         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×Qov
026330*
026340     WHEN 1 ALSO 3
026350     WHEN 2 ALSO 3
026360         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×RPov
026370     WHEN 3 ALSO 3
026380         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×Rov
026390*
026400     WHEN 1 ALSO 4
026410     WHEN 2 ALSO 4
026420         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×SQov
026430     WHEN 3 ALSO 4
026440         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×SPov
026450     WHEN 4 ALSO 4
026460         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×Sov
026470*
026480     WHEN 1 ALSO 5
026490     WHEN 2 ALSO 5
026500         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×TRov
026510     WHEN 3 ALSO 5
026520         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×TQov
026530     WHEN 4 ALSO 5
026540         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×TPov
026550     WHEN 5 ALSO 5
026560         MOVE d×POOv(ʃJE^, ʃJE^Q) TO d×Tov
026570     WHEN OTHER
026580         CONTINUE
026590     END-EVALUATE.
026600*
026610*================================================================*
026620 㪖@ʗ݌v SECTION.
026630*
026640     EVALUATE ʃJE^ ALSO ʃJE^Q
026650     WHEN 1 ALSO 1
026660         COMPUTE 㪖@񐔂Pqv = 㪖@񐔂Pqv + 1
026670         COMPUTE 㪖@Pqv   = 㪖@Pqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026680*
026690     WHEN 1 ALSO 2
026700     WHEN 2 ALSO 2
026710         COMPUTE 㪖@񐔂Qqv = 㪖@񐔂Qqv + 1
026720         COMPUTE 㪖@Qqv   = 㪖@Qqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026730*
026740     WHEN 1 ALSO 3
026750     WHEN 2 ALSO 3
026760         COMPUTE 㪖@񐔂RPqv = 㪖@񐔂RPqv + 1
026770         COMPUTE 㪖@RPqv   = 㪖@RPqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026780     WHEN 3 ALSO 3
026790         COMPUTE 㪖@񐔂Rqv = 㪖@񐔂Rqv + 1
026800         COMPUTE 㪖@Rqv = 㪖@Rqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026810*
026820     WHEN 1 ALSO 4
026830     WHEN 2 ALSO 4
026840         COMPUTE 㪖@񐔂SQqv = 㪖@񐔂SQqv + 1
026850         COMPUTE 㪖@SQqv   = 㪖@SQqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026860     WHEN 3 ALSO 4
026870         COMPUTE 㪖@񐔂SPqv = 㪖@񐔂SPqv + 1
026880         COMPUTE 㪖@SPqv   = 㪖@SPqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026890     WHEN 4 ALSO 4
026900         COMPUTE 㪖@񐔂Sqv = 㪖@񐔂Sqv + 1
026910         COMPUTE 㪖@Sqv   = 㪖@Sqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026920*
026930     WHEN 1 ALSO 5
026940     WHEN 2 ALSO 5
026950         COMPUTE 㪖@񐔂TRqv = 㪖@񐔂TRqv + 1
026960         COMPUTE 㪖@TRqv   = 㪖@TRqv + 㪖@POOv(ʃJE^, ʃJE^Q)
026970     WHEN 3 ALSO 5
026980         COMPUTE 㪖@񐔂TQqv = 㪖@񐔂TQqv + 1
026990         COMPUTE 㪖@TQqv   = 㪖@TQqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027000     WHEN 4 ALSO 5
027010         COMPUTE 㪖@񐔂TPqv = 㪖@񐔂TPqv + 1
027020         COMPUTE 㪖@TPqv   = 㪖@TPqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027030     WHEN 5 ALSO 5
027040         COMPUTE 㪖@񐔂Tqv = 㪖@񐔂Tqv + 1
027050         COMPUTE 㪖@Tqv = 㪖@Tqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027060     WHEN OTHER
027070         CONTINUE
027080     END-EVALUATE.
027090*
027100*================================================================*
027110 㪖@ʗ݌v SECTION.
027120*
027130     EVALUATE ʃJE^ ALSO ʃJE^Q
027140     WHEN 1 ALSO 1
027150         COMPUTE 㪖@񐔂Pqv = 㪖@񐔂Pqv + 1
027160         COMPUTE 㪖@Pqv   = 㪖@Pqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027170*
027180     WHEN 1 ALSO 2
027190     WHEN 2 ALSO 2
027200         COMPUTE 㪖@񐔂Qqv = 㪖@񐔂Qqv + 1
027210         COMPUTE 㪖@Qqv   = 㪖@Qqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027220*
027230     WHEN 1 ALSO 3
027240     WHEN 2 ALSO 3
027250         COMPUTE 㪖@񐔂RPqv = 㪖@񐔂RPqv + 1
027260         COMPUTE 㪖@RPqv   = 㪖@RPqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027270     WHEN 3 ALSO 3
027280         COMPUTE 㪖@񐔂Rqv = 㪖@񐔂Rqv + 1
027290         COMPUTE 㪖@Rqv = 㪖@Rqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027300*
027310     WHEN 1 ALSO 4
027320     WHEN 2 ALSO 4
027330         COMPUTE 㪖@񐔂SQqv = 㪖@񐔂SQqv + 1
027340         COMPUTE 㪖@SQqv   = 㪖@SQqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027350     WHEN 3 ALSO 4
027360         COMPUTE 㪖@񐔂SPqv = 㪖@񐔂SPqv + 1
027370         COMPUTE 㪖@SPqv   = 㪖@SPqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027380     WHEN 4 ALSO 4
027390         COMPUTE 㪖@񐔂Sqv = 㪖@񐔂Sqv + 1
027400         COMPUTE 㪖@Sqv   = 㪖@Sqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027410*
027420     WHEN 1 ALSO 5
027430     WHEN 2 ALSO 5
027440         COMPUTE 㪖@񐔂TRqv = 㪖@񐔂TRqv + 1
027450         COMPUTE 㪖@TRqv   = 㪖@TRqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027460     WHEN 3 ALSO 5
027470         COMPUTE 㪖@񐔂TQqv = 㪖@񐔂TQqv + 1
027480         COMPUTE 㪖@TQqv   = 㪖@TQqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027490     WHEN 4 ALSO 5
027500         COMPUTE 㪖@񐔂TPqv = 㪖@񐔂TPqv + 1
027510         COMPUTE 㪖@TPqv   = 㪖@TPqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027520     WHEN 5 ALSO 5
027530         COMPUTE 㪖@񐔂Tqv = 㪖@񐔂Tqv + 1
027540         COMPUTE 㪖@Tqv = 㪖@Tqv + 㪖@POOv(ʃJE^, ʃJE^Q)
027550     WHEN OTHER
027560         CONTINUE
027570     END-EVALUATE.
027580*
027590*================================================================*
027600 dÑʗ݌v SECTION.
027610*
027620     EVALUATE ʃJE^ ALSO ʃJE^Q
027630     WHEN 1 ALSO 1
027640         COMPUTE dÉ񐔂Pqv = dÉ񐔂Pqv + 1
027650         COMPUTE d×Pqv   = d×Pqv + d×POOv(ʃJE^, ʃJE^Q)
027660*
027670     WHEN 1 ALSO 2
027680     WHEN 2 ALSO 2
027690         COMPUTE dÉ񐔂Qqv = dÉ񐔂Qqv + 1
027700         COMPUTE d×Qqv   = d×Qqv + d×POOv(ʃJE^, ʃJE^Q)
027710*
027720     WHEN 1 ALSO 3
027730     WHEN 2 ALSO 3
027740         COMPUTE dÉ񐔂RPqv = dÉ񐔂RPqv + 1
027750         COMPUTE d×RPqv   = d×RPqv + d×POOv(ʃJE^, ʃJE^Q)
027760     WHEN 3 ALSO 3
027770         COMPUTE dÉ񐔂Rqv = dÉ񐔂Rqv + 1
027780         COMPUTE d×Rqv = d×Rqv + d×POOv(ʃJE^, ʃJE^Q)
027790*
027800     WHEN 1 ALSO 4
027810     WHEN 2 ALSO 4
027820         COMPUTE dÉ񐔂SQqv = dÉ񐔂SQqv + 1
027830         COMPUTE d×SQqv   = d×SQqv + d×POOv(ʃJE^, ʃJE^Q)
027840     WHEN 3 ALSO 4
027850         COMPUTE dÉ񐔂SPqv = dÉ񐔂SPqv + 1
027860         COMPUTE d×SPqv   = d×SPqv + d×POOv(ʃJE^, ʃJE^Q)
027870     WHEN 4 ALSO 4
027880         COMPUTE dÉ񐔂Sqv = dÉ񐔂Sqv + 1
027890         COMPUTE d×Sqv   = d×Sqv + d×POOv(ʃJE^, ʃJE^Q)
027900*
027910     WHEN 1 ALSO 5
027920     WHEN 2 ALSO 5
027930         COMPUTE dÉ񐔂TRqv = dÉ񐔂TRqv + 1
027940         COMPUTE d×TRqv   = d×TRqv + d×POOv(ʃJE^, ʃJE^Q)
027950     WHEN 3 ALSO 5
027960         COMPUTE dÉ񐔂TQqv = dÉ񐔂TQqv + 1
027970         COMPUTE d×TQqv   = d×TQqv + d×POOv(ʃJE^, ʃJE^Q)
027980     WHEN 4 ALSO 5
027990         COMPUTE dÉ񐔂TPqv = dÉ񐔂TPqv + 1
028000         COMPUTE d×TPqv   = d×TPqv + d×POOv(ʃJE^, ʃJE^Q)
028010     WHEN 5 ALSO 5
028020         COMPUTE dÉ񐔂Tqv = dÉ񐔂Tqv + 1
028030         COMPUTE d×Tqv = d×Tqv + d×POOv(ʃJE^, ʃJE^Q)
028040     WHEN OTHER
028050         CONTINUE
028060     END-EVALUATE.
028070*
028080*================================================================*
028090 ݌v SECTION.
028100*
028110     COMPUTE fv         = fv     + v.
028120     COMPUTE Zfv     = Zfv + Zv.
028130     COMPUTE Čfv         = Čfv     + Čv.
028140     COMPUTE ×fv         = ×fv     + ×v.
028150     COMPUTE ÉZfv     = ÉZfv + ÉZv.
028160     COMPUTE kfv   = kfv + kv.
028170*
028180     COMPUTE qfv     = qfv + qv.
028190     COMPUTE 񏈒ufv     = 񏈒ufv + 񏈒uv.
028200     COMPUTE {p񋟗fv = {p񋟗fv + {p񋟗v.
028210*
028220*================================================================*
028230 JnI擾 SECTION.
028240*
028250     MOVE Av|{pa TO |{pa.
028260     MOVE Av|{pN   TO |{pN.
028270     MOVE Av|{p   TO |{p.
028280     MOVE Av|Ҕԍ TO |Ҕԍ.
028290     MOVE Av|}     TO |}.
028300     READ f[^e
028310     INVALID KEY
028320*/G[\̏C
028330*         PERFORM R\[G[mF
028340         DISPLAY "w̎M҂̕f[^܂"
028350         " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
028351*-----------------------------------------*
028352         CALL "actcshm"  WITH C LINKAGE
028353*-----------------------------------------*
028360         PERFORM t@C
028370         MOVE ZERO TO PROGRAM-STATUS
028380         EXIT PROGRAM
028390     NOT INVALID KEY
028400*         MOVE |]A敪(ʃJE^Q)       TO ]A敪v
028410         MOVE |JnaN(ʃJE^Q) TO JnaNv
028420         IF ( |Ia(ʃJE^Q) = ZERO ) OR
028430            ( |IN(ʃJE^Q)   = ZERO ) OR
028440            ( |I(ʃJE^Q)   = ZERO ) OR
028450            ( |I(ʃJE^Q)   = ZERO )
028460             MOVE "9999999" TO IaNv
028470         ELSE
028480             MOVE |IaN(ʃJE^Q) TO IaNv
028490         END-IF
028500     END-READ.
028510*
028520*================================================================*
028530 Ñʗ݌v SECTION.
028540*
028550* POŐz𕔈ʖ݌vB
028560* ́Aʖ̍vzɑ΂A悶B
028570*
028580     EVALUATE ʃJE^ ALSO ʃJE^Q
028590     WHEN 1 ALSO 1
028600         COMPUTE É񐔂Pqv = É񐔂Pqv + 1
028610         COMPUTE ×Pqv   = ×Pqv + ×POOv(ʃJE^, ʃJE^Q)
028620*
028630     WHEN 1 ALSO 2
028640     WHEN 2 ALSO 2
028650         COMPUTE É񐔂Qqv = É񐔂Qqv + 1
028660         COMPUTE ×Qqv   = ×Qqv + ×POOv(ʃJE^, ʃJE^Q)
028670*
028680     WHEN 1 ALSO 3
028690     WHEN 2 ALSO 3
028700         IF É񐔂RPqv = ZERO
028710             MOVE ޔ{L|{pa TO JnaRPqv
028720             MOVE ޔ{L|{pN   TO JnNRPqv
028730             MOVE ޔ{L|{p   TO JnRPqv
028740             MOVE ޔ{L|{p   TO JnRPqv
028750         END-IF
028760         COMPUTE É񐔂RPqv = É񐔂RPqv + 1
028770         COMPUTE ×RPqv   = ×RPqv + ×POOv(ʃJE^, ʃJE^Q)
028780     WHEN 3 ALSO 3
028790         COMPUTE É񐔂Rqv = É񐔂Rqv + 1
028800         COMPUTE ×Rqv = ×Rqv + ×POOv(ʃJE^, ʃJE^Q)
028810*
028820     WHEN 1 ALSO 4
028830     WHEN 2 ALSO 4
028840         IF É񐔂SQqv = ZERO
028850             MOVE ޔ{L|{pa TO JnaSQqv
028860             MOVE ޔ{L|{pN   TO JnNSQqv
028870             MOVE ޔ{L|{p   TO JnSQqv
028880             MOVE ޔ{L|{p   TO JnSQqv
028890         END-IF
028900         COMPUTE É񐔂SQqv = É񐔂SQqv + 1
028910         COMPUTE ×SQqv   = ×SQqv + ×POOv(ʃJE^, ʃJE^Q)
028920     WHEN 3 ALSO 4
028930         IF É񐔂SPqv = ZERO
028940             MOVE ޔ{L|{pa TO JnaSPqv
028950             MOVE ޔ{L|{pN   TO JnNSPqv
028960             MOVE ޔ{L|{p   TO JnSPqv
028970             MOVE ޔ{L|{p   TO JnSPqv
028980         END-IF
028990         COMPUTE É񐔂SPqv = É񐔂SPqv + 1
029000         COMPUTE ×SPqv   = ×SPqv + ×POOv(ʃJE^, ʃJE^Q)
029010     WHEN 4 ALSO 4
029020         COMPUTE É񐔂Sqv = É񐔂Sqv + 1
029030         COMPUTE ×Sqv   = ×Sqv + ×POOv(ʃJE^, ʃJE^Q)
029040*
029050     WHEN 1 ALSO 5
029060     WHEN 2 ALSO 5
029070         IF É񐔂TRqv = ZERO
029080             MOVE ޔ{L|{pa TO JnaTRqv
029090             MOVE ޔ{L|{pN   TO JnNTRqv
029100             MOVE ޔ{L|{p   TO JnTRqv
029110             MOVE ޔ{L|{p   TO JnTRqv
029120         END-IF
029130         COMPUTE É񐔂TRqv = É񐔂TRqv + 1
029140         COMPUTE ×TRqv   = ×TRqv + ×POOv(ʃJE^, ʃJE^Q)
029150     WHEN 3 ALSO 5
029160         IF É񐔂TQqv = ZERO
029170             MOVE ޔ{L|{pa TO JnaTQqv
029180             MOVE ޔ{L|{pN   TO JnNTQqv
029190             MOVE ޔ{L|{p   TO JnTQqv
029200             MOVE ޔ{L|{p   TO JnTQqv
029210         END-IF
029220         COMPUTE É񐔂TQqv = É񐔂TQqv + 1
029230         COMPUTE ×TQqv   = ×TQqv + ×POOv(ʃJE^, ʃJE^Q)
029240     WHEN 4 ALSO 5
029250         IF É񐔂TPqv = ZERO
029260             MOVE ޔ{L|{pa TO JnaTPqv
029270             MOVE ޔ{L|{pN   TO JnNTPqv
029280             MOVE ޔ{L|{p   TO JnTPqv
029290             MOVE ޔ{L|{p   TO JnTPqv
029300         END-IF
029310         COMPUTE É񐔂TPqv = É񐔂TPqv + 1
029320         COMPUTE ×TPqv   = ×TPqv + ×POOv(ʃJE^, ʃJE^Q)
029330     WHEN 5 ALSO 5
029340         COMPUTE É񐔂Tqv = É񐔂Tqv + 1
029350         COMPUTE ×Tqv = ×Tqv + ×POOv(ʃJE^, ʃJE^Q)
029360     WHEN OTHER
029370         CONTINUE
029380     END-EVALUATE.
029390*
029400*================================================================*
029410 Ñʍڎ擾 SECTION.
029420*
029430* POŐz𕔈ʖ݌vB
029440* ́Aʖ̍vzɑ΂A悶B
029450*
029460     EVALUATE ʃJE^ ALSO ʃJE^Q
029470     WHEN 1 ALSO 1
029480         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×Pov
029490*
029500     WHEN 1 ALSO 2
029510     WHEN 2 ALSO 2
029520         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×Qov
029530*
029540     WHEN 1 ALSO 3
029550     WHEN 2 ALSO 3
029560         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×RPov
029570     WHEN 3 ALSO 3
029580         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×Rov
029590*
029600     WHEN 1 ALSO 4
029610     WHEN 2 ALSO 4
029620         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×SQov
029630     WHEN 3 ALSO 4
029640         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×SPov
029650     WHEN 4 ALSO 4
029660         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×Sov
029670*
029680     WHEN 1 ALSO 5
029690     WHEN 2 ALSO 5
029700         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×TRov
029710     WHEN 3 ALSO 5
029720         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×TQov
029730     WHEN 4 ALSO 5
029740         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×TPov
029750     WHEN 5 ALSO 5
029760         MOVE ×POOv(ʃJE^, ʃJE^Q) TO ×Tov
029770     WHEN OTHER
029780         CONTINUE
029790     END-EVALUATE.
029800*
029810*================================================================*
029820 敪擾 SECTION.
029830*
029840* EČ𐿋邩̃tO擾
029850     MOVE Av|{pa TO |{pa. 
029860     MOVE Av|{pN   TO |{pN.   
029870     MOVE Av|{p   TO |{p.   
029880     MOVE Av|Ҕԍ TO |Ҕԍ. 
029890     MOVE Av|}     TO |}.     
029900     READ f[^e
029910     INVALID KEY
029920         DISPLAY NC"Y̏񂪂܂" UPON CONS
029930         DISPLAY NC"{pa" Av|{pa  UPON CONS
029940         DISPLAY NC"{pN"   Av|{pN    UPON CONS 
029950         DISPLAY NC"{p"   Av|{p    UPON CONS 
029960         DISPLAY NC"Ҕԍ" Av|Ҕԍ  UPON CONS
029970         DISPLAY NC"}"     Av|}      UPON CONS 
029980         MOVE NC"" TO t@C
029990         PERFORM G[\q
030000     NOT INVALID KEY
030010         MOVE |敪 TO 敪v
030020     END-READ.
030030*
030040*================================================================*
030050 ̑Z SECTION.
030060****************************************************************
030070* qE񏈒uE񋟗
030080* 񏈒uɂẮAUʖڈȍ~Z肠B
030090****************************************************************
030100*
030110     MOVE ZERO TO qv.
030120     MOVE ZERO TO 񏈒uv.
030130     MOVE ZERO TO {p񋟗v.
030140*
030150* p̕ʂ̂ݎZ肷
030160* p̕ʂ̂ݕʃJE^JEgto
030170* 񏈒û݌É\Z萔ȏɎZ\
030180     MOVE 1 TO ʃJE^
030190     PERFORM VARYING ʃJE^Q FROM 1 BY 1
030200             UNTIL ( ʃJE^Q > ʐv ) OR
030210                   ( ʃJE^ > pʐv )
030220*
030230* |IaN͂̏ꍇ́AALL 9 Zbg
030240         PERFORM JnI擾
030250*
030260         IF ( JnaNv <= ޔ{L|{paN ) AND
030270            ( IaNv >= ޔ{L|{paN )
030280*
030290             MOVE ޔ{L|(ʃJE^Q)     TO ʂv
030300             MOVE ޔ{L|(ʃJE^Q)         TO ʂv
030310             MOVE ޔ{L|E敪(ʃJE^Q)     TO E敪v
030320             MOVE ޔ{L|ʒuԍ(ʃJE^Q) TO ʒuԍv
030330             IF ʂv = 01 OR 02 OR 03
030340                 PERFORM P擾
030350*             ELSE
030360*                 PERFORM ʗ擾
030370             END-IF
030380*
030390* 񏈒u
030400*
030410             IF ޔ{L|{Ë敪(ʃJE^Q) = 1
030420                 COMPUTE 񏈒uv = 񏈒uv + av
030430                 COMPUTE 񏈒unv(ʃJE^Q) = 񏈒unv(ʃJE^Q) + av
030440             END-IF
030450*
030460             IF ʃJE^ <= É\Z萔jv
030470* qiEPE܁EsS܁j
030480                 EVALUATE ޔ{L|q敪(ʃJE^Q)
030490                 WHEN 1
030500*/dlύXBq͓ނ𕡐BIFRgɁB0307
030510                     IF ( ޔ{L|(ʃJE^Q) = 04 OR 05 OR 06 ) AND
030520                        ( Av|{paN = JnaNv   )
030530                         MOVE 1 TO qv
030540                         COMPUTE qv = qv + `v
030550                     END-IF
030560                 WHEN 2
030570*/dlύXBq͓ނ𕡐BIFRgɁB0307
030580*                     IF qv = ZERO
030590                         IF ( ޔ{L|(ʃJE^Q) = 04 OR 05 OR 06 ) AND
030600                            ( Av|{paN = JnaNv   )
030610                             MOVE 1 TO qv
030620                             COMPUTE qv = qv + `v
030630                         END-IF
030640*                     END-IF
030650                 WHEN 3
030660*/dlύXBq͓ނ𕡐BIFRgɁB0307
030670*                     IF qv = ZERO
030680                         IF ( ޔ{L|(ʃJE^Q) = 04 OR 05 OR 06 ) AND
030690                            ( Av|{paN = JnaNv   )
030700                             MOVE 1 TO qv
030710                             COMPUTE qv = qv + `v
030720                         END-IF
030730*                     END-IF
030740                 WHEN OTHER
030750                     CONTINUE
030760                 END-EVALUATE
030770* {p񋟗
030780* ܁EsS܁EEP̏ꍇ̂
030790                 IF ( ޔ{L|񋟋敪(ʃJE^Q) = 1 ) AND
030800                    ( ޔ{L|(ʃJE^Q) = 04 OR 05 OR 06 ) AND
030810                    ( JnaNv = ޔ{L|{paN )
030820                     COMPUTE {p񋟗v = {p񋟗v + {p񋟗`v
030830                 END-IF
030840             END-IF
030850             COMPUTE ʃJE^ = ʃJE^ + 1
030860*
030870         END-IF
030880     END-PERFORM.
030890*
030900*================================================================*
030910 P擾 SECTION.
030920*
030930     MOVE 02               TO |敪R[h.
030940     MOVE ʂv       TO |.
030950     MOVE ZERO             TO |.
030960     MOVE ZERO             TO |E敪.
030970     MOVE ZERO             TO |ʒuԍ.
030980     MOVE Av|{pa   TO |Jna {pabv.
030990     MOVE Av|{pN     TO |JnN   {pNbv.
031000     MOVE Av|{p     TO |Jn   {pbv.
031010*
031020     START }X^ KEY IS <= |敪R[h
031030                                |ʃR[h
031040                                |JnaN
031050                                REVERSED
031060     END-START.
031070*
031080     IF ԃL[ = "00"
031090         READ }X^ NEXT
031100         AT END
031110*/G[\̏C
031120*             PERFORM R\[G[mF
031130             DISPLAY "{pNɑΉ݂܂"
031140             " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
031141*-----------------------------------------*
031142             CALL "actcshm"  WITH C LINKAGE
031143*-----------------------------------------*
031150             PERFORM I
031160             MOVE ZERO TO PROGRAM-STATUS
031170             EXIT PROGRAM
031180         NOT AT END
031190             IF ( {paNbv >= a|JnaN ) AND
031200                ( {paNbv <= a|IaN )
031210                 MOVE a|     TO av    
031220             ELSE
031230*/G[\̏C
031240*                 PERFORM R\[G[mF
031250                 DISPLAY "{pNɑΉ݂܂"
031260                 " f҇=" Av|҃R[h " {pN=" Av|{pN Av|{p UPON CONS
031261*-----------------------------------------*
031262                 CALL "actcshm"  WITH C LINKAGE
031263*-----------------------------------------*
031270                 PERFORM I
031280                 MOVE ZERO TO PROGRAM-STATUS
031290                 EXIT PROGRAM
031300             END-IF
031310         END-READ
031320     END-IF.
031330*================================================================*
031340 pzvZ SECTION.
031350*
031360*/RESEPTD`pzvZ܂łg
031370*/(RESEPTD͔pzvZPGU蕪邾Ȃ̂ŎpzvẐ)
031380*/
031390     PERFORM ݌vڏ.
031400     PERFORM {擾.
031410     PERFORM vZ擾.
031420*/又
031430     MOVE Av|{pa TO ޔ{L|{pa {pabv.
031440     MOVE Av|{pN   TO ޔ{L|{pN   {pNbv.
031450     MOVE Av|{p   TO ޔ{L|{p   {pbv.
031460     MOVE Av|{p   TO ޔ{L|{p   {pbv.
031470     MOVE Av|Ҕԍ TO ޔ{L|Ҕԍ ҃R[hbv.
031480     MOVE Av|}     TO ޔ{L|}     }Ԃbv.
031490*
031500*/ޔ[NŔ肷邽߁A[hȂB
031510     PERFORM vڏ.
031520*
031530     PERFORM Z.
031540     PERFORM ČZ.
031550*     PERFORM ×Z.
031560     PERFORM ×Z.
031570     PERFORM ̑Z.
031580     PERFORM ݌v.
031590*
031600*
031610*****************************************************************
031620* ʊ֘Aڂ̕ʖPOO̍vA悶
031630* z𕔈ʖɎZoB
031640*****************************************************************
031650*
031660     PERFORM ʍv.
031670*
031680* eʖ́iPOŐzɁjiʁEj
031690* 悯zƕʈȊOڂZB
031700*
031710     COMPUTE Av|pz = ʍvvP + ʍvvQ +
031720                            ʍvvR + ʍvvRP +
031730                            ʍvvS + ʍvvSP +
031740                            ʍvvSQ + ʍvvT + 
031750                            ʍvvTP + ʍvvTQ + 
031760                            ʍvvTR + fv + Zfv +
031770                            Čfv + ×fv + ÉZfv +
031780                            qfv + 񏈒ufv + {p񋟗fv +
031790                            kfv.
031800     MOVE Av|pz TO A|pz
031810*
031820*           PERFORM AڃZbg.
031830*
031840*/PQNUTʖڂ̌×͎Z肵Ȃ
031850*/Tʖڂ̑ʒŔ肷
031860     IF ʒjv(5) = ZERO
031870         MOVE ZERO TO A|ʂTQ
031880         INITIALIZE   A|ʂTQ
031890     END-IF.
031900*================================================================*
031910******************************************************************
031920 END PROGRAM KARIKEI.
031930******************************************************************
