000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YAI721.
000060 AUTHOR.                 rc@Kq
000070*
000080*----------------------------------------------------------------*
000090*         {p̎yް쐬z_+޳ޔ
000100*         MED = YAI720
000110*----------------------------------------------------------------*
000120 DATE-WRITTEN.           2013-07-02
000130 DATE-COMPILED.          2013-07-02
000140*----------------------------------------------------------------*
000150******************************************************************
000160*            ENVIRONMENT         DIVISION                        *
000170******************************************************************
000180 ENVIRONMENT             DIVISION.
000190 CONFIGURATION           SECTION.
000200 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000210 OBJECT-COMPUTER.        FMV-DESKPOWER.
000220 SPECIAL-NAMES.          CONSOLE  IS  CONS
000230                         SYSERR   IS  MSGBOX.
000240 INPUT-OUTPUT            SECTION.
000250 FILE-CONTROL.
000370     SELECT  }X^      ASSIGN      TO        GENGOUL
000380                             ORGANIZATION             IS  INDEXED
000390                             ACCESS MODE              IS  DYNAMIC
000400                             RECORD KEY               IS  |敪
000410                             FILE STATUS              IS  ԃL[
000420                             LOCK        MODE         IS  AUTOMATIC.
000260     SELECT  fҏe    ASSIGN      TO        JUSINJL
000270                             ORGANIZATION             IS  INDEXED
000280                             ACCESS MODE              IS  DYNAMIC
000290                             RECORD KEY               IS  |{paN
000300                                                          |҃R[h
000310                             ALTERNATE RECORD KEY     IS  |{paN
000320                                                          |҃Ji
000330                                                          |҃R[h
000340                             ALTERNATE RECORD KEY     IS  |҃R[h
000350                                                          |{paN
000360                             ALTERNATE RECORD KEY     IS  |{paN
000370                                                          |ی
000380                                                          |یҔԍ
000390                                                          |҃R[h
000400                             ALTERNATE RECORD KEY     IS  |{paN
000410                                                          |
000420                                                          |pSҔԍ
000430                                                          |҃R[h
000440                             ALTERNATE RECORD KEY     IS  |{paN
000450                                                          |
000460                                                          |pSҔԍ
000470                                                          |҃R[h
000480                             ALTERNATE RECORD KEY     IS  |aN
000490                                                          |{paN
000500                                                          |҃R[h
000510                             FILE STATUS              IS  ԃL[
000520                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  Zvge      ASSIGN      TO        RECEPTL
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  Z|{paN
000170                                                          Z|҃R[h
000180                                                          Z|Z
000190                             ALTERNATE RECORD KEY     IS  Z|҃R[h
000200                                                          Z|{paN
000210                                                          Z|Z
000220                             ALTERNATE RECORD KEY     IS  Z|aN
000230                                                          Z|{paN
000240                                                          Z|҃R[h
000250                                                          Z|Z
000260                             ALTERNATE RECORD KEY     IS  Z|aN
000270                                                          Z|Z
000280                                                          Z|یҔԍ
000290                                                          Z|҃R[h
000300                                                          Z|{paN
000310                             ALTERNATE RECORD KEY     IS  Z|aN
000320                                                          Z|یҔԍ
000330                                                          Z|҃R[h
000340                                                          Z|Z
000350                                                          Z|{paN
000360                             FILE STATUS              IS  ԃL[
000370                             LOCK        MODE         IS  AUTOMATIC.
000690     SELECT  vf[^e    ASSIGN      TO        KAIKEIL
000700                             ORGANIZATION             IS  INDEXED
000710                             ACCESS MODE              IS  DYNAMIC
000089                             RECORD KEY               IS  |{paN
000090                                                          |҃R[h
000092                             ALTERNATE RECORD KEY     IS  |҃R[h
000093                                                          |{paN
000790                             FILE STATUS              IS  ԃL[
000800                             LOCK        MODE         IS  AUTOMATIC.
           SELECT  f[^e    ASSIGN      TO        HUSYOUL
                                   ORGANIZATION             IS  INDEXED
                                   ACCESS MODE              IS  DYNAMIC
                                   RECORD KEY               IS  |{paN
                                                                |҃R[h
                                   ALTERNATE RECORD KEY     IS  |҃R[h
                                                                |{paN
                                   FILE STATUS              IS  ԃL[
                                   LOCK        MODE         IS  AUTOMATIC.
           SELECT  {pL^e      ASSIGN      TO      SEKIROKL
                                   ORGANIZATION        IS  INDEXED
                                   ACCESS MODE         IS  DYNAMIC
                                   RECORD KEY          IS  {L|{paN
                                                           {L|҃R[h
                                   ALTERNATE RECORD KEY IS {L|҃R[h
                                                           {L|{paN
                                   FILE STATUS              IS  ԃL[
                                   LOCK        MODE         IS  AUTOMATIC.
000530     SELECT  ƃt@CP  ASSIGN      TO "C:\MAKISHISYS\YAWOBJ\TEMP\W7211L.DAT"
000540                             ORGANIZATION             IS  INDEXED
000550                             ACCESS                   IS  DYNAMIC
000560                             RECORD      KEY          IS  P|{paN
000610                                                          P|҃R[h
000910                             ALTERNATE RECORD KEY     IS  P|{paN
                                                                P|҃Ji
                                                                P|҃R[h
000910                             ALTERNATE RECORD KEY     IS  P|҃R[h
                                                                P|{paN
000910                             ALTERNATE RECORD KEY     IS  P|҃Ji
                                                                P|҃R[h
                                                                P|{paN
000620                             FILE        STATUS       IS  ԃL[
000630                             LOCK        MODE         IS  AUTOMATIC.
000530     SELECT  ƃt@CQ  ASSIGN      TO "C:\MAKISHISYS\YAWOBJ\TEMP\W7212L.DAT"
000540                             ORGANIZATION             IS  INDEXED
000550                             ACCESS                   IS  DYNAMIC
000560                             RECORD      KEY          IS  Q|{paN
000610                                                          Q|҃R[h
000620                             FILE        STATUS       IS  ԃL[
000630                             LOCK        MODE         IS  AUTOMATIC.
000640******************************************************************
000650*                      DATA DIVISION                             *
000660******************************************************************
000670 DATA                    DIVISION.
000680 FILE                    SECTION.
001500*                           mqk  PQWn
001510 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001520     COPY GENGOU          OF  XFDLIB  JOINING      AS  PREFIX.
000690*                           mqk  RQOn
000700 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
000710     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
      *                          mqk  PTRUn
       FD  Zvge          BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   Z  AS  PREFIX.
001060*                           mqk  TPQn
001070 FD  vf[^e        BLOCK   CONTAINS   1   RECORDS.
001080     COPY KAIKEI     OF  XFDLIB  JOINING      AS  PREFIX.
      *                           mqk  QTUn
       FD  {pL^e          BLOCK   CONTAINS   1   RECORDS.
          COPY SEKIROK         OF  XFDLIB  JOINING   {L AS  PREFIX.
      *                           mqk  PQWn
       FD  f[^e        BLOCK   CONTAINS   1   RECORDS.
           COPY HUSYOU          OF  XFDLIB  JOINING      AS  PREFIX.
001310*****************
001320* ƃt@CP *
001330*****************
001340*                         mqk  PUOn
001350 FD  ƃt@CP RECORD  CONTAINS 160 CHARACTERS.
001360 01 P|R[h.
001370    03 P|R[hL[.
001535       05 P|{paN.
001536          07 P|{pa               PIC 9.
001537          07 P|{pN.
001538             09 P|{pN              PIC 9(2).
001539             09 P|{p              PIC 9(2).
001540          07 P|{p                 PIC 9(2).
001460       05 P|҃R[h.
001470          07 P|Ҕԍ                PIC 9(6).
001480          07 P|}                    PIC X(1).
001490    03 P|R[hf[^.
             05 P|҃Ji                   PIC X(50).
             05 P|Ҏ                   PIC X(50).
             05 P|.
001550          07 P|z                PIC 9(5).
                07 P|Zz                PIC 9(5).
001550          07 P|z                PIC 9(5).
001550          07 P|Ëz                PIC 9(5).
001550          07 P|㪖@z                PIC 9(5).
001550          07 P|dËz                PIC 9(5).
001551          07 P|pz                  PIC 9(5).
001551          07 P|ꕔS              PIC 9(5).
001500       05 FILLER                           PIC X(6).
000920*
001340*                         mqk  PQWn
001350 FD  ƃt@CQ RECORD  CONTAINS 128 CHARACTERS.
001360 01 Q|R[h.
001370    03 Q|R[hL[.
001535       05 Q|{paN.
001536          07 Q|{pa                PIC 9.
001537          07 Q|{pN.
001538             09 Q|{pN               PIC 9(2).
001539             09 Q|{p               PIC 9(2).
001460       05 Q|҃R[h.
001470          07 Q|Ҕԍ                PIC 9(6).
001480          07 Q|}                    PIC X(1).
001490    03 Q|R[hf[^.
             05 Q|v                     PIC 9(5).
001550       05 Q|Zv                     PIC 9(5).
001550       05 Q|v                     PIC 9(5).
001550       05 Q|Ìv                     PIC 9(5).
001550       05 Q|㪖@v                     PIC 9(5).
001550       05 Q|dÌv                     PIC 9(5).
001551       05 Q|pv                     PIC 9(6).
001551       05 Q|Sv                     PIC 9(5).
             05 Q|v.
001551          07 Q|v              PIC 9(2).
001551          07 Q|pv                PIC 9(7).
001551          07 Q|Sv                PIC 9(6).
001551          07 Q|v                PIC 9(7).
001500       05 FILLER                           PIC X(53).
      *
000930*----------------------------------------------------------------*
000940******************************************************************
000950*                WORKING-STORAGE SECTION                         *
000960******************************************************************
000970 WORKING-STORAGE         SECTION.
000980 01 L[                           PIC X    VALUE SPACE.
000990 01 ԃL[                           PIC X(2) VALUE SPACE.
001000 01 ItO                         PIC X(3) VALUE SPACE.
002120 01 ItOQ                       PIC X(3) VALUE SPACE.
002120 01 ItOR                       PIC X(3) VALUE SPACE.
001010 01 t@C                         PIC N(2) VALUE SPACE.
001180 01 sL[v                         PIC X(4) VALUE SPACE.
       01 {pL^Lv                       PIC X(3) VALUE SPACE.
001540 01 ptO                         PIC X(3) VALUE SPACE.
001540 01 ΏۃtO                         PIC X(3) VALUE SPACE.
001891 01 ʂbms                         PIC 9    VALUE ZERO.
001891 01 JE^                           PIC 9    VALUE ZERO.
001020* **************
001030* * ڑҔp 
001040* **************
001050 01 Ҕڂvq.
001060    03 {paNvq.
001070       05 {pavq                 PIC 9(1) VALUE ZERO.
001080       05 {pNvq                   PIC 9(2) VALUE ZERO.
001090       05 {pvq                   PIC 9(2) VALUE ZERO.
001090    03 {pvq                      PIC 9(2) VALUE ZERO.
          03 ŏIʉ@v                    PIC 9(2) VALUE ZERO.
001090    03 ŏIʉ@v                    PIC 9(2) VALUE ZERO.
          03 󗝌v                        PIC 9(2) VALUE ZERO.
001090    03 󗝓v                        PIC 9(2) VALUE ZERO.
001090    03 Jnvo                      PIC 9(2) VALUE ZERO.
001090    03 Ivo                      PIC 9(2) VALUE ZERO.
001060    03 JnaNvq.
001060       05 JnaNvq.
001070          07 Jnavq              PIC 9(1) VALUE ZERO.
001080          07 JnNvq                PIC 9(2) VALUE ZERO.
001090          07 Jnvq                PIC 9(2) VALUE ZERO.
001090       05 Jnvq                   PIC 9(2) VALUE ZERO.
001060    03 IaNvq.
001060       05 IaNvq.
001070          07 Iavq              PIC 9(1) VALUE ZERO.
001080          07 INvq                PIC 9(2) VALUE ZERO.
001090          07 Ivq                PIC 9(2) VALUE ZERO.
001090       05 Ivq                   PIC 9(2) VALUE ZERO.
001100    03 ʋ敪vq                    PIC X(4) VALUE SPACE.
001110    03 یʂvq                    PIC 9(2) VALUE ZERO.
001120    03 ҃R[hvq.
001130       05 Ҕԍvq                 PIC 9(6) VALUE ZERO.
001140       05 }Ԃvq                     PIC X(1) VALUE SPACE.
001150    03 {lƑ敪vq                PIC 9(1) VALUE ZERO.
      *
          03 vq                    PIC 9(2) VALUE ZERO.
001160*
001170 01 SҔԍv.
001180    03 @ʔԍv                      PIC X(2) VALUE SPACE.
001190    03 FILLER                          PIC X(8) VALUE SPACE.
001530 01 ޔڂfv.
001540   03 Zvgނv                 PIC X(4).
001550   03 Zvgނfv               PIC X(4).
001560   03 Zvgʂfv               PIC 9(2).
001580*
001590 01 .
001600    03 vq                    PIC 9(4)  VALUE ZERO.
001610    03 Zvq                PIC 9(4)  VALUE ZERO.
001620    03 xvq                      PIC 9     VALUE ZERO.
001630    03 [vq                      PIC 9     VALUE ZERO.
001640    03 ԊOvq                    PIC 9     VALUE ZERO.
001650    03 fÎvq                    PIC 9(2)  VALUE ZERO.
001660    03 fÕvq                    PIC 9(2)  VALUE ZERO.
          03 kvq                    PIC 9(4)  VALUE ZERO.
001670    03 Čvq                    PIC 9(4)  VALUE ZERO.
001680    03 ÖԂvq                  PIC 9     VALUE ZERO.
001690    03 ÓHvq                  PIC 9     VALUE ZERO.
001700    03 Ö\vq                  PIC 9     VALUE ZERO.
001710    03 É񐔂vq                  PIC 9(2)  VALUE ZERO.
001720    03 Ëvq                  PIC 9(3)V9 VALUE ZERO.
001730    03 ×vq                    PIC 9(6)  VALUE ZERO.
001740    03 ÉZvq                PIC 9(5)  VALUE ZERO.
001750    03 d㪗vq                    PIC 9(4)  VALUE ZERO.
001760    03 ꕔSvq                PIC 9(5)  VALUE ZERO.
001760    03 Sڍׂvq                PIC 9(5)  VALUE ZERO.
003530    03 qZvq            PIC 9(5)  VALUE ZERO.
003140    03 ^×vq                PIC 9(4)  VALUE ZERO.
001770    03 {p񋟗vq            PIC 9(6)  VALUE ZERO.
001780    03 ʂv                        OCCURS 5.
001790       05 񏈒uvq             PIC 9(4)  VALUE ZERO.
001800       05 ×vq                 PIC 9(4)  VALUE ZERO.
001810       05 㪗vq                 PIC 9(4)  VALUE ZERO.
001820       05 㪗vq                 PIC 9(4)  VALUE ZERO.
001830       05 d×vq                 PIC 9(4)  VALUE ZERO.
001840       05 ʌvvq                 PIC 9(4)  VALUE ZERO.
001850       05 vq                   PIC 9     VALUE ZERO.
001860    03 vq                      PIC 9(2)  OCCURS 5 VALUE ZERO.
001870    03 㪖@ROvq              PIC 9(4)  VALUE ZERO.
001880    03 㪖@RWvq              PIC 9(4)  VALUE ZERO.
001890    03 㪖@SOvq              PIC 9(4)  VALUE ZERO.
001900    03 㪖@STvq              PIC 9(4)  VALUE ZERO.
001910    03 㪖@SWvq              PIC 9(4)  VALUE ZERO.
001890    03 㪖@TOvq              PIC 9(4)  VALUE ZERO.
001900    03 㪖@TQvq              PIC 9(4)  VALUE ZERO.
001900    03 㪖@TTvq              PIC 9(4)  VALUE ZERO.
001910    03 㪖@TWvq              PIC 9(4)  VALUE ZERO.
001920    03 㪖@ROvq              PIC 9(4)  VALUE ZERO.
001930    03 㪖@RWvq              PIC 9(4)  VALUE ZERO.
001940    03 㪖@SOvq              PIC 9(4)  VALUE ZERO.
001950    03 㪖@STvq              PIC 9(4)  VALUE ZERO.
001960    03 㪖@SWvq              PIC 9(4)  VALUE ZERO.
001940    03 㪖@TOvq              PIC 9(4)  VALUE ZERO.
001950    03 㪖@TQvq              PIC 9(4)  VALUE ZERO.
001950    03 㪖@TTvq              PIC 9(4)  VALUE ZERO.
001960    03 㪖@TWvq              PIC 9(4)  VALUE ZERO.
001970    03 d×ROvq                PIC 9(4)  VALUE ZERO.
001980    03 d×RWvq                PIC 9(4)  VALUE ZERO.
001990    03 d×SOvq                PIC 9(4)  VALUE ZERO.
002000    03 d×STvq                PIC 9(4)  VALUE ZERO.
002010    03 d×SWvq                PIC 9(4)  VALUE ZERO.
001990    03 d×TOvq                PIC 9(4)  VALUE ZERO.
002000    03 d×TQvq                PIC 9(4)  VALUE ZERO.
002000    03 d×TTvq                PIC 9(4)  VALUE ZERO.
002010    03 d×TWvq                PIC 9(4)  VALUE ZERO.
002020    03 ×ROvq                PIC 9(4)  VALUE ZERO.
002030    03 ×RWvq                PIC 9(4)  VALUE ZERO.
002040    03 ×SOvq                PIC 9(4)  VALUE ZERO.
002050    03 ×STvq                PIC 9(4)  VALUE ZERO.
002060    03 ×SWvq                PIC 9(4)  VALUE ZERO.
002040    03 ×TOvq                PIC 9(4)  VALUE ZERO.
002050    03 ×TQvq                PIC 9(4)  VALUE ZERO.
002050    03 ×TTvq                PIC 9(4)  VALUE ZERO.
002060    03 ×TWvq                PIC 9(4)  VALUE ZERO.
002070    03 㪗vvq                  PIC 9(4)  VALUE ZERO.
002080    03 㪗vvq                  PIC 9(4)  VALUE ZERO.
002090    03 d×vvq                  PIC 9(4)  VALUE ZERO.
002100*
       01 Wvv.
001600    03 vv                      PIC 9(5)  VALUE ZERO.
001830    03 Zvv                      PIC 9(5)  VALUE ZERO.
001600    03 vv                      PIC 9(5)  VALUE ZERO.
001800    03 Ìvv                      PIC 9(5)  VALUE ZERO.
001810    03 㪖@vv                      PIC 9(5)  VALUE ZERO.
001830    03 dÌvv                      PIC 9(5)  VALUE ZERO.
001830    03 pvv                      PIC 9(5)  VALUE ZERO.
001760    03 ꕔSvv                PIC 9(5)  VALUE ZERO.
002149** Zi̓t敪p (0:ŏIʉ@A1:A9:󎚂Ȃ)
002150 01 Zvgt敪v                 PIC 9 VALUE ZERO.
002151 01 Zvgғt敪v             PIC 9 VALUE ZERO.
002617** p
002618 01 {pNv                       PIC 9(4)  VALUE ZERO.
002619 01 v                               PIC 9(3)  VALUE ZERO.
002620 01 ]v                               PIC 9(3)  VALUE ZERO.
002621*
001200******************************************************************
001210*                          A                              *
001220******************************************************************
001230*
003080****************
003090* ʓ͏ *
003100****************
003110 01 A|̓f[^x`hVQO IS EXTERNAL.
003120    03 A|JnaN.
003130       05 A|Jna                  PIC 9(1).
003140       05 A|JnN                    PIC 9(2).
003150       05 A|Jn                    PIC 9(2).
003150       05 A|Jn                    PIC 9(2).
003120    03 A|IaN.
003130       05 A|Ia                  PIC 9(1).
003140       05 A|IN                    PIC 9(2).
003150       05 A|I                    PIC 9(2).
003150       05 A|I                    PIC 9(2).
003170    03 A|ی                     PIC 9(2).
003180    03 A|{lƑ敪                 PIC 9(1).
003190    03 A|҃R[h.
003200       05 A|Ҕԍ                  PIC 9(6).
003210       05 A|}                      PIC X(1).
          03 A|                     PIC 9(2).
006550*
006560 01 A|L[ IS EXTERNAL.
006570    03 A|ی                     PIC 9(2).
006550*
003110 01 A|f[^x`hVQP IS EXTERNAL.
          03 A|O                     PIC 9(1).
          03 A|S                     PIC 9(2).
003170    03 A|q                     PIC 9(5).
003170    03 A|                           PIC 9(1).
003170    03 A|                           PIC 9(1).
003170    03 A|                           PIC 9(1).
003170    03 A|                     PIC 9(5).
001390******************************************************************
001400*                      PROCEDURE  DIVISION                       *
001410******************************************************************
001420 PROCEDURE               DIVISION.
001430************
001440*           *
001450*    *
001460*           *
001470************
001480     PERFORM .
001490************
001500*           *
001510* 又     *
001520*           *
001530************
001540     PERFORM ƃt@C쐬.
001550************
001560*           *
001570* I   *
001580*           *
001590************
001600     PERFORM I.
001610     MOVE ZERO TO PROGRAM-STATUS.
001620     EXIT PROGRAM.
001630*
001640*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
001650*================================================================*
001660  SECTION.
001670*
001680     PERFORM t@CI[v.
001690* Aڂ̑Ҕ
001700     INITIALIZE Ҕڂvq.
001720     MOVE A|ی      TO یʂvq.
001730     MOVE A|Ҕԍ      TO Ҕԍvq.
001740     MOVE A|}          TO }Ԃvq.
001750     MOVE A|Jna      TO Jnavq.
001760     MOVE A|JnN        TO JnNvq.
001770     MOVE A|Jn        TO Jnvq.
001770     MOVE A|Jn        TO Jnvq.
001750     MOVE A|Ia      TO Iavq.
001760     MOVE A|IN        TO INvq.
001770     MOVE A|I        TO Ivq.
001770     MOVE A|I        TO Ivq.
001780     MOVE A|{lƑ敪  TO {lƑ敪vq.
      *
           MOVE A|      TO vq.

001790*================================================================*
001800 t@CI[v SECTION.
001810*
012140     OPEN INPUT   }X^
012150         MOVE NC"" TO t@C.
012160         PERFORM I[v`FbN.
001820     OPEN INPUT fҏe.
001830         MOVE NC"fҏe" TO t@C.
001840         PERFORM I[v`FbN.
007870     OPEN INPUT Zvge.
007880         MOVE NC"Z"         TO t@C.
007890         PERFORM I[v`FbN.
003060     OPEN INPUT vf[^e.
003070         MOVE NC"v" TO t@C.
003080         PERFORM I[v`FbN.
           OPEN INPUT f[^e.
               MOVE NC"f[^e" TO t@C.
               PERFORM I[v`FbN.
           OPEN INPUT {pL^e.
               MOVE NC"{pL^e"   TO t@C.
               PERFORM I[v`FbN.
001850*================================================================*
001860 I[v`FbN SECTION.
001870*
001880     IF ԃL[  NOT =  "00"
001890         DISPLAY t@C NC"eI[vG[" UPON CONS
001900         DISPLAY NC"ԃL[F" ԃL[         UPON CONS
001910         DISPLAY NC"P͂dmsdqL[Ă"
001920                                                 UPON CONS
003131*-----------------------------------------*
003132         CALL "actcshm"  WITH C LINKAGE
003133*-----------------------------------------*
001930         ACCEPT  L[ FROM CONS
001940         PERFORM t@C
001950         MOVE 99 TO PROGRAM-STATUS
001960         EXIT PROGRAM.
001970*================================================================*
001980 t@C SECTION.
001990*
002000     CLOSE }X^   fҏe Zvge
                 vf[^e f[^e {pL^e.
002010*================================================================*
002020 I SECTION.
002030*
002040     PERFORM t@C.
002050*================================================================*
002060 G[\ SECTION.
002070*
002080     DISPLAY NC"ԃL[" ԃL[  UPON CONS.
002090     DISPLAY NC"Tt@CG[F" t@C   UPON CONS.
002100     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
002110     DISPLAY NC"P͂dmsdqL[Ă"                                                                    UPON CONS.
003131*-----------------------------------------*
003132     CALL "actcshm"  WITH C LINKAGE.
003133*-----------------------------------------*
002120     ACCEPT  L[ FROM CONS.
002130     PERFORM t@C.
002140     MOVE 99 TO PROGRAM-STATUS.
002150     EXIT PROGRAM.
003960*================================================================*
003970 fҏeǍ SECTION.
003980*
003990     READ fҏe NEXT
004000     AT END
004010         MOVE "YES" TO ItO
004020     END-READ.
002160*================================================================*
002170 ƃt@C쐬 SECTION.
002180*
002210     OPEN OUTPUT ƃt@CP
002220          MOVE NC"P" TO t@C
002230          PERFORM I[v`FbN
002210     OPEN OUTPUT ƃt@CQ
002220          MOVE NC"Q" TO t@C
002230          PERFORM I[v`FbN
      *
003720     MOVE Jnavq      TO |{pa.
003730     MOVE JnNvq        TO |{pN.
003740     MOVE Jnvq        TO |{p.
           MOVE SPACE             TO |҃Ji.
           MOVE SPACE             TO |҃R[h.
003790     START fҏe   KEY IS >= |{paN
                                          |҃Ji
                                          |҃R[h
003830     IF ԃL[ = "00"
003840         MOVE SPACE  TO ItO
003850         PERFORM fҏeǍ
003860         PERFORM UNTIL ( ItO = "YES" ) OR
003870                       ( |{paN > IaNvq )
      */Ώۏ̔
001110                 IF ((یʂvq     NOT = ZERO)              AND
                           (یʂvq     NOT = |ی))     OR
HILO  */Ҏw莞A}Ԃ܂܂Ă܂וύX20405
001120*                    ((Ҕԍvq     NOT = ZERO)              AND
001120*                     (Ҕԍvq     NOT = |Ҕԍ))     OR
      *                    ((}Ԃvq         NOT = SPACE)             AND
      *                     (}Ԃvq         NOT = |}))         OR
HILO                      ((Ҕԍvq     NOT = ZERO)              AND
HILO                       (҃R[hvq   NOT = |҃R[h))   OR
001150                    (({lƑ敪vq NOT = ZERO)              AND
                           ({lƑ敪vq NOT = |{lƑ敪)) OR
                           (|ی         = 70 OR 80 OR 90)
      */ΏۊO
                           CONTINUE
                       ELSE
      */vqۗ
                           MOVE "YES" TO ΏۃtO
                           IF vq NOT = ZERO
                               PERFORM 
                           END-IF
                           IF ΏۃtO = "YES"
                               PERFORM f[^`FbN
                               IF sL[v = "YES"
                                   MOVE |{paN TO {paNvq
                                   IF |{paN = JnaNvq
                                       MOVE Jnvq TO Jnvo
                                   ELSE
                                       MOVE 1          TO Jnvo
                                   END-IF
                                   IF |{paN = IaNvq
                                       MOVE Ivq TO Ivo
                                   ELSE
                                       PERFORM 擾
                                       MOVE 󗝓v   TO Ivo
                                   END-IF
003910                             PERFORM PR[hZbg
003910                             PERFORM QR[hZbg
                               END-IF
                           END-IF
                       END-IF
003930                 PERFORM fҏeǍ
003940         END-PERFORM
003950     END-IF.
002810     CLOSE ƃt@CP ƃt@CQ.
004030*================================================================*
004040 PR[hZbg SECTION.
004050*
008270     INITIALIZE P|R[h.
004130     MOVE |҃R[h   TO P|҃R[h.
           MOVE |҃Ji     TO P|҃Ji.
           MOVE |Ҏ     TO P|Ҏ.
           PERFORM VARYING {pvq FROM Jnvo BY 1
                   UNTIL ( {pvq > Ivo )
               INITIALIZE P|
               MOVE |Ҕԍ  TO {L|Ҕԍ
               MOVE |}      TO {L|}
               MOVE |{pa  TO {L|{pa
               MOVE |{pN    TO {L|{pN
               MOVE |{p    TO {L|{p
               MOVE {pvq    TO {L|{p
               READ {pL^e
               NOT INVALID KEY
                   PERFORM ZvgďoP
                   PERFORM 擾
                   PERFORM ڂƌvZ
                   PERFORM Sڍ׏Wv
                   PERFORM ƃt@CZbg
                   PERFORM PR[h
               END-READ
           END-PERFORM.
008240*================================================================*
008250 ƃt@CZbg SECTION.
008260*
008280     MOVE |{pa       TO P|{pa.
008290     MOVE |{pN         TO P|{pN.
008300     MOVE |{p         TO P|{p.
008310     MOVE {pvq         TO P|{p.
008330     MOVE ꕔSvq     TO P|ꕔS.
008240*================================================================*
008250 ƂQt@CZbg SECTION.
008260*
008280     MOVE |{pa       TO Q|{pa.
008290     MOVE |{pN         TO Q|{pN.
008300     MOVE |{p         TO Q|{p.
           MOVE vv           TO Q|v.
           MOVE Zvv           TO Q|Zv.
           MOVE vv           TO Q|v.
           MOVE Ìvv           TO Q|Ìv.
           MOVE 㪖@vv           TO Q|㪖@v.
           MOVE dÌvv           TO Q|dÌv.
           MOVE pvv           TO Q|pv.
           MOVE ꕔSvv     TO Q|Sv.
004030*================================================================*
004040 QR[hZbg SECTION.
004050*
008270     INITIALIZE Q|R[h.
           MOVE SPACE TO Wvv.
004130     MOVE |҃R[h   TO Q|҃R[h.
           PERFORM VARYING {pvq FROM 1 BY 1
                   UNTIL ( {pvq > 31 )
               INITIALIZE P|
               MOVE |Ҕԍ  TO {L|Ҕԍ
               MOVE |}      TO {L|}
               MOVE |{pa  TO {L|{pa
               MOVE |{pN    TO {L|{pN
               MOVE |{p    TO {L|{p
               MOVE {pvq    TO {L|{p
               READ {pL^e
               NOT INVALID KEY
                   PERFORM ZvgďoP
                   PERFORM Wv
                   PERFORM Sڍ׏Wv
               END-READ
           END-PERFORM.
           PERFORM ƂQt@CZbg.
           PERFORM vZbg.
           PERFORM QR[h.
009320*================================================================*
009330 ZvgďoP SECTION.
009340*
009180     MOVE |Ҕԍ  TO |Ҕԍ.
009190     MOVE |}      TO |}.
009200     MOVE |{pa  TO |{pa.
009210     MOVE |{pN    TO |{pN.
009220     MOVE |{p    TO |{p.
009230     MOVE {pvq    TO |{p.
009240     READ vf[^e
           INVALID KEY
               MOVE SPACE     TO |R[h
           END-READ.
009710*
009720*     IF  | NOT = ZERO
009730*         MOVE |vZSz TO ꕔSvq
009740*     ELSE
009750         MOVE |ꕔS     TO ꕔSvq.
009760*     END-IF.
009710*
005200     MOVE |{pa  TO Z|{pa.
005210     MOVE |{pN    TO Z|{pN.  
005220     MOVE |{p    TO Z|{p.  
005230     MOVE |Ҕԍ  TO Z|Ҕԍ.
005240     MOVE |}      TO Z|}.    
           READ Zvge
           INVALID KEY
               MOVE SPACE     TO Z|R[h
           END-READ.
009710*
010900*================================================================*
010910 擾 SECTION.
010920*
010930***********************************************
010940* f[^Zbg                            *
010950***********************************************
010960*    ****************************************************************
010970*    * ijijijɂĂ͘AڂZbg *
010980*    ****************************************************************
           MOVE 1  TO JE^.
010990     MOVE |             TO  vq.
011000*
011010     MOVE |Z         TO  Zvq.
           MOVE |k       TO  kvq.
011050     MOVE |Č             TO  Čvq.
      *
011080     MOVE |×             TO  ×vq.
011090     MOVE |ÉZ         TO  ÉZvq.
011150*
011160     MOVE |{p񋟗     TO  {p񋟗vq.
           COMPUTE P|z = vq + Čvq + ×vq + ÉZvq.
           COMPUTE P|Zz = Zvq + kvq.
           MOVE |pz             TO P|pz.
011360*
011370*================================================================*
011380 ڂƌvZ SECTION.
011390***********************************************
011400* f[^Zbg                            *
011410***********************************************
013980     PERFORM VARYING JE^ FROM 1 BY 1
013990             UNTIL ( JE^ > 5 )
017100         MOVE |񏈒u(JE^) TO 񏈒uvq(JE^)
018031     END-PERFORM.
011130*
      */^Ö@Aqǉ/180518
011140     MOVE |qZ     TO  qZvq.
015100     MOVE |^×         TO  ^×vq.
           IF |{paN < 43006
017120        MOVE |񏈒uv  TO P|z
           ELSE
017120        COMPUTE P|z = |񏈒uv + qZvq + ^×vq
           END-IF.
      *
011450     MOVE |×P     TO ×vq(1).
011460     MOVE |×Q     TO ×vq(2).
011470     MOVE |×RW   TO ×RWvq.
011480     MOVE |×RO   TO ×ROvq.
011490     COMPUTE ×vq(3)   = ×RWvq   + ×ROvq.
011500     MOVE |×ST   TO ×STvq.
011510     MOVE |×SW   TO ×SWvq.
011520     MOVE |×SO   TO ×SOvq.
011530     COMPUTE ×vq(4)   = ×STvq   + ×SWvq   + ×SOvq.
011500     MOVE |×TQ   TO ×TQvq.
011500     MOVE |×TT   TO ×TTvq.
011510     MOVE |×TW   TO ×TWvq.
011520     MOVE |×TO   TO ×TOvq.
011530     COMPUTE ×vq(5)   = ×TQvq + ×TTvq + ×TWvq + ×TOvq.
011530     COMPUTE P|Ëz = ×vq(1) + ×vq(2) +
                                    ×vq(3) + ×vq(4) + ×vq(5).
011570********************
011580* Zbg *
011590********************
011600     MOVE |㪖@P             TO 㪗vq(1).
011610     MOVE |㪖@Q             TO 㪗vq(2).
011620     MOVE |㪖@RW           TO 㪖@RWvq.
011630     MOVE |㪖@RO           TO 㪖@ROvq.
011640     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
011650     MOVE |㪖@ST           TO 㪖@STvq.
011660     MOVE |㪖@SW           TO 㪖@SWvq.
011670     MOVE |㪖@SO           TO 㪖@SOvq.
011680     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
011650     MOVE |㪖@TQ           TO 㪖@TQvq.
011650     MOVE |㪖@TT           TO 㪖@TTvq.
011660     MOVE |㪖@TW           TO 㪖@TWvq.
011670     MOVE |㪖@TO           TO 㪖@TOvq.
011680     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq  + 㪖@TOvq.
011690     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) + 㪗vq(5).
011700*
011710     MOVE |㪖@P             TO 㪗vq(1).
011720     MOVE |㪖@Q             TO 㪗vq(2).
011730     MOVE |㪖@RW           TO 㪖@RWvq.
011740     MOVE |㪖@RO           TO 㪖@ROvq.
011750     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
011760     MOVE |㪖@ST           TO 㪖@STvq.
011770     MOVE |㪖@SW           TO 㪖@SWvq.
011780     MOVE |㪖@SO           TO 㪖@SOvq.
011790     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
011760     MOVE |㪖@TQ           TO 㪖@TQvq.
011760     MOVE |㪖@TT           TO 㪖@TTvq.
011770     MOVE |㪖@TW           TO 㪖@TWvq.
011780     MOVE |㪖@TO           TO 㪖@TOvq.
011790     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq + 㪖@TOvq.
011800     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) + 㪗vq(5).
011810*
011820     MOVE |d×P             TO d×vq(1).
011830     MOVE |d×Q             TO d×vq(2).
011840     MOVE |d×RW           TO d×RWvq.
011850     MOVE |d×RO           TO d×ROvq.
011860     COMPUTE d×vq(3)  = d×RWvq  + d×ROvq.
011870     MOVE |d×ST           TO d×STvq.
011880     MOVE |d×SW           TO d×SWvq.
011890     MOVE |d×SO           TO d×SOvq.
011900     COMPUTE d×vq(4)  = d×STvq  + d×SWvq  + d×SOvq.
011870     MOVE |d×TQ           TO d×TQvq.
011870     MOVE |d×TT           TO d×TTvq.
011880     MOVE |d×TW           TO d×TWvq.
011890     MOVE |d×TO           TO d×TOvq.
011900     COMPUTE d×vq(5)  = d×TQvq + d×TTvq + d×TWvq + d×TOvq.
           COMPUTE d×vvq = d×vq(1) + d×vq(2) + d×vq(3) + d×vq(4) + d×vq(5).
           MOVE d×vvq             TO P|dËz.
           COMPUTE P|㪖@z = 㪗vvq + 㪗vvq.
011920*
011370*================================================================*
011380 Wv SECTION.
011390***********************************************
011400* f[^Zbg                            *
011410***********************************************
010990     MOVE |             TO  vq.
011000*
011010     MOVE |Z         TO  Zvq.
           MOVE |k       TO  kvq.
011050     MOVE |Č             TO  Čvq.
011080     MOVE |×             TO  ×vq.
011090     MOVE |ÉZ         TO  ÉZvq.
011140     MOVE |qZ     TO  qZvq.
015100     MOVE |^×         TO  ^×vq.
011160     MOVE |{p񋟗     TO  {p񋟗vq.
           COMPUTE vv = vv + vq + Čvq + ×vq + ÉZvq.
           COMPUTE Zvv = Zvv + Zvq + kvq.
      *
      */^Ö@Aqǉ/180518
           IF |{paN < 43006
017120         COMPUTE vv = vv + |񏈒uv
           ELSE
017120         COMPUTE vv = vv + |񏈒uv + qZvq + ^×vq
           END-IF.
      *
011450     MOVE |×P     TO ×vq(1).
011460     MOVE |×Q     TO ×vq(2).
011470     MOVE |×RW   TO ×RWvq.
011480     MOVE |×RO   TO ×ROvq.
011490     COMPUTE ×vq(3)   = ×RWvq   + ×ROvq.
011500     MOVE |×ST   TO ×STvq.
011510     MOVE |×SW   TO ×SWvq.
011520     MOVE |×SO   TO ×SOvq.
011530     COMPUTE ×vq(4)   = ×STvq   + ×SWvq   + ×SOvq.
011500     MOVE |×TQ   TO ×TQvq.
011500     MOVE |×TT   TO ×TTvq.
011510     MOVE |×TW   TO ×TWvq.
011520     MOVE |×TO   TO ×TOvq.
011530     COMPUTE ×vq(5)   = ×TQvq + ×TTvq + ×TWvq + ×TOvq.
011530     COMPUTE Ìvv = Ìvv + ×vq(1) + ×vq(2) + ×vq(3) + ×vq(4) + ×vq(5).
011570********************
011580* Zbg *
011590********************
011600     MOVE |㪖@P             TO 㪗vq(1).
011610     MOVE |㪖@Q             TO 㪗vq(2).
011620     MOVE |㪖@RW           TO 㪖@RWvq.
011630     MOVE |㪖@RO           TO 㪖@ROvq.
011640     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
011650     MOVE |㪖@ST           TO 㪖@STvq.
011660     MOVE |㪖@SW           TO 㪖@SWvq.
011670     MOVE |㪖@SO           TO 㪖@SOvq.
011680     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
011650     MOVE |㪖@TQ           TO 㪖@TQvq.
011650     MOVE |㪖@TT           TO 㪖@TTvq.
011660     MOVE |㪖@TW           TO 㪖@TWvq.
011670     MOVE |㪖@TO           TO 㪖@TOvq.
011680     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq + 㪖@TOvq.
011690     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) + 㪗vq(5).
011700*
011710     MOVE |㪖@P             TO 㪗vq(1).
011720     MOVE |㪖@Q             TO 㪗vq(2).
011730     MOVE |㪖@RW           TO 㪖@RWvq.
011740     MOVE |㪖@RO           TO 㪖@ROvq.
011750     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
011760     MOVE |㪖@ST           TO 㪖@STvq.
011770     MOVE |㪖@SW           TO 㪖@SWvq.
011780     MOVE |㪖@SO           TO 㪖@SOvq.
011790     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
011760     MOVE |㪖@TQ           TO 㪖@TQvq.
011760     MOVE |㪖@TT           TO 㪖@TTvq.
011770     MOVE |㪖@TW           TO 㪖@TWvq.
011780     MOVE |㪖@TO           TO 㪖@TOvq.
011790     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq + 㪖@TOvq.
011800     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) + 㪗vq(5).
011810*
011820     MOVE |d×P             TO d×vq(1).
011830     MOVE |d×Q             TO d×vq(2).
011840     MOVE |d×RW           TO d×RWvq.
011850     MOVE |d×RO           TO d×ROvq.
011860     COMPUTE d×vq(3)  = d×RWvq  + d×ROvq.
011870     MOVE |d×ST           TO d×STvq.
011880     MOVE |d×SW           TO d×SWvq.
011890     MOVE |d×SO           TO d×SOvq.
011900     COMPUTE d×vq(4)  = d×STvq  + d×SWvq  + d×SOvq.
011870     MOVE |d×TQ           TO d×TQvq.
011870     MOVE |d×TT           TO d×TTvq.
011880     MOVE |d×TW           TO d×TWvq.
011890     MOVE |d×TO           TO d×TOvq.
011900     COMPUTE d×vq(5)  = d×TQvq + d×TTvq + d×TWvq + d×TOvq.
           COMPUTE d×vvq = d×vq(1) + d×vq(2) + d×vq(3) + d×vq(4) + d×vq(5).
           COMPUTE 㪖@vv = 㪖@vv + 㪗vvq + 㪗vvq.
           COMPUTE dÌvv = dÌvv + d×vvq.
011920*
           COMPUTE pvv = pvv + |pz.
           COMPUTE ꕔSvv = ꕔSvv + ꕔSvq.
      *
011370*================================================================*
011380 Sڍ׏Wv SECTION.
      *
009720*     IF  | NOT = ZERO
009670         MOVE |vZSz TO Sڍׂvq.
009680*     ELSE
009690*         MOVE |ꕔS   TO Sڍׂvq
009700*     END-IF.
009710*
004140*================================================================*
004150 PR[h SECTION.
004160*
004170     WRITE P|R[h
004180     INVALID KEY
004190         MOVE NC"P"  TO t@C
004200         PERFORM G[\
004210     END-WRITE.
004140*================================================================*
004150 QR[h SECTION.
004160*
004170     WRITE Q|R[h
004180     INVALID KEY
004190         MOVE NC"Q"  TO t@C
004200         PERFORM G[\
004210     END-WRITE.
      *================================================================*
       vZbg SECTION.
      *
0           IF | NOT = ZERO
              MOVE  3   TO Z|Z
           ELSE
              IF | NOT = ZERO
                 MOVE  2   TO Z|Z
              ELSE
                 IF |ی = 85
                    MOVE  7   TO Z|Z
                 ELSE
                    MOVE  1   TO Z|Z
                 END-IF
              END-IF
           END-IF.
005200     MOVE |{pa  TO Z|{pa.
005210     MOVE |{pN    TO Z|{pN.  
005220     MOVE |{p    TO Z|{p.  
005230     MOVE |Ҕԍ  TO Z|Ҕԍ.
005240     MOVE |}      TO Z|}.    
           READ Zvge
           INVALID KEY
               MOVE SPACE     TO Z|R[h
           END-READ.
      *
008330     MOVE Z|v         TO Q|pv.
008340     MOVE Z|ꕔS   TO Q|Sv.
008220     MOVE Z|z     TO Q|v.
           MOVE Z|Z   TO Q|v.
           MOVE Z|S       TO A|S.
           IF |{paN < 43006
              MOVE Z|qZ TO A|q
              MOVE Z|             TO A|
              MOVE Z|             TO A|
              MOVE Z|             TO A|
           ELSE
              MOVE ZERO                 TO A|q
           END-IF.
           MOVE Z|{p񋟗 TO A|.
      *O
           IF |ʋ敪 = 1 OR 2 OR 3
016860         MOVE 1                TO A|O
           ELSE
016860         MOVE ZERO             TO A|O
           END-IF.
      *================================================================*
       f[^`FbN SECTION.
      *
           MOVE SPACE          TO sL[v.
      * *****************************************************************
      * * ʗL`FbNFʐ = 0 ̏ꍇf[^쐬ΏۂƂȂ *
      * *****************************************************************
           MOVE |{pa   TO |{pa.
           MOVE |{pN     TO |{pN.
           MOVE |{p     TO |{p.
           MOVE |Ҕԍ   TO |Ҕԍ.
           MOVE |}       TO |}.
           READ f[^e
           INVALID KEY
               MOVE SPACE  TO sL[v
           NOT INVALID KEY
               IF |ʐ NOT = ZERO
      *        *************************************************************
      *        * {pL^`FbNFʉ@ = 0 ̏ꍇf[^쐬ΏۂƂȂ *
      *        *************************************************************
                   MOVE |Ҕԍ  TO {L|Ҕԍ
                   MOVE |}      TO {L|}
                   MOVE |{pa  TO {L|{pa
                   MOVE |{pN    TO {L|{pN
                   MOVE |{p    TO {L|{p
                   MOVE ZERO          TO {L|{p
                   START {pL^e   KEY IS >= {L|҃R[h
                                                {L|{paN
                   END-START
                   IF ԃL[ = "00"
                       MOVE SPACE TO ItOQ
                       MOVE SPACE TO {pL^Lv
                       PERFORM {pL^eǍ
                       PERFORM UNTIL (ItOQ         = "YES"         ) OR
                                     ({L|҃R[h NOT = |҃R[h) OR
                                     ({L|{pa   NOT = |{pa  ) OR
                                     ({L|{pN     NOT = |{pN    ) OR
                                     ({L|{p     NOT = |{p    ) OR
                                     ({pL^Lv         = "YES"         )
                           MOVE "YES"  TO {pL^Lv
                           MOVE "YES"  TO sL[v
                       END-PERFORM
                   ELSE
                       MOVE SPACE  TO sL[v
                   END-IF
               ELSE
                   MOVE SPACE  TO sL[v
               END-IF
           END-READ.
      *
      *================================================================*
       {pL^eǍ SECTION.
      *
           READ {pL^e NEXT
           AT END
               MOVE "YES"  TO ItOQ
           END-READ.
002820*================================================================*
        SECTION.
      *
           MOVE SPACE TO ΏۃtO
      */JЎӂ̃f[^͑ΏۊO
           IF |ی NOT = 70 AND 80
               EVALUATE vq
               WHEN 01
                   PERFORM 
               WHEN 02
                   PERFORM Â̂ݔ
               WHEN 03
                   PERFORM I
               WHEN 04
                   PERFORM 
                   IF ΏۃtO = "YES"
                       PERFORM I
                   END-IF
               WHEN OTHER
                   CONTINUE
               END-EVALUATE
           END-IF.
040770*================================================================*
        SECTION.
      *
014120     MOVE |Ҕԍ  TO {L|Ҕԍ
014130     MOVE |}      TO {L|}
014140     MOVE |{pa  TO {L|{pa
014150     MOVE |{pN    TO {L|{pN
014160     MOVE |{p    TO {L|{p
014170     MOVE ZERO          TO {L|{p
014180     START {pL^e   KEY IS >= {L|҃R[h
014190                                  {L|{paN
014200     END-START
014210     IF ԃL[ = "00"
014120         MOVE SPACE TO ItOQ
014140         PERFORM {pL^eǍ
014150         PERFORM UNTIL (ItOQ         = "YES"         ) OR
014160                       ({L|҃R[h NOT = |҃R[h) OR
014170                       ({L|{pa   NOT = |{pa  ) OR
014180                       ({L|{pN     NOT = |{pN    ) OR
014190                       ({L|{p     NOT = |{p    )
      *
                   IF {L|fË敪 = 2
                       MOVE "YES" TO ΏۃtO
                       MOVE "YES" TO ItOQ
                   END-IF
040620             PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
040770*================================================================*
       Â̂ݔ SECTION.
      *
014120     MOVE |Ҕԍ  TO {L|Ҕԍ
014130     MOVE |}      TO {L|}
014140     MOVE |{pa  TO {L|{pa
014150     MOVE |{pN    TO {L|{pN
014160     MOVE |{p    TO {L|{p
014170     MOVE ZERO          TO {L|{p
014180     START {pL^e   KEY IS >= {L|҃R[h
014190                                  {L|{paN
014200     END-START
014210     IF ԃL[ = "00"
014120         MOVE SPACE TO ItOQ
014140         PERFORM {pL^eǍ
014150         PERFORM UNTIL (ItOQ         = "YES"         ) OR
014160                       ({L|҃R[h NOT = |҃R[h) OR
014170                       ({L|{pa   NOT = |{pa  ) OR
014180                       ({L|{pN     NOT = |{pN    ) OR
014190                       ({L|{p     NOT = |{p    )
      *
                   IF {L|fË敪 = 1
                       MOVE "YES" TO ΏۃtO
                   ELSE
                       MOVE SPACE TO ΏۃtO
                       MOVE "YES" TO ItOQ
                   END-IF
040620             PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
040770*================================================================*
       I SECTION.
      *
           MOVE "YES" TO ΏۃtO.
      *
014190     MOVE |{pa   TO |{pa.
014200     MOVE |{pN     TO |{pN.
014210     MOVE |{p     TO |{p.
014120     MOVE |Ҕԍ   TO |Ҕԍ.
014130     MOVE |}       TO |}.
014140     READ f[^e
014150     INVALID KEY
014160         MOVE SPACE  TO ΏۃtO
014170     NOT INVALID KEY
               IF |ʐ = ZERO
                   MOVE SPACE TO ΏۃtO
               ELSE
020600             PERFORM VARYING ʂbms FROM 1 BY 1
020610                      UNTIL (ʂbms > |ʐ)
                       IF |]A敪(ʂbms) = 9 OR 5
                           MOVE SPACE TO ΏۃtO
                       END-IF
                   END-PERFORM
               END-IF
           END-READ.
027377*================================================================*
027378 擾 SECTION.
027379*
027382     MOVE {pavq TO |敪.
027383     READ }X^
027384     NOT INVALID KEY
027385         MOVE |JnN TO {pNv
027386     END-READ.
027387     IF {pNv NOT = ZERO
027388        COMPUTE {pNv = {pNv + {pNvq - 1
027389     END-IF.
027390*
           MOVE {pvq   TO 󗝌v.
027391     EVALUATE {pvq
027392     WHEN 4
027393     WHEN 6
027394     WHEN 9
027395     WHEN 11
027396         MOVE 30 TO 󗝓v
027397     WHEN 2
027398         DIVIDE 4 INTO {pNv GIVING    v
027399                                    REMAINDER ]v
027400         END-DIVIDE
027401         IF ]v = ZERO
027402             MOVE 29 TO 󗝓v
027403         ELSE
027404             MOVE 28 TO 󗝓v
027405         END-IF
027406     WHEN 1
027407     WHEN 3
027408     WHEN 5
027409     WHEN 7
027410     WHEN 8
027411     WHEN 10
027412     WHEN 12
027413         MOVE 31 TO 󗝓v
027414     WHEN OTHER
027415          CONTINUE
027416     END-EVALUATE.
027417*
004230******************************************************************
004240 END PROGRAM YAI721.
004250******************************************************************
