000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YAS6125.
000060 AUTHOR.                 rc@Kq
000070*
000080*----------------------------------------------------------------*
000090*      ۋ Zvgi_+޳ޔŁj
000100*  (SĂ̕یʗp)
000110*         MED = YAW610 YAS6125P
000120* 2000N9
      */qE^Â̕ύXEǉ/1805
000130*----------------------------------------------------------------*
000120 DATE-WRITTEN.           2012-07-26
000130 DATE-COMPILED.          2012-07-26
000160*----------------------------------------------------------------*
000170******************************************************************
000180*            ENVIRONMENT         DIVISION                        *
000190******************************************************************
000200 ENVIRONMENT             DIVISION.
000210 CONFIGURATION           SECTION.
000220 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000230 OBJECT-COMPUTER.        FMV-DESKPOWER.
000240 SPECIAL-NAMES.          CONSOLE  IS  CONS
000250                         SYSERR   IS  MSGBOX.
000260 INPUT-OUTPUT            SECTION.
000270 FILE-CONTROL.
000280     SELECT  ی҃}X^    ASSIGN      TO        HOKENSL
000290                             ORGANIZATION             IS  INDEXED
000300                             ACCESS MODE              IS  DYNAMIC
000310                             RECORD KEY               IS  ہ|ی
000320                                                          ہ|یҔԍ
000330                             ALTERNATE RECORD KEY     IS  ہ|ی
000340                                                          ہ|یҖ
000350                                                          ہ|یҔԍ
000360                             FILE STATUS              IS  ԃL[
000370                             LOCK        MODE         IS  AUTOMATIC.
000380     SELECT  }X^      ASSIGN      TO        GENGOUL
000390                             ORGANIZATION             IS  INDEXED
000400                             ACCESS MODE              IS  DYNAMIC
000410                             RECORD KEY               IS  |敪
000420                             FILE STATUS              IS  ԃL[
000430                             LOCK        MODE         IS  AUTOMATIC.
000440     SELECT  ̃}X^      ASSIGN      TO        MEISYOL
000450                             ORGANIZATION             IS  INDEXED
000460                             ACCESS MODE              IS  DYNAMIC
000470                             RECORD KEY               IS  |敪R[h
000480                                                          |̃R[h
000490                             FILE STATUS              IS  ԃL[
000500                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  Zvge      ASSIGN      TO        RECEPTL
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  Z|{paN
000170                                                          Z|҃R[h
000180                                                          Z|Z
000190                             ALTERNATE RECORD KEY     IS  Z|҃R[h
000200                                                          Z|{paN
000210                                                          Z|Z
000220                             ALTERNATE RECORD KEY     IS  Z|aN
000230                                                          Z|{paN
000240                                                          Z|҃R[h
000250                                                          Z|Z
000260                             ALTERNATE RECORD KEY     IS  Z|aN
000270                                                          Z|Z
000280                                                          Z|یҔԍ
000290                                                          Z|҃R[h
000300                                                          Z|{paN
000310                             ALTERNATE RECORD KEY     IS  Z|aN
000320                                                          Z|یҔԍ
000330                                                          Z|҃R[h
000340                                                          Z|Z
000350                                                          Z|{paN
000360                             FILE STATUS              IS  ԃL[
000370                             LOCK        MODE         IS  AUTOMATIC.
000570     SELECT  }X^  ASSIGN      TO        SEIGYOL
000580                             ORGANIZATION             IS  INDEXED
000590                             ACCESS MODE              IS  DYNAMIC
000600                             RECORD KEY               IS  |敪
000610                             FILE STATUS              IS  ԃL[
000620                             LOCK        MODE         IS  AUTOMATIC.
000630     SELECT  {p}X^ ASSIGN      TO        SEJOHOL
000640                             ORGANIZATION             IS  INDEXED
000650                             ACCESS MODE              IS  DYNAMIC
000660                             RECORD KEY               IS {|{pԍ
000670                             FILE STATUS              IS  ԃL[
000680                             LOCK        MODE         IS  AUTOMATIC.
000690     SELECT  }X^    ASSIGN      TO        SEIKYUSL
000700                             ORGANIZATION           IS  INDEXED
000710                             ACCESS MODE            IS  DYNAMIC
000720                             RECORD KEY             IS |ی
000730                                                       |یҔԍ
000740                             FILE STATUS            IS  ԃL[
000750                             LOCK    MODE           IS  AUTOMATIC.
000760     SELECT  o߃}X^      ASSIGN      TO        KEIKAL
000770                             ORGANIZATION             IS  INDEXED
000780                             ACCESS MODE              IS  DYNAMIC
000790                             RECORD KEY               IS  o|敪R[h
000800                                                          o|o߃R[h
000810                             FILE STATUS              IS  ԃL[
000820                             LOCK        MODE         IS  AUTOMATIC.
000830     SELECT  e      ASSIGN      TO        HUGEINL
000840                             ORGANIZATION             IS  INDEXED
000850                             ACCESS MODE              IS  DYNAMIC
000860                             RECORD KEY               IS  |敪R[h
000870                                                          |R[h
000880                             FILE STATUS              IS  ԃL[
000890                             LOCK        MODE         IS  AUTOMATIC.
000900     SELECT  fҏe    ASSIGN      TO        JUSINJL
000910                             ORGANIZATION             IS  INDEXED
000920                             ACCESS MODE              IS  DYNAMIC
000930                             RECORD KEY               IS |{paN
000940                                                          |҃R[h
000950                             ALTERNATE RECORD KEY     IS |{paN
000960                                                          |҃Ji
000970                                                          |҃R[h
000980                             ALTERNATE RECORD KEY     IS  |҃R[h
000990                                                         |{paN
001000                             ALTERNATE RECORD KEY     IS |{paN
001010                                                          |ی
001020                                                          |یҔԍ
001030                                                          |҃R[h
001040                             ALTERNATE RECORD KEY     IS |{paN
001050                                                          |
001060                                                     |pSҔԍ
001070                                                          |҃R[h
001080                             ALTERNATE RECORD KEY     IS |{paN
001090                                                          |
001100                                                  |pSҔԍ
001110                                                          |҃R[h
001120                             ALTERNATE RECORD KEY  IS |aN
001130                                                      |{paN
001140                                                      |҃R[h
001150                             FILE STATUS              IS  ԃL[
001160                             LOCK        MODE         IS  AUTOMATIC.
001170     SELECT  {pL^e      ASSIGN      TO        SEKIROKL
001180                             ORGANIZATION             IS  INDEXED
001190                             ACCESS MODE              IS  DYNAMIC
001200                             RECORD KEY           IS {L|{paN
001210                                                     {L|҃R[h
001220                             ALTERNATE RECORD KEY IS {L|҃R[h
001230                                                     {L|{paN
001240                             FILE STATUS              IS  ԃL[
001250                             LOCK        MODE         IS  AUTOMATIC.
001260     SELECT  f[^e    ASSIGN      TO        HUSYOUL
001270                             ORGANIZATION             IS  INDEXED
001280                             ACCESS MODE              IS  DYNAMIC
001290                             RECORD KEY               IS |{paN
001300                                                         |҃R[h
001310                             ALTERNATE RECORD KEY     IS |҃R[h
001320                                                         |{paN
001330                             FILE STATUS              IS  ԃL[
001340                             LOCK        MODE         IS  AUTOMATIC.
001350     SELECT  }X^      ASSIGN      TO        RYOUKINL
001360                             ORGANIZATION             IS  INDEXED
001370                             ACCESS MODE              IS  DYNAMIC
001380                             RECORD KEY               IS  |敪R[h
001390                                                          |ʃR[h
001400                                                          |JnaN.
001410     SELECT  }X^    ASSIGN      TO        KAIJOHOL
001420                             ORGANIZATION             IS  INDEXED
001430                             ACCESS MODE              IS  DYNAMIC
000130                             RECORD KEY               IS  |_I敪
000131                                                          |R[h
000132                                                          |ی
000133                                                          |ύXaN
000134                             ALTERNATE RECORD KEY     IS  |_I敪
000135                                                          |ڍtJi
000136                                                          |R[h
000137                                                          |ی
000138                                                          |ύXaN
000151                             FILE STATUS              IS  ԃL[
001520                             LOCK        MODE         IS  AUTOMATIC.
001530     SELECT  hcǗ}X^    ASSIGN      TO        IDKANRL
001540                             ORGANIZATION             IS  INDEXED
001550                             ACCESS MODE              IS  DYNAMIC
001560                             RECORD KEY               IS  hcǁ|hc敪
001570                                                          hcǁ|{pԍ
001580                                                          hcǁ|ی
001590                                                          hcǁ|یҔԍ
001600                             ALTERNATE RECORD KEY     IS  hcǁ|{phcԍ
001610                                                          hcǁ|hc敪
001620                                                          hcǁ|{pԍ
001630                                                          hcǁ|ی
001640                                                          hcǁ|یҔԍ
001650                             FILE STATUS              IS  ԃL[
001660                             LOCK        MODE         IS  AUTOMATIC.
001500     SELECT  s}X^    ASSIGN      TO        SITYOSNL
001510                             ORGANIZATION             IS  INDEXED
001520                             ACCESS MODE              IS  DYNAMIC
001530                             RECORD KEY               IS  s|
001540                                                          s|sԍ
001550                             ALTERNATE RECORD KEY     IS  s|
001560                                                          s|s
001570                                                          s|sԍ
001580                             FILE STATUS              IS  ԃL[
001590                             LOCK        MODE         IS  AUTOMATIC.
           SELECT  vZ}X^      ASSIGN      TO        KEISANL
                                   ORGANIZATION             IS  INDEXED
                                   ACCESS MODE              IS  DYNAMIC
                                   RECORD KEY               IS  v|敪
                                                                v|JnaN
                                   FILE STATUS              IS  ԃL[
                                   LOCK        MODE         IS  AUTOMATIC.
001810* я󎚗p
001820     SELECT  ƃt@CQ  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W5912L.DAT"
001830                             ORGANIZATION             IS  INDEXED
001840                             ACCESS                   IS  DYNAMIC
001850                             RECORD      KEY          IS  Q|{paN
001860                                                          Q|҃R[h
001870                                                          Q|ی
001880                             FILE        STATUS       IS  ԃL[
001890                             LOCK        MODE         IS  AUTOMATIC.
001900     SELECT  t@C    ASSIGN      TO     GS-PRTF002
001910                             SYMBOLIC    DESTINATION  IS "PRT"
001920                             FORMAT                   IS  `̖o
001930                             GROUP                    IS  ڌQo
001940                             PROCESSING  MODE         IS  ʂo
001950                             UNIT        CONTROL      IS  go
001960                             FILE        STATUS       IS  ʒmo.
001970******************************************************************
001980*                      DATA DIVISION                             *
001990******************************************************************
002000 DATA                    DIVISION.
002010 FILE                    SECTION.
002020*                           mqk  RQOn
002030 FD  ی҃}X^        BLOCK   CONTAINS   1   RECORDS.
002040     COPY HOKENS          OF  XFDLIB  JOINING      AS  PREFIX.
002050*                           mqk  PQWn
002060 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002070     COPY GENGOU          OF  XFDLIB  JOINING      AS  PREFIX.
002080*                           mqk  PQWn
002090 FD  ̃}X^          BLOCK   CONTAINS   1   RECORDS.
002100     COPY MEISYO          OF  XFDLIB  JOINING      AS  PREFIX.
      *                          mqk  PTRUn
       FD  Zvge          BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   Z  AS  PREFIX.
002140*                           mqk  QTUn
002150 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002160     COPY SEIGYO          OF  XFDLIB  JOINING      AS  PREFIX.
002170*                           mqk  PQWn
002180 FD  {p}X^          BLOCK   CONTAINS   1   RECORDS.
002190     COPY SEJOHO         OF  XFDLIB  JOINING   {   AS  PREFIX.
002200*                           mqk  PQWn
002210 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002220     COPY SEIKYUS         OF  XFDLIB  JOINING      AS  PREFIX.
002230*                           mqk  PQWn
002240 FD  o߃}X^          BLOCK   CONTAINS   1   RECORDS.
002250     COPY KEIKA          OF  XFDLIB  JOINING   o   AS  PREFIX.
002260*                           mqk  RQOn
002270 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
002280     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
002290*                           mqk  QTUn
002300 FD  {pL^e          BLOCK   CONTAINS   1   RECORDS.
002310     COPY SEKIROK         OF  XFDLIB  JOINING   {L AS  PREFIX.
002320*                           mqk  PQWn
002330 FD  f[^e        BLOCK   CONTAINS   1   RECORDS.
002340     COPY HUSYOU          OF  XFDLIB  JOINING      AS  PREFIX.
002350*                           mqk  PQWn
002360 FD  e         BLOCK   CONTAINS   1   RECORDS.
002370     COPY HUGEIN          OF  XFDLIB  JOINING      AS  PREFIX.
002380*
002390 FD  }X^         BLOCK   CONTAINS   1   RECORDS.
002400     COPY RYOUKIN         OF  XFDLIB  JOINING      AS  PREFIX.
002410     COPY RYOUKNA         OF  XFDLIB  JOINING   ` AS  PREFIX.
002420     COPY RYOUKNB         OF  XFDLIB  JOINING   a AS  PREFIX.
002430     COPY RYOUKNC         OF  XFDLIB  JOINING   b AS  PREFIX.
002440     COPY RYOUKND         OF  XFDLIB  JOINING   c AS  PREFIX.
002450     COPY RYOUKNE         OF  XFDLIB  JOINING   d AS  PREFIX.
002460     COPY RYOUKNF         OF  XFDLIB  JOINING   e AS  PREFIX.
002470*                           mqk  USOn
002480 FD  }X^        BLOCK   CONTAINS   1   RECORDS.
002490     COPY KAIJOHO         OF  XFDLIB  JOINING      AS  PREFIX.
002500*                           mqk  PQWn
002510 FD  hcǗ}X^          BLOCK   CONTAINS   1   RECORDS.
002520     COPY IDKANR    OF  XFDLIB  JOINING   hc   AS  PREFIX.
002470*                           mqk  QTUn
002480 FD  s}X^          BLOCK   CONTAINS   1   RECORDS.
002490     COPY SITYOSN        OF  XFDLIB  JOINING   s   AS  PREFIX.
      *                           mqk  QTUn
       FD  vZ}X^          BLOCK   CONTAINS   1   RECORDS.
           COPY KEISAN     OF  XFDLIB  JOINING   v   AS  PREFIX.
           COPY KEISANA    OF  XFDLIB  JOINING   v` AS  PREFIX.
002560**
002570 FD  ƃt@CQ RECORD  CONTAINS 32 CHARACTERS.
002580 01  Q|R[h.
002590     03  Q|R[hL[.
002600         05  Q|{paN.
002610             07  Q|{pa            PIC 9.
002620             07  Q|{pN              PIC 9(2).
002630             07  Q|{p              PIC 9(2).
002640         05  Q|҃R[h.
002650             07 Q|Ҕԍ             PIC 9(6).
002660             07 Q|}                 PIC X(1).
002670         05  Q|ی                PIC 9(2).
002680     03  Q|R[hf[^.
002690         05  Q|                    PIC 9(4).
002700         05  FILLER                        PIC X(14).
002710*
002720 FD  t@C.
002730     COPY YAS6125P        OF  XMDLIB.
002740*----------------------------------------------------------------*
002750******************************************************************
002760*                WORKING-STORAGE SECTION                         *
002770******************************************************************
002780 WORKING-STORAGE         SECTION.
002790 01 L[                           PIC X     VALUE SPACE.
002800 01 ԃL[                           PIC X(2)  VALUE SPACE.
002810 01 ItO                         PIC X(3)  VALUE SPACE.
002820 01 ItOQ                       PIC X(3)  VALUE SPACE.
002830 01 tO                         PIC X(3)  VALUE SPACE.
002840 01 ptO                         PIC X(3)  VALUE SPACE.
002850 01 t@C                         PIC N(6)  VALUE SPACE.
002860 01 Zvgofv                     PIC X(8)  VALUE SPACE.
002870 01 Oav                           PIC 9     VALUE ZERO.
002880 01 Jgv                     PIC 9(1)  VALUE ZERO.
002890 01 ʂbms                         PIC 9     VALUE ZERO.
002900 01 Ҕԍv                         PIC 9(6)  VALUE ZERO.
002910 01 ̂v                         PIC N(6)  VALUE SPACE.
002920 01 ʖ̂v                         PIC N(12) VALUE SPACE.
002930 01 ʒv                           PIC 9(2) VALUE 1.
002940 01 EotO                         PIC X(3)  VALUE SPACE.
002950 01 󔒂v                             PIC X(2)  VALUE SPACE.
001363 01 Sp                           PIC X(2)  VALUE X"8140".
001364 01 p                           PIC X(2)  VALUE X"2020".
002960*
002970** {ϊ
002980 01 v                             PIC 9(2).
002990 01 q REDEFINES v.
003000    03 vP                        PIC X(1).
003010    03 vQ                        PIC X(1).
003020*
003030 01 ԍv                         PIC 9.
003040 01 ԍq REDEFINES ԍv.
003050    03 ԍvP                    PIC X.
003060*
003070 01 Spԍv                     PIC N.
003080 01 Spԍq REDEFINES Spԍv.
003090    03 SpԍvP                PIC X(2).
003100*************
003110* ϔԍp
003120 01 ϘAԍWcv.
003130    03 ϘAԍv                  PIC X(2)  VALUE SPACE.
003140    03 ϘAԍmv REDEFINES  ϘAԍv  PIC N(1).
003150    03 ϘAԍv                    PIC X(6)  VALUE SPACE.
003160    03 ϘAԍPʂv                PIC X(2)  VALUE SPACE.
003170    03 ϘAԍPʂmv REDEFINES  ϘAԍPʂv  PIC N.
003180* qԍp
003190 01 qԍWcv.
003200    03 qԍv                  PIC X(2)  VALUE SPACE.
003210    03 qԍmv REDEFINES  qԍv  PIC N(1).
003220    03 qԍv                    PIC X(6)  VALUE SPACE.
003230    03 qԍPʂv                PIC X(2)  VALUE SPACE.
003240    03 qԍPʂmv REDEFINES  qԍPʂv  PIC N.
003250*******
003260*
003270 01 JE^                           PIC 9(2)  VALUE ZERO.
003280 01 JE^Q                         PIC 9(2)  VALUE ZERO.
003290 01 ی̂v                         PIC N(12) VALUE SPACE.
003300*
003310* ޔp
003320 01 INvs.
003330    03 INvs                      PIC 9(2)  VALUE ZERO.
003340    03 Ivs                      PIC 9(2)  VALUE ZERO.
003350    03 Ivs                      PIC 9(2)  VALUE ZERO.
003360* ޔp
003370 01 Nvs.
003380    03 avs                    PIC 9     VALUE ZERO.
003390    03 Nvs                      PIC 9(2)  VALUE ZERO.
003400    03 vs                      PIC 9(2)  VALUE ZERO.
003410    03 vs                      PIC 9(2)  VALUE ZERO.
003420* p
003430 01 vs.
003440    03 Pvs                  PIC X(60) VALUE SPACE.
003450    03 Qvs                  PIC X(60) VALUE SPACE.
003460    03 Rvs                  PIC X(60) VALUE SPACE.
003470    03 Svs                  PIC X(60) VALUE SPACE.
003480    03 Tvs                  PIC X(60) VALUE SPACE.
003490    03 io[vs.
003500       05 io[vP         PIC X(2)  OCCURS 9 VALUE SPACE.
003510    03 io[mv  REDEFINES io[vs PIC X(18).
003520 01 Ҕԍbv                   PIC 9(6)  VALUE ZERO.
003530 01 AԂbv                       PIC 9(4)  VALUE ZERO.
003540 01 sak.
003550    03 R[hsak            OCCURS 9.
003560       05 Ҕԍv               PIC 9(6)  VALUE ZERO.
003570       05 AԂv                   PIC 9(4)  VALUE ZERO.
003580       05 ʂv               PIC 9  OCCURS 9 VALUE ZERO.
003590 01 ev.
003600    03 ev              PIC X(318) OCCURS 9 VALUE SPACE.
003620    03 ewv.
003630       05 ePwv           PIC X(80)  VALUE SPACE.
003640       05 eQwv           PIC X(80)  VALUE SPACE.
003640       05 eRwv           PIC X(80)  VALUE SPACE.
003650       05 eSwv           PIC X(78)  VALUE SPACE.
       01 Pv.
          03 Pvq                OCCURS 7.
             05 Pvo             PIC X(80) VALUE SPACE.
003650*
003660* Zp
003670 01 Zvs.
003680    03 ZJEg                PIC 9    VALUE ZERO.
003690    03 ԍJE^                    PIC 9    VALUE ZERO.
003700    03 ZWcvs  OCCURS 3.
003710       05 Z敪vs             PIC 9    VALUE ZERO.
003720       05 Zvs               PIC 9(2) VALUE ZERO.
003730       05 Zvs               PIC 9(2) VALUE ZERO.
003740    03 ZWcmv  OCCURS 3.
003750       05 Z؂v                   PIC N(1) VALUE SPACE.
003760       05 Zev                   PIC N(3) VALUE SPACE.
003770       05 ZmvP             PIC N(1) VALUE SPACE.
003780       05 ZmvQ             PIC N(1) VALUE SPACE.
003790       05 Œv                     PIC N(1) VALUE SPACE.
003800       05 ZmvP             PIC N(1) VALUE SPACE.
003810       05 ZmvQ             PIC N(1) VALUE SPACE.
003820       05 Œv                     PIC N(1) VALUE SPACE.
003830    03 ZPv                PIC N(10) VALUE SPACE.
003840    03 ZQv                PIC N(10) VALUE SPACE.
003850    03 ZRv                PIC N(10) VALUE SPACE.
003070    03 Z؂v                  PIC X     VALUE SPACE.
003080    03 Zv                    PIC 9(2)  VALUE ZERO.
003090    03 Zv                    PIC 9(2)  VALUE ZERO.
003860*
003870** Ôݗp
003880 01 ČtO                     PIC X(3)  VALUE SPACE.
003890 01 OtO                         PIC X(3)  VALUE SPACE.
003900*
003910 01 vZNv.
003920    03 vZav                      PIC 9(1)  VALUE ZERO.
003930    03 vZNv                        PIC S9(2)  VALUE ZERO.
003940    03 vZv                        PIC S9(2)  VALUE ZERO.
003950    03 vZv                        PIC S9(2)  VALUE ZERO.
003960 01 JnNQv.
003970    03 JnaQv                    PIC 9(1)  VALUE ZERO.
003980    03 JnNQv                      PIC 9(2)  VALUE ZERO.
003990    03 JnQv                      PIC 9(2)  VALUE ZERO.
004000    03 JnQv                      PIC 9(2)  VALUE ZERO.
004010    03 JnNv                    PIC S9(4) VALUE ZERO.
004020 01 INQv.
004030    03 IaQv                    PIC 9(1)  VALUE ZERO.
004040    03 INQv                      PIC 9(2)  VALUE ZERO.
004050    03 IQv                      PIC 9(2)  VALUE ZERO.
004060    03 IQv                      PIC 9(2)  VALUE ZERO.
004070    03 INv                    PIC S9(4) VALUE ZERO.
004080***
004090** ER敪p
004100 01 敪v                 PIC 9 VALUE ZERO.
004110 01 R敪v                 PIC 9 VALUE ZERO.
004120*
004130** Zi̓t敪p (0:ŏIʉ@A1:A9:󎚂Ȃ)
004140 01 Zvgt敪v                 PIC 9 VALUE ZERO.
004150 01 Zvgғt敪v             PIC 9 VALUE ZERO.
004160*
004170** p
004180 01 {pNv                       PIC 9(4)  VALUE ZERO.
004190 01 v                               PIC 9(3)  VALUE ZERO.
004200 01 ]v                               PIC 9(3)  VALUE ZERO.
004210*
004220** }Ԕp
004230 01 JnfÓ蓮敪v               PIC 9     VALUE ZERO.
004240*
004250** 於̗p
004260 01 於̂sak.
004270    03 於̂vs                  PIC X(2)  OCCURS 20 VALUE SPACE.
004280 01 於̂vsP                   PIC X(2)  VALUE SPACE.
004290 01 xv                       PIC X(40) VALUE SPACE.
004300*
004310* Еۗp
004320 01 ڔ敪v                       PIC 9     VALUE ZERO.
004330*
004340* یҔԍ
004350 01 یҔԍrv                   PIC X(6)   VALUE SPACE.
004360*
004370** Sp
004380 01 Sv                     PIC 9     VALUE ZERO.
004390 01 Sv                         PIC 9(2)  VALUE ZERO.
004400 01 Œv                         PIC N     VALUE SPACE.
004410*
004420* [Œ󎚗p
004430 01 یҎŒv                 PIC N(10)  VALUE SPACE.
004440 01 NŒv                     PIC N(4)   VALUE SPACE.
004450 01 یҏZŒv                 PIC N(10)  VALUE SPACE.
004460 01 ϔCŒv                         PIC N(4)   VALUE SPACE.
004470 01 όŒv                       PIC N(15)  VALUE SPACE.
004480*
004490* ϔCp
004500* 01 ϔCPv                     PIC N(18)  VALUE SPACE.
004510* 01 ϔCQv.
004520*    03 ϔCQPv                PIC N(4)   VALUE SPACE.
004530*    03 v                        PIC N(5)   VALUE SPACE.
004540*    03 ϔCQQv                PIC N(9)   VALUE SPACE.
       01 ϔCv.
      */͂̕ύX/20190307
      *    03 ϔCPv                  PIC X(45)  VALUE SPACE.
      *    03 ϔCQv                  PIC X(45)  VALUE SPACE.
      *    03 ϔCRv                  PIC X(45)  VALUE SPACE.
          03 ϔCPv                  PIC X(50)  VALUE SPACE.
          03 ϔCQv                  PIC X(50)  VALUE SPACE.
          03 ϔCRv                  PIC X(50)  VALUE SPACE.
      */͂̕ύX/20190307
004550*
004560*
004570** ZEvp( N(38)Œj /
004580 01 ̌o߂v.
004590*    03 ̌oߍsv                  PIC X(76) OCCURS 2 VALUE SPACE.
004590    03 ̌oߍsv                  PIC X(64) OCCURS 2 VALUE SPACE.
004600 01 ̌o߂mv REDEFINES ̌o߂v.
004610*    03 ̌oߍsmv                PIC N(38) OCCURS 2.
004610    03 ̌oߍsmv                PIC N(32) OCCURS 2.
004620*
004621* 敪
004622 01 Z敪v             PIC 9    VALUE ZERO.
002580 01 ZR敪v             PIC 9    VALUE ZERO.
      *
      */qE^Â̕ύXEǉ/1805
       01 qbl                       PIC X(200) VALUE SPACE.
       01 ^Âbl                       PIC X(68)  VALUE SPACE.
004623*
004770******************************
004780* T  Ev  ҏWp *
004790******************************
004800 01 ʂTv.
004840   03 JnTv.
004850      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
004870      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
         03 ʂPv                         PIC X(1).
004890   03 ÂTv.
            05 ʂQv                      PIC X(1).
004900      05 ÒPTv                  PIC ZZZZ.
            05 ZLPv                  PIC X(1).
004920      05 É񐔂Tv                  PIC ZZ.
            05 CR[Pv                  PIC X(1).
004940      05 ×Tv                    PIC ZZ,ZZZ.
         03 ʂRv                         PIC X(1).
         03 ZLPv                     PIC X(1).
         03 ʂSv                         PIC X(1).
004960   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLQv                  PIC X(1).
004970      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Qv                  PIC X(1).
004990      05 㪖@Tv                  PIC ZZZZ.
         03 ʂTv                         PIC X(1).
         03 ZLQv                     PIC X(1).
         03 ʂUv                         PIC X(1).
005010   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLRv                  PIC X(1).
005020      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Rv                  PIC X(1).
005040      05 㪖@Tv                  PIC ZZZZ.
         03 ʂVv                         PIC X(1).
         03 ZLRv                     PIC X(1).
         03 ʂWv                         PIC X(1).
005060   03 dÂTv.
            05 dÒPTv                  PIC Z(2).
            05 ZLSv                  PIC X(1).
005070      05 dÉ񐔂Tv                  PIC ZZ.
            05 CR[Sv                  PIC X(1).
005090      05 d×Tv                    PIC ZZZZ.
            05 ʂXv                      PIC X(1).
         03 ʂPOv                       PIC X(1).
         03 ZLTv                     PIC X(1).
005130   03 ʗTv                     PIC X(3).
         03 ZLUv                     PIC X(1).
005170   03 Tv                   PIC 9.9.
         03 CR[Tv                     PIC X(1).
005190   03 vTv                   PIC ZZ,ZZZ.
005210*
004630****************
004640* AڑҔ *
004650****************
004660*    ************
004670*    * L[ *
004680*    ************
004690 01 Ώۃf[^vq.
004700    03 {paNvq.
004710       05 {pavq                  PIC 9(1)  VALUE ZERO.
004720       05 {pNvq                    PIC 9(2)  VALUE ZERO.
004730       05 {pvq                    PIC 9(2)  VALUE ZERO.
004740    03 یʂvq                     PIC 9(2)  VALUE ZERO.
004750    03 یҔԍvq                   PIC X(10) VALUE SPACE.
004760    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004770    03 pSҔԍvq               PIC X(10) VALUE SPACE.
004780    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004790    03 pSҔԍvq           PIC X(10) VALUE SPACE.
004800    03 {lƑ敪vq                 PIC 9(1)  VALUE ZERO.
004810    03 ҃Jivq                     PIC X(20) VALUE SPACE.
004820    03 ҃R[hvq.
004830       05 Ҕԍvq                  PIC 9(6)  VALUE ZERO.
004840       05 }Ԃvq                      PIC X(1)  VALUE SPACE.
004850*
004860*    ****************
004870*    * { *
004880*    ****************
004890 01 {v.
004900   03 㪖@Pv                      PIC 9(4)  VALUE ZERO.
004910   03 㪖@Pv                      PIC 9(4)  VALUE ZERO.
004920   03 dÒPv                        PIC 9(4)  VALUE ZERO.
004930*    ************
004940*    *  *
004950*    ************
004960*    ̗
004970***********************
004980 01 Pvq.
004990   03 vq.
005000      05 Svq               PIC 9(3)    VALUE ZERO.
005010      05 vq                 PIC 9(5)    VALUE ZERO.
005020      05 Zvq             PIC 9(5)    VALUE ZERO.
         03 kvq              PIC 9(4)    VALUE ZERO.
005030   03 Čvq                    PIC 9(5)    VALUE ZERO.
005040   03 Âvq.
005050      05 Ëvq               PIC 9(2)V9  VALUE ZERO.
005060      05 É񐔂vq               PIC 9(2)    VALUE ZERO.
005070      05 ×vq                 PIC 9(5)    VALUE ZERO.
005080      05 ÉZvq             PIC 9(5)    VALUE ZERO.
005090   03 qZvq            PIC 9(5)    VALUE ZERO.
005100   03 {p񋟗vq            PIC 9(5)    VALUE ZERO.
005110   03 vvq                      PIC 9(6)    VALUE ZERO.
005120   03 ꕔSvq                PIC 9(6)    VALUE ZERO.
005130   03 zvq                  PIC 9(6)    VALUE ZERO.
005140   03 tvq                  PIC 9(1)    VALUE ZERO.
005150   03 󋋎ҕSzvq              PIC 9(6)    VALUE ZERO.
005160   03 zvq              PIC 9(6)    VALUE ZERO.
005170*
005180* ʖ̗
005190***********************
005200 01 Qvq.
005210   03 񏈒uvq    OCCURS   9.
005220      05 񏈒uvq             PIC 9(5)    VALUE ZERO.
005230*
005240* ̗
005250***********************
005260 01 Rvq.
005270**********
005280* P *
005290**********
005300   03 ʂPvq.
005310      05 ÂPvq.
005320         07 ÒPPvq              PIC 9(4)    VALUE ZERO.
005330         07 É񐔂Pvq              PIC 9(2)    VALUE ZERO.
005340         07 ×Pvq                PIC 9(5)    VALUE ZERO.
005350      05 㪖@Pvq.
005360         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
005370         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
005380      05 㪖@Pvq.
005390         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
005400         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
005410      05 dÂPvq.
005420         07 dÉ񐔂Pvq              PIC 9(2)    VALUE ZERO.
005430         07 d×Pvq                PIC 9(4)    VALUE ZERO.
005440      05 vPvq                     PIC 9(6)    VALUE ZERO.
005450      05 Pvq               PIC 9(3)    VALUE ZERO.
005460      05 vPvq               PIC 9(6)    VALUE ZERO.
005470**********
005480* Q *
005490**********
005500   03 ʂQvq.
005510      05 ÂQvq.
005520         07 ÒPQvq              PIC 9(4)    VALUE ZERO.
005530         07 É񐔂Qvq              PIC 9(2)    VALUE ZERO.
005540         07 ×Qvq                PIC 9(5)    VALUE ZERO.
005550      05 㪖@Qvq.
005560         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
005570         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
005580      05 㪖@Qvq.
005590         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
005600         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
005610      05 dÂQvq.
005620         07 dÉ񐔂Qvq              PIC 9(2)    VALUE ZERO.
005630         07 d×Qvq                PIC 9(4)    VALUE ZERO.
005640      05 vQvq                     PIC 9(6)    VALUE ZERO.
005650      05 Qvq               PIC 9(3)    VALUE ZERO.
005660      05 vQvq               PIC 9(6)    VALUE ZERO.
005670******************
005680* Rʁ^W *
005690******************
005700   03 ʂRWvq.
005710      05 ÂRWvq.
005720         07 ÒPRWvq              PIC 9(4)  VALUE ZERO.
005730         07 É񐔂RWvq              PIC 9(2)  VALUE ZERO.
005740         07 ×RWvq                PIC 9(5)  VALUE ZERO.
005750      05 㪖@RWvq.
005760         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005770         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005780      05 㪖@RWvq.
005790         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005800         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005810      05 dÂRWvq.
005820         07 dÉ񐔂RWvq              PIC 9(2)  VALUE ZERO.
005830         07 d×RWvq                PIC 9(4)  VALUE ZERO.
005840      05 vRWvq                     PIC 9(6)  VALUE ZERO.
005850      05 ʍvRWvq             PIC 9(6)  VALUE ZERO.
005860      05 RWvq               PIC 9(3)  VALUE ZERO.
005870      05 vRWvq               PIC 9(6)  VALUE ZERO.
005880******************
005890* Rʁ^PO *
005900******************
005910   03 ʂROvq.
005920      05 JnROvq.
005930         07 JnROvq            PIC 9(2)  VALUE ZERO.
005940         07 JnROvq            PIC 9(2)  VALUE ZERO.
005950      05 ÂROvq.
005960         07 ÒPROvq              PIC 9(4)  VALUE ZERO.
005970         07 É񐔂ROvq              PIC 9(2)  VALUE ZERO.
005980         07 ×ROvq                PIC 9(5)  VALUE ZERO.
005990      05 㪖@ROvq.
006000         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
006010         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
006020      05 㪖@ROvq.
006030         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
006040         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
006050      05 dÂROvq.
006060         07 dÉ񐔂ROvq              PIC 9(2)  VALUE ZERO.
006070         07 d×ROvq                PIC 9(4)  VALUE ZERO.
006080      05 vROvq                     PIC 9(6)  VALUE ZERO.
006090      05 ROvq               PIC 9(3)  VALUE ZERO.
006100      05 vROvq               PIC 9(6)  VALUE ZERO.
006110****************
006120* Sʁ^T *
006130****************
006140   03 ʂSTvq.
006150      05 ÂSTvq.
006160         07 ÒPSTvq              PIC 9(4)  VALUE ZERO.
006170         07 É񐔂STvq              PIC 9(2)  VALUE ZERO.
006180         07 ×STvq                PIC 9(5)  VALUE ZERO.
006190      05 㪖@STvq.
006200         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
006210         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
006220      05 㪖@STvq.
006230         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
006240         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
006250      05 dÂSTvq.
006260         07 dÉ񐔂STvq              PIC 9(2)  VALUE ZERO.
006270         07 d×STvq                PIC 9(4)  VALUE ZERO.
006280      05 vSTvq                     PIC 9(6)  VALUE ZERO.
006290      05 ʍvSTvq             PIC 9(6)  VALUE ZERO.
006300      05 STvq               PIC 9(3)  VALUE ZERO.
006310      05 vSTvq               PIC 9(6)  VALUE ZERO.
006320****************
006330* Sʁ^W *
006340****************
006350   03 ʂSWvq.
006360      05 JnSWvq.
006370         07 JnSWvq            PIC 9(2)  VALUE ZERO.
006380         07 JnSWvq            PIC 9(2)  VALUE ZERO.
006390      05 ÂSWvq.
006400         07 ÒPSWvq              PIC 9(4)  VALUE ZERO.
006410         07 É񐔂SWvq              PIC 9(2)  VALUE ZERO.
006420         07 ×SWvq                PIC 9(5)  VALUE ZERO.
006430      05 㪖@SWvq.
006440         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
006450         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
006460      05 㪖@SWvq.
006470         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
006480         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
006490      05 dÂSWvq.
006500         07 dÉ񐔂SWvq              PIC 9(2)  VALUE ZERO.
006510         07 d×SWvq                PIC 9(4)  VALUE ZERO.
006520      05 vSWvq                     PIC 9(6)  VALUE ZERO.
006530      05 ʍvSWvq             PIC 9(6)  VALUE ZERO.
006540      05 SWvq               PIC 9(3)  VALUE ZERO.
006550      05 vSWvq               PIC 9(6)  VALUE ZERO.
006560******************
006570* Sʁ^PO *
006580******************
006590   03 ʂSOvq.
006600      05 JnSOvq.
006610         07 JnSOvq            PIC 9(2)  VALUE ZERO.
006620         07 JnSOvq            PIC 9(2)  VALUE ZERO.
006630      05 ÂSOvq.
006640         07 ÒPSOvq              PIC 9(4)  VALUE ZERO.
006650         07 É񐔂SOvq              PIC 9(2)  VALUE ZERO.
006660         07 ×SOvq                PIC 9(5)  VALUE ZERO.
006670      05 㪖@SOvq.
006680         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006690         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006700      05 㪖@SOvq.
006710         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006720         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006730      05 dÂSOvq.
006740         07 dÉ񐔂SOvq              PIC 9(2)  VALUE ZERO.
006750         07 d×SOvq                PIC 9(4)  VALUE ZERO.
006760      05 vSOvq                     PIC 9(6)  VALUE ZERO.
006770      05 SOvq               PIC 9(3)  VALUE ZERO.
006780      05 vSOvq               PIC 9(6)  VALUE ZERO.
006790********************
006800* Tʁ^QDT *
006810********************
006820   03 ʂTQvq.
006830      05 ÂTQvq.
006840         07 ÒPTQvq              PIC 9(4)  VALUE ZERO.
006850         07 É񐔂TQvq              PIC 9(2)  VALUE ZERO.
006860         07 ×TQvq                PIC 9(5)  VALUE ZERO.
006870      05 㪖@TQvq.
006880         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006890         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006900      05 㪖@TQvq.
006910         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006920         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006930      05 dÂTQvq.
006940         07 dÉ񐔂TQvq              PIC 9(2)  VALUE ZERO.
006950         07 d×TQvq                PIC 9(4)  VALUE ZERO.
006960      05 vTQvq                     PIC 9(6)  VALUE ZERO.
006970      05 ʍvTQvq             PIC 9(6)  VALUE ZERO.
006980      05 TQvq               PIC 9(3)  VALUE ZERO.
006990      05 vTQvq               PIC 9(6)  VALUE ZERO.
007000****************
007010* Tʁ^T *
007020****************
007030   03 ʂTTvq.
007040      05 JnTTvq.
007050         07 JnTTvq            PIC 9(2)  VALUE ZERO.
007060         07 JnTTvq            PIC 9(2)  VALUE ZERO.
007070      05 ÂTTvq.
007080         07 ÒPTTvq              PIC 9(4)  VALUE ZERO.
007090         07 É񐔂TTvq              PIC 9(2)  VALUE ZERO.
007100         07 ×TTvq                PIC 9(5)  VALUE ZERO.
007110      05 㪖@TTvq.
007120         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
007130         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
007140      05 㪖@TTvq.
007150         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
007160         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
007170      05 dÂTTvq.
007180         07 dÉ񐔂TTvq              PIC 9(2)  VALUE ZERO.
007190         07 d×TTvq                PIC 9(4)  VALUE ZERO.
007200      05 vTTvq                     PIC 9(6)  VALUE ZERO.
007210      05 ʍvTTvq             PIC 9(6)  VALUE ZERO.
007220      05 TTvq               PIC 9(3)  VALUE ZERO.
007230      05 vTTvq               PIC 9(6)  VALUE ZERO.
007240****************
007250* Tʁ^W *
007260****************
007270   03 ʂTWvq.
007280      05 JnTWvq.
007290         07 JnTWvq            PIC 9(2)  VALUE ZERO.
007300         07 JnTWvq            PIC 9(2)  VALUE ZERO.
007310      05 ÂTWvq.
007320         07 ÒPTWvq              PIC 9(4)  VALUE ZERO.
007330         07 É񐔂TWvq              PIC 9(2)  VALUE ZERO.
007340         07 ×TWvq                PIC 9(5)  VALUE ZERO.
007350      05 㪖@TWvq.
007360         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
007370         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
007380      05 㪖@TWvq.
007390         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
007400         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
007410      05 dÂTWvq.
007420         07 dÉ񐔂TWvq              PIC 9(2)  VALUE ZERO.
007430         07 d×TWvq                PIC 9(4)  VALUE ZERO.
007440      05 vTWvq                     PIC 9(6)  VALUE ZERO.
007450      05 ʍvTWvq             PIC 9(6)  VALUE ZERO.
007460      05 TWvq               PIC 9(3)  VALUE ZERO.
007470      05 vTWvq               PIC 9(6)  VALUE ZERO.
007480******************
007490* Tʁ^PO *
007500******************
007510   03 ʂTOvq.
007520      05 JnTOvq.
007530         07 JnTOvq            PIC 9(2)  VALUE ZERO.
007540         07 JnTOvq            PIC 9(2)  VALUE ZERO.
007550      05 ÂTOvq.
007560         07 ÒPTOvq              PIC 9(4)  VALUE ZERO.
007570         07 É񐔂TOvq              PIC 9(2)  VALUE ZERO.
007580         07 ×TOvq                PIC 9(5)  VALUE ZERO.
007590      05 㪖@TOvq.
007600         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
007610         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
007620      05 㪖@TOvq.
007630         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
007640         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
007650      05 dÂTOvq.
007660         07 dÉ񐔂TOvq              PIC 9(2)  VALUE ZERO.
007670         07 d×TOvq                PIC 9(4)  VALUE ZERO.
007680      05 vTOvq                     PIC 9(6)  VALUE ZERO.
007690      05 TOvq               PIC 9(3)  VALUE ZERO.
007700      05 vTOvq               PIC 9(6)  VALUE ZERO.
007710*
007720**************
007730* {p *
007740**************
007750 01 {pv.
007760    03 _tԍv                    PIC X(22)  VALUE SPACE.
007760*    03 _tԍv.
007760*       05 _tԍPv               PIC X(9)  VALUE SPACE.
007760*       05 _tԍQv               PIC X(1)  VALUE SPACE.
007760*       05 _tԍRv               PIC X(1)  VALUE SPACE.
007760*       05 _tԍSv               PIC X(1)  VALUE SPACE.
007760*       05 _tԍTv               PIC X(1)  VALUE SPACE.
007770    03 ϔԍv                      PIC X(24)  VALUE SPACE.
007780    03 ڍtԍv.
007790       05 ڍtv                 PIC X(8)   VALUE SPACE.
007800       05 ڍtԍv           PIC X(10)  VALUE SPACE.
007810    03 \҃Jiv                    PIC X(50)  VALUE SPACE.
007820    03 \Җv                      PIC X(50)  VALUE SPACE.
007830    03 ڍ@v                      PIC X(50)  VALUE SPACE.
          03 s{ihrv                PIC X(2)   VALUE SPACE.
007840    03 {pZv.
007850       05 {pZPv               PIC X(50)  VALUE SPACE.
007860       05 {pZQv               PIC X(50)  VALUE SPACE.
007870*    03 {pZv.
007880*       05 {pZPv               PIC X(28)  VALUE SPACE.
007890*       05 {pZQv               PIC X(28)  VALUE SPACE.
007900*       05 {pZRv               PIC X(28)  VALUE SPACE.
007910*
007920    03 {pX֔ԍv.
007930       05 {pX֔ԍPv           PIC X(3)   VALUE SPACE.
007940       05 {pX֔ԍQv           PIC X(4)   VALUE SPACE.
007950    03 {pdbԍv                PIC X(15)  VALUE SPACE.
007960    03 z󗝔ԍv                PIC X(15)  VALUE SPACE.
007970    03 󗝔Nv.
007980       05 󗝔Nv                     PIC 9(2)   VALUE ZERO.
007990       05 󗝌v                     PIC 9(2)   VALUE ZERO.
008000       05 󗝓v                     PIC 9(2)   VALUE ZERO.
008010    03 ŏIʉ@Nv.
008020       05 ŏIʉ@Nv                 PIC 9(2)   VALUE ZERO.
008030       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
008040       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
008050    03 _tNv.
008060       05 _tNv                   PIC 9(2)   VALUE ZERO.
008070       05 _tv                   PIC 9(2)   VALUE ZERO.
008080       05 _tv                   PIC 9(2)   VALUE ZERO.
008090    03 ҈ϔCNv.
008100       05 ҈ϔCNv                 PIC 9(2)   VALUE ZERO.
008110       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
008120       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
008130    03 v.
008140       05 sv               PIC X(40)  VALUE SPACE.
008150       05 sxXv           PIC X(40)  VALUE SPACE.
008160       05 aʂv                   PIC 9(1)   VALUE ZERO.
008170       05 ԍv                   PIC X(10)  VALUE SPACE.
008180       05 `lv                 PIC X(40)  VALUE SPACE.
008190       05 `lJiv             PIC X(40)  VALUE SPACE.
008200       05 sxXv               PIC X(60)  VALUE SPACE.
008210       05 aʃRgv           PIC N(4)   VALUE SPACE.
          03 x@.
             05 Z@֖v.
                07 Z@֖Pv            PIC X(8) VALUE SPACE.
                07 Z@֖Qv            PIC X(8) VALUE SPACE.
                07 Z@֖Rv            PIC X(8) VALUE SPACE.
                07 Z@֖Sv            PIC X(8) VALUE SPACE.
             05 xXv.
                07 xXPv                PIC X(8) VALUE SPACE.
                07 xXQv                PIC X(8) VALUE SPACE.
                07 xXRv                PIC X(8) VALUE SPACE.
                07 xXSv                PIC X(8) VALUE SPACE.
             05 U`FbNv               PIC N(1)  VALUE SPACE.
             05 ʃ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
             05 s`FbNv               PIC N(1)  VALUE SPACE.
             05 Ƀ`FbNv               PIC N(1)  VALUE SPACE.
             05 _`FbNv               PIC N(1)  VALUE SPACE.
             05 {X`FbNv               PIC N(1)  VALUE SPACE.
             05 xX`FbNv               PIC N(1)  VALUE SPACE.
             05 {x`FbNv             PIC N(1)  VALUE SPACE.
008220    03 {phcv                    PIC X(15)  VALUE SPACE.
008230    03 s{phcv                PIC X(15)  VALUE SPACE.
008240**************
008250* fҏ *
008260**************
008270 01 fҏv.
008280*    03 {pav                      PIC N(2)  VALUE SPACE.
      */C/20190408
          03 {pav                      PIC 9(1)   VALUE ZERO.
008290    03 {pNv.
008300       05 {pNv                     PIC 9(2)   VALUE ZERO.
008310       05 {pv                     PIC 9(2)   VALUE ZERO.
008320*    03 Lv                          PIC N(12)  VALUE SPACE.
007570    03 Lv.
007580       05 Lv                   PIC N(12)  VALUE SPACE.
008330*
008340    03 ԍv.
008350       05 ԍv                   PIC X(15)  VALUE SPACE.
008360       05 FILLER                       PIC X(15)  VALUE SPACE.
008370*    03 ԍv.
008380*       05 ԍPv                 PIC X(10)  VALUE SPACE.
008390*       05 ԍQv                 PIC X(10)  VALUE SPACE.
008400*       05 FILLER                       PIC X(10)  VALUE SPACE.
008410*
          03 Lԍv.
             05 Lԍwv                 PIC X(40) VALUE SPACE.
008420    03 یҔԍv.
008430       05 یҔԍv             PIC X(8)   VALUE SPACE.
008440       05 FILLER                       PIC X(2)   VALUE SPACE.
008450*
008460    03 sԍv.
008470       05 sԍv             PIC X(8)   VALUE SPACE.
008480       05 FILLER                       PIC X(2)   VALUE SPACE.
001250*    03 vҔԍv                PIC X(20)  VALUE SPACE.
          03 󋋎Ҕԍv.
             05 󋋎Ҕԍv             PIC X(7)  VALUE SPACE.
             05 󋋎ҔԍQv           PIC X(8)  VALUE SPACE.
008490*
008500    03 於̂v.
008510       05 於̂Pv           PIC X(48)  VALUE SPACE.
008520       05 於̂Qv           PIC X(48)  VALUE SPACE.
008530*
008540    03 یʂv                      PIC 9(2)   VALUE ZERO.
008550    03 یҏv.
008560       05 ی҃Jiv               PIC X(50)  VALUE SPACE.
008570       05 یҎv               PIC X(50)  VALUE SPACE.
008580       05 یҐʂv               PIC N(1)   VALUE SPACE.
008590       05 یҌv               PIC N(2)   VALUE SPACE.
008600       05 یҔNv                 PIC 9(2)   VALUE ZERO.
008610       05 یҌv                 PIC 9(2)   VALUE ZERO.
008620       05 یғv                 PIC 9(2)   VALUE ZERO.
008630       05 X֔ԍv.
008640          07 X֔ԍPv              PIC X(3)   VALUE SPACE.
008650          07 X֔ԍQv              PIC X(4)   VALUE SPACE.
008660       05 یҏZPv             PIC X(50)  VALUE SPACE.
008670       05 یҏZQv             PIC X(50)  VALUE SPACE.
008990       05 dbԍv                   PIC X(35)  VALUE SPACE.
008680    03 ҏv.
008690       05 ҃Jiv                   PIC X(50)  VALUE SPACE.
008700       05 Ҏv                   PIC X(50)  VALUE SPACE.
008710       05 Ґʂv                   PIC X(4)   VALUE SPACE.
008720       05 ʃ`FbNv.
008730          07 j`FbNv              PIC N(1)   VALUE SPACE.
008740          07 `FbNv              PIC N(1)   VALUE SPACE.
008750       05 a`FbNv.
008760          07 `FbNv            PIC N(1)   VALUE SPACE.
008770          07 吳`FbNv            PIC N(1)   VALUE SPACE.
008780          07 a`FbNv            PIC N(1)   VALUE SPACE.
008790          07 `FbNv            PIC N(1)   VALUE SPACE.
008800          07 v                    PIC N(2)   VALUE SPACE.
      */C/20190408
008210          07 ߘa`FbNv            PIC N(1)  VALUE SPACE.
                07 ߘablv                PIC X(4)  VALUE SPACE.
009110*          07 v                    PIC N(2)  VALUE SPACE.
      */C/20190408
008810       05 ҔNv                     PIC 9(2)   VALUE ZERO.
008820       05 Ҍv                     PIC 9(2)   VALUE ZERO.
008830       05 ғv                     PIC 9(2)   VALUE ZERO.
008840       05 v.
008850          07 v                PIC N(4)   VALUE SPACE.
008860          07 FILLER                    PIC X(4)   VALUE SPACE.
008870*
008880*       05 v                   PIC N(40) OCCURS 27 VALUE SPACE.
      */pΉ/110421
             05 v OCCURS 29.
                07 wv              PIC X(80)  VALUE SPACE.
008890*
008900       05 ȈՑv                   PIC N(2)   VALUE SPACE.
008901       05 یʖ̂vP             PIC N      VALUE SPACE.
008902       05 یʖ̂v               PIC N(4)   VALUE SPACE.
008910       05 یʃ`FbNv.
                07 ۃ`FbNv            PIC N(1)   VALUE SPACE.
                07 `FbNv            PIC N(1)   VALUE SPACE.
                07 g`FbNv            PIC N(1)   VALUE SPACE.
                07 σ`FbNv            PIC N(1)   VALUE SPACE.
                07 `FbNv            PIC N(1)   VALUE SPACE.
                07 ސE`FbNv            PIC N(1)   VALUE SPACE.
                07 q`FbNv            PIC N(1)   VALUE SPACE.
             05 {l`FbNv               PIC N(1)   VALUE SPACE.
             05 Ƒ`FbNv               PIC N(1)   VALUE SPACE.
             05 Pƃ`FbNv               PIC N(1)   VALUE SPACE.
             05 Q`FbNv               PIC N(1)   VALUE SPACE.
             05 `FbNv               PIC N(1)   VALUE SPACE.
             05 V`FbNv               PIC N(1)   VALUE SPACE.
             05 U΃`FbNv               PIC N(1)   VALUE SPACE.
             05 V`FbNv               PIC N(1)   VALUE SPACE.
             05 W`FbNv               PIC N(1)   VALUE SPACE.
             05 X`FbNv               PIC N(1)   VALUE SPACE.
             05 PO`FbNv             PIC N(1)   VALUE SPACE.
008990*
009000*    03 v                        PIC N(1)  VALUE SPACE.
009000    03 v.
009000      05 wv                    PIC X(2)  VALUE SPACE.
009001    03 ʃRgv                  PIC X(16) VALUE SPACE.
009010*
009020****************
009030* f[^e *
009040****************
009050 01 v.
009060    03 ʐv                        PIC 9(1)  VALUE ZERO.
009070    03 ʏv  OCCURS   9.
009080       05 ʂbmsv                 PIC 9(1)  VALUE ZERO.
009090       05 ʃR[hv.
009100          07 ʂv                PIC 9(2)  VALUE ZERO.
009110          07 ʂv                    PIC 9(2)  VALUE ZERO.
009120          07 E敪v                PIC 9(1)  VALUE ZERO.
009130          07 ʒuԍv            PIC 9(2)  VALUE ZERO.
009140       05 v                     PIC N(18) VALUE SPACE.
009150       05 Nv.
009160          07 Nv                  PIC 9(2)  VALUE ZERO.
009170          07 v                  PIC 9(2)  VALUE ZERO.
009180          07 v                  PIC 9(2)  VALUE ZERO.
009190       05 Nv.
009200          07 Nv                  PIC 9(2)  VALUE ZERO.
009210          07 v                  PIC 9(2)  VALUE ZERO.
009220          07 v                  PIC 9(2)  VALUE ZERO.
009230       05 JnNv.
009240          07 JnNv                  PIC 9(2)  VALUE ZERO.
009250          07 Jnv                  PIC 9(2)  VALUE ZERO.
009260          07 Jnv                  PIC 9(2)  VALUE ZERO.
009270       05 INv.
009280          07 INv                  PIC 9(2)  VALUE ZERO.
009290          07 Iv                  PIC 9(2)  VALUE ZERO.
009300          07 Iv                  PIC 9(2)  VALUE ZERO.
009310       05 v                     PIC 9(2)  VALUE ZERO.
009320       05 ]A敪v                   PIC 9(1)  VALUE ZERO.
009330       05 ]A敪`FbNv.
009340          07 `FbNv            PIC N(1)  VALUE SPACE.
009350          07 ~`FbNv            PIC N(1)  VALUE SPACE.
009360          07 ]`FbNv            PIC N(1)  VALUE SPACE.
009370       05 ]Av                       PIC N(2)  VALUE SPACE.
009380       05 JnN擾tO         PIC X(3)  VALUE SPACE.
009390       05 ʋ؂v                   PIC X(1)  VALUE SPACE.
009400       05 oߗ̂v.
009410          07 oߗ̂v            PIC N(5)  VALUE SPACE.
009420          07 FILLER                    PIC X(2)  VALUE SPACE.
009430    03 oߕʂv                      PIC N(1)  VALUE SPACE.
009030    03 o߂bl                        PIC N(4)  VALUE SPACE.
009440    03 VK`FbNv                  PIC N(1)  VALUE SPACE.
009450    03 p`FbNv                  PIC N(1)  VALUE SPACE.
009460    03 敪v                      PIC N(2)  VALUE SPACE.
009470*
009480************
009490*  *
009500************
009510 01 v.
009520    03 Zv.
009530       05 ԊO`FbNv                PIC N(1) VALUE SPACE.
009540       05 x`FbNv                  PIC N(1) VALUE SPACE.
009550       05 [`FbNv                  PIC N(1) VALUE SPACE.
009560       05 ԊOv                        PIC N(3) VALUE SPACE.
009570       05 xv                          PIC N(2) VALUE SPACE.
009580       05 [v                          PIC N(2) VALUE SPACE.
009590       05 Zev                  PIC N(10) VALUE SPACE.
009600    03 ÉZv.
009610       05 ԃ`FbNv                  PIC N(1) VALUE SPACE.
009620*       05 Ð[`FbNv              PIC N(1) VALUE SPACE.
009630       05 H`FbNv                  PIC N(1) VALUE SPACE.
009640       05 \J`FbNv              PIC N(1) VALUE SPACE.
009650    03 q`FbNv.
009660       05 `FbNv                    PIC N(1) VALUE SPACE.
009670       05 `FbNv                    PIC N(1) VALUE SPACE.
009680       05 `FbNv                    PIC N(1) VALUE SPACE.
009690       05 v                        PIC N(1) VALUE SPACE.
009700       05 v                        PIC N(1) VALUE SPACE.
009710       05 v                        PIC N(1) VALUE SPACE.
009720    03 vv                             PIC 9(7) VALUE ZERO.
009730    03 񏈒uvv                   PIC 9(6) VALUE ZERO.
009740    03 񏈒u`FbNv.
009750       05 `FbNv                PIC N(1) VALUE SPACE.
009760       05 Œ藿`FbNv                PIC N(1) VALUE SPACE.
009770       05 {×`FbNv                PIC N(1) VALUE SPACE.
      */qE^Â̕ύXEǉ/1805
          03 񐔂v                         PIC 9(2)  VALUE ZERO.
          03 ^v                           PIC 9(4)  VALUE ZERO.
004300*
004310** Z܂Ƃߗp
004320 01 Z܂Ƃ߃tO               PIC X(3)  VALUE SPACE.
004330 01 ʗ̂v                     PIC N(4)  VALUE SPACE.
004340 01 ʗ̂vQ                   PIC N(4)  VALUE SPACE.
009780************
009790* l *
009800************
009810 01 lv.
009820    03 KpPv                           PIC N(38) VALUE SPACE.
009830    03 KpQv                           PIC N(38) VALUE SPACE.
009840*    03 KpRv                        PIC N(38) VALUE SPACE.
009850*    03 KpSv                        PIC N(38) VALUE SPACE.
009860*    03 o߃Rgv                     PIC N(60) VALUE SPACE.
009870*
009880* O *
009890    03 ZvgǗNv.
009900       05 ZǗIv                  PIC 9(2)  VALUE ZERO.
009910       05 ZǗv                  PIC 9(2)  VALUE ZERO.
009920    03 \Ԃv                       PIC 9(4)  VALUE ZERO.
009870*
002060** }X^p
002140 01 ZvgV敪.
002150    03 ʃZv                      PIC 9 VALUE ZERO.
009930***
      * `FbNp
       01 {paNrv.
         03 {parv                     PIC 9    VALUE ZERO.
         03 {pNrv.
            05 {pNrv                    PIC 9(2) VALUE ZERO.
            05 {prv                    PIC 9(2) VALUE ZERO.
      *
       01 ̓tO                 PIC X(3) VALUE SPACE.
       01 ̓tO               PIC X(3) VALUE SPACE.
       01 ΏۃtO                 PIC X(3) VALUE SPACE.
      */͍ς݂łȂɂȂĂꍇ̓G[/100902
       01 Ώ۔e                   PIC X(3) VALUE SPACE.
       01 ʉ@tO                         PIC X(3) VALUE SPACE.
       01 bv.
           03 v                       PIC 9 OCCURS 31.
       01 JE^ŏv                     PIC 9(2) VALUE ZERO.
       01 JE^Ōv                     PIC 9(2) VALUE ZERO.
      *
       01 {paNbv.
         03 {paNbv.
           05 {pabv                   PIC 9    VALUE ZERO.
           05 {pNbv.
              07 {pNbv                  PIC 9(2) VALUE ZERO.
              07 {pbv                  PIC 9(2) VALUE ZERO.
         03 {pbv                       PIC 9(2) VALUE ZERO.
      */G[\̏C
       01 G[\e                       PIC 9(1) VALUE ZERO.
      *
       01 ʒRv                   PIC 9(3) VALUE ZERO.
      *
009930***
009940 01 .
009950     03 `̖o                     PIC X(8) VALUE SPACE.
009960     03 ڌQo                     PIC X(8) VALUE SPACE.
009970     03 ʂo                     PIC X(2) VALUE SPACE.
009980     03 go.
009990         05 [o.
010000             07 ړo             PIC X(1) VALUE SPACE.
010010             07 ړso             PIC 9(3) VALUE ZERO.
010020         05 ڍאo                 PIC X(2) VALUE SPACE.
010030     03 ʒmo                     PIC X(2) VALUE SPACE.
010040     03 jbgo                   PIC X(8) VALUE SPACE.
010050*
010060 01 vZ@Nv                     PIC 9(2) VALUE ZERO.
010070* tvnqj
010080 01 aINv                       PIC 9(4) VALUE ZERO.
010090 01 vZ@.
010100    03 vZ@N                    PIC 9(4) VALUE ZERO.
010110    03 vZ@                  PIC 9(4) VALUE ZERO.
010120 01 vZ@q REDEFINES vZ@.
010130    03 vZ@I                      PIC 9(2).
010140    03 vZ@t                      PIC 9(6).
010150    03 vZ@tq REDEFINES vZ@t.
010160       05 vZ@N                   PIC 9(4).
010170       05 vZ@Nq REDEFINES vZ@N.
010180         07 vZ@N                   PIC 9(2).
010190         07 vZ@                   PIC 9(2).
010200       05 vZ@                     PIC 9(2).
010210*
      * C Agp
       01  Pv        PIC X(4096).
       01  Qv        PIC X(512).
       01  vOv  PIC X(8)  VALUE "strmoji2".
      *
       01 vOv     PIC X(8) VALUE "MOJI2".
      *
010220******************************************************************
010230*                          A                              *
010240******************************************************************
010250*
010260**  ʓ̓f[^
010270 01 A|̓f[^ϔC IS EXTERNAL.
010280    03 A|ϔC                     PIC 9.
       01 A|̓f[^db IS EXTERNAL.
          03 A|db                     PIC 9.
009190*
       01 A|vr[ IS EXTERNAL.
          03 A|vr[敪          PIC 9.
010300*
010310************
010320* L[ *
010330************
010340*
010350 01 A|Ώۃf[^ IS EXTERNAL.
010360    03 A|{pN.
010370       05 A|{pa                  PIC 9(1).
010380       05 A|{pN                    PIC 9(2).
010390       05 A|{p                    PIC 9(2).
010400    03 A|҃R[h.
010410       05 A|Ҕԍ                  PIC 9(6).
010420       05 A|}                      PIC X(1).
010430    03 A|ی                     PIC 9(2).
010440    03 A|یҔԍ                   PIC X(10).
010450    03 A|                     PIC 9(2).
010460    03 A|pSҔԍ               PIC X(10).
010470    03 A|                     PIC 9(2).
010480    03 A|pSҔԍ           PIC X(10).
010490    03 A|҃Ji                     PIC X(20).
010500    03 A|{lƑ敪                 PIC 9(1).
013930*
013940 01 A|L[ IS EXTERNAL.
013950    03 A|ی                  PIC 9(2).
013960************************
013970** RJ
013980************************
013990 01 Aԁ|L[ IS EXTERNAL.
014000    03 Aԁ|{pN.
014010       05 Aԁ|{pa               PIC 9.
014020       05 Aԁ|{pN                 PIC 9(2).
014030       05 Aԁ|{p                 PIC 9(2).
014040    03  Aԁ|҃R[h.
014050       05 Aԁ|Ҕԍ               PIC 9(6).
014060       05 Aԁ|}                   PIC X.
014070    03 Aԁ|ΏۃtO                PIC X(3).
014080    03 Aԁ|Ԍv.
014090       05 Aԁ|Ԃv                 PIC 9(2) OCCURS 9.
014100*
014110************************
014120* RZbg     *
014130************************
014140 01 A|L[ IS EXTERNAL.
014150    03 A|{pN.
014160       05 A|{pa               PIC 9.
014170       05 A|{pN                 PIC 9(2).
014180       05 A|{p                 PIC 9(2).
014190    03  A|҃R[h.
014200       05 A|Ҕԍ               PIC 9(6).
014210       05 A|}                   PIC X.
014220    03 A|                    PIC 9(2).
014230    03 A|R                    PIC N(63) OCCURS 15.
014240*
014230************************
014240* EvZbg     *
014250************************
014260 01 AE|L[ IS EXTERNAL.
014270    03 AE|{pN.
014280       05 AE|{pa               PIC 9.
014290       05 AE|{pN                 PIC 9(2).
014300       05 AE|{p                 PIC 9(2).
014310    03  AE|҃R[h.
014320       05 AE|Ҕԍ               PIC 9(6).
014330       05 AE|}                   PIC X.
014340    03 AE|                    PIC 9(2).
014350    03 AE|Ev                    PIC X(126) OCCURS 30.
014340    03 AE|敪                  PIC 9(1).
014370*
014761*
014762************************
014763* Z
014764************************
014765 01 AZ|L[ IS EXTERNAL.
014766    03 AZ|{pN.
014767       05 AZ|{pa               PIC 9.
014768       05 AZ|{pN                 PIC 9(2).
014769       05 AZ|{p                 PIC 9(2).
014770    03  AZ|҃R[h.
014771       05 AZ|Ҕԍ               PIC 9(6).
014772       05 AZ|}                   PIC X.
014773    03 AZ|ΏۃtO                PIC X(3).
014774*
014380************************
014390* Z܂Ƃ
014400************************
014410 01 AZ܂Ƃ߁|L[ IS EXTERNAL.
014420    03 AZ܂Ƃ߁|{paN.
014430       05 AZ܂Ƃ߁|{pa               PIC 9.
014440       05 AZ܂Ƃ߁|{pN.
014450          07 AZ܂Ƃ߁|{pN              PIC 9(2).
014460          07 AZ܂Ƃ߁|{p              PIC 9(2).
014470    03 AZ܂Ƃ߁|҃R[h.
014480       05 AZ܂Ƃ߁|Ҕԍ               PIC 9(6).
014490       05 AZ܂Ƃ߁|}                   PIC X(1).
014500**-------------------------------------------------------**
014510*   1:ZvgȂ̖{̂܂Ƃ߂̔
014520*   2:lEp̎ЕۏZ̔
014530    03 AZ܂Ƃ߁|敪                  PIC 9.
014540**-------------------------------------------------------**
014550*  / OUT /@ 0:ΏۊOA1:Ώ
014560    03 AZ܂Ƃ߁|茋                  PIC 9.
014570**
      */S擾of̑Ή1410
       01 A|S擾L[ IS EXTERNAL.
          03 A|{paN.
             05 A|{pa               PIC 9.
             05 A|{pN.
                07 A|{pN              PIC 9(2).
                07 A|{p              PIC 9(2).
          03 A|҃R[h.
             05 A|Ҕԍ               PIC 9(6).
             05 A|}                   PIC X.
          03 A|ەS                PIC 9(3).
          03 A|ۖ{̕S            PIC 9(3).
          03 A|ەS                PIC 9(3).
          03 A|QVVS              PIC 9(3).
          03 A|S                PIC 9(3).
          03 A|ʗpS              PIC 9(3).
000540************************************
000550* v^t@C쐬p           *
000560************************************
000570 01 gAoqse|쐬f[^ IS EXTERNAL.
000580     03 gAoqse|t@C           PIC X(8).
000590     03 gAoqse|vr[敪       PIC 9.
000600     03 gAoqse|[vO     PIC X(8).
000610     03 gAoqse|I[oC         PIC X(8).
000993************************************
000994* v^t@C쐬p       *
000995************************************
000996 01 gAoqse|쐬f[^ IS EXTERNAL.
000997     03 gAoqse|p         PIC X(8).
006490*
      * Íp
       01 AÍ|Í IS EXTERNAL.
          03 AÍ|͏.
             05 AÍ|L               PIC X(24).
             05 AÍ|ԍ               PIC X(30).
             05 AÍ|Í.
               07 AÍ|ÍҔԍ     PIC X(6).
               07 AÍ|ÍL     PIC X.
               07 AÍ|Íԍ     PIC X.
               07 AÍ|ÍL         PIC X(24).
               07 AÍ|Íԍ         PIC X(30).
          03 AÍ|o͏.
             05 AÍ|L       PIC X(24).
             05 AÍ|ԍ       PIC X(30).
      * 
013822*************
013823* 
013824*************
013825 01 Á|L[ IS EXTERNAL.
013826    03 Á|             PIC 9(2).
013827    03 Á|pSҔԍ   PIC X(10).
013828*   / OUT /
013829    03 Á|̏Wc.
013830       05 Á|P            PIC N.
013831       05 Á|              PIC N(4).
013832       05 Á|          PIC N(10).
013833*
001684************************
001685* ptOZbg *
001686************************
       01 Ap|L[ IS EXTERNAL.
          05 Ap|tO            PIC X(3).
          05 Ap|ptO            PIC X(3).
      * 
      */qE^Â̕ύXEǉ/1805
       01 A^|L[ IS EXTERNAL.
          03 A^|{paN.
             05 A^|{pa                  PIC 9(1).
             05 A^|{pN.
                07 A^|{pN                 PIC 9(2).
                07 A^|{p                 PIC 9(2).
          03 A^|҃R[h.
             05 A^|Ҕԍ                  PIC 9(6).
             05 A^|}                      PIC X(1).
          03 A^|ی                     PIC 9(2).
          03 A^|R[h                     PIC 9(2).
          03 A^|p                     PIC 9(1).
          03 A^|q.
             05 A^|qbl              PIC X(200).
             05 A^|q              OCCURS 5.
                07 A^|qaN     OCCURS 3.
                   09 A^|qaN.
                      11 A^|qa     PIC 9(1).
                      11 A^|qN.
                         13 A^|qN    PIC 9(2).
                         13 A^|q    PIC 9(2).
                   09 A^|q          PIC 9(2).
          03 A^|^.
             05 A^|^Âbl              PIC X(100).
             05 A^|^                    PIC 9(2)    OCCURS 5.
001699*
009182* mFbZ[Wp (Qs)
009183 01 AV|L[ IS EXTERNAL.
009184    03  AV|bZ[WP             PIC X(40).
009185    03  AV|bZ[WQ             PIC X(40).
      *
014250******************************************************************
014260*                      PROCEDURE  DIVISION                       *
014270******************************************************************
014280 PROCEDURE               DIVISION.
014290************
014300*           *
014310*    *
014320*           *
014330************
002570     PERFORM v^t@C쐬.
014340     PERFORM .
014350************
014360*           *
014370* 又     *
014380*           *
014390************
014400* 
014410     PERFORM AڑҔ.
014420     PERFORM Zbg.
014430     PERFORM .
014440************
014450*           *
014460* I   *
014470*           *
014480************
014490     PERFORM f҈敪XV.
014500     PERFORM I.
014510     MOVE ZERO  TO PROGRAM-STATUS.
014520     EXIT PROGRAM.
014530*
014540*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
002860*================================================================*
002870 v^t@C쐬 SECTION.
002880*================================================================*
002890*   /  /
002900     MOVE SPACE TO gAoqse|쐬f[^.
002910     INITIALIZE gAoqse|쐬f[^.
002225     MOVE SPACE TO gAoqse|쐬f[^.
002226     INITIALIZE gAoqse|쐬f[^.
002920*
002930*
002940*-- ύXӏ --------------------------------------*
002230*   gppʃZbg
           MOVE "RECE"                TO gAoqse|p.
002970*   gpv^t@CZbg
002971     MOVE "PRTF002"             TO gAoqse|t@C.
002972*
002973*   gp钠[vOZbg
002974     MOVE "YAS6125"             TO gAoqse|[vO.
002975*
002976*-------------------------------------------------------*
002980*
002990*   / vr[敪Zbg /
003000     MOVE A|vr[敪  TO gAoqse|vr[敪.
003010*
003020     CALL   "CRTPRTF".
003030     CANCEL "CRTPRTF".
003040*
014550*================================================================*
014560  SECTION.
014570*================================================================*
014580*
014590     PERFORM t@CI[v.
014600*    /* ݓt擾 */
014610     ACCEPT vZ@t FROM DATE.
014620*    /* 1980`2079N̊ԂŐݒ */
014630     IF vZ@N > 80
014640         MOVE 19 TO vZ@I
014650     ELSE
014660         MOVE 20 TO vZ@I
014670     END-IF.
014680     PERFORM Jg擾.
014690     PERFORM aIN擾.
014700     COMPUTE vZ@Nv = vZ@N - 1988.
014710*================================================================*
014720 t@CI[v SECTION.
014730*
014740     OPEN INPUT   ی҃}X^
014750         MOVE NC"ی" TO t@C.
014760         PERFORM I[v`FbN.
014770     OPEN INPUT   }X^
014780         MOVE NC"" TO t@C.
014790         PERFORM I[v`FbN.
014800     OPEN INPUT   ̃}X^
014810         MOVE NC"" TO t@C.
014820         PERFORM I[v`FbN.
007560     OPEN INPUT   Zvge
007570         MOVE NC"Z" TO t@C.
007580         PERFORM I[v`FbN.
014860     OPEN INPUT   }X^
014870         MOVE NC"" TO t@C.
014880         PERFORM I[v`FbN.
014890     OPEN INPUT   {p}X^
014900         MOVE NC"{" TO t@C.
014910         PERFORM I[v`FbN.
014920     OPEN INPUT   }X^
014930         MOVE NC"" TO t@C.
014940         PERFORM I[v`FbN.
014950     OPEN INPUT   o߃}X^
014960         MOVE NC"o" TO t@C.
014970         PERFORM I[v`FbN.
014980     OPEN INPUT   {pL^e.
014990         MOVE NC"{Le" TO t@C.
015000         PERFORM I[v`FbN.
015010     OPEN INPUT   f[^e.
015020         MOVE NC"" TO t@C.
015030         PERFORM I[v`FbN.
015040     OPEN INPUT   e.
015050         MOVE NC"" TO t@C.
015060         PERFORM I[v`FbN.
015070     OPEN INPUT  hcǗ}X^.
015080         MOVE NC"hc" TO t@C.
015090         PERFORM I[v`FbN.
015100     OPEN I-O   fҏe.
015110         MOVE NC"" TO t@C.
015120         PERFORM I[v`FbN.
015130     OPEN INPUT }X^.
015140         MOVE NC"" TO t@C.
015150         PERFORM I[v`FbN.
015160     OPEN INPUT   }X^.
015170         MOVE NC"" TO t@C.
015180         PERFORM I[v`FbN.
016150     OPEN INPUT s}X^.
016160         MOVE NC"s" TO t@C.
016170         PERFORM I[v`FbN.
           OPEN INPUT vZ}X^.
               MOVE NC"vZ" TO t@C.
               PERFORM I[v`FbN.
015220     OPEN INPUT   ƃt@CQ.
015230         MOVE NC"Q" TO t@C.
015240         PERFORM I[v`FbN.
015250     OPEN I-O   t@C
015260         PERFORM G[o.
015270*================================================================*
015280 I[v`FbN SECTION.
015290*
015300     IF ԃL[  NOT =  "00"
015310         DISPLAY t@C NC"eI[vG[" UPON CONS
015320         DISPLAY NC"ԃL[F" ԃL[         UPON CONS
015330         DISPLAY NC"P͂dmsdqL[Ă"
015340                                                 UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015350         ACCEPT  L[ FROM CONS
015360         PERFORM t@C
015370         EXIT PROGRAM.
015380*================================================================*
015390 Jg擾 SECTION.
015400*
015410     MOVE ZEROS TO |敪.
015420     READ }X^
015430     NOT INVALID KEY
015440         MOVE |Jg         TO Jgv
015450         MOVE |Z敪 TO 敪v
015460         MOVE |ZR敪 TO R敪v
015470         MOVE |Zvgt敪     TO Zvgt敪v
015480         MOVE |Zvgғt敪 TO Zvgғt敪v
017300         MOVE |ۃZ             TO ʃZv
015490     END-READ.
015500*
015510*================================================================*
015520 aIN擾 SECTION.
015530*
015540*     DISPLAY NC"Jgv"  Jgv UPON MSGBOX.
015550     MOVE Jgv TO |敪.
015560     READ }X^
015570     INVALID KEY
015580         DISPLAY NC"wao^Ă܂" UPON CONS
015590         DISPLAY NC"P͂dmsdqL[Ă"
015600                                                  UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015610         ACCEPT  L[ FROM CONS
015620         PERFORM I
015630         EXIT PROGRAM
015640     NOT INVALID KEY
015650         COMPUTE Oav = Jgv - 1
015660         MOVE Oav TO |敪
015670         READ }X^
015680         INVALID KEY
015690             DISPLAY NC"wao^Ă܂" UPON CONS
015700             DISPLAY NC"P͂dmsdqL[Ă"
015710                                                      UPON CONS
000080*-----------------------------------------*
000090             CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015720             ACCEPT  L[ FROM CONS
015730             PERFORM I
015740             EXIT PROGRAM
015750         NOT INVALID KEY
015760             MOVE |IN TO aINv
015770         END-READ
015780     END-READ.
015790*
015800*================================================================*
015810 AڑҔ SECTION.
015820*
015830     MOVE A|{pa           TO {pavq.
015840     MOVE A|{pN             TO {pNvq.
015850     MOVE A|{p             TO {pvq.
015860     MOVE A|ی           TO یʂvq.
015870     MOVE A|یҔԍ         TO یҔԍvq.
015880     MOVE A|           TO ʂvq.
015890     MOVE A|pSҔԍ     TO pSҔԍvq.
015900     MOVE A|           TO ʂvq.
015910     MOVE A|pSҔԍ TO pSҔԍvq.
015920     MOVE A|{lƑ敪       TO {lƑ敪vq.
015930     MOVE A|҃Ji           TO ҃Jivq.
015940     MOVE A|Ҕԍ           TO Ҕԍvq.
015950     MOVE A|}               TO }Ԃvq.
015960*================================================================*
015970 Zbg SECTION.
015980*
015990     PERFORM ڏ.
           PERFORM {擾.
016000     PERFORM {p擾.
           IF ʂvq = 05
016010         PERFORM 擾㍂
           ELSE
016010         PERFORM 擾
           END-IF
016020     PERFORM fҏ擾.
016030     PERFORM f[^擾.
016040     PERFORM 擾.
016050     PERFORM {pL^擾.
016060*******     PERFORM 擾.
016070*******     PERFORM ȑÕf[^.
016080     PERFORM Z擾.
016090     PERFORM 擾.
016100     PERFORM {擾.
016110     PERFORM {pN擾.
016120     PERFORM Zvgя擾.
016130     PERFORM ϔCN擾.
           PERFORM {p擾.
016140*
016791*-----------------------------------------------*
016800     IF ( 敪v  NOT = 1 ) AND ( Z敪v NOT = 1 )
016813        IF ( 敪v = 3 OR 4 )
016815           PERFORM Ώ۔菈
016817        ELSE
016820           PERFORM 擾
016821        END-IF
016830     END-IF.
016831*-----------------------------------------------*
016180*
015940     IF ( R敪v NOT = 1 )
               MOVE R敪v TO AE|敪
016000     END-IF.
016250*
016260     PERFORM S擾.
016270**
016280********************
016290* fҏZbg *
016300********************
016310*
016320*     MOVE {pav          TO {paP {paQ.
016330     MOVE {pNv            TO {pNP.
016340     MOVE {pv            TO {pP.
016350*
           IF ( Lv(1:1) = NC"" )
              MOVE  SPACE          TO  Lv
           END-IF.
           IF ( ԍv(1:1) = "*"  ) OR
              ( ԍv(1:2) = "" )
              MOVE  SPACE          TO  ԍv
           END-IF.
      *
           INSPECT Lv  REPLACING ALL "@" BY "  ".
           EVALUATE TRUE
           WHEN (Lv NOT = SPACE) AND (ԍv NOT = SPACE)
               MOVE SPACE TO ItOQ
               PERFORM VARYING JE^ FROM 24 BY -1
                 UNTIL (JE^ <= ZERO) OR (ItOQ NOT = SPACE)
                   IF Lv(JE^:1) NOT = SPACE
                       MOVE Lv TO Lԍv
                       MOVE "E"   TO Lԍv(JE^ + 1:2)
                       MOVE ԍv TO Lԍv(JE^ + 3:40 - JE^ - 2)
                       MOVE "YES"  TO ItOQ
                   END-IF
               END-PERFORM
               MOVE Lԍv TO Lԍ
           WHEN Lv NOT = SPACE
               MOVE Lv TO Lԍ
           WHEN ԍv NOT = SPACE
               MOVE ԍv TO Lԍ
           END-EVALUATE.
           MOVE ۃ`FbNv   TO ۃ`FbN.
           MOVE `FbNv   TO `FbN.
           MOVE g`FbNv   TO g`FbN.
           MOVE σ`FbNv   TO σ`FbN.
           MOVE `FbNv   TO `FbN.
           MOVE ސE`FbNv   TO ސE`FbN.
           MOVE q`FbNv   TO q`FbN.
           IF q`FbNv NOT = SPACE
               MOVE "7."       TO q`FbNlb
           END-IF.
           MOVE {l`FbNv   TO {l`FbN.
           MOVE Ƒ`FbNv   TO Ƒ`FbN.
           MOVE Pƃ`FbNv   TO Pƃ`FbN.
           MOVE Q`FbNv   TO Q`FbN.
           MOVE `FbNv   TO `FbN.
           MOVE V`FbNv   TO V`FbN.
           MOVE U΃`FbNv   TO U΃`FbN.
           MOVE V`FbNv   TO V`FbN.
           MOVE W`FbNv   TO W`FbN.
           MOVE X`FbNv   TO X`FbN.
           MOVE PO`FbNv TO PO`FbN.
      */C/20190408
037370     IF {pav > 4
              MOVE {pav         TO |敪
037380        READ }X^
037390        NOT INVALID KEY
037400            MOVE |   TO {pa
037410        END-READ
              MOVE "===="             TO {pa
           END-IF.
      */C/20190408
016570*
016580*     MOVE ϔCŒv          TO ϔCŒ.
016590     MOVE یҔԍv    TO یҔԍ.
016600*     MOVE 於̂v        TO یҖ.
016610     MOVE 於̂Pv  TO یҖ̂P.
016620     MOVE 於̂Qv  TO یҖ̂Q.
016630*     MOVE یʖ̂v      TO ی.
016640*     MOVE یҎŒv  TO Œ.
016650*     MOVE ی҃Jiv      TO ی҃Ji.
016660     MOVE یҎv      TO یҎ.
016670*     MOVE یҐʂv      TO یҐ.
016671***
016672*     IF ( یҔNv NOT = ZERO ) AND ( یҌv NOT = ZERO ) AND ( یғv NOT = ZERO ) 
016680*        MOVE NŒv      TO NŒ
016690*        MOVE یҌv      TO یҌ
016700*        MOVE یҔNv        TO یҔN
016710*        MOVE NC"N"              TO یҔNŒ
016720*        MOVE یҌv        TO یҌ
016730*        MOVE NC""              TO یҌŒ
016740*        MOVE یғv        TO یғ
016750*        MOVE NC""              TO یғŒ
016751*     END-IF.
016760***
      */ X֔ԍEdbԍǉ /42505
           IF ({paNvq >= 42505) AND (A|db = 1)
              IF (|_X֓dbԍ = 0 OR 2) AND
                 ((X֔ԍPv NOT = SPACE) OR (X֔ԍQv NOT = SPACE))
017280           MOVE ""          TO X
017260           MOVE X֔ԍPv  TO X֔ԍP
017270           MOVE X֔ԍQv  TO X֔ԍQ
017280           MOVE "-"           TO X֔ԍ
              END-IF
              IF |_X֓dbԍ = 0 OR 3
017260           MOVE dbԍv    TO dbԍ
              END-IF
           END-IF.
016800     MOVE یҏZPv    TO ZP.
016810     MOVE یҏZQv    TO ZQ.
016820     MOVE ҃Jiv          TO ҃Ji.
016830     MOVE Ҏv          TO Ҏ.
016840*     MOVE Ґʂv          TO Ґ.
016850     MOVE j`FbNv        TO j`FbN.
016860     MOVE `FbNv        TO `FbN.
016870     MOVE `FbNv      TO `FbN.
016880     MOVE 吳`FbNv      TO 吳`FbN.
016890     MOVE a`FbNv      TO a`FbN.
016900     MOVE `FbNv      TO `FbN.
016910*     MOVE v              TO .
      */C/20190408
           MOVE ߘablv         TO ߘabl.
023070     MOVE ߘa`FbNv     TO ߘa`FbN.
017390*     MOVE v              TO Ҙa.
      */C/20190408
016920     MOVE ҔNv            TO ҔN.
016930*     MOVE NC"N"              TO ҔNŒ.
016940     MOVE Ҍv            TO Ҍ.
016950*     MOVE NC""              TO ҌŒ.
016960     MOVE ғv            TO ғ.
016970*     MOVE NC""              TO ғŒ.
      */{͖̏{̂ɕSҔԍA󋋎ҔԍLڂ
           IF sԍv(3:2) = "27"
               IF sԍv(1:2) NOT = "99"
                   MOVE sԍv TO SҔԍ
               END-IF
      */󋋎ҔԍWȏ̏ꍇg𖳎Ĉ/110425
               IF 󋋎ҔԍQv = SPACE
                   MOVE 󋋎Ҕԍv TO 󋋎Ҕԍ
               ELSE
                   MOVE 󋋎Ҕԍv     TO 󋋎ҔԍQ
               END-IF
           END-IF.
016980*     MOVE v          TO .
016990* 
017000*     MOVE NC"iƖЊQEʋ΍ЊQ͑Oҍs׈ȊǑɂj" 
017010*                              TO O.
017020     MOVE v(1)       TO P.
017030     MOVE v(2)       TO Q.
017040     MOVE v(3)       TO R.
017050     MOVE v(4)       TO S.
017060     MOVE v(5)       TO T.
017060     MOVE v(6)       TO U.
017070*
017080     MOVE v            TO P Q.
017090     IF v NOT = NC"@"
017100        MOVE NC""           TO ŒP ŒQ
017110     END-IF.
017120*
017260********************
017270* f[^Zbg *
017280********************
017290* P *
017300**********
017310     MOVE v(1)       TO P.
017320     MOVE Nv(1)       TO NP.
017330     MOVE v(1)       TO P.
017340     MOVE v(1)       TO P.
017350     MOVE Nv(1)       TO NP.
017360     MOVE v(1)       TO P.
017370     MOVE v(1)       TO P.
017380     MOVE JnNv(1)       TO JnNP.
017390     MOVE Jnv(1)       TO JnP.
017400     MOVE Jnv(1)       TO JnP.
017410     MOVE INv(1)       TO INP.
017420     MOVE Iv(1)       TO IP.
017430     MOVE Iv(1)       TO IP.
017440     MOVE v(1)       TO P.
017450     MOVE `FbNv(1) TO `FbNP.
017460     MOVE ~`FbNv(1) TO ~`FbNP.
017470     MOVE ]`FbNv(1) TO ]`FbNP.
017480*
017490*     MOVE ]Av(1)         TO ]AP.
017500*     IF Nv(1) NOT = ZERO
017510*        MOVE "."            TO ؂PP ؂PQ
017520*     END-IF.
017530*     IF Nv(1) NOT = ZERO
017540*        MOVE "."            TO ؂PR ؂PS
017550*     END-IF.
017560*     IF JnNv(1) NOT = ZERO
017570*        MOVE "."            TO ؂PT ؂PU
017580*     END-IF.
017590*     IF INv(1) NOT = ZERO
017600*        MOVE "."            TO ؂PV ؂PW
017610*     END-IF.
017620**********
017630* Q *
017640**********
017650     MOVE v(2)       TO Q.
017660     MOVE Nv(2)       TO NQ.
017670     MOVE v(2)       TO Q.
017680     MOVE v(2)       TO Q.
017690     MOVE Nv(2)       TO NQ.
017700     MOVE v(2)       TO Q.
017710     MOVE v(2)       TO Q.
017720     MOVE JnNv(2)       TO JnNQ.
017730     MOVE Jnv(2)       TO JnQ.
017740     MOVE Jnv(2)       TO JnQ.
017750     MOVE INv(2)       TO INQ.
017760     MOVE Iv(2)       TO IQ.
017770     MOVE Iv(2)       TO IQ.
017780     MOVE v(2)       TO Q.
017790     MOVE `FbNv(2) TO `FbNQ.
017800     MOVE ~`FbNv(2) TO ~`FbNQ.
017810     MOVE ]`FbNv(2) TO ]`FbNQ.
017820*     MOVE ]Av(2)         TO ]AQ.
017830*     IF Nv(2) NOT = ZERO
017840*        MOVE "."            TO ؂QP ؂QQ
017850*     END-IF.
017860*     IF Nv(2) NOT = ZERO
017870*        MOVE "."            TO ؂QR ؂QS
017880*     END-IF.
017890*     IF JnNv(2) NOT = ZERO
017900*        MOVE "."            TO ؂QT ؂QU
017910*     END-IF.
017920*     IF INv(2) NOT = ZERO
017930*        MOVE "."            TO ؂QV ؂QW
017940*     END-IF.
017950**********
017960* R *
017970**********
017980     MOVE v(3)       TO R.
017990     MOVE Nv(3)       TO NR.
018000     MOVE v(3)       TO R.
018010     MOVE v(3)       TO R.
018020     MOVE Nv(3)       TO NR.
018030     MOVE v(3)       TO R.
018040     MOVE v(3)       TO R.
018050     MOVE JnNv(3)       TO JnNR.
018060     MOVE Jnv(3)       TO JnR.
018070     MOVE Jnv(3)       TO JnR.
018080     MOVE INv(3)       TO INR.
018090     MOVE Iv(3)       TO IR.
018100     MOVE Iv(3)       TO IR.
018110     MOVE v(3)       TO R.
018120     MOVE `FbNv(3) TO `FbNR.
018130     MOVE ~`FbNv(3) TO ~`FbNR.
018140     MOVE ]`FbNv(3) TO ]`FbNR.
018150*     MOVE ]Av(3)         TO ]AR.
018160*     IF Nv(3) NOT = ZERO
018170*        MOVE "."            TO ؂RP ؂RQ
018180*     END-IF.
018190*     IF Nv(3) NOT = ZERO
018200*        MOVE "."            TO ؂RR ؂RS
018210*     END-IF.
018220*     IF JnNv(3) NOT = ZERO
018230*        MOVE "."            TO ؂RT ؂RU
018240*     END-IF.
018250*     IF INv(3) NOT = ZERO
018260*        MOVE "."            TO ؂RV ؂RW
018270*     END-IF.
018280**********
018290* S *
018300**********
018310     MOVE v(4)       TO S.
018320     MOVE Nv(4)       TO NS.
018330     MOVE v(4)       TO S.
018340     MOVE v(4)       TO S.
018350     MOVE Nv(4)       TO NS.
018360     MOVE v(4)       TO S.
018370     MOVE v(4)       TO S.
018380     MOVE JnNv(4)       TO JnNS.
018390     MOVE Jnv(4)       TO JnS.
018400     MOVE Jnv(4)       TO JnS.
018410     MOVE INv(4)       TO INS.
018420     MOVE Iv(4)       TO IS.
018430     MOVE Iv(4)       TO IS.
018440     MOVE v(4)       TO S.
018450     MOVE `FbNv(4) TO `FbNS.
018460     MOVE ~`FbNv(4) TO ~`FbNS.
018470     MOVE ]`FbNv(4) TO ]`FbNS.
018480*     MOVE ]Av(4)         TO ]AS.
018490*     IF Nv(4) NOT = ZERO
018500*        MOVE "."            TO ؂SP ؂SQ
018510*     END-IF.
018520*     IF Nv(4) NOT = ZERO
018530*        MOVE "."            TO ؂SR ؂SS
018540*     END-IF.
018550*     IF JnNv(4) NOT = ZERO
018560*        MOVE "."            TO ؂ST ؂SU
018570*     END-IF.
018580*     IF INv(4) NOT = ZERO
018590*        MOVE "."            TO ؂SV ؂SW
018600*     END-IF.
018610**********
018620* T *
018630**********
018640     MOVE v(5)       TO T.
018650     MOVE Nv(5)       TO NT.
018660     MOVE v(5)       TO T.
018670     MOVE v(5)       TO T.
018680     MOVE Nv(5)       TO NT.
018690     MOVE v(5)       TO T.
018700     MOVE v(5)       TO T.
018710     MOVE JnNv(5)       TO JnNT.
018720     MOVE Jnv(5)       TO JnT.
018730     MOVE Jnv(5)       TO JnT.
018740     MOVE INv(5)       TO INT.
018750     MOVE Iv(5)       TO IT.
018760     MOVE Iv(5)       TO IT.
018770     MOVE v(5)       TO T.
018780     MOVE `FbNv(5) TO `FbNT.
018790     MOVE ~`FbNv(5) TO ~`FbNT.
018800     MOVE ]`FbNv(5) TO ]`FbNT.
018810*     MOVE ]Av(5)         TO ]AT.
018820*     IF Nv(5) NOT = ZERO
018830*        MOVE "."            TO ؂TP ؂TQ
018840*     END-IF.
018850*     IF Nv(5) NOT = ZERO
018860*        MOVE "."            TO ؂TR ؂TS
018870*     END-IF.
018880*     IF JnNv(5) NOT = ZERO
018890*        MOVE "."            TO ؂TT ؂TU
018900*     END-IF.
018910*     IF INv(5) NOT = ZERO
018920*        MOVE "."            TO ؂TV ؂TW
018930*     END-IF.
018940**************
018950* o߃Zbg *
018960**************
018970     PERFORM VARYING ʂbms FROM 1 BY 1
018980***             UNTIL ( ʂbms > ʐv )
018990             UNTIL ( ʂbms > 5 )
019000**         MOVE ʂbmsv(ʂbms)   TO oߕʂbms(ʂbms)
019010**         MOVE ʋ؂v(ʂbms)     TO ʋ(ʂbms)
019020         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
019030     END-PERFORM.
019040*****************************************
019050*     VKEp`FbNɂ        *
019060*   VK...L p...Ȃ *
019070*****************************************
019080     MOVE VK`FbNv    TO VK`FbN.
019090     MOVE p`FbNv    TO p`FbN.
019100*     MOVE 敪v        TO  敪.
019110********************
019120* f[^Zbg *
019130********************
019140*    ****************************************************************
019150*    * ijijijɂĂ͘AڂZbg *
019160*    ****************************************************************
019170     MOVE vq                   TO  .
019180     MOVE ԊO`FbNv             TO  ԊO`FbN.
019190     MOVE x`FbNv               TO  x`FbN.
019200     MOVE [`FbNv               TO  [`FbN.
019210*     MOVE Zev               TO  Ze.
019220     MOVE Zvq               TO  Z.
      *     IF {paNvq >= 42006
      *         MOVE NC"x"               TO  kbl
      *         MOVE NC"~"                   TO  k~bl
      *     END-IF.
           MOVE kvq             TO  k.
           IF (ԊO`FbNv NOT = SPACE) OR ([`FbNv NOT = SPACE) OR
              (x`FbNv NOT = SPACE)
              MOVE Zv                 TO  Z
              MOVE Z؂v               TO  Z
              MOVE Zv                 TO  Z
           END-IF.
019230     MOVE Čvq                   TO  Č.
019240     MOVE Ëvq                 TO  Ë.
019250     MOVE É񐔂vq                 TO  É.
019260     MOVE ×vq                   TO  ×.
019270     MOVE ԃ`FbNv               TO  ԃ`FbN.
019280     MOVE H`FbNv               TO  H`FbN.
019290*     MOVE Ð[`FbNv           TO  Ð[`FbN.
019300     MOVE \J`FbNv           TO  \J`FbN.
019310     MOVE ÉZvq               TO  ÉZ.
      */qE^Â̕ύXEǉ/1805
           IF ( {paNvq < 43006 )
018050        MOVE `FbNv              TO  `FbN
018060        MOVE `FbNv              TO  `FbN
018070        MOVE `FbNv              TO  `FbN
           ELSE
              MOVE ALL NC""                TO  
           END-IF.
      *     IF ( {paNvq >= 43006 ) AND ( qZvq NOT = ZERO )
      *        MOVE 񐔂v                TO  
      *        MOVE NC""                    TO  
      *     END-IF.
019350*     MOVE v                     TO  .
019360*     MOVE v                     TO  .
019370*     MOVE v                     TO  .
019380     MOVE qZvq           TO  qZ.
019390     MOVE {p񋟗vq           TO  {p񋟗.
019400     MOVE vv                       TO  v.
019410********************
019420* 񏈒uZbg *
019430********************
019440     PERFORM VARYING ʂbms FROM 1 BY 1
019450***             UNTIL ( ʂbms > ʐv )
019460             UNTIL ( ʂbms > 5 )
019470         MOVE 񏈒uvq(ʂbms) TO 񏈒u(ʂbms)
019480     END-PERFORM.
019490     MOVE 񏈒uvv         TO 񏈒uv.
019500*
019510     MOVE {×`FbNv            TO {×`FbN.
019520     MOVE `FbNv            TO `FbN.
019530     MOVE Œ藿`FbNv            TO Œ藿`FbN.
019540******************
019550* {Zbg *
019560******************
019570*     MOVE 㪖@Pv                TO  㪖@P.
019580*     MOVE 㪖@Pv                TO  㪖@P.
019590*     MOVE dÒPv                  TO  dÒP.
019600********************
019610* Zbg *
019620********************
019630*    **********
019640*    * P *
019650*    **********
019660     MOVE ÒPPvq             TO ÒPP.
019670     MOVE É񐔂Pvq             TO É񐔂P.
019680     MOVE ×Pvq               TO ×P.
019690     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
019700     MOVE 㪖@Pvq             TO 㪖@P.
019710     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
019720     MOVE 㪖@Pvq             TO 㪖@P.
019730     MOVE dÉ񐔂Pvq             TO dÉ񐔂P.
019740     MOVE d×Pvq               TO d×P.
019750     MOVE vPvq                 TO vP.
019760     IF Pvq NOT = ZERO
019770         COMPUTE P = Pvq / 100
019780     END-IF.
019790     MOVE vPvq           TO vP.
019800*    **********
019810*    * Q *
019820*    **********
019830     MOVE ÒPQvq             TO ÒPQ.
019840     MOVE É񐔂Qvq             TO É񐔂Q.
019850     MOVE ×Qvq               TO ×Q.
019860     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
019870     MOVE 㪖@Qvq             TO 㪖@Q.
019880     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
019890     MOVE 㪖@Qvq             TO 㪖@Q.
019900     MOVE dÉ񐔂Qvq             TO dÉ񐔂Q.
019910     MOVE d×Qvq               TO d×Q.
019920     MOVE vQvq                 TO vQ.
019930     IF Qvq NOT = ZERO
019940         COMPUTE Q = Qvq / 100
019950     END-IF.
019960     MOVE vQvq           TO vQ.
019970*    ****************
019980*    * Rʁ^W *
019990*    ****************
020000     MOVE ÒPRWvq             TO ÒPRW.
020010     MOVE É񐔂RWvq             TO É񐔂RW.
020020     MOVE ×RWvq               TO ×RW.
020030     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
020040     MOVE 㪖@RWvq             TO 㪖@RW.
020050     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
020060     MOVE 㪖@RWvq             TO 㪖@RW.
020070     MOVE dÉ񐔂RWvq             TO dÉ񐔂RW.
020080     MOVE d×RWvq               TO d×RW.
020090     MOVE vRWvq                 TO vRW.
020100     MOVE ʍvRWvq         TO ʍvRW.
020110     IF RWvq NOT = ZERO
020120         COMPUTE RW = RWvq / 100
020130     END-IF.
020140     MOVE vRWvq           TO vRW.
      */Vp͒Ȃ/131008
           IF ʃZv < 2
      */  0.70.6 /42505
               IF ({paNvq >= 42505)
                  MOVE "60"                  TO RW
                  MOVE "0.6"                 TO ʂRW
                  MOVE "==="                 TO RW ʒRW
               END-IF
           END-IF.
020150*    ****************
020160*    * Rʁ^10 *
020170*    ****************
020180     MOVE JnROvq           TO JnRO.
020190     MOVE JnROvq           TO JnRO.
020200     MOVE ÒPROvq             TO ÒPRO.
020210     MOVE É񐔂ROvq             TO É񐔂RO.
020220     MOVE ×ROvq               TO ×RO.
020230     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
020240     MOVE 㪖@ROvq             TO 㪖@RO.
020250     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
020260     MOVE 㪖@ROvq             TO 㪖@RO.
020270     MOVE dÉ񐔂ROvq             TO dÉ񐔂RO.
020280     MOVE d×ROvq               TO d×RO.
020290     MOVE vROvq                 TO vRO.
020300     IF ROvq NOT = ZERO
020310         COMPUTE RO = ROvq / 100
020320     END-IF.
020330     MOVE vROvq           TO vRO.
      */Rg/131010
020340**    ****************
020350**    * Sʁ^T *
020360**    ****************
020370*     MOVE ÒPSTvq             TO ÒPST.
020380*     MOVE É񐔂STvq             TO É񐔂ST.
020390*     MOVE ×STvq               TO ×ST.
020400*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
020410*     MOVE 㪖@STvq             TO 㪖@ST.
020420*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
020430*     MOVE 㪖@STvq             TO 㪖@ST.
020440*     MOVE dÉ񐔂STvq             TO dÉ񐔂ST.
020450*     MOVE d×STvq               TO d×ST.
020460*     MOVE vSTvq                 TO vST.
020470*     MOVE ʍvSTvq         TO ʍvST.
020480*     IF STvq NOT = ZERO
020490*         COMPUTE ST = STvq / 100
020500*     END-IF.
020510*     MOVE vSTvq           TO vST.
020520*    ****************
020530*    * Sʁ^W *
020540*    ****************
020550     MOVE JnSWvq           TO JnSW.
020560     MOVE JnSWvq           TO JnSW.
020570     MOVE ÒPSWvq             TO ÒPSW.
020580     MOVE É񐔂SWvq             TO É񐔂SW.
020590     MOVE ×SWvq               TO ×SW.
020600     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
020610     MOVE 㪖@SWvq             TO 㪖@SW.
020620     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
020630     MOVE 㪖@SWvq             TO 㪖@SW.
020640     MOVE dÉ񐔂SWvq             TO dÉ񐔂SW.
020650     MOVE d×SWvq               TO d×SW.
020660     MOVE vSWvq                 TO vSW.
020670     MOVE ʍvSWvq         TO ʍvSW.
020680     IF SWvq NOT = ZERO
020690         COMPUTE SW = SWvq / 100
020700     END-IF.
020710     MOVE vSWvq           TO vSW.
      */Vp͒Ȃ/131008
           IF ʃZv < 2
      */  0.70.6 /42505
               IF ({paNvq >= 42505)
                  MOVE "60"                  TO SW
                  MOVE "0.6"                 TO ʂSW
                  MOVE "==="                 TO SW ʒSW
               END-IF
           END-IF.
020720*    ****************
020730*    * Sʁ^10 *
020740*    ****************
020750     MOVE JnSOvq           TO JnSO.
020760     MOVE JnSOvq           TO JnSO.
020770     MOVE ÒPSOvq             TO ÒPSO.
020780     MOVE É񐔂SOvq             TO É񐔂SO.
020790     MOVE ×SOvq               TO ×SO.
020800     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
020810     MOVE 㪖@SOvq             TO 㪖@SO.
020820     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
020830     MOVE 㪖@SOvq             TO 㪖@SO.
020840     MOVE dÉ񐔂SOvq             TO dÉ񐔂SO.
020850     MOVE d×SOvq               TO d×SO.
020860     MOVE vSOvq                 TO vSO.
020870     IF SOvq NOT = ZERO
020880         COMPUTE SO = SOvq / 100
020890     END-IF.
020900     MOVE vSOvq           TO vSO.
020910*
020920************************************************************************
020930* Tʁ^2.5̈󎚂͕KvȂB
020940*------------------------------------------------------------------------*
020950*    *****************
020960*    * Tʁ^2.5 *
020970*    *****************
020980*     MOVE ÒPTQvq             TO ÒPTQ.
020990*     MOVE É񐔂TQvq             TO É񐔂TQ.
021000*     MOVE ×TQvq               TO ×TQ.
021010*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
021020*     MOVE 㪖@TQvq             TO 㪖@TQ.
021030*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
021040*     MOVE 㪖@TQvq             TO 㪖@TQ.
021050*     MOVE dÉ񐔂TQvq             TO dÉ񐔂TQ.
021060*     MOVE d×TQvq               TO d×TQ.
021070*     MOVE vTQvq                 TO vTQ.
021080*     MOVE ʍvTQvq         TO ʍvTQ.
021090*     IF TQvq NOT = ZERO
021100*         COMPUTE TQ = TQvq / 100
021110*     END-IF.
021120*     MOVE vTQvq           TO vTQ.
021130************************************************************************
      */Rg/131010
021140**    ****************
021150**    * Tʁ^T *
021160**    ****************
021170*     IF vTTvq NOT = ZERO
021180*        MOVE "5)33 "                      TO ŒTT
021190*        MOVE "0.33"                       TO ʗTT
021200*        MOVE JnTTvq           TO JnTT
021210*        MOVE JnTTvq           TO JnTT
021220*        MOVE ÒPTTvq             TO ÒPTT
021230*        MOVE É񐔂TTvq             TO É񐔂TT
021240*        MOVE ×TTvq               TO ×TT
021250*        MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT
021260*        MOVE 㪖@TTvq             TO 㪖@TT
021270*        MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT
021280*        MOVE 㪖@TTvq             TO 㪖@TT
021290*        MOVE dÉ񐔂TTvq             TO dÉ񐔂TT
021300*        MOVE d×TTvq               TO d×TT
021310*        MOVE vTTvq                 TO vTT
021320*        MOVE ʍvTTvq         TO ʍvTT
021330*        IF TTvq NOT = ZERO
021340*            COMPUTE TT = TTvq / 100
021350*        END-IF
021360*        MOVE vTTvq           TO vTT
021370*     END-IF.
021380*    ****************
021390*    * Tʁ^W *
021400*    ****************
021220     MOVE SPACE TO ʂTv.
021230     IF vTWvq NOT = ZERO
      */t
021560        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TWvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTWvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TWvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TWvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TWvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TWvq / dÉ񐔂TWvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TWvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TWvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
              MOVE "x"                          TO ZLTv
      */  0.70.6 /42505
              IF ({paNvq >= 42505)
021290           MOVE "0.6 "                    TO ʗTv
              ELSE
021290           MOVE "0.7 "                    TO ʗTv
              END-IF
      */
021680        IF TWvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TWvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTWvq           TO vTv
021720        MOVE ʂTv                     TO ʂTW
021490     END-IF.
021620*    ****************
021630*    * Tʁ^10 *
021640*    ****************
021530     MOVE SPACE TO ʂTv.
021540     IF vTOvq NOT = ZERO
      */t
021560        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TOvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTOvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TOvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TOvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TOvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TOvq / dÉ񐔂TOvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TOvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TOvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
      *        ZLTv ʗTv
      */
021680        IF TOvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TOvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTOvq           TO vTv
021720        MOVE ʂTv                     TO ʂTO
021730     END-IF.
021850*
021860     MOVE KpPv                        TO KpP.
021870     MOVE KpQv                        TO KpQ.
      *
      */qE^Â̕ύXEǉ/1805
           IF ( {paNvq >= 43006 )
              INITIALIZE A^|L[
019550        MOVE {pavq TO A^|{pa
019560        MOVE {pNvq   TO A^|{pN
019570        MOVE {pvq   TO A^|{p
019580        MOVE Ҕԍvq TO A^|Ҕԍ
019590        MOVE }Ԃvq     TO A^|}
              MOVE یʂvq TO A^|ی
              MOVE 24           TO A^|R[h
              MOVE ZERO         TO A^|p
              CALL "KINUNRYO"
              CANCEL "KINUNRYO"
              MOVE A^|qbl           TO qbl
              MOVE A^|^Âbl           TO ^Âbl
              IF ( qZvq NOT = ZERO )
                 MOVE qbl                TO q
              END-IF
              IF ( ^v NOT = ZERO )
                 MOVE ^Âbl                TO ^
              END-IF
           END-IF.
      *
021880     MOVE Z|v                      TO v.
           IF A|ی < 50
               MOVE Z|ꕔS            TO ꕔS
               MOVE Z|z              TO z
           ELSE
               MOVE Z|󋋎ҕSz          TO ꕔS
               MOVE Z|z          TO z
           END-IF
021910*
021810*------------------------------------------------------------------------------------*
021820* ʁiZȂŁA{̃Zɂ܂Ƃ߂鎞Az͏݁EKpQɏʈ󎚁j
021830     IF Z܂Ƃ߃tO = "YES"
021850         MOVE Z|v                  TO v
021860         MOVE Z|󋋎ҕSz          TO ꕔS
021870*     / Z/
021880         COMPUTE z = Z|v - Z|󋋎ҕSz
      */͌̕q͕SzLڂ/130418
      */Ԏs̏Q͕SzLڂ/
      */l͕̓SzLڂ/170217
               IF ((| = 52) AND (|pSҔԍ = "85140630")) OR
                  ((| = 53) AND (|pSҔԍ = "80140171")) OR
                  ((| = 55) AND (|pSҔԍ(1:5) = "81144" OR "81145"))
019830             MOVE Z|ꕔS TO ꕔS
019840             MOVE Z|z   TO z
               END-IF
021890*
021900*/[Q̋󔒂ɃXgOĂ܂NOT SPACE͍̎Ōɓ]LB
021910*/ZR̎͗]]LB
021920         IF ʗ̂v NOT = SPACE
021930            IF KpQv NOT = SPACE
021940                MOVE SPACE TO ʗ̂vQ
021950                STRING NC""             DELIMITED BY SIZE
021960                       ʗ̂v     DELIMITED BY SPACE
021970                       INTO ʗ̂vQ
021980                END-STRING
021990*                MOVE ʗ̂vQ TO KpQ(35:4)
021990                MOVE ʗ̂vQ TO KpQ(28:4)
022000            ELSE
022010                STRING KpQv           DELIMITED BY SPACE
022020                       NC""             DELIMITED BY SIZE
022030                       ʗ̂v     DELIMITED BY SPACE
022040                       INTO KpQ
022050                END-STRING
022060            END-IF
022070         END-IF
022080*
022090     END-IF.
      */Rg/131010
021920**------------------------------------------------------------------------------------*
021930** 14N64ʖځE5ʖڂ̒4533ɕύXB
021940**
021950*     IF ( vTTvq NOT = ZERO ) AND
021960*        ( {paNvq < 41406 )
021970*        MOVE "5)45 "  TO ŒTT
021980*        MOVE "0.45"   TO ʗTT
021990*     END-IF.
022000**------------------------------------------------------------------------------------*
022010**********************
022020* {pf[^Zbg *
022030**********************
022040     MOVE _tԍv           TO _tԍ.
022050*     MOVE z󗝔ԍv       TO z󗝔ԍ.
022060     MOVE {pX֔ԍPv     TO {pX֔ԍP.
022070     MOVE {pX֔ԍQv     TO {pX֔ԍQ.
022080*
022090     MOVE {pZPv         TO {pZP.
022100     MOVE {pZQv         TO {pZQ.
022110*     MOVE {pZRv         TO {pZR.
022120*
022130     MOVE ڍtԍv TO ڍtԍP
022140                                    ڍtԍQ.
022150     MOVE \҃Jiv           TO \҃Ji.
022160     MOVE \Җv             TO \Җ.
022170     MOVE {pdbԍv       TO {pdbԍ.
022180     MOVE ڍ@v             TO ڍ@.
           MOVE s{ihrv       TO s{ԍ.
022190*
022200*     MOVE sxXv         TO sxX.
022210*     MOVE aʃRgv     TO a.
022220     MOVE ԍv             TO ԍ.
022230     MOVE `lJiv       TO `lJi.
022240     MOVE `lv           TO `l.
022250     MOVE ϔCPv         TO ϔCP.
022260     MOVE ϔCQv         TO ϔCQ.
022260     MOVE ϔCRv         TO ϔCR.
           MOVE Z@֖Pv   TO Z@֖P.
           MOVE Z@֖Qv   TO Z@֖Q.
           MOVE Z@֖Rv   TO Z@֖R.
           MOVE Z@֖Sv   TO Z@֖S.
           MOVE xXPv       TO xXP.
           MOVE xXQv       TO xXQ.
           MOVE xXRv       TO xXR.
           MOVE xXSv       TO xXS.
           MOVE U`FbNv   TO U`FbN.
           MOVE ʃ`FbNv   TO ʃ`FbN.
           MOVE `FbNv   TO `FbN.
           MOVE s`FbNv   TO s`FbN.
           MOVE Ƀ`FbNv   TO Ƀ`FbN.
           MOVE _`FbNv   TO _`FbN.
           MOVE {X`FbNv   TO {X`FbN.
           MOVE xX`FbNv   TO xX`FbN.
           MOVE {x`FbNv TO {x`FbN.
022270*
022271*     MOVE NC"ĈϔC͏܂B" TO ϔC⑫.
022272*
022280****
022290*
022300* / _tE҈ϔC /
      */C/20190408
037370     IF {pav > 4
               MOVE {pav         TO |敪
037380         READ }X^
037390         NOT INVALID KEY
037400             MOVE |   TO 󗝘a
037410         END-READ
               MOVE "===="             TO 󗝘a
           END-IF.
      */C/20190408
022310     MOVE _tNv             TO 󗝔N.
022320     MOVE _tv             TO 󗝌.
022330     MOVE _tv             TO 󗝓.
022340* ( ϔCN 邩 )
022350     IF A|ϔC  = ZERO
      */C/20190408
037370         IF {pav > 4
                   MOVE {pav         TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE |   TO ϔCa
037410             END-READ
                   MOVE "===="             TO ϔCa
               END-IF
      */C/20190408
022360        MOVE ҈ϔCNv       TO ϔCN
022370        MOVE ҈ϔCv       TO ϔC
022380        MOVE ҈ϔCv       TO ϔC
022390     END-IF.
022400*
022410* {pID
022420*
022430*     MOVE όŒv TO όŒ.
022440     EVALUATE یʂvq
022450*     WHEN 1
022460*     WHEN 8
022470*         MOVE {phcv      TO {phc
022480     WHEN 4
022490     WHEN 9
022500         MOVE ϔԍv        TO ϔԍ
               MOVE όŒv      TO όŒ
022510     END-EVALUATE.
022470     MOVE {phcv TO {phc.
022500*     MOVE ϔԍv   TO ϔԍ.
022520*
022530********************
022540* Of[^Zbg *
022550********************
022560     MOVE Ҏv          TO fҎ.
022570     STRING ZǗv       DELIMITED BY SPACE
022580            "-"                  DELIMITED BY SIZE
022590            {pv             DELIMITED BY SPACE
022600            "-"                  DELIMITED BY SIZE
022610            ڍtԍv   DELIMITED BY SPACE
022620            "-"                  DELIMITED BY SIZE
022630            ҃R[hvq       DELIMITED BY SPACE
022640            INTO ZvgǗԍ
022650     END-STRING.
022660     MOVE \Ԃv        TO \.
022670*
      */VpQȍ~͒󗓂̈׈/131008
           IF ʃZv >= 2
               PERFORM vZ}X^擾
               MOVE ʒRv TO ʒRP ʒSP
               COMPUTE ʒRQ = ʒRv / 100
               COMPUTE ʒSQ = ʒRv / 100
           END-IF.
      */Z̕ύX/131008
           IF ʃZv < 2
               MOVE ALL "="                 TO Z
               MOVE "6-14 EerPe" TO VZ
           END-IF.
      *
      *     IF ʃZv NOT = 1
      *         MOVE ALL NC""      TO P Q
      *         MOVE "510-0075 OdlssP4-16 j`mdmhrVe@TEL  059-359-0333  FAX  059-359-0335"
      *                              TO Z
      *     END-IF.
022670*
022680******************
022690* SZbg *
022700******************
022710*     MOVE Sv             TO S.
022720*     MOVE Œv             TO Œ.
022730*
022731*
022732* ʃRg
022733*     MOVE ʃRgv         TO ʃRg.
022734*
022735*15/06p~**     MOVE  NC"S"          TO t.
022736*
022737*
022740*****     PERFORM eXg󎚏.
022750*
      **/22N6A/100617
      *     IF {paNvq >= 42206
      *         MOVE "===" TO R RQ S SQ
      *         MOVE "70"  TO R   S
      *         MOVE "0.7" TO RQ SQ
      *     END-IF.
022760*
022770*-------------------------------------------------------------------------*
022780*---  ZEvăZbǵÄZbgSECTION ̍Ōɂ邱ƁI -----*
022790     PERFORM ZEvăZbg.
022800*-------------------------------------------------------------------------*
022810*
022820*================================================================*
022830 ڏ SECTION.
022840*
022850     INITIALIZE {pv.
022860     INITIALIZE fҏv.
022870     INITIALIZE v.
022880     INITIALIZE lv.
022890     INITIALIZE Pvq.
022900     INITIALIZE Qvq.
022910     INITIALIZE Rvq.
022930     INITIALIZE YAS6125P.
022920     MOVE SPACE TO YAS6125P.
021920*================================================================*
021930 {擾 SECTION.
021920*================================================================*
023130*
           EVALUATE ʂvq
           WHEN 05
               MOVE 2          TO Z|Z
           WHEN OTHER
               MOVE 1          TO Z|Z
           END-EVALUATE.
019550     MOVE {pavq   TO Z|{pa.
019560     MOVE {pNvq     TO Z|{pN.
019570     MOVE {pvq     TO Z|{p.
019580     MOVE Ҕԍvq   TO Z|Ҕԍ.
019590     MOVE }Ԃvq       TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
      *
028780     MOVE {pavq       TO |{pa.
028790     MOVE {pNvq         TO |{pN.
028800     MOVE {pvq         TO |{p.
028810     MOVE ҃R[hvq     TO |҃R[h.
028820     READ fҏe
019630     INVALID KEY
              MOVE SPACE     TO |R[h
              INITIALIZE        |R[h
           END-READ.
      *
027790     MOVE {pavq       TO |{pa.
027800     MOVE {pNvq         TO |{pN.
027810     MOVE {pvq         TO |{p.
027820     MOVE ҃R[hvq     TO |҃R[h.
027830     READ f[^e
019630     INVALID KEY
              MOVE SPACE     TO |R[h
              INITIALIZE        |R[h
027870     NOT INVALID KEY
027900         MOVE |ʐ                   TO ʐv
           END-READ.
021940*
022940*================================================================*
022950 {p擾 SECTION.
022960*
022970**************************************************
022980* {@f[^gpAȉ̏擾           *
022990*  _tԍ.. _tԍvɊi[             *
023000*  ԍ ... ڍtԍvɊi[       *
023010*  \Җ ... \ҖvɊi[               *
023020*  Z1,2   ...{pZ1,2vɊi[          *
023030*  dbԍ ... {pdbԍvɊi[         *
023040**************************************************
023050     MOVE ZERO  TO {|{pԍ.
023060     READ {p}X^
023070     INVALID KEY
023080         CONTINUE
023090     NOT INVALID KEY
023130         MOVE {|V_tԍ   TO _tԍv
023150*
023160         MOVE   "ЁE"             TO ڍtv
023170         MOVE   {|ڍtԍ TO ڍtԍv
023180*
023190*** ρEq̎̂݁A_tԍ̕ҏWB
023200         EVALUATE یʂvq
023210         WHEN 04
023220             PERFORM ϔԍZbg
023230         WHEN 09
023240             PERFORM qԍZbg
023250         END-EVALUATE
023260***
023270*
023280         MOVE {|X֔ԍP        TO {pX֔ԍPv
023290         MOVE {|X֔ԍQ        TO {pX֔ԍQv
023300         MOVE {|\҃Ji        TO \҃Jiv
023310         MOVE {|\Җ          TO \Җv
023320         MOVE {|ڍ@          TO ڍ@v
               MOVE {|s{ihr    TO s{ihrv
023330*
023340         MOVE {|ZP            TO {pZPv
023350         MOVE {|ZQ            TO {pZQv
023360*         STRING {|ZP     DELIMITED BY SPACE
023370*                {|ZQ     DELIMITED BY SPACE
023380*                INTO {pZv
023390*         END-STRING
023400*
023410         MOVE {|dbԍ          TO {pdbԍv
023420** U
023430*         MOVE {|s      TO sv
023440*         MOVE {|sxX  TO sxXv
023450*         MOVE {|a          TO aʂv
023460*         MOVE {|ԍ          TO ԍv
023470*         MOVE {|`l        TO `lv
023480*         MOVE {|`lJi    TO `lJiv
023490*
023500** U  / }X^U擾 /
023520         MOVE ZERO  TO  |_I敪
023510         MOVE 24    TO  |R[h
023520         MOVE ZERO  TO  |ی
023530         MOVE ZERO  TO  |ύXaN
023540         READ }X^
023550         NOT INVALID KEY
023560             MOVE |s      TO sv
023570             MOVE |sxX  TO sxXv
023580             MOVE |a          TO aʂv
023590             MOVE |ԍ          TO ԍv
023600             MOVE |`l        TO `lv
023610             MOVE |`lJi    TO `lJiv
      *}X^gp/20190403
      *                   MOVE "˾¼   ϻ" TO `lJiv
023620*
023630             STRING sv     DELIMITED BY SPACE
023640                    " "                DELIMITED BY SIZE
023650                    sxXv DELIMITED BY SPACE
023660                    INTO sxXv
023670             END-STRING
023680             EVALUATE aʂv
023690             WHEN 1
023700                 MOVE NC"iʁj" TO aʃRgv
023710             WHEN 2
023720                 MOVE NC"ij" TO aʃRgv
023730             WHEN OTHER
023740                 MOVE SPACE        TO aʃRgv
023750             END-EVALUATE
023760*
023770*             MOVE |ڍt    TO v
023780         END-READ

      */͐ÛݑΉ
               MOVE NC"" TO U`FbNv
      *
               EVALUATE aʂv
               WHEN 1
                   MOVE NC"" TO ʃ`FbNv
               WHEN 2
                   MOVE NC"" TO `FbNv
               END-EVALUATE
      *
               MOVE ZERO  TO JE^
               MOVE sv TO Z@֖v
               INSPECT sv TALLYING JE^ FOR ALL "s"
               IF ( JE^ >= 1 )
                   MOVE NC"" TO s`FbNv
                   MOVE SPACE  TO Z@֖v
                   UNSTRING sv DELIMITED BY "s"
                       INTO Z@֖v
                   END-UNSTRING
               END-IF
               MOVE ZERO TO JE^
               INSPECT sv TALLYING JE^ FOR ALL ""
               IF ( JE^ >= 1 )
                   MOVE NC"" TO Ƀ`FbNv
                   MOVE SPACE  TO Z@֖v
                   UNSTRING sv DELIMITED BY ""
                       INTO Z@֖v
                   END-UNSTRING
               END-IF
               MOVE ZERO TO JE^
               INSPECT sv TALLYING JE^ FOR ALL "_"
               IF ( JE^ >= 1 )
                   MOVE NC"" TO _`FbNv
                   MOVE SPACE  TO Z@֖v
                   UNSTRING sv DELIMITED BY "_"
                       INTO Z@֖v
                   END-UNSTRING
               END-IF
      *
               MOVE sxXv TO xXv
               MOVE ZERO TO JE^
               INSPECT sxXv TALLYING JE^ FOR ALL "{X"
               IF ( JE^ >= 1 )
                   MOVE NC"" TO {X`FbNv
                   MOVE SPACE  TO xXv
                   UNSTRING sxXv DELIMITED BY "{X"
                       INTO xXv
                   END-UNSTRING
               END-IF
               MOVE ZERO TO JE^
               INSPECT sxXv TALLYING JE^ FOR ALL "xX"
               IF ( JE^ >= 1 )
                   MOVE NC"" TO xX`FbNv
                   MOVE SPACE  TO xXv
                   UNSTRING sxXv DELIMITED BY "xX"
                       INTO xXv
                   END-UNSTRING
               END-IF
               MOVE ZERO TO JE^
               INSPECT sxXv TALLYING JE^ FOR ALL "{"
               IF ( JE^ >= 1 )
                   MOVE NC"" TO {x`FbNv
                   MOVE SPACE  TO xXv
                   UNSTRING sxXv DELIMITED BY "{"
                       INTO xXv
                   END-UNSTRING
               END-IF
               MOVE ZERO TO JE^
               INSPECT sxXv TALLYING JE^ FOR ALL "x"
               IF ( JE^ >= 1 )
                   MOVE NC"" TO {x`FbNv
                   MOVE SPACE  TO xXv
                   UNSTRING sxXv DELIMITED BY "x"
                       INTO xXv
                   END-UNSTRING
               END-IF
023790*
023800     END-READ.
023810*
023820* Œ
023830*     MOVE NC"×{xz̎̂Аڍt" TO ϔCPv.
023840*     MOVE NC"@@"           TO ϔCQPv.
023850*     MOVE NC"@aɈϔC܂B" TO ϔCQQv.
      */ϔC̕ύX/20190307
      *     MOVE "×{xz̎̂Аڍt"      TO ϔCPv
      *     MOVE " rc a(OdlssP" TO ϔCQv
      **/Z̕ύX/131008
      **     MOVE "4-16j`mdmhrVe)ɈϔC܂B"   TO ϔCRv
      *     MOVE "6-14 EerPe)ɈϔC܂B"   TO ϔCRv
           MOVE "×{̎̂Ѓz[vڍt  \" TO ϔCPv
           MOVE "rc    aiOdlss 1  6-14  " TO ϔCQv
           MOVE "Eer 1FjɈϔC܂B                 " TO ϔCRv
      */ϔC̕ύX/20190307
023860*
023870*********************************************
023880** hcǗ}X^@{phc擾B
023890*   (ۑgAΏ)
023900*********************************************
023910     EVALUATE یʂvq 
023920* 
023930     WHEN 01
023940         MOVE یҔԍvq         TO یҔԍrv
023950* ސE
023960     WHEN 08
026860* 
026870     WHEN 05
023970         MOVE یҔԍvq(3:6)    TO یҔԍrv
023980     END-EVALUATE.
023990**   / {pID /
024000     IF یʂvq = 01 OR 08 OR 05
024010         MOVE 01                     TO hcǁ|hc敪
024020         MOVE ZERO                   TO hcǁ|{pԍ
024030         MOVE یҔԍrv(1:2)  TO hcǁ|ی
024040         MOVE SPACE                  TO hcǁ|یҔԍ
024050         READ hcǗ}X^
024060         NOT INVALID KEY
024070              MOVE NC"ԍ@{p@֔ԍ"  TO όŒv
024080              STRING یҔԍrv(1:2) DELIMITED BY SPACE
024090                     "   "                 DELIMITED BY SIZE
024100                     hcǁ|{phcԍ  DELIMITED BY SPACE
024110                     INTO {phcv
024120             END-STRING
024130         END-READ
024140     END-IF.
024150**
024160*
024170*================================================================*
024180 ϔԍZbg SECTION.
024190*
024200**************************************************************
024210* یҔԍɂAς̔ԍ󎚂邩A_tԍ
024220**************************************************************
024230** 1.ϑgA
024240     MOVE SPACE  TO  EotO.
024250     IF {|ϘAԍ NOT = ZERO
024260** (یҔԍ)
024270        IF ( یҔԍvq(1:2) = "31" )  OR
024280           ( یҔԍvq = "34130021" )
024290*
024300*           MOVE  NC"ϑgA"   TO ϘAԍmv 
024310           MOVE  NC"ϑgA"     TO όŒv 
024320           MOVE  NC""               TO ϘAԍmv 
024330           MOVE  NC""               TO ϘAԍPʂmv 
024340           MOVE  {|ϘAԍ     TO ϘAԍv
024350           IF    (ϘAԍv(1:1) = "0")  AND (EotO  = SPACE )
024360                 MOVE SPACE TO  ϘAԍv(1:1)
024370           ELSE
024380                 MOVE "YES" TO  EotO
024390           END-IF
024400           IF    (ϘAԍv(2:1) = "0")  AND (EotO  = SPACE )
024410                 MOVE SPACE TO  ϘAԍv(2:1)
024420           ELSE
024430                 MOVE "YES" TO  EotO
024440           END-IF
024450           IF    (ϘAԍv(3:1) = "0")  AND (EotO  = SPACE )
024460                 MOVE SPACE TO  ϘAԍv(3:1)
024470           ELSE
024480                 MOVE "YES" TO  EotO
024490           END-IF
024500           IF    (ϘAԍv(4:1) = "0")  AND (EotO  = SPACE )
024510                 MOVE SPACE TO  ϘAԍv(4:1)
024520           ELSE
024530                 MOVE "YES" TO  EotO
024540           END-IF
024550           IF    (ϘAԍv(5:1) = "0")  AND (EotO  = SPACE )
024560                 MOVE SPACE TO  ϘAԍv(5:1)
024570           ELSE
024580                 MOVE "YES" TO  EotO
024590           END-IF
024600           IF    (ϘAԍv(6:1) = "0")  AND (EotO  = SPACE )
024610                 MOVE SPACE TO  ϘAԍv(6:1)
024620           ELSE
024630                 MOVE "YES" TO  EotO
024640           END-IF
024650           MOVE  ϘAԍWcv     TO ϔԍv
024660        END-IF
024670     END-IF.
024680*
024690** 2. nϋc
024700     MOVE SPACE  TO  EotO.
024720** (یҔԍ)
024730     IF ( یҔԍvq(1:2) = "32" OR "33" OR "34" )  AND
024740        ( یҔԍvq NOT = "34130021" )
024710        IF {|nϘAԍ NOT = ZERO
024750*
024760*           MOVE  NC"nϋc"     TO ϘAԍmv 
024770           MOVE  NC"nϑgc" TO όŒv
024780           MOVE  NC""               TO ϘAԍmv 
024790           MOVE  NC""               TO ϘAԍPʂmv 
024800           MOVE  {|nϘAԍ   TO ϘAԍv
024810           IF    (ϘAԍv(1:1) = "0")  AND (EotO  = SPACE )
024820                 MOVE SPACE TO  ϘAԍv(1:1)
024830           ELSE
024840                 MOVE "YES" TO  EotO
024850           END-IF
024860           IF    (ϘAԍv(2:1) = "0")  AND (EotO  = SPACE )
024870                 MOVE SPACE TO  ϘAԍv(2:1)
024880           ELSE
024890                 MOVE "YES" TO  EotO
024900           END-IF
024910           IF    (ϘAԍv(3:1) = "0")  AND (EotO  = SPACE )
024920                 MOVE SPACE TO  ϘAԍv(3:1)
024930           ELSE
024940                 MOVE "YES" TO  EotO
024950           END-IF
024960           IF    (ϘAԍv(4:1) = "0")  AND (EotO  = SPACE )
024970                 MOVE SPACE TO  ϘAԍv(4:1)
024980           ELSE
024990                 MOVE "YES" TO  EotO
025000           END-IF
025010           IF    (ϘAԍv(5:1) = "0")  AND (EotO  = SPACE )
025020                 MOVE SPACE TO  ϘAԍv(5:1)
025030           ELSE
025040                 MOVE "YES" TO  EotO
025050           END-IF
025060           IF    (ϘAԍv(6:1) = "0")  AND (EotO  = SPACE )
025070                 MOVE SPACE TO  ϘAԍv(6:1)
025080           ELSE
025090                 MOVE "YES" TO  EotO
025100           END-IF
025110           MOVE  ϘAԍWcv     TO ϔԍv
025120        ELSE
024250           IF {|ϘAԍ NOT = ZERO
024310               MOVE  NC"ϑgA"     TO όŒv 
024320               MOVE  NC""               TO ϘAԍmv 
024330               MOVE  NC""               TO ϘAԍPʂmv 
024340               MOVE  {|ϘAԍ     TO ϘAԍv
024350               IF (ϘAԍv(1:1) = "0")  AND (EotO  = SPACE )
024360                   MOVE SPACE TO  ϘAԍv(1:1)
024370               ELSE
024380                   MOVE "YES" TO  EotO
024390               END-IF
024400               IF (ϘAԍv(2:1) = "0")  AND (EotO  = SPACE )
024410                   MOVE SPACE TO  ϘAԍv(2:1)
024420               ELSE
024430                   MOVE "YES" TO  EotO
024440               END-IF
024450               IF (ϘAԍv(3:1) = "0")  AND (EotO  = SPACE )
024460                   MOVE SPACE TO  ϘAԍv(3:1)
024470               ELSE
024480                   MOVE "YES" TO  EotO
024490               END-IF
024500               IF (ϘAԍv(4:1) = "0")  AND (EotO  = SPACE )
024510                   MOVE SPACE TO  ϘAԍv(4:1)
024520               ELSE
024530                   MOVE "YES" TO  EotO
024540               END-IF
024550               IF (ϘAԍv(5:1) = "0")  AND (EotO  = SPACE )
024560                   MOVE SPACE TO  ϘAԍv(5:1)
024570               ELSE
024580                   MOVE "YES" TO  EotO
024590               END-IF
024600               IF (ϘAԍv(6:1) = "0")  AND (EotO  = SPACE )
024610                   MOVE SPACE TO  ϘAԍv(6:1)
024620               ELSE
024630                   MOVE "YES" TO  EotO
024640               END-IF
024650               MOVE  ϘAԍWcv     TO ϔԍv
024670           END-IF
              END-IF
025130     END-IF.
025140*
025150*================================================================*
025160 qԍZbg SECTION.
025170*
025180     MOVE SPACE  TO  EotO.
025190     IF {|qԍ NOT = ZERO
025200*           MOVE  NC"hq"    TO qԍmv 
025201*           MOVE  NC"hq"       TO όŒv
025203           IF {|hqȋ敪 = 1
025204              MOVE  NC"hq"      TO όŒv
025205           ELSE
025206              MOVE  NC"hq"      TO όŒv
025207           END-IF
025220           MOVE  NC""           TO qԍmv 
025230           MOVE  NC""           TO qԍPʂmv 
025240           MOVE  {|qԍ TO qԍv
025250           IF    (qԍv(1:1) = "0")  AND (EotO  = SPACE )
025260                 MOVE SPACE TO  qԍv(1:1)
025270           ELSE
025280                 MOVE "YES" TO  EotO
025290           END-IF
025300           IF    (qԍv(2:1) = "0")  AND (EotO  = SPACE )
025310                 MOVE SPACE TO  qԍv(2:1)
025320           ELSE
025330                 MOVE "YES" TO  EotO
025340           END-IF
025350           IF    (qԍv(3:1) = "0")  AND (EotO  = SPACE )
025360                 MOVE SPACE TO  qԍv(3:1)
025370           ELSE
025380                 MOVE "YES" TO  EotO
025390           END-IF
025400           IF    (qԍv(4:1) = "0")  AND (EotO  = SPACE )
025410                 MOVE SPACE TO  qԍv(4:1)
025420           ELSE
025430                 MOVE "YES" TO  EotO
025440           END-IF
025450           IF    (qԍv(5:1) = "0")  AND (EotO  = SPACE )
025460                 MOVE SPACE TO  qԍv(5:1)
025470           ELSE
025480                 MOVE "YES" TO  EotO
025490           END-IF
025500           IF    (qԍv(6:1) = "0")  AND (EotO  = SPACE )
025510                 MOVE SPACE TO  qԍv(6:1)
025520           ELSE
025530                 MOVE "YES" TO  EotO
025540           END-IF
025550           MOVE  qԍWcv     TO ϔԍv
025560     END-IF.
025570*
025580*================================================================*
025590 擾 SECTION.
025600*
025610****************************************************
025620* Af[^ی҃}X^萿擾B *
025630* ہ|敪=1̏ꍇ}X^gp   *
025640*  ...... 於̂vɊi[               *
025650****************************************************
025660*----------------------------------------------------------------------------------*
025670* }X^ǂށB
025680* ۑސEVl̎A""B}X^ɂƂ́Ax
025690*                       ixɂ́Ai{jƋ於͂ĂB
025700* 2001/10/26 CF28̂ݎx
025710*----------------------------------------------------------------------------------*
025720*
025730     MOVE یʂvq   TO ہ|ی.
025740     MOVE یҔԍvq TO ہ|یҔԍ.
025750     READ ی҃}X^
025760     INVALID KEY
025770         MOVE SPACE              TO 於̂sak
025780         MOVE SPACE              TO xv
025790         MOVE ZERO               TO ڔ敪v
025800     NOT INVALID KEY
025810         IF ہ|敪 = 1
025820             MOVE یʂvq   TO |ی
025830             MOVE یҔԍvq TO |یҔԍ
025840             READ }X^
025850             INVALID KEY
025860                 MOVE SPACE        TO 於̂sak
025870                 MOVE SPACE        TO xv
025880             NOT INVALID KEY
025890                 MOVE |یҖ  TO 於̂sak
025900                 MOVE |x  TO xv
025910             END-READ
025920*        / ɈȊO@xNA[ /
025930             IF (( یʂvq = 01 ) AND ( یҔԍvq(1:2) = "28" )) OR
025940                (( یʂvq = 08 ) AND ( یҔԍvq(3:2) = "28" )) 
025950                 CONTINUE
025960             ELSE
025970                 MOVE SPACE  TO xv
025980             END-IF
025990*
026000         ELSE
026010             MOVE ہ|یҖ      TO 於̂sak
026020             MOVE ہ|ڔ敪      TO ڔ敪v
026030             EVALUATE یʂvq
026040             WHEN 1
026050             WHEN 8
026060                 MOVE SPACE           TO xv
026070             WHEN OTHER
026080                 MOVE ہ|x  TO xv
026090             END-EVALUATE
026100         END-IF
026110     END-READ.
026120*
026130     IF 於̂sak NOT = SPACE
026140        EVALUATE یʂvq
026150** ЕہE
026160        WHEN 2
026170        WHEN 6
026180          IF ڔ敪v = 1
026190*             MOVE 於̂sak    TO 於̂v
026210             STRING 於̂sak  DELIMITED BY SPACE
026230                    "a"              DELIMITED BY SIZE
026240                    INTO 於̂v
026250             END-STRING
026200          ELSE
026210             STRING 於̂sak  DELIMITED BY SPACE
026220                    "Љی"  DELIMITED BY SIZE
026230                    "a"              DELIMITED BY SIZE
026240                    INTO 於̂v
026250             END-STRING
026260          END-IF
026270** gEς͎x܂ň
026280        WHEN 3
026290            STRING 於̂sak  DELIMITED BY SPACE
026300                   "Nیg"    DELIMITED BY SIZE
026310                   xv      DELIMITED BY SPACE
026320                   "a"              DELIMITED BY SIZE
026330                   INTO 於̂v
026340            END-STRING
026350        WHEN 4
026360            STRING 於̂sak  DELIMITED BY SPACE
026370                   "ϑg"        DELIMITED BY SIZE
026380                   xv      DELIMITED BY SPACE
026390                   "a"              DELIMITED BY SIZE
026400                   INTO 於̂v
026410            END-STRING
026420** ہEސE
026430        WHEN 1
026440        WHEN 8
026450            PERFORM ۑސEZbg
026460        WHEN OTHER
026470            STRING 於̂sak  DELIMITED BY SPACE
026480                   "a"              DELIMITED BY SIZE
026490                   INTO 於̂v
026500            END-STRING
026510        END-EVALUATE
026520     END-IF.
026530*
026540*================================================================*
026550 ۑސEZbg SECTION.
026560*
026570     PERFORM VARYING JE^ FROM 1 BY 1
026580             UNTIL ( JE^ > 20 )  OR
026590                   ( 於̂vs(JE^) = SPACE )
026600        MOVE 於̂vs(JE^) TO 於̂vsP
026610     END-PERFORM.
026620     IF 於̂vsP = "s" OR "" OR "" OR ""
026630        STRING 於̂sak  DELIMITED BY SPACE
026640               ""              DELIMITED BY SIZE
026650               xv      DELIMITED BY SPACE
026660               "a"              DELIMITED BY SIZE
026670               INTO 於̂v
026680        END-STRING
026690     ELSE
026700        STRING 於̂sak  DELIMITED BY SPACE
026710               "@"              DELIMITED BY SIZE
026720               xv      DELIMITED BY SPACE
026730               "a"              DELIMITED BY SIZE
026740               INTO 於̂v
026750        END-STRING
026760     END-IF.
026770*================================================================*
026780 fҏ擾 SECTION.
026790*
026800**************************************************
026810* Af[^fҏeȉ̏擾 *
026820*  {pN ..... {pNvɊi[                 *
026830*  {p ..... {pvɊi[                 *
026840*  Ҕԍ.... ҔԍvɊi[ecAԗp   *
026850*  L ....... LvɊi[                   *
026860*  ԍ ....... ԍvɊi[                   *
026870*  یҔԍ . یҔԍvɊi[             *
026880*  ی ... یʂvɊi[               *
026890*  ی҃Ji.ی҃JivɊi[           *
026900*  یҎ.یҎvɊi[           *
026910*  ZP ......یҏZPvɊi[         *
026920*  ZQ ......یҏZQvɊi[         *
026930*  ҃Ji ....҃JivɊi[               *
026940*  Ҏ ....ҎvɊi[               *
026950*  Ґ ....敪ɂ`FbN""i[ *
026960*  Ҙa ....aɂ`FbN""i[ *
026970*  ҔN ......ҔNvɊi[                 *
026980*  Ҍ ......ҌvɊi[                 *
026990*  ғ ......ғvɊi[                 *
027000*   ........̃}X^葱vɎ擾     *
027010**************************************************
           IF |R[h NOT = SPACE
022660         EVALUATE |ی
022670         WHEN 01
022690            MOVE NC""        TO ۃ`FbNv
022680         WHEN 08
022690            MOVE NC""        TO ސE`FbNv
022700         WHEN 02
022710         WHEN 06
022750         WHEN 07
022720            MOVE NC""        TO `FbNv
022730         WHEN 03
022740            MOVE NC""        TO g`FbNv
               WHEN 04
                  MOVE NC""        TO σ`FbNv
      */q̃`FbN𕪂/140213
               WHEN 09
                  MOVE NC""        TO q`FbNv
               WHEN 05
                  MOVE NC""        TO `FbNv
022770         END-EVALUATE
               IF | = ZERO
                   MOVE NC"" TO Pƃ`FbNv
               ELSE
                   MOVE NC"" TO Q`FbNv
               END-IF
      */{Ƌ敪͂ǂꂩPɁB
               IF |ی = 05
                   EVALUATE |ʋ敪
                   WHEN 1
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
                   END-EVALUATE
               ELSE
028984             EVALUATE |ʋ敪
                   WHEN 1
                   WHEN 2
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
028991             WHEN 6
                       MOVE NC"" TO U΃`FbNv
                   WHEN OTHER
                       IF |{lƑ敪 = 1
                           MOVE NC"" TO {l`FbNv
                       ELSE
                           MOVE NC"" TO Ƒ`FbNv
                       END-IF
028999             END-EVALUATE
               END-IF
               EVALUATE Z|S
               WHEN ZERO
                   MOVE NC"" TO PO`FbNv
               WHEN 1
                   MOVE NC"" TO X`FbNv
      */_ސ쌧̏ꍇAO҂ṔAtWɂB(PS邽߁A҂PAی҂WAPƂȂ)
                   IF (|ی     = 01 AND |یҔԍ(1:2) = "14") OR
                      (|ی NOT = 01 AND |یҔԍ(3:2) = "14")
                       IF (|ی NOT = 05 ) AND (|ʋ敪 = 1)
                           MOVE SPACE  TO X`FbNv
                           MOVE NC"" TO W`FbNv
                       END-IF
                   END-IF
               WHEN 2
                   MOVE NC"" TO W`FbNv
               WHEN 3
                   MOVE NC"" TO V`FbNv
               END-EVALUATE
      *
027110*         EVALUATE |{pa
027120*         WHEN 1
027130*             MOVE NC""  TO {pav
027140*         WHEN 2
027150*             MOVE NC"吳"  TO {pav
027160*         WHEN 3
027170*             MOVE NC"a"  TO {pav
027180*         WHEN 4
027190*             MOVE NC""  TO {pav
027200*         END-EVALUATE
      */C/20190408
               MOVE |{pa     TO {pav
027210         MOVE |{pN       TO {pNv
027220         MOVE |{p       TO {pv
027230         MOVE |Ҕԍ     TO Ҕԍv
027240*         MOVE |L         TO Lv
027250*         MOVE |ԍ         TO ԍv
      *                                          
               MOVE SPACE TO AÍ|Í
      *
      *    / AÍ|͏Zbg /
               MOVE |L       TO AÍ|L
               MOVE |ԍ       TO AÍ|ԍ
               MOVE |Í TO AÍ|Í
      *     
               CALL   vOv
               CANCEL vOv
      *
               MOVE AÍ|L TO Lv
               MOVE AÍ|ԍ TO ԍv
      *
027260         MOVE |یҔԍ   TO یҔԍv
027270         MOVE |ی     TO یʂv
027280** Sy؂̎}ԍ폜
027290         IF ( |ی = 01 ) AND ( |یҔԍ(1:6) = "133033" )
027300            MOVE |یҔԍ(1:6)  TO یҔԍv
027310         END-IF
027320**
027330         MOVE |ی҃Ji TO ی҃Jiv
027340         MOVE |یҎ TO یҎv
027350         MOVE |X֔ԍP   TO X֔ԍPv
027360         MOVE |X֔ԍQ   TO X֔ԍQv
027370         MOVE |ZP       TO یҏZPv
027380         MOVE |ZQ       TO یҏZQv
      */ dbԍǉ /42505
               IF |dbԍ NOT = SPACE
                  STRING "db:"        DELIMITED BY SIZE
                         |dbԍ   DELIMITED BY SPACE
                    INTO dbԍv
                  END-STRING
               ELSE
                  IF |ғdbԍ NOT = SPACE
                     STRING "db:"            DELIMITED BY SIZE
                            |ғdbԍ   DELIMITED BY SPACE
                       INTO dbԍv
                     END-STRING
                  END-IF
               END-IF
027390         MOVE |҃Ji     TO ҃Jiv
027400         MOVE |Ҏ     TO Ҏv
027410         MOVE |pSҔԍ TO sԍv
               MOVE |vҔԍ     TO 󋋎Ҕԍv
027420*
027430         EVALUATE |یҐ
027440         WHEN 1
027450             MOVE NC"j"  TO یҐʂv
027460         WHEN 2
027470             MOVE NC""  TO یҐʂv
027480         END-EVALUATE
027490*
027500         EVALUATE |Ґ
027510         WHEN 1
027520             MOVE "(j)"  TO Ґʂv
027530         WHEN 2
027540             MOVE "()"  TO Ґʂv
027550         END-EVALUATE
027560         EVALUATE |Ґ
027570         WHEN 1
027580             MOVE NC""  TO j`FbNv
027590         WHEN 2
027600             MOVE NC""  TO `FbNv
027610         END-EVALUATE
027620*
027630         EVALUATE |یҘa
027640         WHEN 1
027650             MOVE NC""  TO یҌv
027660         WHEN 2
027670             MOVE NC"吳"  TO یҌv
027680         WHEN 3
027690             MOVE NC"a"  TO یҌv
027700         WHEN 4
027710             MOVE NC""  TO یҌv
027720         END-EVALUATE
027730*
027740         MOVE |یҔN TO یҔNv
027750         MOVE |یҌ TO یҌv
027760         MOVE |یғ TO یғv
027770*
027780         EVALUATE |Ҙa
027790         WHEN 1
027800             MOVE NC""  TO `FbNv
027810         WHEN 2
027820             MOVE NC""  TO 吳`FbNv
027830         WHEN 3
027840             MOVE NC""  TO a`FbNv
027850         WHEN 4
027860             MOVE NC""  TO `FbNv
      */C/20190408
023060         WHEN 5
                   MOVE "5"   TO ߘablv
023070             MOVE NC""  TO ߘa`FbNv
027870         END-EVALUATE
027880         EVALUATE |Ҙa
027890         WHEN 1
027900             MOVE NC""  TO v
027910         WHEN 2
027920             MOVE NC"吳"  TO v
027930         WHEN 3
027940             MOVE NC"a"  TO v
027950         WHEN 4
027960             MOVE NC""  TO v
027970         END-EVALUATE
027980*
      */C/20190408
029310         IF |Ҙa > 4
037370             MOVE |Ҙa     TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE | TO v
037410             END-READ
029330         END-IF
      */C/20190408
027990         MOVE |ҔN  TO ҔNv
028000         MOVE |Ҍ  TO Ҍv
028010         MOVE |ғ  TO ғv
028020* 
028030         EVALUATE یʂvq 
028040* ސE
028050*         WHEN  08
028060*             IF ({lƑ敪vq = 1 ) AND (|ю呱 = 1)
028070*                 MOVE NC"ю"  TO v
028080*             ELSE
028090*                 MOVE 05          TO |敪R[h
028100*                 MOVE |    TO |̃R[h
028110*                 READ ̃}X^
028120*                 INVALID KEY
028130*                     MOVE SPACE    TO v
028140*                 NOT INVALID KEY
028150*                     MOVE | TO v
028160*                 END-READ
028170*             END-IF
028180* 
028190*         WHEN 01
028200*             IF {lƑ敪vq = 1
028210*                 MOVE NC"ю"    TO v
028220*             ELSE
028230*                 MOVE 05          TO |敪R[h
028240*                 MOVE |    TO |̃R[h
028250*                 READ ̃}X^
028260*                 INVALID KEY
028270*                     MOVE SPACE    TO v
028280*                 NOT INVALID KEY
028290*                     MOVE | TO v
028300*                 END-READ
028310*             END-IF
028320* q͖"{l"
028330         WHEN 09
028340              MOVE NC"{l"    TO v
028350* ہEސE
028360         WHEN 08
028370         WHEN 01
028380             IF {lƑ敪vq = 1
028390                 MOVE NC"{l"    TO v
028400             ELSE
028410                 MOVE NC"\"      TO v
028420             END-IF
028430         WHEN OTHER
028440             IF {lƑ敪vq = 1
028450                 MOVE NC"{l"    TO v
028460             ELSE
028470                 MOVE 05          TO |敪R[h
028480                 MOVE |    TO |̃R[h
028490                 READ ̃}X^
028500                 INVALID KEY
028510                     MOVE SPACE    TO v
028520                 NOT INVALID KEY
028530                     MOVE | TO v
028540                 END-READ
028550             END-IF
028560         END-EVALUATE
028570*
028580** یʃ`FbNݒ
028590* 14/10p~
028591*         EVALUATE یʂvq
028600*         WHEN  01
028610*             MOVE NC""   TO یʖ̂v
028620*         WHEN  02
028630*         WHEN  06
028640*         WHEN  07
028650*             MOVE NC""   TO یʖ̂v
028660*         WHEN  03
028670*             MOVE NC"g"   TO یʖ̂v
028680*         WHEN  04
028690*             MOVE NC""   TO یʖ̂v
028700*         WHEN  08
028710*             MOVE NC"ސE"   TO یʖ̂v
028720*         WHEN  09
028730*             MOVE NC"q" TO یʖ̂v
028740*         END-EVALUATE
028741* 14/10`
028742         EVALUATE یʂvq
028743         WHEN  01
028744             MOVE NC""   TO یʖ̂vP
028745         WHEN  02
028746         WHEN  06
028747         WHEN  07
028748             MOVE NC""   TO یʖ̂vP
028749         WHEN  03
028750             MOVE NC"g"   TO یʖ̂vP
028751         WHEN  04
028752             MOVE NC""   TO یʖ̂vP
028753         WHEN  08
028754             MOVE NC""   TO یʖ̂vP
028755         WHEN  09
028756             MOVE NC""   TO یʖ̂vP
028757         END-EVALUATE
028758         IF {lƑ敪vq = 1
028759             MOVE NC"{l"  TO ȈՑv
028760         ELSE
028761             MOVE NC"Ƒ"  TO ȈՑv
028762         END-IF
028763*
028764         STRING یʖ̂vP  DELIMITED BY SIZE
028765                NC"E"            DELIMITED BY SIZE
028766                ȈՑv        DELIMITED BY SIZE
028768                INTO یʖ̂v
028769         END-STRING
028770*
028771* Œ荀
028772         EVALUATE یʂvq 
028780* ہEސE
028790         WHEN  01
028800         WHEN  08
028810             MOVE NC"ю̎" TO یҎŒv
028820             MOVE NC"ю̏Z" TO یҏZŒv
028830             MOVE NC"ю"       TO ϔCŒv
028840* gE
028850         WHEN  03
028860         WHEN  04
028870             MOVE NC"g̎" TO یҎŒv
028880             MOVE NC"g̏Z" TO یҏZŒv
028890             MOVE NC"g"       TO ϔCŒv
028900* ЕہEq
028910         WHEN  OTHER
028920             MOVE NC"ی҂̎" TO یҎŒv
028930             MOVE NC"ی҂̏Z" TO یҏZŒv
028940             MOVE NC"ی"       TO ϔCŒv
028950         END-EVALUATE
028960*
028970*         MOVE NC"N" TO NŒv
028980*
028981** 14/10`@ʋ敪Rg
028982*         IF |{paN >= 41410
028983*             IF | = ZERO
028984*                EVALUATE |ʋ敪
028985*                WHEN 1
028986*                   MOVE "70Έȏ"  TO ʃRgv
028987*                WHEN 2
028988*                   MOVE "70Έȏ"  TO ʃRgv
028989*                WHEN 3
028990*                   MOVE "70Έȏ"  TO ʃRgv
028991*                WHEN 6
028992*                   IF |{paN < 42004
028993*                      MOVE "3Ζ"    TO ʃRgv
028994*                   ELSE
028995*                      MOVE "Aw"   TO ʃRgv
028996*                   END-IF
028999*                END-EVALUATE
029000*             END-IF
029001*         END-IF
030010**
      */Z܂Ƃ߂ɑΉ/101108
030020         IF | NOT = ZERO
030030            PERFORM Z܂Ƃߔ
030040         ELSE
030050            MOVE SPACE TO Z܂Ƃ߃tO
030060         END-IF
029002*
029003     END-IF.
029004*================================================================*
029010 f[^擾 SECTION.
029020*
029030**************************************************
029040* Af[^畉f[^eȉ̏擾 *
029050*  ...ʁ{ʂɂĉHĊi[     *
029060*  N.......Nv                       *
029070*  .......v                       *
029080*  .......v                       *
029090*  JnN.......Nv                       *
029100*  Jn.......v                       *
029110*  Jn.......v                       *
029120*  IN.......INv                       *
029130*  I.......Iv                       *
029140*  I.......Iv                       *
029150*  .......v                       *
029160*  ]A敪 ....敪ɂ`FbN""i[ *
029170*  q ....敪ɂ`FbN""i[ *
029180*  o߃R[h...o߃}X^擾             *
029190**************************************************
           IF |R[h NOT = SPACE
029290         MOVE |ʐ                   TO ʐv
029300         PERFORM VARYING ʂbms FROM 1 BY 1
029310                 UNTIL ( ʂbms > ʐv )
029320             MOVE |(ʂbms) TO ʂv(ʂbms)
029330             MOVE |(ʂbms)     TO ʂv(ʂbms)
029340             MOVE |E敪(ʂbms) TO E敪v(ʂbms)
029350             MOVE |ʒuԍ(ʂbms)
029360                                           TO ʒuԍv(ʂbms)
029370********************************************************
029380* jS_...ʖ1+ʁ{ʖ2ɂĉHĊi[ *
029390********************************************************
029400* 
029410             MOVE SPACE                     TO ̂v
029420             MOVE 03                        TO |敪R[h
029430             MOVE |(ʂbms)  TO |̃R[h
029440             READ ̃}X^
029450             INVALID KEY
029460                 MOVE SPACE        TO ̂v
029470             NOT INVALID KEY
029480                 MOVE | TO ̂v
029490             END-READ
029500* 
020710             MOVE SPACE                    TO v(ʂbms)
032680*
032690             PERFORM ʖ̖
029690*
029700             MOVE |N(ʂbms)   TO Nv(ʂbms)
029710             MOVE |(ʂbms)   TO v(ʂbms)
029720             MOVE |(ʂbms)   TO v(ʂbms)
029730             MOVE |JnN(ʂbms)   TO Nv(ʂbms)
029740             MOVE |Jn(ʂbms)   TO v(ʂbms)
029750             MOVE |Jn(ʂbms)   TO v(ʂbms)
029760             IF |]A敪(ʂbms) = 9
029770                 MOVE 99                   TO INv(ʂbms)
029780                 MOVE 99                   TO Iv(ʂbms)
029790                 MOVE 99                   TO Iv(ʂbms)
029800             ELSE
029810                 MOVE |IN(ʂbms)   TO INv(ʂbms)
029820                 MOVE |I(ʂbms)   TO Iv(ʂbms)
029830                 MOVE |I(ʂbms)   TO Iv(ʂbms)
029840             END-IF
029850* oߗ̎擾
029860             MOVE 01                         TO o|敪R[h
029870             MOVE |o߃R[h(ʂbms) TO o|o߃R[h
029880             READ o߃}X^
029890             INVALID KEY
029900                 MOVE ZERO            TO ʂbmsv(ʂbms)
029910                 MOVE SPACE           TO ʋ؂v(ʂbms)
029920                 MOVE SPACE           TO oߗ̂v(ʂbms)
029930             NOT INVALID KEY
029940                 EVALUATE ʂbms
029950                 WHEN 1
029960                     MOVE NC"@" TO oߕʂv
029970                 WHEN 2
029980                     MOVE NC"A" TO oߕʂv
029990                 WHEN 3
030000                     MOVE NC"B" TO oߕʂv
030010                 WHEN 4
030020                     MOVE NC"C" TO oߕʂv
030030                 WHEN 5
030040                     MOVE NC"D" TO oߕʂv
030050                 END-EVALUATE
030060                 STRING  oߕʂv     DELIMITED BY SPACE
030070                         o|oߗ   DELIMITED BY SPACE
030080                        INTO oߗ̂v(ʂbms)
030090                 END-STRING
030100             END-READ
030110*
030120             MOVE |]A敪(ʂbms) TO ]A敪v(ʂbms)
030130             EVALUATE |]A敪(ʂbms)
030140             WHEN 1
030150             WHEN 2
030160                 MOVE NC""               TO `FbNv(ʂbms)
030170             WHEN 3
030180                 MOVE NC""               TO ~`FbNv(ʂbms)
030190             WHEN 4
030200                 MOVE NC""               TO ]`FbNv(ʂbms)
030210             END-EVALUATE
030220*
030230*             EVALUATE |]A敪(ʂbms)
030240*             WHEN 1
030250*             WHEN 2
030260*                 MOVE NC""               TO ]Av(ʂbms)
030270*             WHEN 3
030280*                 MOVE NC"~"               TO ]Av(ʂbms)
030290*             WHEN 4
030300*                 MOVE NC"]"               TO ]Av(ʂbms)
030310*             WHEN OTHER
030320*                 MOVE NC"p"               TO ]Av(ʂbms)
030330*             END-EVALUATE
030340*
                    MOVE Z|ʎ(ʂbms) TO v(ʂbms)
030350         END-PERFORM
030360* VK/p `FbN
033380         EVALUATE Z|Z敪
               WHEN 1
033390             MOVE NC""                   TO VK`FbNv
               WHEN 2
033410             MOVE NC""                   TO p`FbNv
033400         WHEN 3
033390             MOVE NC""                   TO VK`FbNv
033410             MOVE NC""                   TO p`FbNv
               WHEN OTHER
033410             MOVE NC""                   TO p`FbNv
033420         END-EVALUATE
030480* }Ԕp
030490         MOVE |JnfÓ蓮敪 TO  JnfÓ蓮敪v
030500*
030501* 敪
030502         MOVE |Z敪 TO Z敪v
027880         MOVE |ZR敪 TO ZR敪v
      *
      */Rʓ /42505
               PERFORM Rʓ
               IF ΏۃtO = "YES"
                   MOVE NC"E" TO 
               END-IF
030503*
030510     END-IF.
040083*
      */̍ہEސEE㍂̎Ōo߂͂ĂȂ́Ao߂/160610
           IF ((یʂvq = 01) AND (یҔԍvq(1:2) = "20" )) OR
              ((یʂvq = 08) AND (یҔԍvq(3:2) = "20" )) OR
              ((ʂvq = 05) AND (pSҔԍvq(3:2) = "20" ))
016020        PERFORM oߎ擾
           END-IF.
018770     PERFORM VARYING ʂbms FROM 1 BY 1
018790             UNTIL ( ʂbms > 5 )
018820         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
018830     END-PERFORM.
030730*================================================================*
030910 ʖ̖ SECTION.
030920*
006490     STRING Z|ʖ̂P(ʂbms)  DELIMITED BY SPACE
009980            ̂v                    DELIMITED BY SPACE
006500            Z|ʖ̂Q(ʂbms)  DELIMITED BY SPACE
006520       INTO v(ʂbms)
006570     END-STRING.
031050*
030690*================================================================*
030700 擾 SECTION.
030710*
030720********************
030730* f[^Zbg *
030740********************
030750*    ****************************************************************
030760*    * ijijijɂĂ͘AڂZbg *
030770*    ****************************************************************
030780     MOVE Z|                 TO vq.
030790     IF Z|ԊO = 1
030800         MOVE NC""                   TO ԊO`FbNv
030810     END-IF.
030820     IF Z|x = 1
030830         MOVE NC""                   TO x`FbNv
030840     END-IF.
030850     IF Z|[ = 1
030860         MOVE NC""                   TO [`FbNv
030870     END-IF.
030880*
030890*     IF Z|ԊO = 1
030900*         MOVE NC"ԊO"               TO ԊOv
030910*     END-IF.
030920*     IF Z|x = 1
030930*         MOVE NC"x"                 TO xv
030940*     END-IF.
030950*     IF Z|[ = 1
030960*         MOVE NC"["                 TO [v
030970*     END-IF.
030980*
030990*     STRING ԊOv     DELIMITED BY SPACE
031000*            NC"@"       DELIMITED BY SIZE
031010*            xv       DELIMITED BY SPACE
031020*            NC"@"       DELIMITED BY SIZE
031030*            [v       DELIMITED BY SPACE
031040*            INTO Zev
031050*     END-STRING.
031060*
031070     MOVE Z|Z             TO  Zvq.
           MOVE Z|k           TO  kvq.
031080     MOVE Z|Č                 TO  Čvq.
031090     MOVE Z|Ë               TO  Ëvq.
031100     MOVE Z|É               TO  É񐔂vq.
031110     MOVE Z|×                 TO  ×vq.
031120     MOVE Z|ÉZ             TO  ÉZvq.
031130*
031140     IF Z| = 1
031150         MOVE NC""                   TO ԃ`FbNv
031160     END-IF.
031170*     IF Z|ԊO = 1
031180*         MOVE NC""                   TO Ð[`FbNv
031190*     END-IF.
031200     IF Z|\J = 1
031210         MOVE NC""                   TO \J`FbNv
031220     END-IF.
031230     IF Z|H = 1
031240         MOVE NC""                   TO H`FbNv
031250     END-IF.
031260*
031270     MOVE Z|qZ         TO  qZvq.
031280*
      */qE^Â̕ύXEǉ/1805
021850     IF ( Z| >= 1 )
021860         MOVE NC""                   TO `FbNv
021870     END-IF.
021880     IF ( Z| >= 1 )
021890         MOVE NC""                   TO `FbNv
021900     END-IF.
021910     IF ( Z| >= 1 )
021920         MOVE NC""                   TO `FbNv
021930     END-IF.
           IF ( {paNvq >= 43006 )
              MOVE Z|q        TO 񐔂v
           END-IF.
           MOVE Z|^×              TO ^v.
031380*
031390*     IF Z| = 1
031400*         MOVE NC""                   TO v
031410*     END-IF.
031420*     IF Z| = 1
031430*         MOVE NC""                   TO v
031440*     END-IF.
031450*     IF Z| = 1
031460*         MOVE NC""                   TO v
031470*     END-IF.
031480*
031490     MOVE Z|{p񋟗         TO {p񋟗vq.
031500* v
031510     MOVE Z|v                   TO vv.
031520********************
031530* 񏈒uZbg *
031540********************
031550     PERFORM VARYING ʂbms FROM 1 BY 1
031560             UNTIL ( ʂbms > ʐv )
031570         MOVE Z|񏈒u(ʂbms) TO 񏈒uvq(ʂbms)
031580         IF Z|񏈒u(ʂbms) NOT = ZERO
031590            EVALUATE |(ʂbms)
031600* PEŖoE
031610            WHEN 1
031620            WHEN 2
031630            WHEN 3
031640                MOVE NC""       TO {×`FbNv
031650* EPE܁E܍Sk
031660            WHEN 4
031670            WHEN 5
031680            WHEN 7
031690                MOVE NC""       TO `FbNv
031700* sS܁EsS܍Sk
031710            WHEN 6
031720            WHEN 8
031730                MOVE NC""       TO Œ藿`FbNv
031740            END-EVALUATE
031750         END-IF
031760     END-PERFORM.
031770     MOVE Z|񏈒uv    TO 񏈒uvv.
031780********************
031790* Zbg *
031800********************
031810*    **********
031820*    * P *
031830*    **********
031840     MOVE Z|ÒPP             TO ÒPPvq.
031850     MOVE Z|É񐔂P             TO É񐔂Pvq.
031860     MOVE Z|×P               TO ×Pvq.
031870     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
031880     MOVE Z|㪖@P             TO 㪖@Pvq.
031890     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
031900     MOVE Z|㪖@P             TO 㪖@Pvq.
031910     MOVE Z|dÉ񐔂P             TO dÉ񐔂Pvq.
031920     MOVE Z|d×P               TO d×Pvq.
031930     MOVE Z|vP                 TO vPvq.
031940     MOVE Z|P           TO Pvq.
031950     MOVE Z|vP           TO vPvq.
031960*    **********
031970*    * Q *
031980*    **********
031990     MOVE Z|ÒPQ             TO ÒPQvq.
032000     MOVE Z|É񐔂Q             TO É񐔂Qvq.
032010     MOVE Z|×Q               TO ×Qvq.
032020     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
032030     MOVE Z|㪖@Q             TO 㪖@Qvq.
032040     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
032050     MOVE Z|㪖@Q             TO 㪖@Qvq.
032060     MOVE Z|dÉ񐔂Q             TO dÉ񐔂Qvq.
032070     MOVE Z|d×Q               TO d×Qvq.
032080     MOVE Z|vQ                 TO vQvq.
032090     MOVE Z|Q           TO Qvq.
032100     MOVE Z|vQ           TO vQvq.
032110*    ****************
032120*    * Rʁ^W *
032130*    ****************
032140     MOVE Z|ÒPRW             TO ÒPRWvq.
032150     MOVE Z|É񐔂RW             TO É񐔂RWvq.
032160     MOVE Z|×RW               TO ×RWvq.
032170     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
032180     MOVE Z|㪖@RW             TO 㪖@RWvq.
032190     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
032200     MOVE Z|㪖@RW             TO 㪖@RWvq.
032210     MOVE Z|dÉ񐔂RW             TO dÉ񐔂RWvq.
032220     MOVE Z|d×RW               TO d×RWvq.
032230     MOVE Z|vRW                 TO vRWvq.
032240     MOVE Z|ʍvRW         TO ʍvRWvq.
032250     MOVE Z|RW           TO RWvq.
032260     MOVE Z|vRW           TO vRWvq.
032270*    ****************
032280*    * Rʁ^10 *
032290*    ****************
032300     MOVE Z|JnRO           TO JnROvq.
032310     MOVE Z|JnRO           TO JnROvq.
032320     MOVE Z|ÒPRO             TO ÒPROvq.
032330     MOVE Z|É񐔂RO             TO É񐔂ROvq.
032340     MOVE Z|×RO               TO ×ROvq.
032350     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
032360     MOVE Z|㪖@RO             TO 㪖@ROvq.
032370     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
032380     MOVE Z|㪖@RO             TO 㪖@ROvq.
032390     MOVE Z|dÉ񐔂RO             TO dÉ񐔂ROvq.
032400     MOVE Z|d×RO               TO d×ROvq.
032410     MOVE Z|vRO                 TO vROvq.
032420     MOVE Z|RO           TO ROvq.
032430     MOVE Z|vRO           TO vROvq.
032440**    ****************
032450**    * Sʁ^T *
032460**    ****************
032470*     MOVE Z|ÒPST             TO ÒPSTvq.
032480*     MOVE Z|É񐔂ST             TO É񐔂STvq.
032490*     MOVE Z|×ST               TO ×STvq.
032500*     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
032510*     MOVE Z|㪖@ST             TO 㪖@STvq.
032520*     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
032530*     MOVE Z|㪖@ST             TO 㪖@STvq.
032540*     MOVE Z|dÉ񐔂ST             TO dÉ񐔂STvq.
032550*     MOVE Z|d×ST               TO d×STvq.
032560*     MOVE Z|vST                 TO vSTvq.
032570*     MOVE Z|ʍvST         TO ʍvSTvq.
032580*     MOVE Z|ST           TO STvq.
032590*     MOVE Z|vST           TO vSTvq.
032600*    ****************
032610*    * Sʁ^W *
032620*    ****************
032630     MOVE Z|JnSW           TO JnSWvq.
032640     MOVE Z|JnSW           TO JnSWvq.
032650     MOVE Z|ÒPSW             TO ÒPSWvq.
032660     MOVE Z|É񐔂SW             TO É񐔂SWvq.
032670     MOVE Z|×SW               TO ×SWvq.
032680     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
032690     MOVE Z|㪖@SW             TO 㪖@SWvq.
032700     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
032710     MOVE Z|㪖@SW             TO 㪖@SWvq.
032720     MOVE Z|dÉ񐔂SW             TO dÉ񐔂SWvq.
032730     MOVE Z|d×SW               TO d×SWvq.
032740     MOVE Z|vSW                 TO vSWvq.
032750     MOVE Z|ʍvSW         TO ʍvSWvq.
032760     MOVE Z|SW           TO SWvq.
032770     MOVE Z|vSW           TO vSWvq.
032780*    ****************
032790*    * Sʁ^10 *
032800*    ****************
032810     MOVE Z|JnSO           TO JnSOvq.
032820     MOVE Z|JnSO           TO JnSOvq.
032830     MOVE Z|ÒPSO             TO ÒPSOvq.
032840     MOVE Z|É񐔂SO             TO É񐔂SOvq.
032850     MOVE Z|×SO               TO ×SOvq.
032860     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
032870     MOVE Z|㪖@SO             TO 㪖@SOvq.
032880     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
032890     MOVE Z|㪖@SO             TO 㪖@SOvq.
032900     MOVE Z|dÉ񐔂SO             TO dÉ񐔂SOvq.
032910     MOVE Z|d×SO               TO d×SOvq.
032920     MOVE Z|vSO                 TO vSOvq.
032930     MOVE Z|SO           TO SOvq.
032940     MOVE Z|vSO           TO vSOvq.
032950*    *****************
032960*    * Tʁ^2.5 *
032970*    *****************
032980     MOVE Z|ÒPTQ             TO ÒPTQvq.
032990     MOVE Z|É񐔂TQ             TO É񐔂TQvq.
033000     MOVE Z|×TQ               TO ×TQvq.
033010     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
033020     MOVE Z|㪖@TQ             TO 㪖@TQvq.
033030     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
033040     MOVE Z|㪖@TQ             TO 㪖@TQvq.
033050     MOVE Z|dÉ񐔂TQ             TO dÉ񐔂TQvq.
033060     MOVE Z|d×TQ               TO d×TQvq.
033070     MOVE Z|vTQ                 TO vTQvq.
033080     MOVE Z|ʍvTQ         TO ʍvTQvq.
033090     MOVE Z|TQ           TO TQvq.
033100     MOVE Z|vTQ           TO vTQvq.
033110**    ****************
033120**    * Tʁ^T *
033130**    ****************
033140*     MOVE Z|JnTT           TO JnTTvq.
033150*     MOVE Z|JnTT           TO JnTTvq.
033160*     MOVE Z|ÒPTT             TO ÒPTTvq.
033170*     MOVE Z|É񐔂TT             TO É񐔂TTvq.
033180*     MOVE Z|×TT               TO ×TTvq.
033190*     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
033200*     MOVE Z|㪖@TT             TO 㪖@TTvq.
033210*     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
033220*     MOVE Z|㪖@TT             TO 㪖@TTvq.
033230*     MOVE Z|dÉ񐔂TT             TO dÉ񐔂TTvq.
033240*     MOVE Z|d×TT               TO d×TTvq.
033250*     MOVE Z|vTT                 TO vTTvq.
033260*     MOVE Z|ʍvTT         TO ʍvTTvq.
033270*     MOVE Z|TT           TO TTvq.
033280*     MOVE Z|vTT           TO vTTvq.
033290*    ****************
033300*    * Tʁ^W *
033310*    ****************
029950     MOVE Z|JnTW           TO JnTWvq.
029960     MOVE Z|JnTW           TO JnTWvq.
029970     MOVE Z|ÒPTW             TO ÒPTWvq.
029980     MOVE Z|É񐔂TW             TO É񐔂TWvq.
029990     MOVE Z|×TW               TO ×TWvq.
030000     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
030010     MOVE Z|㪖@TW             TO 㪖@TWvq.
030020     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
030030     MOVE Z|㪖@TW             TO 㪖@TWvq.
030040     MOVE Z|dÉ񐔂TW             TO dÉ񐔂TWvq.
030050     MOVE Z|d×TW               TO d×TWvq.
030060     MOVE Z|vTW                 TO vTWvq.
030070     MOVE Z|ʍvTW         TO ʍvTWvq.
030080     MOVE Z|TW           TO TWvq.
030090     MOVE Z|vTW           TO vTWvq.
033470*    ****************
033480*    * Tʁ^10 *
033490*    ****************
033500     MOVE Z|JnTO           TO JnTOvq.
033510     MOVE Z|JnTO           TO JnTOvq.
033520     MOVE Z|ÒPTO             TO ÒPTOvq.
033530     MOVE Z|É񐔂TO             TO É񐔂TOvq.
033540     MOVE Z|×TO               TO ×TOvq.
033550     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
033560     MOVE Z|㪖@TO             TO 㪖@TOvq.
033570     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
033580     MOVE Z|㪖@TO             TO 㪖@TOvq.
033590     MOVE Z|dÉ񐔂TO             TO dÉ񐔂TOvq.
033600     MOVE Z|d×TO               TO d×TOvq.
033610     MOVE Z|vTO                 TO vTOvq.
033620     MOVE Z|TO           TO TOvq.
033630     MOVE Z|vTO           TO vTOvq.
033640*
033650*================================================================*
033660 {pL^擾 SECTION.
033670*
033680************************************************************
033690* Pf[^畉f[^eȉ̏擾           *
033700*  Z .....敪ɂ`FbN""i[... *
033710*  ÉZ .....敪ɂ`FbN""i[... *
033720************************************************************
033730     MOVE  SPACE  TO  ČtO.
033740     PERFORM VARYING ʂbms FROM 1 BY 1 UNTIL ʂbms > ʐv
033750         IF ( {pNv = Nv(ʂbms) ) AND
033760            ( {pv = v(ʂbms) )
033770             MOVE Ҕԍvq          TO {L|Ҕԍ
033780             MOVE }Ԃvq              TO {L|}
033790             MOVE {pavq          TO {L|{pa
033800             MOVE Nv(ʂbms)  TO JnNv(ʂbms) {L|{pN
033810             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
033820             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
033830         ELSE
033840             MOVE Ҕԍvq          TO {L|Ҕԍ
033850             MOVE }Ԃvq              TO {L|}
033860             MOVE {pavq          TO {L|{pa
033870             MOVE {pNvq            TO {L|{pN
033880             MOVE {pvq            TO {L|{p
033890             MOVE ZERO                  TO {L|{p
033900         END-IF
033910         START {pL^e   KEY IS >= {L|҃R[h
033920                                      {L|{paN
033930         END-START
033940         IF ԃL[ = "00"
033960             MOVE ZERO  TO INvs
033970             MOVE ZERO  TO Ivs
033980             MOVE ZERO  TO Ivs
033990             MOVE SPACE TO ItOQ
034000             PERFORM {pL^eǍ
034010             IF  ( ItOQ      = SPACE   ) AND
034020                 ( {L|҃R[h  = ҃R[hvq ) AND
034030                 ( {L|{pa    = {pavq   ) AND
034040                 ( {L|{pN      = {pNvq     ) AND
034050                 ( {L|{p      = {pvq     ) 
034060*
034070*        *****************************************************************
034080*        * JnN ( ̕ʂłȂA
034090*                       ł}Ԃ鎞́Aŏ̎{pJn)*
034100*        *****************************************************************
034110                 IF ( {pNv NOT = Nv(ʂbms) ) OR
034120                    ( {pv NOT = v(ʂbms) ) OR
034130                    ( JnfÓ蓮敪v = 1 )
034140                     MOVE {L|{pN   TO JnNv(ʂbms)
034150                     MOVE {L|{p   TO Jnv(ʂbms)
034160                     MOVE {L|{p   TO Jnv(ʂbms)
034170                 END-IF
034180             END-IF
034190             PERFORM UNTIL ( ItOQ         = "YES"            ) OR
034200                           ( {L|҃R[h NOT = ҃R[hvq   ) OR
034210                           ( {L|{pa   NOT = {pavq     ) OR
034220                           ( {L|{pN     NOT = {pNvq       ) OR
034230                           ( {L|{p     NOT = {pvq       ) OR
034240                           ( {L|{p         > Iv(ʂbms))
034250*               **********
034260*               *  *
034270*               **********
034290                MOVE {L|{pN               TO INvs
034300                MOVE {L|{p               TO Ivs
034310                MOVE {L|{p               TO Ivs
034320*
034330                PERFORM {pL^eǍ
034340            END-PERFORM
034350        END-IF
034360*       **************************
034370*       * pFINZbg *
034380*       **************************
034390        IF ]A敪v(ʂbms) = 9
034400            MOVE INvs    TO INv(ʂbms)
034410            MOVE Ivs    TO Iv(ʂbms)
034420            MOVE Ivs    TO Iv(ʂbms)
034430        END-IF
034440        IF INv(ʂbms) > 󗝔Nv
034450            MOVE INv(ʂbms) TO 󗝔Nv
034460            MOVE Iv(ʂbms) TO 󗝌v
034470            MOVE Iv(ʂbms) TO 󗝓v
034480        END-IF
034490     END-PERFORM.
034500*
034510** ----- Ô݂𔻒 -----------*
034520*
034530*     MOVE Ҕԍvq          TO {L|Ҕԍ.
034540*     MOVE }Ԃvq              TO {L|}.
034550*     MOVE {pavq          TO {L|{pa.
034560*     MOVE {pNvq            TO {L|{pN.
034570*     MOVE {pvq            TO {L|{p.
034580*     MOVE ZERO                  TO {L|{p.
034590*     START {pL^e   KEY IS >= {L|҃R[h
034600*                                  {L|{paN
034610*     END-START.
034620*     IF ԃL[ = "00"
034630*             MOVE SPACE TO ItOQ
034640*             PERFORM {pL^eǍ
034650*             IF  ( ItOQ      = SPACE   ) AND
034660*                 ( {L|҃R[h  = ҃R[hvq ) AND
034670*                 ( {L|{pa    = {pavq   ) AND
034680*                 ( {L|{pN      = {pNvq     ) AND
034690*                 ( {L|{p      = {pvq     ) 
034700** {pJnČǂ
034710*                 IF   {L|Č = 1
034720*                      MOVE "YES"  TO  ČtO
034730*                 END-IF
034740**
034750*             END-IF
034760*     END-IF.
034770*     IF ČtO = "YES"
034780*        PERFORM Ôݔ
034790*     END-IF.
034800*
034810*================================================================*
034820 Ôݔ SECTION.
034830*
034840*** O̒ʉ@ 
034850     MOVE  SPACE            TO OtO.
034860     MOVE |҃R[h    TO {L|҃R[h.
034870     MOVE |{pa      TO {L|{pa.
034880     MOVE |{pN        TO {L|{pN.
034890     MOVE |{p        TO {L|{p.
034900     MOVE 1                 TO {L|{p.
034910     START {pL^e   KEY IS <  {L|҃R[h
034920                                  {L|{paN
034930                                  REVERSED
034940     END-START.
034950     IF ԃL[ = "00"
034960         MOVE SPACE  TO ItOQ
034970         PERFORM {pL^eǍ
034980         IF ( ItOQ      = SPACE  ) AND
034990            ( {L|҃R[h  = |҃R[h ) AND
035000            ( {L|fË敪    = 2 ) 
035010*
035020            PERFORM O
035030**** KpPgp
035040            IF OtO = "YES"
035050               MOVE NC"Ô"    TO  KpPv
035060            END-IF
035070**
035080         END-IF
035090     END-IF.
035100*
035110*================================================================*
035120 O  SECTION.
035130* 
035140*** ǂݍ񂾎{pL^̔NAOǂ (N̍ 1 ?)
035150      MOVE  SPACE  TO  OtO.
035160      INITIALIZE  vZNv JnNQv INQv.
035170**
035180      MOVE |{pa    TO IaQv.
035190      MOVE |{pN      TO INQv.
035200      MOVE |{p      TO IQv.
035210      MOVE {L|{pa  TO JnaQv.
035220      MOVE {L|{pN    TO JnNQv.
035230      MOVE {L|{p    TO JnQv.
035240*
035250      EVALUATE TRUE
035260       WHEN (JnaQv = IaQv) AND (JnNQv = INQv)
035270            PERFORM  Or
035280       WHEN (JnaQv = IaQv) AND (JnNQv NOT = INQv)
035290            PERFORM  OrN
035300       WHEN  JnaQv NOT = IaQv 
035310            PERFORM  Or
035320      END-EVALUATE.
035330*
035340      IF vZv = 1
035350         MOVE  "YES"  TO  OtO
035360      END-IF.
035370*
035380*================================================================*
035390 擾 SECTION.
035400*
035410* RJȏ̒ "CHOUKI" Ă. 
035420     MOVE  SPACE TO  Aԁ|L[.
035430     INITIALIZE      Aԁ|L[.
035440     MOVE {pavq  TO  Aԁ|{pa.
035450     MOVE {pNvq    TO  Aԁ|{pN.
035460     MOVE {pvq    TO  Aԁ|{p.
035470     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
035480     MOVE }Ԃvq      TO  Aԁ|}.
035490*
035500     CALL   "CHOUKI".
035510     CANCEL "CHOUKI".
035520*
035530**** KpPgp (uÔ݁v鎞́A)
035540     IF Aԁ|ΏۃtO  = "YES"
035550        IF KpPv  = SPACE
035560           MOVE NC"{ppRʂɋL"  TO KpPv
035570        ELSE
035580           STRING KpPv           DELIMITED BY SPACE
035590                  NC"C"             DELIMITED BY SIZE
035600                  NC"{ppRʂɋL"   DELIMITED BY SIZE
035610                  INTO KpPv
035620           END-STRING
035630        END-IF
035640     END-IF.
035650*
035660*================================================================*
035670 ȑÕf[^ SECTION.
035680*
035690*********************************************************************************
035700*  ŏ̏ȑO̓Ɏ{pL^R[h(A~)́A敪
035710*  pɂ`FbNB(VKƌp̗)
035720*********************************************************************************
035730** ŏ̏擾
035740     MOVE SPACE                 TO tO.
035750     MOVE Ҕԍvq          TO {L|Ҕԍ.
035760     MOVE }Ԃvq              TO {L|}.
035770     MOVE {pavq          TO {L|{pa.
035780     MOVE {pNvq            TO {L|{pN.
035790     MOVE {pvq            TO {L|{p.
035800     MOVE ZERO                  TO {L|{p.
035810     START {pL^e   KEY IS >= {L|҃R[h
035820                                  {L|{paN
035830     END-START.
035840     IF ԃL[ = "00"
035850         MOVE ZERO  TO avs
035860         MOVE ZERO  TO Nvs
035870         MOVE ZERO  TO vs
035880         MOVE ZERO  TO vs
035890         MOVE SPACE TO ItOQ
035900         PERFORM {pL^eǍ
035910         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
035920                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
035930                       ( {L|{pa   NOT = {pavq    ) OR
035940                       ( {L|{pN     NOT = {pNvq      ) OR
035950                       ( {L|{p     NOT = {pvq      ) OR
035960                       ( tO           = "YES"           ) 
035970               IF  {L|fË敪 = 2
035980                   MOVE {L|{pa           TO avs
035990                   MOVE {L|{pN             TO Nvs
036000                   MOVE {L|{p             TO vs
036010                   MOVE {L|{p             TO vs
036020                   MOVE "YES"                    TO tO
036030               END-IF
036040               PERFORM {pL^eǍ
036050         END-PERFORM
036060     END-IF.
036070*
036080* ȑÕf[^
036090     IF tO = "YES"
036100        MOVE Ҕԍvq          TO {L|Ҕԍ
036110        MOVE }Ԃvq              TO {L|}
036120        MOVE avs          TO {L|{pa
036130        MOVE Nvs            TO {L|{pN
036140        MOVE vs            TO {L|{p
036150        MOVE vs            TO {L|{p
036160        START {pL^e   KEY IS <  {L|҃R[h
036170                                     {L|{paN
036180                                     REVERSED
036190        END-START
036200        IF ԃL[ = "00"
036210           MOVE SPACE  TO ItOQ
036220           PERFORM {pL^eǍ
036230           IF ( ItOQ    = SPACE        ) AND
036240              ( {L|Ҕԍ  = Ҕԍvq ) AND
036250              ( {L|}      = }Ԃvq     ) AND
036260              ( {L|{pa  = avs ) AND
036270              ( {L|{pN    = Nvs   ) AND
036280              ( {L|{p    = vs   )
036290*  ȑO̓Ɏ{pL^R[h
036300                IF p`FbNv = SPACE
036310                   MOVE NC""    TO p`FbNv
036320                END-IF
036330           END-IF
036340         END-IF
036350     END-IF.
036360*
036370*================================================================*
036380 Z擾 SECTION.
036390*****************************************************************
036400** ZԊOƐ[̎AKpɁutԁv󎚂B
036410**   ̈󎚂͌3܂ŉ\
036420*****************************************************************
036430     IF ( Z|ԊO = 1 ) OR ( Z|[ = 1 ) OR ( Z|x = 1 )
036440*
036450         MOVE Ҕԍvq          TO {L|Ҕԍ
036460         MOVE }Ԃvq              TO {L|}
036470         MOVE {pavq          TO {L|{pa
036480         MOVE {pNvq            TO {L|{pN
036490         MOVE {pvq            TO {L|{p
036500         MOVE ZERO                  TO {L|{p
036510         START {pL^e   KEY IS >= {L|҃R[h
036520                                      {L|{paN
036530         END-START
036540         IF ԃL[ = "00"
036550             MOVE ZERO  TO ZJEg
036560             MOVE SPACE TO ItOQ
036570             PERFORM {pL^eǍ
036580             PERFORM UNTIL ( ItOQ         = "YES"           ) OR
036590                           ( {L|҃R[h NOT = ҃R[hvq  ) OR
036600                           ( {L|{pa   NOT = {pavq    ) OR
036610                           ( {L|{pN     NOT = {pNvq      ) OR
036620                           ( {L|{p     NOT = {pvq      ) 
036630                   IF  ( {L|Z = 1 OR 2 OR 3 ) AND ( {L|fË敪 = 2 )
036640                       COMPUTE ZJEg = ZJEg  + 1
036650                       IF  ZJEg <= 3
036660                           MOVE {L|Z TO Z敪vs(ZJEg)
036670                           MOVE {L|t   TO Zvs(ZJEg)
036680                           MOVE {L|t   TO Zvs(ZJEg)
036690                       END-IF
036700                   END-IF
036710                   PERFORM {pL^eǍ
036720             END-PERFORM
036730** Z̎KpɃZbg
033380            IF ( Zvs(1) NOT = ZERO ) OR ( Zvs(1) NOT = ZERO ) 
                     MOVE Zvs(1) TO Zv
                     MOVE ":"               TO Z؂v
                     MOVE Zvs(1) TO Zv
                  END-IF
033380            IF ( Zvs(2) NOT = ZERO ) OR ( Zvs(2) NOT = ZERO ) 
031910               PERFORM ZKpZbg
                  END-IF
036750         END-IF
036760*
036770     END-IF.
036780*
036790*================================================================*
036800 ZKpZbg SECTION.
036810*
036820     PERFORM VARYING ԍJE^ FROM 1 BY 1
036830              UNTIL  ԍJE^ > 3
036840         IF ( Zvs(ԍJE^)  = ZERO )  AND 
036850            ( Zvs(ԍJE^)  = ZERO ) 
036860             CONTINUE
036870         ELSE
036880* Œ荀
036890             EVALUATE Z敪vs(ԍJE^) 
036900             WHEN 1
036910                MOVE NC"ԊO"   TO Zev(ԍJE^)
036900             WHEN 2
036910                MOVE NC"x@"   TO Zev(ԍJE^)
036920             WHEN 3
036930                MOVE NC"[@"   TO Zev(ԍJE^)
036940             END-EVALUATE
036950*
036960             MOVE NC"F"          TO Z؂v(ԍJE^)
036970             MOVE NC""          TO Œv(ԍJE^)
036980             MOVE NC""          TO Œv(ԍJE^)
036990*
037000**** {ϊ
037010* 
037020             MOVE Zvs(ԍJE^)  TO  v
037030             IF v >= 10
037040                 MOVE vP    TO ԍvP
037050                 PERFORM {ϊ
037060                 MOVE Spԍv  TO ZmvP(ԍJE^)
037070                 MOVE vQ    TO ԍvP
037080                 PERFORM {ϊ
037090                 MOVE Spԍv  TO ZmvQ(ԍJE^)
037100             ELSE
037110                 MOVE vQ    TO ԍvP
037120                 PERFORM {ϊ
037130                 MOVE Spԍv  TO ZmvQ(ԍJE^)
037140             END-IF
037150* 
037160             MOVE Zvs(ԍJE^)  TO  v
037170             MOVE vP    TO ԍvP
037180             PERFORM {ϊ
037190             MOVE Spԍv  TO ZmvP(ԍJE^)
037200             MOVE vQ    TO ԍvP
037210             PERFORM {ϊ
037220             MOVE Spԍv  TO ZmvQ(ԍJE^)
037230** 
037240        END-IF
037250     END-PERFORM.
037260*
037270     MOVE  ZWcmv(1)   TO ZPv. 
037280     MOVE  ZWcmv(2)   TO ZQv. 
037290     MOVE  ZWcmv(3)   TO ZRv. 
037300*
037310**** KpPQgpiRLڂœKpPgĂ鎞́AKpQj
037320     IF ( Zvs(2)  = ZERO ) AND ( Zvs(2)  = ZERO ) 
037330         CONTINUE
037340     ELSE
037350         IF KpPv  = SPACE
037360               STRING NC"Z"       DELIMITED BY SIZE
037370                      ZPv   DELIMITED BY SIZE
037380                      ZQv   DELIMITED BY SIZE
037390                      ZRv   DELIMITED BY SIZE
037400                      INTO KpPv
037410               END-STRING
037420         ELSE
037430               STRING NC"Z"       DELIMITED BY SIZE
037440                      ZPv   DELIMITED BY SIZE
037450                      ZQv   DELIMITED BY SIZE
037460                      ZRv   DELIMITED BY SIZE
037470                      INTO KpQv
037480               END-STRING
037490         END-IF
037500     END-IF.
037510*
037520*================================================================*
037530 {ϊ SECTION.
037540*
037550     MOVE NC"O"     TO Spԍv.
037560     CALL "htoz" WITH C LINKAGE
037570                        USING ԍvP SpԍvP.
037580*
037590*================================================================*
037600 擾 SECTION.
037610*
036080     MOVE SPACE TO  Á|L[.
036090     INITIALIZE     Á|L[.
036100     MOVE ʂvq           TO Á|.
036110     MOVE pSҔԍvq TO Á|pSҔԍ.
036120*
036130     CALL   "JOSEIMEI".
036140     CANCEL "JOSEIMEI".
036150*
036160     MOVE Á|P TO v.
037590**================================================================*
037600* 擾 SECTION.
037610**
037620******************************************
037630**  鎞Aʂ󎚂B
037640******************************************
037650**
037660*     EVALUATE ʂvq 
037670****  (ۂ͂̑ŁAYȂ)
037680*     WHEN  50
037690*         CONTINUE
037700**** 41Vl
037710*     WHEN  51
037720************ 4 "4113" "4108" "4132" ̎́AuvBȊÓuVv
037730*        IF  ( sԍv(1:4) = "4113" )  OR
037740*            ( sԍv(1:4) = "4108" )  OR
037750*            ( sԍv(1:4) = "4132" )  
037760*            MOVE NC""    TO v
037770*        ELSE
037780*            MOVE NC"V"    TO v
037790*        END-IF
037800**** q
037810*     WHEN  52
037820*            MOVE NC""    TO v
037830****            MOVE NC"e"    TO v
037840**** g
037850*     WHEN  53
037860*            MOVE NC""    TO v
037870**** 픚
037880*     WHEN  54
037890*            MOVE NC""    TO v
037900**** c 
037910*     WHEN  55
037920*            MOVE NC""    TO v
037930**** ̑
037940*     WHEN  60
037950*            CONTINUE
037960*     WHEN  OTHER
037970*            CONTINUE
037980*     END-EVALUATE.
037990**
038000*================================================================*
038010 {擾 SECTION.
038020*
038030     MOVE 01                TO `|敪R[h.
038040     MOVE ZERO              TO `|.
038050     MOVE ZERO              TO `|.
038060     MOVE ZERO              TO `|E敪.
038070     MOVE ZERO              TO `|ʒuԍ.
038080     MOVE {pavq      TO `|Jna.
038090     MOVE {pNvq        TO `|JnN.
038100     MOVE {pvq        TO `|Jn.
038110     START }X^ KEY IS <= |敪R[h
038120                                |ʃR[h
038130                                |JnaN
038140                                REVERSED
038150     END-START.
038160     READ }X^ NEXT
038170     NOT AT END
038180         MOVE `|㪖@          TO 㪖@Pv
038190         MOVE `|㪖@          TO 㪖@Pv
038200         MOVE `|d×            TO dÒPv
038210     END-READ.
038220*
038230*================================================================*
038240 {pN擾 SECTION.
038250*
038260     MOVE {pavq TO |敪.
038270     READ }X^
038280     NOT INVALID KEY
038290         MOVE |JnN TO {pNv
038300     END-READ.
038310     IF {pNv NOT = ZERO
038320        COMPUTE {pNv = {pNv + {pNvq - 1
038330     END-IF.
038340     MOVE {pNv  TO ZvgǗNv.
038350*
038360*================================================================*
038370 ϔCN擾 SECTION.
038380*
038390** ---// ̎󗝔Nɂ́AŏIʉ@ĂׁAޔ //----
038400     MOVE 󗝔Nv   TO ŏIʉ@Nv.
038410     MOVE 󗝌v   TO ŏIʉ@v.
038420     MOVE 󗝓v   TO ŏIʉ@v.
038430***
038440* (_t)
038450     EVALUATE Zvgt敪v 
038460*    /  ŏIʉ@ /
038470     WHEN ZERO
038480         MOVE ŏIʉ@Nv TO _tNv
038490         MOVE ŏIʉ@v TO _tv
038500         MOVE ŏIʉ@v TO _tv
038510*    /   /
038520     WHEN 1 
038530         PERFORM 擾
038540         MOVE 󗝔Nv     TO _tNv
038550         MOVE 󗝌v     TO _tv
038560         MOVE 󗝓v     TO _tv
038570*    /  󎚂Ȃ /
038580     WHEN 9
038590         MOVE ZERO         TO _tNv
038600         MOVE ZERO         TO _tv
038610         MOVE ZERO         TO _tv
038620*    /  ̑́AŏIʉ@ /
038630     WHEN OTHER
038640         MOVE ŏIʉ@Nv TO _tNv
038650         MOVE ŏIʉ@v TO _tv
038660         MOVE ŏIʉ@v TO _tv
038670     END-EVALUATE.
038680**
038690* (ґ)
038700     EVALUATE Zvgғt敪v 
038710*    /  ŏIʉ@ /
038720     WHEN ZERO
038730         MOVE ŏIʉ@Nv TO ҈ϔCNv
038740         MOVE ŏIʉ@v TO ҈ϔCv
038750         MOVE ŏIʉ@v TO ҈ϔCv
038760*    /   /
038770     WHEN 1 
038780         PERFORM 擾
038790         MOVE 󗝔Nv     TO ҈ϔCNv
038800         MOVE 󗝌v     TO ҈ϔCv
038810         MOVE 󗝓v     TO ҈ϔCv
038820*    /  󎚂Ȃ /
038830     WHEN 9
038840         MOVE ZERO         TO ҈ϔCNv
038850         MOVE ZERO         TO ҈ϔCv
038860         MOVE ZERO         TO ҈ϔCv
038870*    /  ̑́AŏIʉ@ /
038880     WHEN OTHER
038890         MOVE ŏIʉ@Nv TO ҈ϔCNv
038900         MOVE ŏIʉ@v TO ҈ϔCv
038910         MOVE ŏIʉ@v TO ҈ϔCv
038920     END-EVALUATE.
038930*
038940*================================================================*
038950 擾 SECTION.
038960*
038970     MOVE {pNvq   TO 󗝔Nv.
038980     MOVE {pvq   TO 󗝌v.
038990     MOVE {pavq TO |敪.
039000     READ }X^
039010     NOT INVALID KEY
039020         MOVE |JnN TO {pNv
039030     END-READ.
039040     IF {pNv NOT = ZERO
039050        COMPUTE {pNv = {pNv + {pNvq - 1
039060     END-IF.
039070*
039080     EVALUATE {pvq
039090     WHEN 4
039100     WHEN 6
039110     WHEN 9
039120     WHEN 11
039130         MOVE 30 TO 󗝓v
039140     WHEN 2
039150         DIVIDE 4 INTO {pNv GIVING    v
039160                                    REMAINDER ]v
039170         END-DIVIDE
039180         IF ]v = ZERO
039190             MOVE 29 TO 󗝓v
039200         ELSE
039210             MOVE 28 TO 󗝓v
039220         END-IF
039230     WHEN 1
039240     WHEN 3
039250     WHEN 5
039260     WHEN 7
039270     WHEN 8
039280     WHEN 10
039290     WHEN 12
039300         MOVE 31 TO 󗝓v
039310     WHEN OTHER
039320          CONTINUE
039330     END-EVALUATE.
039340*
039350*================================================================*
039360 擾 SECTION.
039370*
039380********************************************************************
039390*  R[ĥ́A1sɂ܂Ƃ߂Ĉ󎚂B
039400*  : @A Ƃœ].
039410*     R[ĥ܂Ƃ߁Ae[uɃZbg
039420*     (Aʂœ̂́A2sɂȂ)
039430********************************************************************
039440     MOVE  ZERO   TO  JE^ JE^Q.
039450     PERFORM VARYING ʂbms FROM 1 BY 1
039460             UNTIL ( ʂbms > ʐv )
039470*
039480****        IF ( |Ҕԍ(ʂbms)  NOT = ZERO )  AND
039490        IF ( |A(ʂbms)      NOT = ZERO )
039500*
039510           IF JE^ = ZERO
039520               MOVE 1   TO  JE^ JE^Q
039530               MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
039540               MOVE |A(ʂbms)     TO AԂv(JE^)   AԂbv
039550               MOVE ʂbms                   TO ʂv(JE^ JE^Q)
039560           ELSE
039570              IF ( |Ҕԍ(ʂbms)  = Ҕԍbv )  AND
039580                 ( |A(ʂbms)      = AԂbv     )
039590                 COMPUTE JE^Q = JE^Q  +  1
039600                 MOVE ʂbms                  TO ʂv(JE^ JE^Q)
039610              ELSE
039620                 COMPUTE JE^ = JE^  +  1
039630                 MOVE 1   TO  JE^Q
039640                 MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
039650                 MOVE |A(ʂbms)     TO AԂv(JE^)  AԂbv
039660                 MOVE ʂbms                   TO ʂv(JE^ JE^Q)
039670              END-IF
039680           END-IF
039690        END-IF
039700     END-PERFORM.
039710**************************************************************************
039720*  }X^蕶͎擾
039730**************************************************************************
039740     MOVE  ZERO   TO  JE^ JE^Q.
039750     PERFORM VARYING JE^ FROM 1 BY 1
039760             UNTIL ( JE^ > 9 )  OR ( AԂv(JE^) = ZERO )
039770** ۂ 敪 01
039780         MOVE 01                        TO |敪R[h
039790         MOVE Ҕԍv(JE^)  TO |Ҕԍ
039800         MOVE AԂv(JE^)      TO |A
039810         READ e
039820         NOT INVALID KEY
039830             INITIALIZE vs
039840             MOVE |bl(1) TO  Pvs
039850             MOVE |bl(2) TO  Qvs
039860             MOVE |bl(3) TO  Rvs
039870             MOVE |bl(4) TO  Svs
039880             MOVE |bl(5) TO  Tvs
039890             PERFORM VARYING JE^Q FROM 1 BY 1
039900                     UNTIL ( JE^Q > 9 )  OR 
039910                           ( ʂv(JE^ JE^Q) = ZERO )
039920                EVALUATE ʂv(JE^ JE^Q)
039930                WHEN 1
039940                   MOVE "@"  TO  io[vP(JE^Q)
039950                WHEN 2
039960                   MOVE "A"  TO  io[vP(JE^Q)
039970                WHEN 3
039980                   MOVE "B"  TO  io[vP(JE^Q)
039990                WHEN 4
040000                   MOVE "C"  TO  io[vP(JE^Q)
040010                WHEN 5
040020                   MOVE "D"  TO  io[vP(JE^Q)
039990                WHEN 6
040000                   MOVE "E"  TO  io[vP(JE^Q)
040010                WHEN 7
040020                   MOVE "F"  TO  io[vP(JE^Q)
040030                WHEN OTHER
040040                   CONTINUE
040050                END-EVALUATE
040060             END-PERFORM
040070*
040152             IF |͋敪 = 1
040153                 STRING io[mv  DELIMITED BY SPACE
040154                        Pvs  DELIMITED BY SIZE
040155                        Qvs  DELIMITED BY SIZE
040156                        Rvs  DELIMITED BY SIZE
040157                        Svs  DELIMITED BY SIZE
040158                        Tvs  DELIMITED BY SIZE
040159                        INTO ev(JE^)
040160                 END-STRING
040161             ELSE
005946                 INSPECT vs REPLACING ALL Sp BY p
                       MOVE SPACE TO Pv Qv
                       MOVE io[mv TO Pv
                       MOVE Pvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Qvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Rvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Svs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Tvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                        MOVE Pv TO ev(JE^)
040170             END-IF
040171*
040172         END-READ
040173     END-PERFORM.
040180*
040190*     PERFORM Zbg.
035680     PERFORM S̃Zbg.
040200*
040210*================================================================*
040220 Zbg SECTION.
040230*
040240**************************************************************************
040250*  ͂1s𒴂鎞́AsɕB
040260**************************************************************************
040270     MOVE  ZERO   TO  JE^ JE^Q.
040280     PERFORM VARYING JE^ FROM 1 BY 1
040290             UNTIL ( JE^ > 9 )  OR ( ev(JE^) = SPACE )
040300*
040520        INITIALIZE ewv
040530        MOVE ev(JE^)   TO ewv
040540        IF ( ePwv  NOT = SPACE )
040550           COMPUTE JE^Q = JE^Q  +  1
040560           MOVE ePwv  TO v(JE^Q)
040570        END-IF
040580        IF ( eQwv  NOT = SPACE )
040590           COMPUTE JE^Q = JE^Q  +  1
040600           MOVE eQwv  TO v(JE^Q)
040610        END-IF
034690        IF  eRwv  NOT = SPACE
034700            COMPUTE JE^Q = JE^Q  +  1
034710            MOVE eRwv  TO v(JE^Q)
034720        END-IF
034690        IF  eSwv  NOT = SPACE
034700            COMPUTE JE^Q = JE^Q  +  1
034710            MOVE eSwv  TO v(JE^Q)
034720        END-IF
040450*
040460     END-PERFORM.
035700*================================================================*
035710 S̃Zbg SECTION.
035720*
035730**************************************************************************
035740*  ͂1s𒴂鎞́AsɕB
035750**************************************************************************
           MOVE ev(1) TO Pv.
007270     PERFORM VARYING JE^ FROM 2 BY 1
007280             UNTIL ( JE^ > 9 )  OR  ( ev(JE^) = SPACE )
               MOVE ev(JE^) TO Qv
006966         CALL vOv WITH C LINKAGE
006967                             USING BY REFERENCE Pv
006968                                   BY REFERENCE Qv
           END-PERFORM.
035760     MOVE  Pv   TO  Pv.
035760     MOVE  ZERO   TO  JE^.
035770     PERFORM VARYING JE^ FROM 1 BY 1
035780             UNTIL ( JE^ > 7 )
035790*
035910        MOVE Pvo(JE^)  TO v(JE^)
035980*
035990     END-PERFORM.
036000*
040470*================================================================*
040480 R擾 SECTION.
040490*
040500* R擾 "CHOUBUN" Ă. 
040510     MOVE  SPACE TO  A|L[.
040520     INITIALIZE      A|L[.
040530     MOVE {pavq  TO  A|{pa.
040540     MOVE {pNvq    TO  A|{pN.
040550     MOVE {pvq    TO  A|{p.
040560     MOVE Ҕԍvq  TO  A|Ҕԍ.
040570     MOVE }Ԃvq      TO  A|}.
040580** ڗp56
040590     MOVE 56            TO  A|.
040600*
040610     CALL   "CHOUBUN".
040620     CANCEL "CHOUBUN".
040630*
040640*
040650*================================================================*
040660 S擾 SECTION.
040670*================================================================*
040680*  {lSł͂ȂAt
040700*     COMPUTE Sv = Av|S / 10.
040710*     COMPUTE Sv     = 10 - Sv.
040720*     MOVE NC""           TO  Œv.
040721*
040722* 14/10`@{lSɕύX
040723* 15/06 tɕύX
      * 19/07 SɕύX/0707
040724     MOVE Z|S TO Sv.
040726     MOVE NC""        TO  Œv.
040730*
040740*================================================================*
040750 {pL^eǍ SECTION.
040760*
040770     READ {pL^e NEXT
040780     AT END
040790         MOVE "YES" TO ItOQ
040800     END-READ.
040810*================================================================*
040820 Or  SECTION.
040830*
040840     IF  IQv >  JnQv
040850         COMPUTE vZv = IQv - JnQv
040860     ELSE
040870        MOVE ZERO TO vZv
040880     END-IF.
040890*
040900*================================================================*
040910 OrN  SECTION.
040920*
040930     IF  INQv >  JnNQv
040940         COMPUTE vZNv = INQv - JnNQv
040950         COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
040960     ELSE
040970        MOVE ZERO TO vZv
040980     END-IF.
040990*
041000*================================================================*
041010 Or  SECTION.
041020*
041030     MOVE JnaQv TO |敪.
041040     READ }X^
041050     NOT INVALID KEY
041060         MOVE |JnN TO JnNv
041070     END-READ.
041080     MOVE IaQv TO |敪.
041090     READ }X^
041100     NOT INVALID KEY
041110         MOVE |JnN TO INv
041120     END-READ.
041130**
041140     IF (JnNv NOT = ZERO) AND (INv NOT = ZERO)
041150        COMPUTE JnNv = JnNv + JnNQv - 1
041160        COMPUTE INv = INv + INQv - 1
041170*
041180        IF INv =  JnNv
041190           PERFORM  Or
041200        ELSE
041210           IF  INv >  JnNv
041220               COMPUTE vZNv = INv - JnNv
041230               COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
041240           ELSE
041250               MOVE ZERO TO vZv
041260           END-IF
041270        END-IF
041280     ELSE
041290        MOVE ZERO TO vZv
041300     END-IF.
041310*
041320*================================================================*
041330 Zvgя擾 SECTION.
041340*
041350     MOVE {pavq       TO Q|{pa.
041360     MOVE {pNvq         TO Q|{pN.
041370     MOVE {pvq         TO Q|{p.
041380     MOVE ҃R[hvq     TO Q|҃R[h.
041390     MOVE یʂvq       TO Q|ی.
           IF A|ی < 50
041390         MOVE یʂvq   TO Q|ی
           ELSE
032090         MOVE ʂvq   TO Q|ی
           END-IF.

041400     READ ƃt@CQ
041410     NOT INVALID KEY
041420          MOVE Q|    TO \Ԃv
041430     END-READ.
041440*
041450*================================================================*
041460  SECTION.
041470*
041480     EVALUATE یʂvq
041490     WHEN 01
041500     WHEN 04
041510     WHEN 08
041520     WHEN 09
           WHEN 05
041530        MOVE "YAS6125P"  TO  `̖o
041540        MOVE "GRP002"   TO  ڌQo
041550        WRITE YAS6125P
041560****        WRITE R[h
041570        PERFORM G[o
041580     WHEN OTHER
041590        MOVE "YAS6125P"  TO  `̖o
041600        MOVE "GRP001"   TO  ڌQo
041610        WRITE YAS6125P
041620****        WRITE R[h
041630        PERFORM G[o
041640     END-EVALUATE.
041650*
041660     MOVE "YAS6125P"  TO  `̖o.
041670     MOVE "SCREEN"   TO  ڌQo.
041680     WRITE YAS6125P.
041690****     WRITE R[h.
041700     PERFORM G[o.
041710*================================================================*
041720 G[o SECTION.
041730*
041740     IF ʒmo NOT = "00"
041750         DISPLAY NC"[G["              UPON CONS
041760         DISPLAY NC"ڌQoF" ڌQo UPON CONS
041770         DISPLAY NC"ʒmoF" ʒmo UPON CONS
041780         DISPLAY NC"goF" go UPON CONS
041790         DISPLAY NC"P͂dmsdqL[Ă"
041800                                             UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
041810         ACCEPT  L[ FROM CONS
041820         PERFORM t@C
041830         MOVE 99  TO PROGRAM-STATUS
041840         EXIT PROGRAM
041850     END-IF.
041860*================================================================*
041870 f҈敪XV SECTION.
041880*
041890** //  fҏë敪ɂPZbgAXVB//  
041900*
041910     MOVE {pavq       TO |{pa.
041920     MOVE {pNvq         TO |{pN.
041930     MOVE {pvq         TO |{p.
041940     MOVE ҃R[hvq     TO |҃R[h.
041950     READ fҏe
041960     NOT INVALID KEY
041970         MOVE  1  TO  |Z敪
041980         REWRITE  |R[h
041990         END-REWRITE
042000         IF ԃL[ NOT = "00"
042010            MOVE NC"f" TO t@C
042020            PERFORM G[\
042030         END-IF
042040     END-READ.
042050*
040580*================================================================*
040590 Ev擾 SECTION.
040600*
040610* Ev擾 "TEKIYBUN" Ă. 
040620     MOVE  SPACE TO  AE|L[.
040630     INITIALIZE      AE|L[.
           INITIALIZE      Ap|L[.
040640     MOVE {pavq  TO  AE|{pa.
040650     MOVE {pNvq    TO  AE|{pN.
040660     MOVE {pvq    TO  AE|{p.
040670     MOVE Ҕԍvq  TO  AE|Ҕԍ.
040680     MOVE }Ԃvq      TO  AE|}.
040700*     MOVE 63            TO  AE|.
039370     MOVE 56            TO  AE|.
015000     IF (ZR敪v NOT = 1 )
               MOVE R敪v TO AE|敪
           ELSE
               MOVE 1                  TO AE|敪
015050     END-IF.
040710*
040720     CALL   "TEKIYBUN".
040730     CANCEL "TEKIYBUN".
040740*/42505
           IF Ap|ptO = "YES"
              MOVE NC"F"       TO p
           END-IF.
           IF Ap|tO = "YES"
              MOVE NC""       TO 
           END-IF.
      *
042060*================================================================*
042070 ZEvăZbg SECTION.
043230*---------------------------------------------------------------*
043240* Evt@CΒȒOɍăZbgB
043250* iΉȂA܂蒷R͂̂܂܁j
043260*---------------------------------------------------------------*
           PERFORM Ev擾.
           MOVE AE|Ev(1)    TO RP.
           MOVE AE|Ev(2)    TO RQ.
           MOVE AE|Ev(3)    TO RR.
           MOVE AE|Ev(4)    TO RS.
           MOVE AE|Ev(5)    TO RT.
           MOVE AE|Ev(6)    TO RU.
           MOVE AE|Ev(7)    TO RV.
           MOVE AE|Ev(8)    TO RW.
042250*
044960*================================================================*
044961 Ώ۔菈 SECTION.
044963*------------------------------------------------------------------------------------*
044964* }X^́u敪v 3 iRʈȏj̎ARʈȏォ肵āA
044965* ̎̂݁AB
044966*------------------------------------------------------------------------------------*
044967*
044979     MOVE  SPACE TO  AZ|L[.
044980     INITIALIZE      AZ|L[.
044981     MOVE {pavq  TO  AZ|{pa.
044982     MOVE {pNvq    TO  AZ|{pN.
044983     MOVE {pvq    TO  AZ|{p.
044984     MOVE Ҕԍvq  TO  AZ|Ҕԍ.
044985     MOVE }Ԃvq      TO  AZ|}.
044986     CALL   "RECEHUGE".
044987     CANCEL "RECEHUGE".
044989*
044990     IF AZ|ΏۃtO = "YES"
044991        PERFORM 擾
044992     END-IF.
044993*
042260*================================================================*
042270*================================================================*
042280 G[\ SECTION.
042290*
042300     DISPLAY NC"t@CG[F" t@C   UPON CONS.
042310     DISPLAY NC"ԃL[" ԃL[                 UPON CONS.
042320     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
042330     DISPLAY NC"P͂dmsdqL[Ă" UPON CONS.
003321*-----------------------------------------*
003322     CALL "actcshm"  WITH C LINKAGE.
003323*-----------------------------------------*
042340     ACCEPT  L[ FROM CONS
042350     PERFORM t@C.
042360     EXIT PROGRAM.
042370*================================================================*
042380 I SECTION.
042390*
042400     PERFORM t@C.
042410*================================================================*
042420 t@C SECTION.
042430*
042440     CLOSE t@C.
042450     CLOSE ی҃}X^     }X^          ̃}X^
042460           Zvge       }X^      {p}X^
042470           o߃}X^       fҏe        }X^
042480           {pL^e       f[^e        e
042490           }X^       }X^        hcǗ}X^
042500           ƃt@CQ   s}X^        vZ}X^.
042510*
042520*================================================================*
042530*================================================================*
042540 eXg󎚏 SECTION.
042550     MOVE ALL "X"    TO ڍtԍP ڍtԍQ
042560                        {phc ϔԍ.
042570     MOVE ALL NC"m" TO όŒ.
042580     MOVE ALL NC"m" TO P Q.
042590     MOVE NC""     TO ŒP ŒQ.
042600*     MOVE ALL NC"m" TO {paP {paQ.
042610     MOVE 99         TO {pNP  {pP .
042620*     MOVE ALL NC"m" TO Œ NŒ ZŒ
      * ϔCŒ.
042630*     MOVE ALL "X"    TO ی҃Ji.
042640     MOVE ALL "m" TO یҎ.
042650*     MOVE ALL NC"m" TO یҌ یҔNŒ یҌŒ یғŒ.
042660*     MOVE 99         TO یҔN یҌ یғ.
042670     MOVE ALL "X"    TO ZP ZQ.
042680*     MOVE ALL NC"m" TO ی Œ.
042690*     MOVE 9          TO S.
042700     MOVE ALL "X"    TO یҔԍ.
042710*     MOVE ALL NC"m" TO L.
042720*     MOVE ALL "X"    TO ԍ.
042730     MOVE ALL "X"    TO ҃Ji.
042740     MOVE ALL "m" TO Ҏ.
042750*     MOVE "(j)"     TO Ґ.
042760*     MOVE ALL NC"m" TO  ҔNŒ ҌŒ ғŒ.
042770     MOVE 99         TO ҔN Ҍ ғ.
042780     MOVE ALL "M"    TO P Q R S
                              T U.
042800     MOVE ALL NC"m" TO P.
042810     MOVE 99 TO NP P P NP P P
042820                JnNP JnP JnP INP IP IP
042830                P.
042840     MOVE NC"" TO `FbNP ~`FbNP ]`FbNP.
042850     MOVE ALL NC"m" TO Q.
042860     MOVE 99 TO NQ Q Q NQ Q Q
042870                JnNQ JnQ JnQ INQ IQ IQ
042880                Q.
042890     MOVE NC"" TO `FbNQ ~`FbNQ ]`FbNQ.
042900     MOVE ALL NC"m" TO R.
042910     MOVE 99 TO NR R R NR R R
042920                JnNR JnR JnR INR IR IR
042930                R.
042940     MOVE NC"" TO `FbNR ~`FbNR ]`FbNR.
042950     MOVE ALL NC"m" TO S.
042960     MOVE 99 TO NS S S NS S S
042970                JnNS JnS JnS INS IS IS
042980                S.
042990     MOVE NC"" TO `FbNS ~`FbNS ]`FbNS.
043000     MOVE ALL NC"m" TO T.
043010     MOVE 99 TO NT T T NT T T
043020                JnNT JnT JnT INT IT IT
043030                T.
043040     MOVE NC"" TO `FbNT ~`FbNT ]`FbNT.
043050     PERFORM VARYING ʂbms FROM 1 BY 1
043060             UNTIL ( ʂbms > 5 )
043070         MOVE ALL NC"m" TO oߗ(ʂbms)
043080     END-PERFORM.
           MOVE NC"" TO j`FbN `FbN 
           `FbN 吳`FbN a`FbN `FbN 
           PO`FbN X`FbN W`FbN V`FbN 
           `FbN g`FbN σ`FbN ۃ`FbN ސE`FbN `FbN 
           Pƃ`FbN Q`FbN 
           {l`FbN U΃`FbN Ƒ`FbN V`FbN `FbN
           U`FbN ʃ`FbN `FbN s`FbN Ƀ`FbN
           _`FbN {X`FbN xX`FbN {x`FbN

           MOVE ALL NC"" TO KpP KpQ
           MOVE ALL "X" TO SҔԍ 󋋎Ҕԍ Lԍ 
      *     _tԍ
      *
043090     MOVE NC"" TO VK`FbN p`FbN.
043100     MOVE 99999 TO  .
043110     MOVE 99999 TO  Č.
043120     MOVE 99.9 TO  Ë.
043130     MOVE 99 TO  É.
043140     MOVE 99999 TO  ×.
043150     MOVE NC"" TO  `FbN `FbN `FbN.
043160     MOVE 99999 TO  qZ.
043170     MOVE 999999 TO  v.
043180     MOVE NC"" TO  ԊO`FbN x`FbN [`FbN.
043190     MOVE 99999 TO  Z.
043200     MOVE NC"" TO  ԃ`FbN H`FbN \J`FbN.
043210     MOVE 99999 TO  ÉZ.
043220     MOVE 99999 TO  {p񋟗.
043230     MOVE NC"" TO `FbN Œ藿`FbN {×`FbN.
043240     PERFORM VARYING ʂbms FROM 1 BY 1
043250             UNTIL ( ʂbms > 5 )
043260         MOVE 99999 TO 񏈒u(ʂbms)
043270     END-PERFORM.
043280     MOVE 999999 TO 񏈒uv.
043290     MOVE 99    TO É񐔂P 㪖@񐔂P 㪖@񐔂P dÉ񐔂P.
043300     MOVE 9999  TO ÒPP 㪖@P   㪖@P   d×P.
043310     MOVE 99999 TO ×P   vP       vP.
043320     MOVE 9.9 TO P.
043330     MOVE 99 TO É񐔂Q 㪖@񐔂Q 㪖@񐔂Q dÉ񐔂Q.
043340     MOVE 9999  TO ÒPQ 㪖@Q   㪖@Q   d×Q.
043350     MOVE 99999 TO ×Q   vQ       vQ.
043360     MOVE 9.9 TO Q.
043370     MOVE 99 TO É񐔂RW 㪖@񐔂RW 㪖@񐔂RW dÉ񐔂RW.
043380     MOVE 9999  TO ÒPRW 㪖@RW   㪖@RW   d×RW.
043390     MOVE 99999 TO ×RW vRW vRW ʍvRW.
043400     MOVE 9.9 TO RW.
043410     MOVE 99 TO JnRO JnRO.
043420     MOVE 99 TO É񐔂RO 㪖@񐔂RO 㪖@񐔂RO dÉ񐔂RO.
043430     MOVE 9999  TO ÒPRO 㪖@RO   㪖@RO   d×RO.
043440     MOVE 99999 TO ×RO vRO vRO.
043450     MOVE 9.9 TO RO.
043460*     MOVE 99 TO É񐔂ST 㪖@񐔂ST 㪖@񐔂ST dÉ񐔂ST.
043470*     MOVE 9999  TO ÒPST 㪖@ST   㪖@ST   d×ST.
043480*     MOVE 99999 TO ×ST vST vST ʍvST.
043490*     MOVE 9.9 TO ST.
043500     MOVE 99 TO JnSW JnSW.
043510     MOVE 99 TO É񐔂SW 㪖@񐔂SW 㪖@񐔂SW dÉ񐔂SW.
043520     MOVE 9999  TO ÒPSW 㪖@SW   㪖@SW   d×SW.
043530     MOVE 99999 TO ×SW vSW vSW ʍvSW.
043540     MOVE 9.9 TO SW.
043550     MOVE 99 TO JnSO JnSO.
043560     MOVE 99 TO É񐔂SO 㪖@񐔂SO 㪖@񐔂SO dÉ񐔂SO.
043570     MOVE 9999  TO ÒPSO 㪖@SO   㪖@SO   d×SO.
043580     MOVE 99999 TO ×SO vSO vSO.
043590     MOVE 9.9 TO SO.
043860     MOVE ALL "X" TO ʂTO ʂTW.
043600*
043610*     MOVE "5)45 " TO ŒTT.
043620*     MOVE "0.45"  TO ʗTT.
043630*     MOVE 11 TO JnTT JnTT.
043640*     MOVE 22 TO É񐔂TT 㪖@񐔂TT 㪖@񐔂TT dÉ񐔂TT.
043650*     MOVE 3335  TO ÒPTT 㪖@TT   㪖@TT   d×TT.
043660*     MOVE 99995 TO ×TT vTT vTT ʍvTT.
043670*     MOVE 8.8 TO TT.
043680*     MOVE "5)80 " TO ŒTW.
043690*     MOVE "0.8 "  TO ʗTW.
043700*     MOVE 11 TO JnTW JnTW.
043710*     MOVE 22 TO É񐔂TW 㪖@񐔂TW 㪖@񐔂TW dÉ񐔂TW.
043720*     MOVE 3338  TO ÒPTW 㪖@TW   㪖@TW   d×TW.
043730*     MOVE 99998 TO ×TW vTW vTW ʍvTW.
043740*     MOVE 8.8 TO TW.
043750*     MOVE "5)100" TO ŒTO.
043760*     MOVE 11 TO JnTO JnTO.
043770*     MOVE 22 TO É񐔂TO 㪖@񐔂TO 㪖@񐔂TO dÉ񐔂TO.
043780*     MOVE 3330  TO ÒPTO 㪖@TO   㪖@TO   d×TO.
043790*     MOVE 99990 TO ×TO vTO vTO.
043800*     MOVE 8.8 TO TO.
043810     MOVE ALL NC"m" TO KpP KpQ.
043820     MOVE ALL "m" TO RP RQ RR
043830                      RS RT RU.
043840     MOVE 999999 TO v ꕔS z.
043850*     MOVE ALL "X"    TO یҖ̂P یҖ̂Q.
043860*     MOVE ALL "X" TO _tԍ.
043870     MOVE 99 TO 󗝔N 󗝌 󗝓.
043880     MOVE 99 TO ϔCN ϔC ϔC.
043890     MOVE 999  TO {pX֔ԍP.
043900     MOVE 9999 TO {pX֔ԍQ.
043910     MOVE ALL "X" TO {pZP {pZQ.
043920     MOVE ALL "m" TO ڍ@.
043930     MOVE ALL "X" TO \҃Ji.
043940     MOVE ALL "m" TO \Җ.
043950     MOVE ALL "X" TO {pdbԍ.
043960*     MOVE ALL "m" TO `l.
043970*     MOVE ALL "X" TO sxX ԍ `lJi.
043980*     MOVE NC"immj" TO a.
043990*
044000*================================================================*
042180*================================================================*
042190 Z܂Ƃߔ SECTION.
042200*---------------------------------------------------------------------------*
042210* {̂܂Ƃߋ敪P
042220* ̎́AtOYES (z݂ň󎚁j
042230*iFls̏Q́A{̕یiیnj̃ZvgPŐAZ͂Ȃj
042240*---------------------------------------------------------------------------*
042250*
042260     MOVE SPACE TO Z܂Ƃ߃tO.
009201     IF Z|{̂܂Ƃߋ敪 = 1 
009202        MOVE "YES" TO Z܂Ƃ߃tO
009203     END-IF.
042650*
042660*----------------------------------------------------------------------*
042670** / _ސ쌧ŗLFEvɕSҔԍƎ󋋎Ҕԍ /
042680     IF ( Z܂Ƃ߃tO = "YES" ) AND
042690        ( |pSҔԍ(3:2) = "14" )
042700        IF |pSҔԍ(1:2) NOT = "99"
042710*            MOVE ALL NC"P"    TO P Q R
042720*            MOVE ALL NC"b"    TO cP cQ
042730*            MOVE NC"b"                    TO cR cS
042740*            MOVE NC"SҔԍ"        TO _ސŒP
042750*            MOVE NC"󋋎Ҕԍ"            TO _ސŒQ
042760*            MOVE NC"^"                    TO _ސŒR
042770*            MOVE |pSҔԍ    TO _ސ앉SҔԍ 
042780*            MOVE |vҔԍ        TO _ސ󋋎Ҕԍ
                  MOVE sԍv     TO SҔԍ
      *            MOVE vҔԍv TO 󋋎Ҕԍ
      */󋋎ҔԍWȏ̏ꍇg𖳎Ĉ/110425
                  MOVE |vҔԍ   TO 󋋎Ҕԍv
                  IF 󋋎ҔԍQv = SPACE
016830                MOVE 󋋎Ҕԍv TO 󋋎Ҕԍ
                  ELSE
                      MOVE 󋋎Ҕԍv     TO 󋋎ҔԍQ
                  END-IF
042790        END-IF
042800     END-IF.
042810**/a̎RQcЂƂe/100518
042820     IF ( Z܂Ƃ߃tO = "YES" ) AND
042830        ( |pSҔԍ(3:2) = "30" )
042840        IF |pSҔԍ(1:2) NOT = "99"
042850*            MOVE ALL NC"P"    TO P Q R
042860*            MOVE ALL NC"b"    TO cP cQ
042870*            MOVE NC"b"                    TO cR cS
042880*            MOVE NC"SҔԍ"        TO _ސŒP
042890*            MOVE NC"󋋎Ҕԍ"            TO _ސŒQ
042900*            MOVE NC"^"                    TO _ސŒR
042910*            MOVE |pSҔԍ    TO _ސ앉SҔԍ 
042920*            MOVE |vҔԍ        TO _ސ󋋎Ҕԍ
                  MOVE sԍv     TO SҔԍ
      *            MOVE vҔԍv TO 󋋎Ҕԍ
      */󋋎ҔԍWȏ̏ꍇg𖳎Ĉ/110425
                  MOVE |vҔԍ   TO 󋋎Ҕԍv
                  IF 󋋎ҔԍQv = SPACE
016830                MOVE 󋋎Ҕԍv TO 󋋎Ҕԍ
                  ELSE
                      MOVE 󋋎Ҕԍv     TO 󋋎ҔԍQ
                  END-IF
042790        END-IF
042930     END-IF.
042940*
043210*================================================================*
       {p擾 SECTION.
      *
      *     MOVE SPACE TO {pv.
028350     MOVE Ҕԍvq          TO {L|Ҕԍ
028360     MOVE }Ԃvq              TO {L|}
028370     MOVE {pavq          TO {L|{pa
028380     MOVE {pNvq            TO {L|{pN
028390     MOVE {pvq            TO {L|{p
028400     MOVE ZERO                  TO {L|{p
028420     START {pL^e   KEY IS >= {L|҃R[h
028430                                  {L|{paN
028440     END-START
028450     IF ԃL[ = "00"
030910         MOVE SPACE TO ItOQ
030920         PERFORM {pL^eǍ
030930         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030940                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030950                       ( {L|{pa   NOT = {pavq    ) OR
030960                       ( {L|{pN     NOT = {pNvq      ) OR
030970                       ( {L|{p     NOT = {pvq      )
                   MOVE NC"" TO {p`FbN({L|{p)
                   PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
           PERFORM VARYING JE^ FROM 1 BY 1 UNTIL JE^ > 31
               MOVE JE^ TO {p(JE^)
           END-PERFORM.
037520*================================================================*
023610 擾㍂ SECTION.
023620*
023630****************************************************
023640* Af[^s}X^萿擾B *
023650*  ...... 於̂vɊi[               *
023660*                                                  *
023670* 2001/10/26 CF28̂ݎx    *
023680*                                                  *
023690****************************************************
023700     MOVE ʂvq        TO s|.
023710     MOVE pSҔԍvq  TO s|sԍ.
023720     READ s}X^
023730     INVALID KEY
023740         MOVE SPACE              TO 於̂sak
023750         MOVE SPACE              TO xv
023760     NOT INVALID KEY
023770         IF s|敪 = 1
023780             MOVE ʂvq       TO |ی
023790             MOVE pSҔԍvq TO |یҔԍ
023800             READ }X^
023810             INVALID KEY
023820                 MOVE SPACE        TO 於̂sak
023830                 MOVE SPACE        TO xv
023840             NOT INVALID KEY
023850                 MOVE |یҖ  TO 於̂sak
023860                 MOVE |x  TO xv
023870*
023880                 IF pSҔԍvq(3:2) NOT = "28"
023890                    MOVE SPACE TO xv
023900                 END-IF
023910*
023920             END-READ
023930         ELSE
023940             MOVE s|s  TO 於̂sak
023950             MOVE SPACE           TO xv
023960         END-IF
023970     END-READ.
023980*
023990     IF 於̂sak NOT = SPACE
024000        PERFORM VARYING JE^ FROM 1 BY 1
024010                UNTIL ( JE^ > 20 )  OR
024020                      ( 於̂vs(JE^) = SPACE )
024030           MOVE 於̂vs(JE^) TO 於̂vsP
024040        END-PERFORM
024050        IF 於̂vsP = "s" OR "" OR "" OR ""
024060           STRING 於̂sak  DELIMITED BY SPACE
024070                  ""              DELIMITED BY SIZE
024080                  xv      DELIMITED BY SPACE
024090                  "a"              DELIMITED BY SIZE
024100                  INTO 於̂v
024110           END-STRING
024120        ELSE
024130           STRING 於̂sak  DELIMITED BY SPACE
024140                  "@"              DELIMITED BY SIZE
024150                  xv      DELIMITED BY SPACE
024160                  "a"              DELIMITED BY SIZE
024170                  INTO 於̂v
024180           END-STRING
024190        END-IF
024200     END-IF.
024210*
024220*================================================================*
       Rʓ SECTION.
      *
      *------------------------------------------------------------------------------------------*
      * ARʈȏ㕉all͍ς݂`FbN@22N6{p
      *------------------------------------------------------------------------------------------*
           MOVE SPACE  TO ΏۃtO.
           MOVE SPACE  TO ̓tO.
      *
      *     PERFORM f[^`FbN.
      *     IF sL[v = "YES"
               MOVE {pavq   TO {parv
               MOVE {pNvq     TO {pNrv
               MOVE {pvq     TO {prv
               IF ( |ʐ >= 3 )
      *
      *---------------------------------------------------------------------------*
      * --- ΏہF100́HHiɂRʈȏ゠邩j̃`FbN-----------*
      *
      *--------------------------------------------------------* 
      *
      *           / ZERONA[ /
                  MOVE ZERO TO bv
                  MOVE ZERO TO JE^ŏv
                  MOVE ZERO TO JE^Ōv
      *
                  PERFORM VARYING ʂbms FROM 1 BY 1
                           UNTIL  ʂbms > |ʐ 
      *              / -- Jn --- /
                     IF ( {pavq  = |Jna(ʂbms) ) AND
                        ( {pNvq    = |JnN(ʂbms) )   AND
                        ( {pvq    = |Jn(ʂbms) )
      *                 / p /
                        IF |]A敪(ʂbms) = 9
                           MOVE |Jn(ʂbms)  TO JE^ŏv
                           MOVE 31                      TO JE^Ōv
                        ELSE
      *                 / I /
                           MOVE |Jn(ʂbms)  TO JE^ŏv
                           MOVE |I(ʂbms)  TO JE^Ōv
                        END-IF
      *              / -- JnȊO --- /
                     ELSE
      *                  / p /
                        IF |]A敪(ʂbms) = 9
                           MOVE 1                       TO JE^ŏv
                           MOVE 31                      TO JE^Ōv
                        ELSE
      *                  / I /
                           MOVE 1                       TO JE^ŏv
                           MOVE |I(ʂbms)  TO JE^Ōv
                        END-IF
                     END-IF
      *             / Z /
                     PERFORM VARYING JE^ FROM  JE^ŏv BY 1
                                     UNTIL JE^  >  JE^Ōv 
                          COMPUTE v(JE^) = v(JE^) + 1
                     END-PERFORM
      *
                  END-PERFORM
      **
      **          / e[u`FbN /
                  PERFORM VARYING JE^ FROM 1 BY 1
                                     UNTIL ( JE^ > 31 )  OR ( ΏۃtO = "YES" )
                      IF v(JE^) >= 3
                          MOVE "YES" TO ΏۃtO
                      END-IF
                  END-PERFORM
               END-IF.
      *     END-IF.
      *
      *     IF ΏۃtO = "YES"
      *         MOVE "YES" TO ΏۃtO
      *     END-IF.
024220*================================================================*
       vZ}X^擾 SECTION.
      *
      * 敪FOP@Nی
           MOVE 01             TO v|敪.
           MOVE A|{pa TO v|Jna {pabv.
           MOVE A|{pN   TO v|JnN   {pNbv.
           MOVE A|{p   TO v|Jn   {pbv.
      *
           START vZ}X^ KEY IS <= v|敪 v|JnaN REVERSED
           END-START.
      *
           IF ԃL[ = "00"
               READ vZ}X^ NEXT
               AT END
                   PERFORM R\[G[mF
                   DISPLAY "{pNɑΉ݂܂"
                   " f҇=" A|҃R[h " {pN=" A|{pN A|{p UPON CONS
                   PERFORM I
                   MOVE ZERO TO PROGRAM-STATUS
                   EXIT PROGRAM
               NOT AT END
                   IF ( {paNbv >= v`|JnaN ) AND
                      ( {paNbv <= v`|IaN )
                       MOVE v`|ʒ(3) TO ʒRv
                   ELSE
                       PERFORM R\[G[mF
                       DISPLAY "{pNɑΉ݂܂"
                       " f҇=" A|҃R[h " {pN=" A|{pN A|{p UPON CONS
                       PERFORM I
                       MOVE ZERO TO PROGRAM-STATUS
                       EXIT PROGRAM
                   END-IF
               END-READ
           END-IF.
040820*================================================================*
040830 oߎ擾 SECTION.
040840*
036040     MOVE  SPACE TO  Aԁ|L[.
036050     INITIALIZE      Aԁ|L[.
036060     MOVE {pavq  TO  Aԁ|{pa.
036070     MOVE {pNvq    TO  Aԁ|{pN.
036080     MOVE {pvq    TO  Aԁ|{p.
036090     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
036100     MOVE }Ԃvq      TO  Aԁ|}.
036110*
036120     CALL   "CHOUKI".
036130     CANCEL "CHOUKI".
036140*
      */PEŖoE͓]Aɂ炸Rȏ́uǍDvA
      */ȊOׂ͂āuǍDvɂ@@@@@@@@@@@@@@@@/151217
031620     PERFORM VARYING ʂbms FROM 1 BY 1
031630             UNTIL ( ʂbms > ʐv )
               IF  (|o߃R[h(ʂbms) = ZERO)
028850             EVALUATE ʂbms
028860             WHEN 1
028870                 MOVE NC"@" TO oߕʂv
028880             WHEN 2
028890                 MOVE NC"A" TO oߕʂv
028900             WHEN 3
028910                 MOVE NC"B" TO oߕʂv
028920             WHEN 4
028930                 MOVE NC"C" TO oߕʂv
028940             WHEN 5
028950                 MOVE NC"D" TO oߕʂv
028960             END-EVALUATE
                   IF |(ʂbms) = 01 OR 02 OR 03
040850*              IF ( |]A敪(ʂbms) NOT = 1 AND 2)
040900                 IF ( Aԁ|Ԃv(ʂbms)  >= 3 )
040910                     MOVE NC"ǍD" TO  o߂bl
040920                 ELSE
040930                     MOVE NC"ǍD"     TO  o߂bl
040940                 END-IF
                   ELSE
040930                 MOVE NC"ǍD"     TO  o߂bl
040950*              END-IF
                   END-IF
                   MOVE SPACE      TO  oߗ̂v(ʂbms)
028970             STRING  oߕʂv     DELIMITED BY SPACE
028980                     o߂bl       DELIMITED BY SPACE
028990                INTO oߗ̂v(ʂbms)
029000             END-STRING
               END-IF
           END-PERFORM.
040960*
005659*================================================================*
       R\[G[mF SECTION.
      *
           IF G[\e = ZERO
014083         MOVE  "G[̂ŃR\[ʂ̓e" TO AV|bZ[WP
014084         MOVE  "mFACĂB"             TO AV|bZ[WQ
014085         CALL   "MSG007"
014086         CANCEL "MSG007"
           END-IF.
           MOVE 1 TO G[\e.
      *================================================================*
044010******************************************************************
044020 END PROGRAM YAS6125.
044030******************************************************************
