000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YGN662.
000060 AUTHOR.                 池田　幸子
000070*
000080*----------------------------------------------------------------*
000090*         群馬用
000100*         カルテ印刷（柔+ｳｨﾝﾄﾞｳｽﾞ版）
000110*         MED = YAW660 YGN662P
      *
      */職業追加/160331
000120*----------------------------------------------------------------*
000130 DATE-WRITTEN.           2016-04-06
000140 DATE-COMPILED.          2016-04-06
000150*----------------------------------------------------------------*
000160******************************************************************
000170*            ENVIRONMENT         DIVISION                        *
000180******************************************************************
000190 ENVIRONMENT             DIVISION.
000200 CONFIGURATION           SECTION.
000210 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000220 OBJECT-COMPUTER.        FMV-DESKPOWER.
000230 SPECIAL-NAMES.          CONSOLE  IS  CONS
000240                         SYSERR   IS  MSGBOX.
000250 INPUT-OUTPUT            SECTION.
000260 FILE-CONTROL.
000270     SELECT  保険者マスタ    ASSIGN      TO        HOKENSL
000280                             ORGANIZATION             IS  INDEXED
000290                             ACCESS MODE              IS  DYNAMIC
000300                             RECORD KEY               IS  保−保険種別
000310                                                          保−保険者番号
000320* 将来は、キー項目の保険者名称を保険者カナにする
000330                             ALTERNATE RECORD KEY     IS  保−保険種別
000340                                                          保−保険者名称
000350                                                          保−保険者番号
000360                             FILE STATUS              IS  状態キー
000370                             LOCK        MODE         IS  AUTOMATIC.
000380     SELECT  元号マスタ      ASSIGN      TO        GENGOUL
000390                             ORGANIZATION             IS  INDEXED
000400                             ACCESS MODE              IS  DYNAMIC
000410                             RECORD KEY               IS  元−元号区分
000420                             FILE STATUS              IS  状態キー
000430                             LOCK        MODE         IS  AUTOMATIC.
000440     SELECT  名称マスタ      ASSIGN      TO        MEISYOL
000450                             ORGANIZATION             IS  INDEXED
000460                             ACCESS MODE              IS  DYNAMIC
000470                             RECORD KEY               IS  名−区分コード
000480                                                          名−名称コード
000490                             FILE STATUS              IS  状態キー
000500                             LOCK        MODE         IS  AUTOMATIC.
000510     SELECT  レセプトＦ      ASSIGN      TO        RECEPTL
000520                             ORGANIZATION             IS  INDEXED
000530                             ACCESS MODE              IS  DYNAMIC
000540                             RECORD KEY               IS  レセ−施術和暦年月
000550                                                          レセ−患者コード
000560                                                          レセ−レセ種別
000570                             ALTERNATE RECORD KEY     IS  レセ−患者コード
000580                                                          レセ−施術和暦年月
000590                                                          レセ−レセ種別
000600                             ALTERNATE RECORD KEY     IS  レセ−請求和暦年月
000610                                                          レセ−施術和暦年月
000620                                                          レセ−患者コード
000630                                                          レセ−レセ種別
000640                             ALTERNATE RECORD KEY     IS  レセ−請求和暦年月
000650                                                          レセ−レセ種別
000660                                                          レセ−請求保険者番号
000670                                                          レセ−患者コード
000680                                                          レセ−施術和暦年月
000690                             ALTERNATE RECORD KEY     IS  レセ−請求和暦年月
000700                                                          レセ−請求保険者番号
000710                                                          レセ−患者コード
000720                                                          レセ−レセ種別
000730                                                          レセ−施術和暦年月
000740                             FILE STATUS              IS  状態キー
000750                             LOCK        MODE         IS  AUTOMATIC.
000760     SELECT  制御情報マスタ  ASSIGN      TO        SEIGYOL
000770                             ORGANIZATION             IS  INDEXED
000780                             ACCESS MODE              IS  DYNAMIC
000790                             RECORD KEY               IS  制−制御区分
000800                             FILE STATUS              IS  状態キー
000810                             LOCK        MODE         IS  AUTOMATIC.
000820     SELECT  受診者情報Ｆ    ASSIGN      TO        JUSINJL
000830                             ORGANIZATION             IS  INDEXED
000840                             ACCESS MODE              IS  DYNAMIC
000850                             RECORD KEY               IS  受−施術和暦年月
000860                                                          受−患者コード
000870                             ALTERNATE RECORD KEY     IS  受−施術和暦年月
000880                                                          受−患者カナ
000890                                                          受−患者コード
000900                             ALTERNATE RECORD KEY     IS  受−患者コード
000910                                                          受−施術和暦年月
000920                             ALTERNATE RECORD KEY     IS  受−施術和暦年月
000930                                                          受−保険種別
000940                                                          受−保険者番号
000950                                                          受−患者コード
000960                             ALTERNATE RECORD KEY     IS  受−施術和暦年月
000970                                                          受−公費種別
000980                                                          受−費用負担者番号
000990                                                          受−患者コード
001000                             ALTERNATE RECORD KEY     IS  受−施術和暦年月
001010                                                          受−助成種別
001020                                                          受−費用負担者番号助成
001030                                                          受−患者コード
001040                             ALTERNATE RECORD KEY     IS  受−請求和暦年月
001050                                                          受−施術和暦年月
001060                                                          受−患者コード
001070                             FILE STATUS              IS  状態キー
001080                             LOCK        MODE         IS  AUTOMATIC.
001090     SELECT  施術記録Ｆ      ASSIGN      TO        SEKIROKL
001100                             ORGANIZATION             IS  INDEXED
001110                             ACCESS MODE              IS  DYNAMIC
001120                             RECORD KEY               IS  施記−施術和暦年月日
001130                                                          施記−患者コード
001140                             ALTERNATE RECORD KEY     IS  施記−患者コード
001150                                                          施記−施術和暦年月日
001160                             FILE STATUS              IS  状態キー
001170                             LOCK        MODE         IS  AUTOMATIC.
001180     SELECT  負傷データＦ    ASSIGN      TO        HUSYOUL
001190                             ORGANIZATION             IS  INDEXED
001200                             ACCESS MODE              IS  DYNAMIC
001210                             RECORD KEY               IS 負−施術和暦年月
001220                                                         負−患者コード
001230                             ALTERNATE RECORD KEY     IS 負−患者コード
001240                                                         負−施術和暦年月
001250                             FILE STATUS              IS  状態キー
001260                             LOCK        MODE         IS  AUTOMATIC.
001270     SELECT  負傷原因Ｆ      ASSIGN      TO        HUGEINL
001280                             ORGANIZATION             IS  INDEXED
001290                             ACCESS MODE              IS  DYNAMIC
001300                             RECORD KEY               IS  負原−区分コード
001310                                                          負原−負傷原因コード
001320                             FILE STATUS              IS  状態キー
001330                             LOCK        MODE         IS  AUTOMATIC.
001340     SELECT  市町村マスタ    ASSIGN      TO        SITYOSNL
001350                             ORGANIZATION             IS  INDEXED
001360                             ACCESS MODE              IS  DYNAMIC
001370                             RECORD KEY               IS  市−公費種別
001380                                                          市−市町村番号
001390                             ALTERNATE RECORD KEY     IS  市−公費種別
001400                                                          市−市町村名称
001410                                                          市−市町村番号
001420                             FILE STATUS              IS  状態キー
001430                             LOCK        MODE         IS  AUTOMATIC.
000241     SELECT  生保情報Ｆ      ASSIGN      TO        SEIHOJL
000242                             ORGANIZATION             IS INDEXED
000243                             ACCESS MODE              IS DYNAMIC
000244                             RECORD KEY               IS 生保−施術和暦年月
000245                                                         生保−患者コード
000255                             ALTERNATE RECORD KEY     IS 生保−患者コード
000265                                                         生保−施術和暦年月
000277                             FILE STATUS              IS 状態キー
000278                             LOCK        MODE         IS AUTOMATIC.
001440     SELECT  事業所マスタ    ASSIGN      TO        JIGYOSL
001450                             ORGANIZATION             IS  INDEXED
001460                             ACCESS MODE              IS  DYNAMIC
001470                             RECORD KEY               IS  事−保険種別
001480                                                          事−保険者番号
001490                                                          事−記号
001500                             FILE STATUS              IS  状態キー
001510                             LOCK        MODE         IS  AUTOMATIC.
001720     SELECT カルテファイル   ASSIGN      TO        KARUTEL
001721                             ORGANIZATION             IS  INDEXED
001722                             ACCESS                   IS  DYNAMIC
001723                             RECORD      KEY          IS  カ−会コード
001724                                                          カ−区分
001725                                                          カ−施術和暦年月
001726                                                          カ−患者コード
001727                             ALTERNATE RECORD KEY     IS  カ−会コード
001728                                                          カ−区分
001729                                                          カ−患者コード
001730                                                          カ−施術和暦年月
001731                             ALTERNATE RECORD KEY     IS  カ−区分
001732                                                          カ−施術和暦年月
001733                                                          カ−患者コード
001734                                                          カ−会コード
001735                             ALTERNATE RECORD KEY     IS  カ−区分
001736                                                          カ−患者コード
001737                                                          カ−施術和暦年月
001738                                                          カ−会コード
001739                             FILE        STATUS       IS  状態キー
001740                             LOCK        MODE         IS  AUTOMATIC.
001520     SELECT  印刷ファイル    ASSIGN      TO     GS-PRTF002
001530                             SYMBOLIC    DESTINATION  IS "PRT"
001540                             FORMAT                   IS  定義体名Ｐ
001550                             GROUP                    IS  項目群名Ｐ
001560                             PROCESSING  MODE         IS  処理種別Ｐ
001570                             UNIT        CONTROL      IS  拡張制御Ｐ
001580                             FILE        STATUS       IS  通知情報Ｐ.
001590******************************************************************
001600*                      DATA DIVISION                             *
001610******************************************************************
001620 DATA                    DIVISION.
001630 FILE                    SECTION.
001640*                           ［ＲＬ＝  ３２０］
001650 FD  保険者マスタ        BLOCK   CONTAINS   1   RECORDS.
001660     COPY HOKENS          OF  XFDLIB  JOINING   保   AS  PREFIX.
001670*                           ［ＲＬ＝  １２８］
001680 FD  元号マスタ          BLOCK   CONTAINS   1   RECORDS.
001690     COPY GENGOU          OF  XFDLIB  JOINING   元   AS  PREFIX.
001700*                           ［ＲＬ＝  １２８］
001710 FD  名称マスタ          BLOCK   CONTAINS   1   RECORDS.
001720     COPY MEISYO          OF  XFDLIB  JOINING   名   AS  PREFIX.
001730*                          ［ＲＬ＝  １５３６］
001740 FD  レセプトＦ          BLOCK   CONTAINS   1   RECORDS.
001750     COPY RECEPT          OF  XFDLIB  JOINING   レセ  AS  PREFIX.
001760*                           ［ＲＬ＝  ２５６］
001770 FD  制御情報マスタ          BLOCK   CONTAINS   1   RECORDS.
001780     COPY SEIGYO          OF  XFDLIB  JOINING   制   AS  PREFIX.
001790*                           ［ＲＬ＝  ３２０］
001800 FD  受診者情報Ｆ        BLOCK   CONTAINS   1   RECORDS.
001810     COPY JUSINJ          OF  XFDLIB  JOINING   受   AS  PREFIX.
001820*                           ［ＲＬ＝  ２５６］
001830 FD  施術記録Ｆ          BLOCK   CONTAINS   1   RECORDS.
001840     COPY SEKIROK         OF  XFDLIB  JOINING   施記 AS  PREFIX.
001850*                           ［ＲＬ＝  １２８］
001860 FD  負傷データＦ        BLOCK   CONTAINS   1   RECORDS.
001870     COPY HUSYOU          OF  XFDLIB  JOINING   負   AS  PREFIX.
001880*                           ［ＲＬ＝  １２８］
001890 FD  負傷原因Ｆ          BLOCK   CONTAINS   1   RECORDS.
001900     COPY HUGEIN          OF  XFDLIB  JOINING   負原   AS  PREFIX.
001910*                           ［ＲＬ＝  ２５６］
001920 FD  市町村マスタ        BLOCK   CONTAINS   1   RECORDS.
001930     COPY SITYOSN         OF  XFDLIB  JOINING   市   AS  PREFIX.
001080* 
000280 FD  生保情報Ｆ          BLOCK   CONTAINS   1   RECORDS.
000281     COPY SEIHOJ          OF  XFDLIB  JOINING   生保   AS  PREFIX.
001940*
001950 FD  事業所マスタ        BLOCK   CONTAINS   1   RECORDS GLOBAL.
001960     COPY JIGYOS          OF  XFDLIB  JOINING   事   AS  PREFIX.
002300*                           ［ＲＬ＝  ３８４０］
002301 FD  カルテファイル      BLOCK   CONTAINS   1   RECORDS GLOBAL.
002302     COPY KARUTE          OF  XFDLIB  JOINING   カ   AS  PREFIX.
002303     COPY KARUTA          OF  XFDLIB  JOINING   カ表 AS  PREFIX.
002304     COPY KARUTB          OF  XFDLIB  JOINING   カ裏 AS  PREFIX.
002305     COPY KARUTC          OF  XFDLIB  JOINING   カ表コメ AS  PREFIX.
001970*
001980 FD  印刷ファイル.
001990     COPY YGN662P        OF  XMDLIB.
002000*----------------------------------------------------------------*
002010******************************************************************
002020*                WORKING-STORAGE SECTION                         *
002030******************************************************************
002040 WORKING-STORAGE         SECTION.
002050 01 キー入力                           PIC X     VALUE SPACE.
002060 01 状態キー                           PIC X(2)  VALUE SPACE.
002070 01 終了フラグ                         PIC X(3)  VALUE SPACE.
002080 01 終了フラグ２                       PIC X(3)  VALUE SPACE.
002090 01 部位ＣＮＴ                         PIC 9     VALUE ZERO.
002100 01 詳細ＣＮＴ                         PIC 9     VALUE ZERO.
002110 01 文字ＣＮＴ                         PIC 9(2)  VALUE ZERO.
002120 01 初検フラグ                         PIC X(3)  VALUE SPACE.
002130 01 ファイル名                         PIC N(2)  VALUE SPACE.
002140 01 前和暦Ｗ                           PIC 9     VALUE ZERO.
002150 01 カレント元号Ｗ                     PIC 9(1)  VALUE ZERO.
002160 01 全角空白                           PIC X(2)  VALUE X"8140".
002170 01 半角空白                           PIC X(2)  VALUE X"2020".
002180 01 負傷名称Ｗ                         PIC N(6)  VALUE SPACE.
002190 01 部位名称Ｗ                         PIC N(10) VALUE SPACE.
002200 01 負傷番号Ｗ                         PIC 9     VALUE ZERO.
002210 01 負傷番号Ｒ REDEFINES 負傷番号Ｗ.
002220    03 負傷番号Ｗ１                    PIC X.
002230*
002240 01 全角負傷番号Ｗ                     PIC N     VALUE SPACE.
002250 01 全角負傷番号Ｒ REDEFINES 全角負傷番号Ｗ.
002260    03 全角負傷番号Ｗ１                PIC X(2).
002270*
002280 01 バーコード区分Ｗ                   PIC 9(1)  VALUE ZERO.
002290 01 負担率Ｗ                           PIC 9(3) VALUE ZERO.
002300 01 甲乙区分Ｗ                         PIC 9    VALUE ZERO.
002310 01 本人負担率Ｗ                       PIC 9(3) VALUE ZERO.
002320 01 家族負担率Ｗ                       PIC 9(3) VALUE ZERO.
002330*
002340 01 施術和暦年月日ＣＷ.
002350   03 施術和暦年月ＣＷ.
002360     05 施術和暦ＣＷ                   PIC 9    VALUE ZERO.
002370     05 施術年月ＣＷ.
002380        07 施術年ＣＷ                  PIC 9(2) VALUE ZERO.
002390        07 施術月ＣＷ                  PIC 9(2) VALUE ZERO.
002400   03 施術日ＣＷ                       PIC 9(2) VALUE ZERO.
002410 01 施術西暦年Ｗ                       PIC 9(4) VALUE ZERO.
002420 01 患者西暦年Ｗ                       PIC 9(4) VALUE ZERO.
002430 01 被保険者西暦年Ｗ                   PIC 9(4) VALUE ZERO.
002440*
002450** 負傷原因用
002460*
002470 01 カウンタ                           PIC 9(2)  VALUE ZERO.
002480 01 カウンタ２                         PIC 9(2)  VALUE ZERO.
002490*
002500 01 負傷原因ＷＴ.
002510    03 負傷原因１ＷＴ                  PIC X(60) VALUE SPACE.
002520    03 負傷原因２ＷＴ                  PIC X(60) VALUE SPACE.
002530    03 負傷原因３ＷＴ                  PIC X(60) VALUE SPACE.
002540    03 負傷原因４ＷＴ                  PIC X(60) VALUE SPACE.
002550    03 負傷原因５ＷＴ                  PIC X(60) VALUE SPACE.
002560    03 負傷原因ナンバーＷＴ.
002570       05 負傷原因ナンバーＷ１         PIC X(2)  OCCURS 9 VALUE SPACE.
002580    03 負傷原因ナンバーＮＷ  REDEFINES 負傷原因ナンバーＷＴ PIC X(18).
002590 01 負傷患者番号ＣＷ                   PIC 9(6)  VALUE ZERO.
002600 01 負傷連番ＣＷ                       PIC 9(4)  VALUE ZERO.
002610 01 負傷原因ＴＢＬ.
002620    03 負傷原因コードＴＢＬ            OCCURS 9.
002630       05 負傷患者番号Ｗ               PIC 9(6)  VALUE ZERO.
002640       05 負傷連番Ｗ                   PIC 9(4)  VALUE ZERO.
002650       05 負傷原因部位Ｗ               PIC 9  OCCURS 9 VALUE ZERO.
002660 01 負傷原因内容Ｗ.
002670    03 負傷原因内容合成Ｗ              PIC X(316) OCCURS 9 VALUE SPACE.
002680    03 負傷原因内容分解ＸＷ.
002690       05 負傷原因内容１ＸＷ           PIC X(120)  VALUE SPACE.
002700       05 負傷原因内容２ＸＷ           PIC X(120)  VALUE SPACE.
002710       05 負傷原因内容３ＸＷ           PIC X(76)  VALUE SPACE.
002730*
002740*/負傷原因の詳細印刷/0610
002750 01 負傷原因Ｗテーブル２.
002760    03 負傷原因Ｗ２                    PIC X(80) OCCURS 36 VALUE SPACE.
002770** 負傷原因印刷区分用
002780 01 負傷原因印刷区分Ｗ                 PIC 9 VALUE ZERO.
002790*
002800 01 負傷原因情報Ｗ.
002810    03 負傷原因コードＷ  OCCURS   9.
002820       09 負傷原因患者番号Ｗ           PIC 9(6) VALUE ZERO.
002830       09 負傷原因連番Ｗ               PIC 9(4) VALUE ZERO.
002840*
002850* 社保用
002860 01 接尾語区分Ｗ                       PIC 9     VALUE ZERO.
002870*
002880****************
002890* 連結項目待避 *
002900****************
002910*    ************
002920*    * 印刷キー *
002930*    ************
002940 01 対象データＷＲ.
002950    03 施術和暦年月ＷＲ.
002960       05 施術和暦ＷＲ                  PIC 9(1)  VALUE ZERO.
002970       05 施術年ＷＲ                    PIC 9(2)  VALUE ZERO.
002980       05 施術月ＷＲ                    PIC 9(2)  VALUE ZERO.
002990    03 保険種別ＷＲ                     PIC 9(2)  VALUE ZERO.
003000    03 保険者番号ＷＲ                   PIC X(10) VALUE SPACE.
003010    03 本人家族区分ＷＲ                 PIC 9(1)  VALUE ZERO.
003020    03 被保険者カナＷＲ                 PIC X(20) VALUE SPACE.
003030    03 患者コードＷＲ.
003040       05 患者番号ＷＲ                  PIC 9(6)  VALUE ZERO.
003050       05 枝番ＷＲ                      PIC X(1)  VALUE SPACE.
003060    03 印刷モードＦＷＲ                 PIC 9(1)  VALUE ZERO.
003070    03 提出年月日ＷＲ.
003080       05 提出年ＷＲ                    PIC 9(2)  VALUE ZERO.
003090       05 提出月ＷＲ                    PIC 9(2)  VALUE ZERO.
003100       05 提出日ＷＲ                    PIC 9(2)  VALUE ZERO.
003110    03 段数ＷＲ                         PIC 9(1)  VALUE ZERO.
003120************
003130* 料金情報 *
003140************
003150*
003160 01 印刷負担率Ｗ                        PIC 9(1)  VALUE ZERO.
003170**************
003180* 受診者情報 *
003190**************
003200 01 受診者情報Ｗ.
003210    03 患者コードＷ.
003220       05 患者番号Ｗ                   PIC 9(6)  VALUE ZERO.
003230       05 枝番Ｗ                       PIC X(1)  VALUE SPACE.
003240    03 保険種別チェックＷ.
003250       05 社保チェックＷ               PIC N(1)  VALUE SPACE.
003260       05 組合チェックＷ               PIC N(1)  VALUE SPACE.
003270       05 共済チェックＷ               PIC N(1)  VALUE SPACE.
003280       05 国保チェックＷ               PIC N(1)  VALUE SPACE.
003290       05 後高チェックＷ               PIC N(1)  VALUE SPACE.
003290       05 日雇チェックＷ               PIC N(1)  VALUE SPACE.
003300       05 船員チェックＷ               PIC N(1)  VALUE SPACE.
003300       05 高１チェックＷ               PIC N(1)  VALUE SPACE.
003310       05 高２チェックＷ               PIC N(1)  VALUE SPACE.
003320       05 高３チェックＷ               PIC N(1)  VALUE SPACE.
          03 保険種別名称Ｗ                  PIC N(3)  VALUE SPACE.
003330    03 市町村番号Ｗ.
003340       05 印刷市町村番号Ｗ             PIC X(8)  VALUE SPACE.
003350       05 FILLER                       PIC X(2).
003360    03 費用負担者番号Ｗ.
003370       05 印刷費用負担者番号Ｗ         PIC X(8)  VALUE SPACE.
003380       05 FILLER                       PIC X(2).
003390    03 受益者番号助成Ｗ.
003400       05 印刷受益者番号助成Ｗ         PIC X(8)  VALUE SPACE.
003410       05 FILLER                       PIC X(12).
003390    03 福祉番号Ｗ                      PIC X(22)  VALUE SPACE.
003390    03 福祉番号分割Ｗ                  PIC X(17)  VALUE SPACE.
003420    03 記号Ｗ                          PIC X(24)  VALUE SPACE.
003430    03 番号Ｗ.
003440       05 印刷番号Ｗ                   PIC X(30)  VALUE SPACE.
003450*       05 FILLER                       PIC X(18).
003460    03 被保険者情報Ｗ.
003470       05 被保険者カナＷ               PIC X(50)  VALUE SPACE.
003480       05 被保険者氏名Ｗ               PIC X(50)  VALUE SPACE.
003490*
003500       05 被保険者性別チェックＷ.
003510          07 被保険者男チェックＷ      PIC N(1)  VALUE SPACE.
003520          07 被保険者女チェックＷ      PIC N(1)  VALUE SPACE.
003530*       05 被保険者性別Ｗ               PIC 9     VALUE ZERO.
003540       05 被保険者和暦チェックＷ.
003550          07 被保険者明治チェックＷ    PIC N(1)  VALUE SPACE.
003560          07 被保険者大正チェックＷ    PIC N(1)  VALUE SPACE.
003570          07 被保険者昭和チェックＷ    PIC N(1)  VALUE SPACE.
003580          07 被保険者平成チェックＷ    PIC N(1)  VALUE SPACE.
003590       05 被保険者生年月日Ｗ.
003600          07 被保険者和暦Ｗ            PIC 9     VALUE ZERO.
003610          07 被保険者年Ｗ              PIC 9(2)  VALUE ZERO.
003620          07 被保険者月Ｗ              PIC 9(2)  VALUE ZERO.
003630          07 被保険者日Ｗ              PIC 9(2)  VALUE ZERO.
003640       05 被保険者年齢Ｗ               PIC 9(3)  VALUE ZERO.
003650*
003660       05 被保険者郵便番号Ｗ.
003670          07 被保険者郵便番号１Ｗ      PIC X(3)  VALUE SPACE.
003680          07 被保険者郵便番号２Ｗ      PIC X(4)  VALUE SPACE.
003690*       05 被保険者住所Ｗ.
003700*          07 印刷被保険者住所Ｗ        PIC X(80) VALUE SPACE.
003710       05 被保険者住所Ｗ.
003720          07 印刷被保険者住所１Ｗ      PIC X(40) VALUE SPACE.
003730          07 印刷被保険者住所２Ｗ      PIC X(40) VALUE SPACE.
003740       05 被保険者電話番号Ｗ           PIC X(15) VALUE SPACE.
003750       05 分割電話番号Ｗ.
003760          07 分割電話番号１Ｗ          PIC X(5)  VALUE SPACE.
003770          07 分割電話番号２Ｗ          PIC X(5)  VALUE SPACE.
003780          07 分割電話番号３Ｗ          PIC X(5)  VALUE SPACE.
003790*          07 市外局番Ｗ                PIC X(5)  VALUE SPACE.
003800*          07 分割局番Ｗ                PIC X(5)  VALUE SPACE.
003810*          07 分割番号Ｗ                PIC X(5)  VALUE SPACE.
003820    03 資格取得年月日Ｗ.
003830       05 資格取得元号Ｗ               PIC N(2)  VALUE SPACE.
003840       05 資格取得和暦Ｗ               PIC 9(1)  VALUE ZERO.
003850       05 資格取得年Ｗ                 PIC 9(2)  VALUE ZERO.
003860       05 資格取得月Ｗ                 PIC 9(2)  VALUE ZERO.
003870       05 資格取得日Ｗ                 PIC 9(2)  VALUE ZERO.
003880    03 有効期限年月日Ｗ.
003890       05 有効期限元号Ｗ               PIC N(2)  VALUE SPACE.
003900       05 有効期限和暦Ｗ               PIC 9(1)  VALUE ZERO.
003910       05 有効期限年Ｗ                 PIC 9(2)  VALUE ZERO.
003920       05 有効期限月Ｗ                 PIC 9(2)  VALUE ZERO.
003930       05 有効期限日Ｗ                 PIC 9(2)  VALUE ZERO.
003940       05 資格和暦チェックＷ.
003950          07 資格昭和チェックＷ        PIC N(1)  VALUE SPACE.
003960          07 資格平成チェックＷ        PIC N(1)  VALUE SPACE.
004140       05 資格元号Ｗ                   PIC N(2) VALUE SPACE.
003970    03 患者情報Ｗ.
003980       05 患者カナＷ                   PIC X(50)  VALUE SPACE.
003990       05 患者氏名Ｗ                   PIC X(50)  VALUE SPACE.
004000       05 患者性別チェックＷ.
004010          07 患者男チェックＷ          PIC N(1)  VALUE SPACE.
004020          07 患者女チェックＷ          PIC N(1)  VALUE SPACE.
004030       05 続柄Ｗ.
004040          07 印刷続柄Ｗ                PIC N(4)  VALUE SPACE.
004050          07 FILLER                    PIC X(4).
004060       05 続柄チェックＷ.
004070          07 本人チェックＷ            PIC N(1)  VALUE SPACE.
004080          07 家族チェックＷ            PIC N(1)  VALUE SPACE.
004090       05 和暦チェックＷ.
004100          07 明治チェックＷ            PIC N(1)  VALUE SPACE.
004110          07 大正チェックＷ            PIC N(1)  VALUE SPACE.
004120          07 昭和チェックＷ            PIC N(1)  VALUE SPACE.
004130          07 平成チェックＷ            PIC N(1)  VALUE SPACE.
004140       05 患者元号Ｗ                   PIC N(2) VALUE SPACE.
004140       05 患者年Ｗ                     PIC 9(2) VALUE ZERO.
004150       05 患者月Ｗ                     PIC 9(2) VALUE ZERO.
004160       05 患者日Ｗ                     PIC 9(2) VALUE ZERO.
004170       05 患者年齢Ｗ                   PIC 9(3) VALUE ZERO.
004180       05 患者性別Ｗ                   PIC N(4) VALUE SPACE.
003750       05 職業Ｗ                       PIC N(4) VALUE SPACE.
004190*
004200       05 患者郵便番号Ｗ.
004210          07 患者郵便番号１Ｗ          PIC X(3)  VALUE SPACE.
004220          07 患者郵便番号２Ｗ          PIC X(4)  VALUE SPACE.
004230       05 患者住所Ｗ.
004240          07 患者住所１Ｗ              PIC X(40) VALUE SPACE.
004250          07 患者住所２Ｗ              PIC X(40) VALUE SPACE.
004260       05 患者電話番号Ｗ               PIC X(15) VALUE SPACE.
004270    03 負傷原因Ｗ                      PIC X(120) OCCURS 33 VALUE SPACE.
004280**************
004290* 事業所情報 *
004300**************
004310 01 事業所情報Ｗ.
004320    03 事業所名称Ｗ.
004330       05 印刷事業所名称１Ｗ           PIC X(30)  VALUE SPACE.
004330       05 印刷事業所名称２Ｗ           PIC X(30)  VALUE SPACE.
004340    03 事業所郵便番号Ｗ.
004350       05 事業所郵便番号１Ｗ           PIC X(3)  VALUE SPACE.
004360       05 事業所郵便番号２Ｗ           PIC X(4)  VALUE SPACE.
004370*    03 事業所住所Ｗ.
004380*       05 印刷事業所住所Ｗ             PIC X(70)  VALUE SPACE.
004390*       05 FILLER                       PIC X(10).
004400    03 事業所住所Ｗ.
004410       05 印刷事業所住所１Ｗ           PIC X(50)  VALUE SPACE.
004420       05 印刷事業所住所２Ｗ           PIC X(50)  VALUE SPACE.
004430**************
004440* 請求先情報 *
004450**************
004460 01 請求先情報Ｗ.
004470    03 保険者番号Ｗ.
004480       05 印刷保険者番号Ｗ             PIC X(8)  VALUE SPACE.
004490       05 FILLER                       PIC X(2).
004500    03 請求先名称Ｗ.
004510*       05 印刷請求先名称Ｗ             PIC X(40) VALUE SPACE.
004520       05 印刷請求先名称Ｗ             PIC X(54) VALUE SPACE.
004530    03 支部名Ｗ.
004540       05 印刷支部名Ｗ                 PIC X(40) VALUE SPACE.
004550*    03 請求先名支部名Ｗ.
004560*       05 印刷請求先名支部名Ｗ         PIC X(54) VALUE SPACE.
004570*       05 FILLER                       PIC X(26).
004580    03 請求先名支部名Ｗ.
004590       05 印刷請求先名支部名１Ｗ       PIC X(40) VALUE SPACE.
004600       05 印刷請求先名支部名２Ｗ       PIC X(40) VALUE SPACE.
004610    03 保険者呼名Ｗ.
004620*       05 印刷保険者呼名Ｗ             PIC N(7)  VALUE SPACE.
004630       05 印刷保険者呼名Ｗ             PIC X(14)  VALUE SPACE.
004640    03 請求先郵便番号Ｗ.
004650       05 請求先郵便番号１Ｗ           PIC X(3)  VALUE SPACE.
004660       05 請求先郵便番号２Ｗ           PIC X(4)  VALUE SPACE.
004670    03 請求先住所１Ｗ.
004680       05 印刷請求先住所１Ｗ           PIC X(40) VALUE SPACE.
004690    03 請求先住所２Ｗ.
004700       05 印刷請求先住所２Ｗ           PIC X(35) VALUE SPACE.
004710       05 FILLER                       PIC X(5).
004720    03 請求先電話番号Ｗ                PIC X(15) VALUE SPACE.
004730****************
004740* 詳細用ワーク *
004750****************
004760* 連印−負傷印刷行用ワーク
004770 01 印刷行ＳＷ                           PIC 9(1) VALUE ZERO.
004780*
004790 01 負傷原因情報ＳＷ.
004800    03 負傷原因コードＳＷ  OCCURS   9.
004810       09 負傷患者番号ＳＷ               PIC 9(6) VALUE ZERO.
004820       09 負傷連番ＳＷ                   PIC 9(4) VALUE ZERO.
004830*
004840 01 負傷情報ＳＷ.
004850    03 負傷データＳＷ  OCCURS   9.
004860       05 会部位コードＳＷ               PIC X(4)  VALUE SPACE.
004870       05 部位ＣＮＴＳＷ                 PIC 9(1)  VALUE ZERO.
004880       05 負傷種別ＳＷ                   PIC 9(2)  VALUE ZERO.
004890       05 部位ＳＷ                       PIC 9(2)  VALUE ZERO.
004900       05 左右区分ＳＷ                   PIC 9(1)  VALUE ZERO.
004910       05 負傷位置番号ＳＷ               PIC 9(2)  VALUE ZERO.
004920       05 負傷名ＳＷ                     PIC N(18) VALUE SPACE.
004930       05 負傷年月日ＳＷ.
004940          07 負傷和暦ＳＷ                PIC 9(1)  VALUE ZERO.
004950          07 負傷年ＳＷ                  PIC 9(2)  VALUE ZERO.
004960          07 負傷月ＳＷ                  PIC 9(2)  VALUE ZERO.
004970          07 負傷日ＳＷ                  PIC 9(2)  VALUE ZERO.
004980          07 負傷年月日区切ＳＷ          PIC X(1)  VALUE SPACE.
004990       05 施術開始年月日ＳＷ.
005000          07 施術開始和暦ＳＷ            PIC 9(1)  VALUE ZERO.
005010          07 施術開始年ＳＷ              PIC 9(2)  VALUE ZERO.
005020          07 施術開始月ＳＷ              PIC 9(2)  VALUE ZERO.
005030          07 施術開始日ＳＷ              PIC 9(2)  VALUE ZERO.
005040          07 施開年月日区切ＳＷ          PIC X(1)  VALUE SPACE.
005050       05 施術終了年月日ＳＷ.
005060          07 施術終了和暦ＳＷ            PIC 9(1)  VALUE ZERO.
005070          07 施術終了年ＳＷ              PIC 9(2)  VALUE ZERO.
005080          07 施術終了月ＳＷ              PIC 9(2)  VALUE ZERO.
005090          07 施術終了日ＳＷ              PIC 9(2)  VALUE ZERO.
005100          07 施終年月日区切ＳＷ          PIC X(1)  VALUE SPACE.
005110       05 開始年月日取得フラグＳ         PIC X(3)  VALUE SPACE.
005120       05 転帰ＳＷ                       PIC N(4)  VALUE SPACE.
005130       05 転帰チェックＳＷ.
005140          07 治癒チェックＳＷ            PIC N(1)  VALUE SPACE.
005150          07 中止チェックＳＷ            PIC N(1)  VALUE SPACE.
005160          07 継続チェックＳＷ            PIC N(1)  VALUE SPACE.
005170          07 転医チェックＳＷ            PIC N(1)  VALUE SPACE.
005180       05 施術累計回数ＳＷ               PIC 9(4)  VALUE ZERO.
005190****************
005200* 負傷データＦ *
005210****************
005220 01 負傷情報Ｗ.
005230    03 部位数Ｗ                        PIC 9(1)  VALUE ZERO.
005240    03 負傷データ情報Ｗ  OCCURS   9.
005250       05 会部位コードＷ               PIC X(4)  VALUE SPACE.
005260       05 部位ＣＮＴＷ                 PIC 9(1)  VALUE ZERO.
005270       05 負傷種別Ｗ                   PIC 9(2)  VALUE ZERO.
005280       05 部位Ｗ                       PIC 9(2)  VALUE ZERO.
005290       05 左右区分Ｗ                   PIC 9(1)  VALUE ZERO.
005300       05 負傷位置番号Ｗ               PIC 9(2)  VALUE ZERO.
005310       05 負傷名Ｗ                     PIC N(18) VALUE SPACE.
005320       05 負傷年月日Ｗ.
005330          07 負傷和暦Ｗ                PIC 9(1)  VALUE ZERO.
005340          07 負傷年Ｗ                  PIC 9(2)  VALUE ZERO.
005350          07 負傷月Ｗ                  PIC 9(2)  VALUE ZERO.
005360          07 負傷日Ｗ                  PIC 9(2)  VALUE ZERO.
005370          07 負傷年月日区切Ｗ          PIC X(1)  VALUE SPACE.
005380       05 施術開始年月日Ｗ.
005390          07 施術開始和暦Ｗ            PIC 9(1)  VALUE ZERO.
005400          07 施術開始年Ｗ              PIC 9(2)  VALUE ZERO.
005410          07 施術開始月Ｗ              PIC 9(2)  VALUE ZERO.
005420          07 施術開始日Ｗ              PIC 9(2)  VALUE ZERO.
005430          07 施開年月日区切Ｗ          PIC X(1)  VALUE SPACE.
005440       05 施術終了年月日Ｗ.
005450          07 施術終了和暦Ｗ            PIC 9(1)  VALUE ZERO.
005460          07 施術終了年Ｗ              PIC 9(2)  VALUE ZERO.
005470          07 施術終了月Ｗ              PIC 9(2)  VALUE ZERO.
005480          07 施術終了日Ｗ              PIC 9(2)  VALUE ZERO.
005490          07 施終年月日区切Ｗ          PIC X(1)  VALUE SPACE.
005500       05 開始年月日取得フラグ         PIC X(3)  VALUE SPACE.
005510       05 転帰Ｗ                       PIC N(4)  VALUE SPACE.
005520       05 転帰チェックＷ.
005530          07 治癒チェックＷ            PIC N(1)  VALUE SPACE.
005540          07 中止チェックＷ            PIC N(1)  VALUE SPACE.
005550          07 継続チェックＷ            PIC N(1)  VALUE SPACE.
005560          07 転医チェックＷ            PIC N(1)  VALUE SPACE.
005570*
005580******************
005590* 負担率チェック *
005600******************
005610 01 負担率チェックＷ.
005620    03 ０割チェックＷ                  PIC N(1)  VALUE SPACE.
005630    03 １割チェックＷ                  PIC N(1)  VALUE SPACE.
005640    03 ２割チェックＷ                  PIC N(1)  VALUE SPACE.
005650    03 ３割チェックＷ                  PIC N(1)  VALUE SPACE.
005660**********
005670* 合計行 *
005680**********
005690 01 合計行Ｗ.
005700    03 請求終了日Ｗ                    PIC 9(2) VALUE ZERO.
005710    03 対象西暦Ｗ                      PIC 9(4) VALUE ZERO.
005720    03 商Ｗ                            PIC 9(3) VALUE ZERO.
005730    03 余Ｗ                            PIC 9(3) VALUE ZERO.
005740*/年月毎持つ保険者データのワーク
005750 01 保負担率区分Ｗ                     PIC 9    VALUE ZERO.
005760 01 保本人負担率Ｗ                     PIC 9(3) VALUE ZERO.
005770 01 保家族負担率Ｗ                     PIC 9(3) VALUE ZERO.
005780 01 保本人負担率乙Ｗ                   PIC 9(3) VALUE ZERO.
005790 01 保家族負担率乙Ｗ                   PIC 9(3) VALUE ZERO.
005800*
005810 01 比較和暦年月Ｗ.
005820    03 比較和暦Ｗ                      PIC 9    VALUE ZERO.
005830    03 比較年Ｗ                        PIC 9(2) VALUE ZERO.
005840    03 比較月Ｗ                        PIC 9(2) VALUE ZERO.
005850*
005860*/老人保険改正の対応0101
005870 01 老人負担計算区分Ｗ                 PIC 9    VALUE ZERO.
005880 01 負担率用種別Ｗ                     PIC 9(2) VALUE ZERO.
005890 01 助成負担区分Ｗ                     PIC 9(2) VALUE ZERO.
005900*
005910** 助成負担率用(14/10〜)
005920 01 助成負担率ＷＷ.
005930    03 助成負担率Ｗ                    PIC 9(3) VALUE ZERO.
005940    03 助成負担率Ｗ１                  PIC 9    VALUE ZERO.
005950    03 助成負担率文字Ｗ１              PIC X    VALUE SPACE.
005960    03 助成負担率表示Ｗ                PIC X(6) VALUE SPACE.
      *
      */症状、同意、処置の印刷対応/*160309
       01 カルテＣＭ.
          03 症状Ｗ.
             05 症状ＷＰ                     PIC X(50)  VALUE SPACE OCCURS 20.
          03 同意医師名Ｗ                    PIC X(50)  VALUE SPACE.
          03 同意和暦年月日Ｗ.
             05 同意元号Ｗ                   PIC N(2)   VALUE SPACE.
             05 同意年Ｗ                     PIC 9(2)   VALUE ZERO.
             05 同意年ＴＷ                   PIC X(2)   VALUE "年".
             05 同意月Ｗ                     PIC 9(2)   VALUE ZERO.
             05 同意月ＴＷ                   PIC X(2)   VALUE "月".
             05 同意日Ｗ                     PIC 9(2)   VALUE ZERO.
             05 同意日ＴＷ                   PIC X(2)   VALUE "日".
          03 処置Ｗ.
             05 処置ＷＰ                     PIC X(60) VALUE SPACE OCCURS 15.
005970*
005980******************************************************************
005990 01 印刷制御.
006000     03 定義体名Ｐ                     PIC X(8) VALUE SPACE.
006010     03 項目群名Ｐ                     PIC X(8) VALUE SPACE.
006020     03 処理種別Ｐ                     PIC X(2) VALUE SPACE.
006030     03 拡張制御Ｐ.
006040         05 端末制御Ｐ.
006050             07 移動方向Ｐ             PIC X(1)  VALUE SPACE.
006060             07 移動行数Ｐ             PIC 9(3)  VALUE ZERO.
006070         05 詳細制御Ｐ                 PIC X(2)  VALUE SPACE.
006080     03 通知情報Ｐ                     PIC X(2)  VALUE SPACE.
006090     03 ユニット名Ｐ                   PIC X(8)  VALUE SPACE.
006100*
006110 01 計算機西暦年Ｗ                     PIC 9(2)  VALUE ZERO.
006120* 日付ＷＯＲＫ
006130 01 和暦終了年Ｗ                       PIC 9(4)  VALUE ZERO.
006140 01 計算機西暦.
006150    03 計算機西暦年                    PIC 9(4)  VALUE ZERO.
006160    03 計算機西暦月日                  PIC 9(4)  VALUE ZERO.
006170 01 計算機西暦Ｒ REDEFINES 計算機西暦.
006180    03 計算機世紀                      PIC 9(2).
006190    03 計算機日付                      PIC 9(6).
006200    03 計算機日付Ｒ REDEFINES 計算機日付.
006210       05 計算機年月                   PIC 9(4).
006220       05 計算機年月Ｒ REDEFINES 計算機年月.
006230         07 計算機年                   PIC 9(2).
006240         07 計算機月                   PIC 9(2).
006250       05 計算機日                     PIC 9(2).
006010 01 計算機和暦年Ｗ                     PIC 9(2) VALUE ZERO.
006260*
006270* C 連携用
006280 01  文字１Ｗ        PIC X(4096).
006290 01  文字２Ｗ        PIC X(512).
006300 01  プログラム名Ｗ  PIC X(8)  VALUE "strmoji2".
006301*
006302 01 複合プログラム名Ｗ     PIC X(8) VALUE "MOJI2".
006303*
006310******************************************************************
006320*                          連結項目                              *
006330******************************************************************
006340*
006350**********************
006360* メッセージ表示キー *
006370**********************
006380 01 連メ−キー IS EXTERNAL.
006390    03  連メ−メッセージ                 PIC N(20).
006400*
006410************
006420* 印刷キー *
006430************
006440 01 連印−対象データ IS EXTERNAL.
006450    03 連印−施術和暦年月.
006460       05 連印−施術和暦                  PIC 9(1).
006470       05 連印−施術年                    PIC 9(2).
006480       05 連印−施術月                    PIC 9(2).
006490    03 連印−保険種別                     PIC 9(2).
006500    03 連印−保険者番号                   PIC X(10).
006510    03 連印−本人家族区分                 PIC 9(1).
006520    03 連印−被保険者カナ                 PIC X(20).
006530    03 連印−患者コード.
006540       05 連印−患者番号                  PIC 9(6).
006550       05 連印−枝番                      PIC X(1).
006560    03 連印−印刷モードＦ                 PIC 9(1).
006570*/詳細
006580    03 連印−保険証印刷区分               PIC 9(1).
006590    03 連印−負傷詳細 OCCURS 7.
006600       05 連印−負傷印刷行                PIC 9(1).
006610       05 連印−部位印刷区分              PIC 9(1).
006620       05 連印−転帰印刷区分              PIC 9(1).
006630       05 連印−原因印刷区分              PIC 9(1).
006640*/
006650 01 連印−対象データ追加 IS EXTERNAL GLOBAL.
006660    03 連印−部位丸付け                   PIC 9(1).
006670*/年齢印刷0304
006680*/入力画面(660,6601)と新用紙(6621)との連結項目。(旧用紙、特別用紙等のＰＧを変えたく無い為、新たに作ります)
006690    03 連印−年齢印刷区分                 PIC 9(1).
006700*/負傷原因の詳細モード対応/0610
006710    03 連印−原因開始行                   PIC 9(2).
006720*/相談支援記載追加/080812
006730    03 連印−相談支援記載                 PIC 9(1).
006740*/ワクごと印刷 ０：枠なし １：ワクあり ２：ワクのみ /0402
006750    03 連印−枠印刷Ｆ                     PIC 9(1).
006760*/長期理由0311
006770    03 連印−長期印刷Ｆ                   PIC 9(1).
      */
       01 連印−対象データ追加４ IS EXTERNAL.
     */所見、同意医師、備考 /160309
          03 連印−所見印刷区分                 PIC 9(1).
          03 連印−同意印刷区分                 PIC 9(1).
          03 連印−備考印刷区分                 PIC 9(1).
006780*
006790 01 連入−表示フラグ６６０ IS EXTERNAL GLOBAL.
006800    03 連入−プレビュー区分               PIC 9(1).
006810* 負担率取得用14/10〜
006820 01 連率−負担率取得キー IS EXTERNAL.
006830    03 連率−施術和暦年月.
006840       05 連率−施術和暦               PIC 9.
006850       05 連率−施術年月.
006860          07 連率−施術年              PIC 9(2).
006870          07 連率−施術月              PIC 9(2).
006880    03 連率−患者コード.
006890       05 連率−患者番号               PIC 9(6).
006900       05 連率−枝番                   PIC X.
006910    03 連率−実際負担率                PIC 9(3).
006920    03 連率−実際本体負担率            PIC 9(3).
006930    03 連率−健保負担率                PIC 9(3).
006940    03 連率−２７老負担率              PIC 9(3).
006950    03 連率−助成負担率                PIC 9(3).
006960    03 連率−特別用負担率              PIC 9(3).
006970************************************
006980* プリンタファイル作成用           *
006990************************************
007000 01 Ｈ連ＰＲＴＦ−作成データ IS EXTERNAL.
007010     03 Ｈ連ＰＲＴＦ−ファイル名           PIC X(8).
007020     03 Ｈ連ＰＲＴＦ−プレビュー区分       PIC 9.
007030     03 Ｈ連ＰＲＴＦ−帳票プログラム名     PIC X(8).
007040     03 Ｈ連ＰＲＴＦ−オーバレイ名         PIC X(8).
007050************************************
007060* プリンタファイル作成特殊用       *
007070************************************
007080 01 Ｈ連特殊ＰＲＴＦ−作成データ IS EXTERNAL.
007090     03 Ｈ連特殊ＰＲＴＦ−用紙種類         PIC X(8).
007100*
007102*---------------------------------------------------------*
007103* 暗号複合用
007104 01 連暗号複合−暗号情報 IS EXTERNAL.
007105    03 連暗号複合−入力情報.
007106       05 連暗号複合−記号               PIC X(24).
007107       05 連暗号複合−番号               PIC X(30).
007108       05 連暗号複合−暗号化項目.
007109         07 連暗号複合−暗号患者番号     PIC X(6).
007110         07 連暗号複合−暗号判定記号     PIC X.
007111         07 連暗号複合−暗号判定番号     PIC X.
007112         07 連暗号複合−暗号記号         PIC X(24).
007113         07 連暗号複合−暗号番号         PIC X(30).
007114    03 連暗号複合−出力情報.
007115       05 連暗号複合−複合した記号       PIC X(24).
007116       05 連暗号複合−複合した番号       PIC X(30).
007117*---------------------------------------------------------*
007118* 
007120******************************************************************
007121*                      PROCEDURE  DIVISION                       *
007130******************************************************************
007140 PROCEDURE               DIVISION.
007150************
007160*           *
007170* 初期処理   *
007180*           *
007190************
007200     PERFORM プリンタファイル作成.
007210     PERFORM 初期化.
007220************
007230*           *
007240* 主処理     *
007250*           *
007260************
007270* 印刷
007280     PERFORM 連結項目待避.
007290     PERFORM 印刷セット.
007300*****     PERFORM テスト印刷.
007310     PERFORM 印刷処理.
007320************
007330*           *
007340* 終了処理   *
007350*           *
007360************
007370     PERFORM 終了処理.
007380     EXIT PROGRAM.
007390*
007400*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
007410*================================================================*
007420 プリンタファイル作成 SECTION.
007430*================================================================*
007440*   / 初期化 /
007450     MOVE SPACE TO Ｈ連ＰＲＴＦ−作成データ.
007460     INITIALIZE Ｈ連ＰＲＴＦ−作成データ.
007470     MOVE SPACE TO Ｈ連特殊ＰＲＴＦ−作成データ.
007480     INITIALIZE Ｈ連特殊ＰＲＴＦ−作成データ.
007490*
007500*
007510*--↓↓ 変更箇所 ↓↓--------------------------------------*
007520*   使用する用紙種別セット
007530     MOVE "KARUTE"              TO Ｈ連特殊ＰＲＴＦ−用紙種類.
007540*   使用するプリンタファイル名セット
007550     MOVE "PRTF002"             TO Ｈ連ＰＲＴＦ−ファイル名.
007560*
007570*   使用する帳票プログラム名セット
007580     MOVE "YGN662"             TO Ｈ連ＰＲＴＦ−帳票プログラム名.
007590*
007600*--↑↑-----------------------------------------------------*
007610*
007620*   / プレビュー区分セット /
007630     MOVE 連入−プレビュー区分 TO Ｈ連ＰＲＴＦ−プレビュー区分.
007640*     MOVE 1 TO Ｈ連ＰＲＴＦ−プレビュー区分.
007650*
007660     CALL   "CRTPRTF".
007670     CANCEL "CRTPRTF".
007680*
007690*================================================================*
007700 初期化 SECTION.
007710*
007720     PERFORM ファイルオープン.
007730*    /* 現在日付取得 */
007740     ACCEPT 計算機日付 FROM DATE.
007750*    /* 1980〜2079年の間で設定 */
007760     IF 計算機年 > 80
007770         MOVE 19 TO 計算機世紀
007780     ELSE
007790         MOVE 20 TO 計算機世紀
007800     END-IF.
007810     PERFORM カレント元号取得.
007820     PERFORM 和暦終了年取得.
007830     COMPUTE 計算機西暦年Ｗ = 計算機西暦年 - 1988.
008280*/発行時年齢を印刷する0302
008290     COMPUTE 計算機和暦年Ｗ = 計算機西暦年 - 和暦終了年Ｗ.
007840*================================================================*
007850 カレント元号取得 SECTION.
007860*
007870     MOVE ZEROS TO 制−制御区分.
007880     READ 制御情報マスタ
007890     NOT INVALID KEY
007900         MOVE 制−カレント元号 TO カレント元号Ｗ
007910         MOVE 制−カルテ負傷原因印刷区分 TO 負傷原因印刷区分Ｗ
007920         MOVE 制−バーコード２３２Ｃ使用区分 TO バーコード区分Ｗ
007930     END-READ.
007940*
007950*================================================================*
007960 和暦終了年取得 SECTION.
007970*
007980     MOVE カレント元号Ｗ TO 元−元号区分.
007990     READ 元号マスタ
008000     INVALID KEY
008010         DISPLAY NC"指定和暦が登録されていません" UPON CONS
008020         DISPLAY NC"数字１文字入力しＥＮＴＥＲキーを押してください"
008030                                                  UPON CONS
008040*-----------------------------------------*
008050         CALL "actcshm"  WITH C LINKAGE
008060*-----------------------------------------*
008070         ACCEPT  キー入力 FROM CONS
008080         PERFORM 終了処理
008090         EXIT PROGRAM
008100     NOT INVALID KEY
008110         COMPUTE 前和暦Ｗ = カレント元号Ｗ - 1
008120         MOVE 前和暦Ｗ TO 元−元号区分
008130         READ 元号マスタ
008140         INVALID KEY
008150             DISPLAY NC"指定和暦が登録されていません" UPON CONS
008160             DISPLAY NC"数字１文字入力しＥＮＴＥＲキーを押してください"
008170                                                      UPON CONS
008180*-----------------------------------------*
008190             CALL "actcshm"  WITH C LINKAGE
008200*-----------------------------------------*
008210             ACCEPT  キー入力 FROM CONS
008220             PERFORM 終了処理
008230             EXIT PROGRAM
008240         NOT INVALID KEY
008250             MOVE 元−終了西暦年 TO 和暦終了年Ｗ
008260         END-READ
008270     END-READ.
008280*
008290*================================================================*
008300 連結項目待避 SECTION.
008310*
008320     INITIALIZE 対象データＷＲ.
008330     MOVE 連印−施術和暦      TO 施術和暦ＷＲ.
008340     MOVE 連印−施術年        TO 施術年ＷＲ.
008350     MOVE 連印−施術月        TO 施術月ＷＲ.
008360     MOVE 連印−保険種別      TO 保険種別ＷＲ.
008370     MOVE 連印−保険者番号    TO 保険者番号ＷＲ.
008380     MOVE 連印−本人家族区分  TO 本人家族区分ＷＲ.
008390     MOVE 連印−被保険者カナ  TO 被保険者カナＷＲ.
008400     MOVE 連印−患者番号      TO 患者番号ＷＲ.
008410     MOVE 連印−枝番          TO 枝番ＷＲ.
008420     MOVE 連印−印刷モードＦ  TO 印刷モードＦＷＲ.
008430*================================================================*
008440 ファイルオープン SECTION.
008450*
008460     OPEN INPUT   保険者マスタ
008470         MOVE NC"保険者" TO ファイル名.
008480         PERFORM オープンチェック.
008490     OPEN INPUT   元号マスタ
008500         MOVE NC"元号" TO ファイル名.
008510         PERFORM オープンチェック.
008520     OPEN INPUT   名称マスタ
008530         MOVE NC"名称" TO ファイル名.
008540         PERFORM オープンチェック.
008550     OPEN INPUT   レセプトＦ
008560         MOVE NC"レセ" TO ファイル名.
008570         PERFORM オープンチェック.
008580     OPEN INPUT   制御情報マスタ
008590         MOVE NC"制御情報" TO ファイル名.
008600         PERFORM オープンチェック.
008610     OPEN INPUT   受診者情報Ｆ.
008620         MOVE NC"受情" TO ファイル名.
008630         PERFORM オープンチェック.
008640     OPEN INPUT   施術記録Ｆ.
008650         MOVE NC"施記Ｆ" TO ファイル名.
008660         PERFORM オープンチェック.
008670     OPEN INPUT   負傷データＦ.
008680         MOVE NC"負傷" TO ファイル名.
008690         PERFORM オープンチェック.
008700     OPEN INPUT   負傷原因Ｆ.
008710         MOVE NC"負傷原因" TO ファイル名.
008720         PERFORM オープンチェック.
008730     OPEN INPUT 市町村マスタ.
008740         MOVE NC"市町村" TO ファイル名.
008750         PERFORM オープンチェック.
006630     OPEN INPUT 生保情報Ｆ.
006640         MOVE NC"生保" TO ファイル名.
006650         PERFORM オープンチェック.
008760     OPEN INPUT 事業所マスタ.
008770         MOVE NC"事業所" TO ファイル名.
008780         PERFORM オープンチェック.
009320     OPEN INPUT カルテファイル.
009321         MOVE NC"カルテファイル" TO ファイル名.
009322         PERFORM オープンチェック.
008790     OPEN I-O   印刷ファイル
008800         MOVE NC"印刷" TO ファイル名.
008810         PERFORM エラー処理Ｐ.
008820*================================================================*
008830 オープンチェック SECTION.
008840*
008850     IF 状態キー  NOT =  "00"
008860         DISPLAY ファイル名 NC"Ｆオープンエラー" UPON CONS
008870         DISPLAY NC"状態キー：" 状態キー         UPON CONS
008880         DISPLAY NC"数字１文字入力しＥＮＴＥＲキーを押してください"
008890                                                 UPON CONS
008900*-----------------------------------------*
008910         CALL "actcshm"  WITH C LINKAGE
008920*-----------------------------------------*
008930         ACCEPT  キー入力 FROM CONS
008940         PERFORM ファイル閉鎖
008950         EXIT PROGRAM.
008960*================================================================*
008970 ファイル閉鎖 SECTION.
008980*
008990     CLOSE 印刷ファイル   保険者マスタ 元号マスタ  
009000           制御情報マスタ 名称マスタ   市町村マスタ
009010           レセプトＦ     受診者情報Ｆ 施術記録Ｆ
009020           負傷データＦ   事業所マスタ 負傷原因Ｆ
                 生保情報Ｆ     カルテファイル.
009030*================================================================*
009040 終了処理 SECTION.
009050*
009060     PERFORM ファイル閉鎖.
009070*================================================================*
009080 印刷セット SECTION.
009090*
009100     EVALUATE 印刷モードＦＷＲ
009110     WHEN 0
009120         PERFORM 印刷セット１
009130     WHEN 1
009140         PERFORM 印刷セット２
009150     WHEN 2
009160         PERFORM 印刷セット３
009170*/詳細モード用
009180     WHEN 4
009190         PERFORM 印刷セット５
009200     END-EVALUATE.
009210*
009220*================================================================*
009230 印刷セット１ SECTION.
009240*
009250     INITIALIZE YGN662P.
009260     INITIALIZE 受診者情報Ｗ.
009270     INITIALIZE 事業所情報Ｗ.
009280     INITIALIZE 請求先情報Ｗ.
009290     INITIALIZE 負傷情報Ｗ.
009300     INITIALIZE 負担率チェックＷ.
009800     INITIALIZE カルテＣＭ.
009310     PERFORM 負担率取得.
009320     PERFORM 請求先情報取得.
009330     PERFORM 受診者情報取得.
009340     PERFORM 負傷データ取得.
009861     PERFORM カルテコメント取得.
009350*
009360     IF 負傷原因印刷区分Ｗ  NOT = 1 
009370        PERFORM 負傷原因取得
009380     END-IF.
009390*
009400     PERFORM 印刷上部セット.
009410     PERFORM 印刷下部セット.
009420*================================================================*
009430 印刷セット２ SECTION.
009440*
009450     INITIALIZE YGN662P.
009460     INITIALIZE 受診者情報Ｗ.
009470     INITIALIZE 事業所情報Ｗ.
009480     INITIALIZE 請求先情報Ｗ.
009490     INITIALIZE 負傷情報Ｗ.
009500     INITIALIZE 負担率チェックＷ.
009510     PERFORM 負担率取得.
009520     PERFORM 請求先情報取得.
009530     PERFORM 受診者情報取得.
009540     PERFORM 印刷上部セット.
009550*================================================================*
009560 印刷セット３ SECTION.
009570*
009580     INITIALIZE YGN662P.
009590     INITIALIZE 受診者情報Ｗ.
009600     INITIALIZE 事業所情報Ｗ.
009610     INITIALIZE 請求先情報Ｗ.
009620     INITIALIZE 負傷情報Ｗ.
009800     INITIALIZE カルテＣＭ.
009630     PERFORM 受診者情報取得.
009640     PERFORM 負傷データ取得.
009861     PERFORM カルテコメント取得.
009650*
009660     IF 負傷原因印刷区分Ｗ  NOT = 1 
009670        PERFORM 負傷原因取得
009680     END-IF.
009690*
009700     PERFORM 印刷下部セット.
009710*================================================================*
009720 印刷セット５ SECTION.
009730*
009740*/詳細モード用
009750     INITIALIZE YGN662P.
009760     INITIALIZE 受診者情報Ｗ.
009770     INITIALIZE 事業所情報Ｗ.
009780     INITIALIZE 請求先情報Ｗ.
009790     INITIALIZE 負傷情報Ｗ.
009800     INITIALIZE 負傷原因情報Ｗ.
009800     INITIALIZE カルテＣＭ.
009810     PERFORM 負担率取得.
009820     PERFORM 請求先情報取得.
009830     PERFORM 受診者情報取得.
009840     PERFORM 負傷データ取得.
009861     PERFORM カルテコメント取得.
009850*
009860     IF 負傷原因印刷区分Ｗ  NOT = 1
009870        PERFORM 詳細モード負傷原因処理
009880        PERFORM 負傷原因取得
009890     END-IF.
009900*/負傷原因の詳細印刷/0610
009910     PERFORM 原因行セット.
009920*
009930     IF 連印−保険証印刷区分 = 1
009940         PERFORM 印刷上部セット
009950     END-IF.
009960*
009970     PERFORM 詳細モード負傷処理.
009980     PERFORM 印刷下部セット.
009990*
           DISPLAY 連印−所見印刷区分 連印−同意印刷区分 連印−備考印刷区分 UPON CONS
026040     IF 連印−所見印刷区分 = 1
           DISPLAY "A" 連印−所見印刷区分 UPON CONS
              PERFORM VARYING カウンタ FROM 1 BY 1
                        UNTIL カウンタ > 20
                 MOVE 症状ＷＰ(カウンタ)   TO 初検時の症状(カウンタ)
              END-PERFORM
026060     END-IF.
026040     IF 連印−同意印刷区分 = 1
           DISPLAY "B" 連印−同意印刷区分 UPON CONS
              MOVE 同意医師名Ｗ        TO 同意医師名
              MOVE 同意元号Ｗ          TO 同意和暦
              MOVE 同意年Ｗ            TO 同意年
              MOVE 同意月Ｗ            TO 同意月
              MOVE 同意日Ｗ            TO 同意日
026060     END-IF.
026040     IF 連印−備考印刷区分 = 1
           DISPLAY "C" 連印−備考印刷区分 UPON CONS
              PERFORM VARYING カウンタ FROM 1 BY 1
                        UNTIL カウンタ > 15
                 MOVE 処置ＷＰ(カウンタ)   TO 初回処置(カウンタ)
              END-PERFORM
026060     END-IF.
010000*================================================================*
010010 印刷上部セット SECTION.
010020*
010030     IF バーコード区分Ｗ NOT = ZERO
010040         MOVE 患者コードＷＲ         TO 患者コード
010050         MOVE " " TO EDIT-MODE OF 患者コード
010060     ELSE
010070         MOVE "X" TO EDIT-MODE OF 患者コード
010080     END-IF.
010090     MOVE 患者番号Ｗ                 TO 患者番号.
010100     MOVE 枝番Ｗ                     TO 枝番.
010110*
           MOVE 保険種別名称Ｗ             TO 保険種別.
010120     MOVE 社保チェックＷ             TO 社保チェック.
010150     MOVE 国保チェックＷ             TO 国保チェック.
010160     MOVE 後高チェックＷ             TO 後高チェック.
010140     MOVE 共済チェックＷ             TO 共済チェック.
010130     MOVE 組合チェックＷ             TO 組合チェック.
010190     MOVE 日雇チェックＷ             TO 日雇チェック.
010200     MOVE 船員チェックＷ             TO 船員チェック.
010210     MOVE 高１チェックＷ             TO 高１チェック.
010220     MOVE 高２チェックＷ             TO 高２チェック.
010170     MOVE 高３チェックＷ             TO 高３チェック.
010170     MOVE ０割チェックＷ             TO ０割チェック.
010170     MOVE １割チェックＷ             TO １割チェック.
010170     MOVE ２割チェックＷ             TO ２割チェック.
010170     MOVE ３割チェックＷ             TO ３割チェック.
           MOVE 助成負担率Ｗ１             TO 助成負担割合.
010240**************************
010250* 被保険者証情報セット   *
010260**************************
010270     IF 記号Ｗ(1:2) = "＊" 
010280        MOVE  SPACE    TO  記号
010290     ELSE
010300        MOVE 記号Ｗ    TO  記号
010310     END-IF.
010320     IF ( 印刷番号Ｗ(1:1) = "*"  ) OR
010330        ( 印刷番号Ｗ(1:2) = "＊" )
010340        MOVE  SPACE      TO  番号
010350     ELSE
010080        MOVE 印刷番号Ｗ  TO  番号
010370     END-IF.
010380************************
010390* 被保険者情報セット   *
010400************************
010410     MOVE 被保険者氏名Ｗ             TO 被保険者氏名.
010420*     MOVE 被保険者カナＷ             TO 被保険者カナ.
010430*     MOVE 被保険者男チェックＷ       TO 被保険者男.
010440*     MOVE 被保険者女チェックＷ       TO 被保険者女.
010450*     MOVE 被保険者郵便番号１Ｗ       TO 被保険者郵便１.
010460*     MOVE 被保険者郵便番号２Ｗ       TO 被保険者郵便２.
010470*     MOVE "-"                        TO 被保険者郵便区切.
010480*     MOVE 被保険者住所Ｗ             TO 被保険者住所.
010490*     MOVE 印刷被保険者住所１Ｗ       TO 被保険者住所１.
010500*     MOVE 印刷被保険者住所２Ｗ       TO 被保険者住所２.
010510*     MOVE 被保険者電話番号Ｗ         TO 被保険者電話番号.
010520*     MOVE 資格取得元号Ｗ             TO 資格取得元号.
011200*     MOVE 資格元号Ｗ                 TO 資格元号.
010530     MOVE 資格取得年Ｗ               TO 資格取得年.
010540     MOVE 資格取得月Ｗ               TO 資格取得月.
010550     MOVE 資格取得日Ｗ               TO 資格取得日.
010560     MOVE 資格昭和チェックＷ         TO 資格昭和チェック.
010570     MOVE 資格平成チェックＷ         TO 資格平成チェック.
010580*/有効期限
010590     MOVE 有効期限年Ｗ               TO 有効年.
010600     MOVE 有効期限月Ｗ               TO 有効月.
010610     MOVE 有効期限日Ｗ               TO 有効日.
010620     IF ( 有効期限年Ｗ = ZERO ) AND
010630       ( 有効期限月Ｗ = ZERO ) AND
010640       ( 有効期限日Ｗ = ZERO )
010650        MOVE SPACE          TO 有効和暦
010660*        MOVE SPACE          TO 有効年月日表示
010670*        MOVE SPACE          TO 有効年表示
010680*        MOVE SPACE          TO 有効月表示
010690*        MOVE SPACE          TO 有効日表示
010700     ELSE
010710        MOVE 有効期限元号Ｗ TO 有効和暦
010720*        MOVE NC"有効年月日" TO 有効年月日表示
010730*        MOVE NC"年"         TO 有効年表示
010740*        MOVE NC"月"         TO 有効月表示
010750*        MOVE NC"日"         TO 有効日表示
010760     END-IF.
010770     MOVE 被保険者明治チェックＷ     TO 被保険者明治チェック.
010780     MOVE 被保険者大正チェックＷ     TO 被保険者大正チェック.
010790     MOVE 被保険者昭和チェックＷ     TO 被保険者昭和チェック.
010800     MOVE 被保険者平成チェックＷ     TO 被保険者平成チェック.
010810     MOVE 被保険者年Ｗ               TO 被保険者年.
010820     MOVE 被保険者月Ｗ               TO 被保険者月.
010830     MOVE 被保険者日Ｗ               TO 被保険者日.
010840*     MOVE 被保険者年齢Ｗ             TO 被保険者年齢.
010850********************
010860* 患者情報セット   *
010870********************
010990*
011000     IF  印刷費用負担者番号Ｗ(1:2) = "99"
011010         MOVE SPACE                  TO 市町村番号
011020     ELSE
011030         MOVE 印刷費用負担者番号Ｗ   TO 市町村番号
011040     END-IF.
011050*
011060     IF (印刷受益者番号助成Ｗ(1:1) = "*") OR
011070        (印刷受益者番号助成Ｗ(1:2) = "＊")
011080         MOVE SPACE                  TO 受給者番号
011090     ELSE
011100         MOVE 印刷受益者番号助成Ｗ   TO 受給者番号
011110     END-IF.
           MOVE 助成負担率Ｗ１             TO 助成負担割合.
      *     MOVE 福祉番号Ｗ                 TO 福祉番号.
011120*     MOVE 患者カナＷ                 TO 患者カナ.
011130     MOVE 患者氏名Ｗ                 TO 患者氏名.
011140*     MOVE 患者男チェックＷ           TO 患者男チェック.
011150*     MOVE 患者女チェックＷ           TO 患者女チェック.
011160     MOVE 明治チェックＷ             TO 明治チェック.
011170     MOVE 大正チェックＷ             TO 大正チェック.
011180     MOVE 昭和チェックＷ             TO 昭和チェック.
011190     MOVE 平成チェックＷ             TO 平成チェック.
011200*     MOVE 患者元号Ｗ                 TO 患者元号.
011200     MOVE 患者年Ｗ                   TO 患者年.
011210     MOVE 患者月Ｗ                   TO 患者月.
011220     MOVE 患者日Ｗ                   TO 患者日.
      */職業追加/160331
012100     MOVE 職業Ｗ                     TO 職業.
011230*     MOVE 患者年齢Ｗ                 TO 患者年齢.
011240*     MOVE 本人チェックＷ             TO 本人チェック.
011250*     MOVE 家族チェックＷ             TO 家族チェック.
011260     MOVE 印刷続柄Ｗ                 TO 続柄.
011270     MOVE 患者郵便番号１Ｗ           TO 患者郵便番号１.
011280     MOVE 患者郵便番号２Ｗ           TO 患者郵便番号２.
011290     MOVE "-"                        TO 患者郵便区切.
011300*     MOVE 患者住所Ｗ                 TO 患者住所.
011310     MOVE 患者電話番号Ｗ             TO 患者電話番号.
011320     MOVE 患者住所１Ｗ               TO 患者住所１.
011330     MOVE 患者住所２Ｗ               TO 患者住所２.
011340********************
011350* 事業所情報セット *
011360********************
011370     MOVE 印刷事業所名称１Ｗ          TO 事業所名称１.
011370     MOVE 印刷事業所名称２Ｗ          TO 事業所名称２.
011380*     MOVE 事業所郵便番号１Ｗ         TO 事業所郵便番号１.
011390*     MOVE 事業所郵便番号２Ｗ         TO 事業所郵便番号２.
011400*     IF 事業所郵便番号１Ｗ NOT = SPACE
011410*         MOVE "-"                    TO 事業所郵便区切
011420*     END-IF.
011430*     MOVE 印刷事業所住所Ｗ           TO 事業所住所.
011440     MOVE 印刷事業所住所１Ｗ         TO 事業所住所１.
011450     MOVE 印刷事業所住所２Ｗ         TO 事業所住所２.
011460************************************
011470* 都道府県・健康保険組合情報セット *
011480************************************
011490*労災、自費の時は保険者情報は印字しない
011500     IF 保険種別ＷＲ = 70 OR 90
011510         MOVE SPACE                  TO 保険者番号
011530         MOVE SPACE                  TO 請求先名称１
011540         MOVE SPACE                  TO 請求先名称２
011550*         MOVE SPACE                  TO 保険者郵便番号１
011560*         MOVE SPACE                  TO 保険者郵便番号２
011570*         MOVE SPACE                  TO 保険者郵便区切
011580         MOVE SPACE                  TO 請求先住所１
011590         MOVE SPACE                  TO 請求先住所２
011600     ELSE
011610         MOVE 印刷保険者番号Ｗ       TO 保険者番号
011630         MOVE 印刷請求先名支部名１Ｗ TO 請求先名称１
011640         MOVE 印刷請求先名支部名２Ｗ TO 請求先名称２
011650*         MOVE 請求先郵便番号１Ｗ     TO 保険者郵便番号１
011660*         MOVE 請求先郵便番号２Ｗ     TO 保険者郵便番号２
011670*         MOVE "-"                    TO 保険者郵便区切
011680         MOVE 請求先住所１Ｗ         TO 請求先住所１
011690         MOVE 請求先住所２Ｗ         TO 請求先住所２
011700*         MOVE 請求先電話番号Ｗ       TO 保険者電話番号
011710     END-IF.
012680*/年齢印刷0304
012690*     IF 連印−年齢印刷区分 = 1
012700*/発行時年齢を印刷する0302
012710*         MOVE 受−患者和暦 TO 元−元号区分
012720*         READ 元号マスタ
012730*         INVALID KEY
012740*             DISPLAY NC"指定和暦が登録されていません" UPON CONS
012750*             DISPLAY NC"数字１文字入力しＥＮＴＥＲキーを押してください" UPON CONS
012760*             ACCEPT  キー入力 FROM CONS
012770*             PERFORM 終了処理
012780*             EXIT PROGRAM
012790*         NOT INVALID KEY
012800*             COMPUTE 患者西暦年Ｗ = 元−開始西暦年 + 受−患者年 - 1
012810*             COMPUTE 患者年齢Ｗ = 計算機西暦年 - 患者西暦年Ｗ
012820*             EVALUATE TRUE
012830*             WHEN 受−患者月 > 計算機月
012840*                 COMPUTE 患者年齢Ｗ = 患者年齢Ｗ - 1
012850*             WHEN (受−患者月 = 計算機月) AND
012860*                  (受−患者日 > 計算機日)
012870*                 COMPUTE 患者年齢Ｗ = 患者年齢Ｗ - 1
012880*             END-EVALUATE
012890*             IF 患者年齢Ｗ < ZERO
012900*                 MOVE ZERO TO 患者年齢Ｗ
012910*             END-IF
012920**
012930*             MOVE 患者年齢Ｗ     TO 発行時年齢
012940*             MOVE 計算機和暦年Ｗ TO システム年
012950*             MOVE 計算機月       TO システム月
012960*             MOVE 計算機日       TO システム日
012970*             MOVE "."            TO システム日付区切１ システム日付区切２
012980*             MOVE NC"才"         TO 才
012990*         END-READ
013000*     END-IF.
013010*
011720*================================================================*
011730 印刷下部セット SECTION.
011740*
011750********************
011760* 負傷データセット *
011770********************
011780* １部位 *
011790**********
011800*     MOVE 会部位コードＷ(1)   TO 負傷コード１.
011810     MOVE 負傷名Ｗ(1)         TO 負傷名１.
011820     MOVE 負傷年Ｗ(1)         TO 負傷年１.
011830     MOVE 負傷月Ｗ(1)         TO 負傷月１.
011840     MOVE 負傷日Ｗ(1)         TO 負傷日１.
011850     MOVE 施術開始年Ｗ(1)     TO 施術開始年１.
011860     MOVE 施術開始月Ｗ(1)     TO 施術開始月１.
011870     MOVE 施術開始日Ｗ(1)     TO 施術開始日１.
011880     MOVE 施術終了年Ｗ(1)     TO 施術終了年１.
011890     MOVE 施術終了月Ｗ(1)     TO 施術終了月１.
011900     MOVE 施術終了日Ｗ(1)     TO 施術終了日１.
011910*     MOVE 負傷年月日区切Ｗ(1) TO 区切１１ 区切１２.
011920*     MOVE 施開年月日区切Ｗ(1) TO 区切１３ 区切１４.
011930*     MOVE 施終年月日区切Ｗ(1) TO 区切１５ 区切１６.
011940*     MOVE 転帰Ｗ(1)           TO 転帰１.
011950     MOVE 治癒チェックＷ(1)   TO 治癒チェック１.
011960     MOVE 中止チェックＷ(1)   TO 中止チェック１.
011970*     MOVE 継続チェックＷ(1)   TO 継続チェック１.
011980     MOVE 転医チェックＷ(1)   TO 転医チェック１.
011990*     ******************
012000*     * 日数は一時保留 *
012010*     ******************
012020*     **********************
012030*     * 施術回数は一時保留 *
012040*     **********************
012050*     **********************
012060*     * 転帰名称は一時保留 *
012070*     **********************
012080**********
012090* ２部位 *
012100**********
012110*     MOVE 会部位コードＷ(2)   TO 負傷コード２.
012120     MOVE 負傷名Ｗ(2)         TO 負傷名２.
012130     MOVE 負傷年Ｗ(2)         TO 負傷年２.
012140     MOVE 負傷月Ｗ(2)         TO 負傷月２.
012150     MOVE 負傷日Ｗ(2)         TO 負傷日２.
012160     MOVE 施術開始年Ｗ(2)     TO 施術開始年２.
012170     MOVE 施術開始月Ｗ(2)     TO 施術開始月２.
012180     MOVE 施術開始日Ｗ(2)     TO 施術開始日２.
012190     MOVE 施術終了年Ｗ(2)     TO 施術終了年２.
012200     MOVE 施術終了月Ｗ(2)     TO 施術終了月２.
012210     MOVE 施術終了日Ｗ(2)     TO 施術終了日２.
012220*     MOVE 負傷年月日区切Ｗ(2) TO 区切２１ 区切２２.
012230*     MOVE 施開年月日区切Ｗ(2) TO 区切２３ 区切２４.
012240*     MOVE 施終年月日区切Ｗ(2) TO 区切２５ 区切２６.
012250*     MOVE 転帰Ｗ(2)           TO 転帰２.
012260     MOVE 治癒チェックＷ(2)   TO 治癒チェック２.
012270     MOVE 中止チェックＷ(2)   TO 中止チェック２.
012280*     MOVE 継続チェックＷ(2)   TO 継続チェック２.
012290     MOVE 転医チェックＷ(2)   TO 転医チェック２.
012300*     ******************
012310*     * 日数は一時保留 *
012320*     ******************
012330*     **********************
012340*     * 施術回数は一時保留 *
012350*     **********************
012360*     **********************
012370*     * 転帰名称は一時保留 *
012380*     **********************
012390**********
012400* ３部位 *
012410**********
012420*     MOVE 会部位コードＷ(3)   TO 負傷コード３.
012430     MOVE 負傷名Ｗ(3)         TO 負傷名３.
012440     MOVE 負傷年Ｗ(3)         TO 負傷年３.
012450     MOVE 負傷月Ｗ(3)         TO 負傷月３.
012460     MOVE 負傷日Ｗ(3)         TO 負傷日３.
012470     MOVE 施術開始年Ｗ(3)     TO 施術開始年３.
012480     MOVE 施術開始月Ｗ(3)     TO 施術開始月３.
012490     MOVE 施術開始日Ｗ(3)     TO 施術開始日３.
012500     MOVE 施術終了年Ｗ(3)     TO 施術終了年３.
012510     MOVE 施術終了月Ｗ(3)     TO 施術終了月３.
012520     MOVE 施術終了日Ｗ(3)     TO 施術終了日３.
012530*     MOVE 負傷年月日区切Ｗ(3) TO 区切３１ 区切３２.
012540*     MOVE 施開年月日区切Ｗ(3) TO 区切３３ 区切３４.
012550*     MOVE 施終年月日区切Ｗ(3) TO 区切３５ 区切３６.
012560*     MOVE 転帰Ｗ(3)           TO 転帰３.
012570     MOVE 治癒チェックＷ(3)   TO 治癒チェック３.
012580     MOVE 中止チェックＷ(3)   TO 中止チェック３.
012590*     MOVE 継続チェックＷ(3)   TO 継続チェック３.
012600     MOVE 転医チェックＷ(3)   TO 転医チェック３.
012610*     ******************
012620*     * 日数は一時保留 *
012630*     ******************
012640*     **********************
012650*     * 施術回数は一時保留 *
012660*     **********************
012670*     **********************
012680*     * 転帰名称は一時保留 *
012690*     **********************
012700**********
012710* ４部位 *
012720**********
012730*     MOVE 会部位コードＷ(4)   TO 負傷コード４.
012740     MOVE 負傷名Ｗ(4)         TO 負傷名４.
012750     MOVE 負傷年Ｗ(4)         TO 負傷年４.
012760     MOVE 負傷月Ｗ(4)         TO 負傷月４.
012770     MOVE 負傷日Ｗ(4)         TO 負傷日４.
012780     MOVE 施術開始年Ｗ(4)     TO 施術開始年４.
012790     MOVE 施術開始月Ｗ(4)     TO 施術開始月４.
012800     MOVE 施術開始日Ｗ(4)     TO 施術開始日４.
012810     MOVE 施術終了年Ｗ(4)     TO 施術終了年４.
012820     MOVE 施術終了月Ｗ(4)     TO 施術終了月４.
012830     MOVE 施術終了日Ｗ(4)     TO 施術終了日４.
012840*     MOVE 負傷年月日区切Ｗ(4) TO 区切４１ 区切４２.
012850*     MOVE 施開年月日区切Ｗ(4) TO 区切４３ 区切４４.
012860*     MOVE 施終年月日区切Ｗ(4) TO 区切４５ 区切４６.
012870*     MOVE 転帰Ｗ(4)           TO 転帰４.
012880     MOVE 治癒チェックＷ(4)   TO 治癒チェック４.
012890     MOVE 中止チェックＷ(4)   TO 中止チェック４.
012900*     MOVE 継続チェックＷ(4)   TO 継続チェック４.
012910     MOVE 転医チェックＷ(4)   TO 転医チェック４.
012920*     ******************
012930*     * 日数は一時保留 *
012940*     ******************
012950*     **********************
012960*     * 施術回数は一時保留 *
012970*     **********************
012980*     **********************
012990*     * 転帰名称は一時保留 *
013000*     **********************
013010**********
013020* ５部位 *
013030**********
013040*     MOVE 会部位コードＷ(5)   TO 負傷コード５.
013050     MOVE 負傷名Ｗ(5)         TO 負傷名５.
013060     MOVE 負傷年Ｗ(5)         TO 負傷年５.
013070     MOVE 負傷月Ｗ(5)         TO 負傷月５.
013080     MOVE 負傷日Ｗ(5)         TO 負傷日５.
013090     MOVE 施術開始年Ｗ(5)     TO 施術開始年５.
013100     MOVE 施術開始月Ｗ(5)     TO 施術開始月５.
013110     MOVE 施術開始日Ｗ(5)     TO 施術開始日５.
013120     MOVE 施術終了年Ｗ(5)     TO 施術終了年５.
013130     MOVE 施術終了月Ｗ(5)     TO 施術終了月５.
013140     MOVE 施術終了日Ｗ(5)     TO 施術終了日５.
013150*     MOVE 負傷年月日区切Ｗ(5) TO 区切５１ 区切５２.
013160*     MOVE 施開年月日区切Ｗ(5) TO 区切５３ 区切５４.
013170*     MOVE 施終年月日区切Ｗ(5) TO 区切５５ 区切５６.
013180*     MOVE 転帰Ｗ(5)           TO 転帰５.
013190     MOVE 治癒チェックＷ(5)   TO 治癒チェック５.
013200     MOVE 中止チェックＷ(5)   TO 中止チェック５.
013210*     MOVE 継続チェックＷ(5)   TO 継続チェック５.
013220     MOVE 転医チェックＷ(5)   TO 転医チェック５.
013230*     ******************
013240*     * 日数は一時保留 *
013250*     ******************
013260*     **********************
013270*     * 施術回数は一時保留 *
013280*     **********************
013290*     **********************
013300*     * 転帰名称は一時保留 *
013310*     **********************
013320************
013330* 負傷原因 *
013340************
           PERFORM VARYING カウンタ FROM 1 BY 1
                     UNTIL カウンタ > 8
              MOVE 負傷原因Ｗ(カウンタ)   TO 負傷原因(カウンタ)
           END-PERFORM.
013450*
013280**************
013290* 初検の症状 *
013300**************
           PERFORM VARYING カウンタ FROM 1 BY 1
                     UNTIL カウンタ > 20
              MOVE 症状ＷＰ(カウンタ)   TO 初検時の症状(カウンタ)
           END-PERFORM.
013280********
013290* 同意 *
013300********
           MOVE 同意医師名Ｗ        TO 同意医師名.
           MOVE 同意元号Ｗ          TO 同意和暦.
           MOVE 同意年Ｗ            TO 同意年.
           MOVE 同意月Ｗ            TO 同意月.
           MOVE 同意日Ｗ            TO 同意日.
013280************
013290* 初回処置 *
013300************
           PERFORM VARYING カウンタ FROM 1 BY 1
                     UNTIL カウンタ > 15
              MOVE 処置ＷＰ(カウンタ)   TO 初回処置(カウンタ)
           END-PERFORM.
013460*
013460*================================================================*
013470 負担率取得 SECTION.
013480*
013490     MOVE ZERO TO 本人負担率Ｗ.
013500     MOVE ZERO TO 家族負担率Ｗ.
013510*
013520     MOVE 施術和暦ＷＲ   TO 受−施術和暦.
013530     MOVE 施術年ＷＲ     TO 受−施術年.
013540     MOVE 施術月ＷＲ     TO 受−施術月.
013550     MOVE 患者番号ＷＲ   TO 受−患者番号.
013560     MOVE 枝番ＷＲ       TO 受−枝番.
013570     READ 受診者情報Ｆ
013580     INVALID KEY
013590         MOVE  NC"　　施術月の受診者情報がありません" TO 連メ−メッセージ
013600         CALL   "MSG001"
013610         CANCEL "MSG001"
013620         PERFORM ファイル閉鎖
013630         MOVE ZERO TO PROGRAM-STATUS
013640         EXIT PROGRAM
013650     NOT INVALID KEY
013680         PERFORM 負担率取得１４１０
013690         COMPUTE 印刷負担率Ｗ = 負担率Ｗ / 10
013710     END-READ.
013720*
013730     EVALUATE 印刷負担率Ｗ
013740     WHEN 0
013750         MOVE NC"○"      TO ０割チェックＷ
013760     WHEN 1
013770         MOVE NC"○"      TO １割チェックＷ
013780     WHEN 2
013790         MOVE NC"○"      TO ２割チェックＷ
013800     WHEN 3
013810         MOVE NC"○"      TO ３割チェックＷ
013820     END-EVALUATE.
013830*
013840*================================================================*
013850 負担率取得１４１０ SECTION.
013860*
013870* 受診者Ｆ READ中
013880* 平成14/10〜
013890     MOVE ZERO  TO 負担率Ｗ.
013900     INITIALIZE 助成負担率ＷＷ.
013910*
013920     MOVE SPACE TO 連率−負担率取得キー.
013930     INITIALIZE 連率−負担率取得キー.
013940     MOVE 受−施術和暦年月 TO 連率−施術和暦年月.
013950     MOVE 受−患者コード   TO 連率−患者コード.
013960*
013970     CALL   "HUTANRIT".
013980     CANCEL "HUTANRIT".
013990*
014000* / 本体 /
014010     MOVE 連率−実際本体負担率 TO 負担率Ｗ.
014020*
014030*
014040* / 助成 /
014050     IF 受−助成種別 NOT = ZERO
014060        MOVE 連率−助成負担率  TO 助成負担率Ｗ
014070*
014080        COMPUTE 助成負担率Ｗ１ = 助成負担率Ｗ / 10
014090        MOVE 助成負担率Ｗ１ TO  助成負担率文字Ｗ１
014100*
014110        STRING "("                 DELIMITED BY SIZE
014120               助成負担率文字Ｗ１  DELIMITED BY SIZE
014130               "割)"               DELIMITED BY SIZE
014140               INTO 助成負担率表示Ｗ
014150        END-STRING
014160*
014170     END-IF.
014180*
014190*================================================================*
014200 受診者情報取得 SECTION.
014210*
014220**************************************************
014230* 連結データから受診者情報Ｆより以下の情報を取得 *
014240* ● 患者番号.... 患者番号Ｗ                     *
014250* ● 枝番........ 枝番Ｗ                         *
014260* ● 記号 ....... 記号Ｗに格納                   *
014270* ● 番号 ....... 番号Ｗに格納                   *
014280* ● 被保険者カナ.被保険者カナＷに格納           *
014290* ● 被保険者氏名.被保険者氏名Ｗに格納           *
014300* ● 郵便番号１ ..郵便番号１Ｗに格納             *
014310* ● 郵便番号２ ..郵便番号２Ｗに格納             *
014320* ● 住所１ ......住所１Ｗに格納                 *
014330* ● 住所２ ......住所２Ｗに格納                 *
014340* ● 電話番号.....電話番号Ｗに格納               *
014350* ● 患者カナ ....患者カナＷに格納               *
014360* ● 患者氏名 ....患者氏名Ｗに格納               *
014370* ● 続柄 ........名称マスタより続柄Ｗに取得     *
014380* ● 患者和暦 ....和暦によりチェックに"○"を格納 *
014390* ● 患者年 ......患者年Ｗに格納                 *
014400* ● 患者月 ......患者月Ｗに格納                 *
014410* ● 患者日 ......患者日Ｗに格納                 *
014420**************************************************
014430     MOVE 施術和暦ＷＲ       TO 受−施術和暦.
014440     MOVE 施術年ＷＲ         TO 受−施術年.
014450     MOVE 施術月ＷＲ         TO 受−施術月.
014460     MOVE 患者コードＷＲ     TO 受−患者コード.
014470     READ 受診者情報Ｆ
014480     INVALID KEY
014490         CONTINUE
014500*            /* ありえない */
014510     NOT INVALID KEY
014520         MOVE 受−患者番号     TO 患者番号Ｗ
014530         MOVE 受−枝番         TO 枝番Ｗ
014540*
014550         EVALUATE 保険種別ＷＲ
014560         WHEN 1
014570         WHEN 8
014580             MOVE NC"○"       TO 国保チェックＷ
                   MOVE NC"国保"     TO 保険種別名称Ｗ
014590         WHEN 2
014620             MOVE NC"○"       TO 社保チェックＷ
                   MOVE NC"協会"     TO 保険種別名称Ｗ
014600         WHEN 6
014620             MOVE NC"○"       TO 日雇チェックＷ
                   MOVE NC"日雇"     TO 保険種別名称Ｗ
014610         WHEN 7
014620             MOVE NC"○"       TO 船員チェックＷ
                   MOVE NC"船員"     TO 保険種別名称Ｗ
014630         WHEN 3
014640             MOVE NC"○"       TO 組合チェックＷ
                   MOVE NC"組合"     TO 保険種別名称Ｗ
014650         WHEN 4
014660             MOVE NC"○"       TO 共済チェックＷ
                   MOVE NC"共済"     TO 保険種別名称Ｗ
014670         WHEN 5
014680             MOVE NC"○"       TO 後高チェックＷ
                   MOVE NC"後高"     TO 保険種別名称Ｗ
014730         END-EVALUATE
028984         EVALUATE 受−特別区分
               WHEN 1
                   MOVE NC"○" TO 高１チェックＷ
               WHEN 2
                   MOVE NC"○" TO 高２チェックＷ
               WHEN 3
                   MOVE NC"○" TO 高３チェックＷ
014730         END-EVALUATE
014771*
014792*-----------------------------------------------------------------*
014793         MOVE SPACE TO 連暗号複合−暗号情報
014794*
014795*        / 連暗号複合−入力情報セット /
014796         MOVE 受−記号       TO 連暗号複合−記号
014797         MOVE 受−番号       TO 連暗号複合−番号
014798         MOVE 受−暗号化項目 TO 連暗号複合−暗号化項目
014799*
014800         CALL   複合プログラム名Ｗ
014801         CANCEL 複合プログラム名Ｗ
014802*
014803         MOVE 連暗号複合−複合した記号 TO 記号Ｗ
014804         MOVE 連暗号複合−複合した番号 TO 番号Ｗ
014807*-----------------------------------------------------------------*
014808*
014814         MOVE 受−被保険者カナ TO 被保険者カナＷ
014815         MOVE 受−被保険者氏名 TO 被保険者氏名Ｗ
014820*
014830         EVALUATE 受−被保険者性別
014840         WHEN 1
014850             MOVE NC"○"  TO 被保険者男チェックＷ
014860         WHEN 2
014870             MOVE NC"○"  TO 被保険者女チェックＷ
014880         END-EVALUATE
014890*
014900         EVALUATE 受−被保険者和暦
014910         WHEN 1
014920             MOVE NC"○"  TO 被保険者明治チェックＷ
014930         WHEN 2
014940             MOVE NC"○"  TO 被保険者大正チェックＷ
014950         WHEN 3
014960             MOVE NC"○"  TO 被保険者昭和チェックＷ
014970         WHEN 4
014980             MOVE NC"○"  TO 被保険者平成チェックＷ
014990         END-EVALUATE
015000         MOVE 受−被保険者年   TO 被保険者年Ｗ
015010         MOVE 受−被保険者月   TO 被保険者月Ｗ
015020         MOVE 受−被保険者日   TO 被保険者日Ｗ
015030
015040*被保険者年齢
015050     MOVE 連印−施術和暦 TO 元−元号区分
015060     READ 元号マスタ
015070     NOT INVALID KEY
015080         COMPUTE 施術西暦年Ｗ = 元−開始西暦年 + ( 連印−施術年 - 1 )
015090     END-READ
015100     IF ( 受−被保険者和暦 NOT = ZERO ) AND
015110        ( 受−被保険者年   NOT = ZERO ) AND
015120        ( 受−被保険者月   NOT = ZERO ) AND
015130        ( 受−被保険者日   NOT = ZERO )
015140
015150         MOVE ZERO TO 被保険者年齢Ｗ
015160*
015170         MOVE 受−被保険者和暦 TO 元−元号区分
015180         READ 元号マスタ
015190         NOT INVALID KEY
015200             COMPUTE 被保険者西暦年Ｗ = 元−開始西暦年 + ( 受−被保険者年 - 1 )
015210         END-READ
015220*
015230         COMPUTE 被保険者年齢Ｗ   = 施術西暦年Ｗ - 被保険者西暦年Ｗ
015240*
015250         IF 連印−施術月 < 受−被保険者月
015260             COMPUTE 被保険者年齢Ｗ = 被保険者年齢Ｗ - 1
015270         END-IF
015280*
015290     END-IF
015300*
015310*/郵便番号 ゼロの時はスペース
015320         IF 受−郵便番号１ = "000"
015330             MOVE SPACE          TO 被保険者郵便番号１Ｗ
015340             MOVE SPACE          TO 被保険者郵便番号２Ｗ
015350         ELSE
015360             MOVE 受−郵便番号１ TO 被保険者郵便番号１Ｗ
015370             MOVE 受−郵便番号２ TO 被保険者郵便番号２Ｗ
015380         END-IF
015390         MOVE 受−電話番号     TO 被保険者電話番号Ｗ
015400         MOVE 受−住所１       TO 印刷被保険者住所１Ｗ
015410         MOVE 受−住所２       TO 印刷被保険者住所２Ｗ
015420*         STRING 受−住所１  DELIMITED BY SPACE
015430*                受−住所２  DELIMITED BY SPACE
015440*           INTO 被保険者住所Ｗ
015450*         END-STRING
               IF 受−保険種別 = 70 OR 80 OR 85 OR 90
018370             MOVE 受−患者カナ       TO 被保険者カナＷ
018380             MOVE 受−患者氏名       TO 被保険者氏名Ｗ
018000             EVALUATE 受−患者性別
018010             WHEN 1
018020                 MOVE NC"○"  TO 被保険者男チェックＷ
018030             WHEN 2
018040                 MOVE NC"○"  TO 被保険者女チェックＷ
018050             END-EVALUATE
018070             EVALUATE 受−患者和暦
018080             WHEN 1
018090                 MOVE NC"○"  TO 被保険者明治チェックＷ
018100             WHEN 2
018110                 MOVE NC"○"  TO 被保険者大正チェックＷ
018120             WHEN 3
018130                 MOVE NC"○"  TO 被保険者昭和チェックＷ
      */被保険者平成を追加/080606
                   WHEN 4
                       MOVE NC"○"  TO 被保険者平成チェックＷ
018140             END-EVALUATE
018150             MOVE 受−患者年   TO 被保険者年Ｗ
018160             MOVE 受−患者月   TO 被保険者月Ｗ
018170             MOVE 受−患者日   TO 被保険者日Ｗ
019210             MOVE 受−患者郵便番号１ TO 被保険者郵便番号１Ｗ
019220             MOVE 受−患者郵便番号２ TO 被保険者郵便番号２Ｗ
016980             MOVE 受−患者住所１       TO 印刷被保険者住所１Ｗ
016990             MOVE 受−患者住所２       TO 印刷被保険者住所２Ｗ
018220             MOVE 受−患者電話番号   TO 被保険者電話番号Ｗ
016040             IF ( 受−患者和暦 NOT = ZERO ) AND
016050                ( 受−患者年   NOT = ZERO ) AND
016060                ( 受−患者月   NOT = ZERO ) AND
016070                ( 受−患者日   NOT = ZERO )
016080
016090                 MOVE ZERO TO 被保険者年齢Ｗ
016100*
016110                 MOVE 受−患者和暦 TO 元−元号区分
016120                 READ 元号マスタ
016130                 NOT INVALID KEY
016140                     COMPUTE 被保険者西暦年Ｗ = 元−開始西暦年 + ( 受−患者年 - 1 )
016150                 END-READ
016160*
016170                 COMPUTE 被保険者年齢Ｗ   = 施術西暦年Ｗ - 被保険者西暦年Ｗ
016180*
016190                 IF 連印−施術月 < 受−患者月
016200                     COMPUTE 被保険者年齢Ｗ = 被保険者年齢Ｗ - 1
016210                 END-IF
016220*
016230*                MOVE 被保険者年齢Ｗ     TO 被保険者年齢
016240             END-IF
               END-IF
015460*
015470*/郵便番号 ゼロの時はスペース
015480         IF 受−患者郵便番号１ = "000"
015490             MOVE SPACE              TO 患者郵便番号１Ｗ
015500             MOVE SPACE              TO 患者郵便番号２Ｗ
015510         ELSE
015520             MOVE 受−患者郵便番号１ TO 患者郵便番号１Ｗ
015530             MOVE 受−患者郵便番号２ TO 患者郵便番号２Ｗ
015540         END-IF
015550         MOVE 受−患者住所１     TO 患者住所１Ｗ
015560         MOVE 受−患者住所２     TO 患者住所２Ｗ
015570*         STRING 受−患者住所１  DELIMITED BY SPACE
015580*                受−患者住所２  DELIMITED BY SPACE
015590*           INTO 患者住所Ｗ
015600*         END-STRING
015610         MOVE 受−患者電話番号   TO 患者電話番号Ｗ
015620*
015630*電話番号分割
015640*         UNSTRING 電話番号Ｗ  DELIMITED BY "-"
015650*             INTO 分割電話番号１Ｗ
015660*                  分割電話番号２Ｗ
015670*                  分割電話番号３Ｗ
015680*         END-UNSTRING
015690*電話番号右詰処理
015700*         IF 分割電話番号３Ｗ = SPACE
015710*             MOVE 分割電話番号２Ｗ TO 分割電話番号３Ｗ
015720*             MOVE 分割電話番号１Ｗ TO 分割電話番号２Ｗ
015730*             MOVE SPACE            TO 分割電話番号１Ｗ
015740*         END-IF
015750*
015760         MOVE 受−患者カナ     TO 患者カナＷ
015770         MOVE 受−患者氏名     TO 患者氏名Ｗ
015780*
015790         MOVE 受−保険種別     TO 事−保険種別
015800         MOVE 受−保険者番号   TO 事−保険者番号
015810         MOVE 記号Ｗ           TO 事−記号
015820*
015830         READ 事業所マスタ
015840         INVALID KEY
015850            MOVE SPACE TO 事−レコード
015860            INITIALIZE    事−レコード
015870         END-READ
015880         MOVE 事−事業所名称   TO 事業所情報Ｗ
015890         MOVE 事−事業所住所１ TO 印刷事業所住所１Ｗ
015900         MOVE 事−事業所住所２ TO 印刷事業所住所２Ｗ
      */職業追加/160331
016420         MOVE 55               TO 名−区分コード
016430         MOVE 受−患者職業     TO 名−名称コード
016440         READ 名称マスタ
016450         INVALID KEY
016460             MOVE SPACE        TO 職業Ｗ
016470         NOT INVALID KEY
016480             MOVE 名−略称     TO 職業Ｗ
016490         END-READ
015910* 続柄
015920         IF 受−本人家族区分 = 1
015930             MOVE NC"本人"     TO 続柄Ｗ
015940             MOVE NC"○"       TO 本人チェックＷ
015950         ELSE
015960             MOVE 05          TO 名−区分コード
015970             MOVE 受−続柄    TO 名−名称コード
015980             READ 名称マスタ
015990             INVALID KEY
016000                 MOVE SPACE   TO 続柄Ｗ
016010             NOT INVALID KEY
016020                 MOVE 名−略称  TO 続柄Ｗ
016030             END-READ
016040             MOVE NC"○"       TO 家族チェックＷ
016050         END-IF
016060* 患者和暦年月日
016070         EVALUATE 受−患者和暦
016080         WHEN 1
016090             MOVE NC"○"  TO 明治チェックＷ
016100         WHEN 2
016110             MOVE NC"○"  TO 大正チェックＷ
016120         WHEN 3
016130             MOVE NC"○"  TO 昭和チェックＷ
016140         WHEN 4
016150             MOVE NC"○"  TO 平成チェックＷ
016160         END-EVALUATE
016070         EVALUATE 受−患者和暦
016080         WHEN 1
016090             MOVE NC"明治"  TO 患者元号Ｗ
016100         WHEN 2
016110             MOVE NC"大正"  TO 患者元号Ｗ
016120         WHEN 3
016130             MOVE NC"昭和"  TO 患者元号Ｗ
016140         WHEN 4
016150             MOVE NC"平成"  TO 患者元号Ｗ
016160         END-EVALUATE
016170         MOVE 受−患者年  TO 患者年Ｗ
016180         MOVE 受−患者月  TO 患者月Ｗ
016190         MOVE 受−患者日  TO 患者日Ｗ
016170         MOVE 受−患者年  TO 患者年Ｗ
016180         MOVE 受−患者月  TO 患者月Ｗ
016190         MOVE 受−患者日  TO 患者日Ｗ
016200*患者年齢
016210     MOVE 連印−施術和暦 TO 元−元号区分
016220     READ 元号マスタ
016230     NOT INVALID KEY
016240         COMPUTE 施術西暦年Ｗ = 元−開始西暦年 + ( 連印−施術年 - 1 )
016250     END-READ
016260     IF ( 受−患者和暦 NOT = ZERO ) AND
016270        ( 受−患者年   NOT = ZERO ) AND
016280        ( 受−患者月   NOT = ZERO ) AND
016290        ( 受−患者日   NOT = ZERO )
016300*
016310         MOVE ZERO TO 患者年齢Ｗ
016320*
016330         MOVE 受−患者和暦 TO 元−元号区分
016340         READ 元号マスタ
016350         NOT INVALID KEY
016360             COMPUTE 患者西暦年Ｗ = 元−開始西暦年 + ( 受−患者年 - 1 )
016370         END-READ
016380*
016390         COMPUTE 患者年齢Ｗ   = 施術西暦年Ｗ - 患者西暦年Ｗ
016400*
016410         IF 連印−施術月 < 受−患者月
016420             COMPUTE 患者年齢Ｗ = 患者年齢Ｗ - 1
016430         END-IF
016440*
016450     END-IF
016460* 患者性別
016470*         EVALUATE 受−患者性別
016480*         WHEN 1
016490*             MOVE NC"（男）" TO 患者性別Ｗ
016500*         WHEN 2
016510*             MOVE NC"（女）" TO 患者性別Ｗ
016520*         END-EVALUATE
016530         EVALUATE 受−患者性別
016540         WHEN 1
016550             MOVE NC"○"  TO 患者男チェックＷ
016560         WHEN 2
016570             MOVE NC"○"  TO 患者女チェックＷ
016580         END-EVALUATE
016590*/有効期限
016600         MOVE 受−有効和暦   TO 有効期限和暦Ｗ
016610         MOVE 受−有効年     TO 有効期限年Ｗ
016620         MOVE 受−有効月     TO 有効期限月Ｗ
016630         MOVE 受−有効日     TO 有効期限日Ｗ
016640         MOVE 有効期限和暦Ｗ TO 元−元号区分
016650         READ 元号マスタ
016660         INVALID KEY
016670             MOVE SPACE        TO 有効期限元号Ｗ
016680         NOT INVALID KEY
016690             MOVE 元−元号名称 TO 有効期限元号Ｗ
016700         END-READ
016710*/資格取得年月日
016720         MOVE 受−資格和暦 TO 資格取得和暦Ｗ
016730         MOVE 受−資格年   TO 資格取得年Ｗ
016740         MOVE 受−資格月   TO 資格取得月Ｗ
016750         MOVE 受−資格日   TO 資格取得日Ｗ
016760         IF (資格取得和暦Ｗ NOT = ZERO) AND
016770            (資格取得年Ｗ   NOT = ZERO) AND
016780            (資格取得月Ｗ   NOT = ZERO) AND
016790            (資格取得日Ｗ   NOT = ZERO)
016800             EVALUATE 資格取得和暦Ｗ
016810             WHEN 3
016820                 MOVE NC"○"  TO 資格昭和チェックＷ
016830             WHEN 4
016840                 MOVE NC"○"  TO 資格平成チェックＷ
016850             END-EVALUATE
016800             EVALUATE 資格取得和暦Ｗ
016810             WHEN 3
016820                 MOVE NC"昭和"  TO 資格元号Ｗ
016830             WHEN 4
016840                 MOVE NC"平成"  TO 資格元号Ｗ
016850             END-EVALUATE
016860         END-IF
016870**市町村国保､退職の場合は有効期限を出力
016880**業種別国保(国保組合)､共済､日雇､船員､社保､組合､自衛官は有効期限日を出力する
016890*         IF (( 受−保険種別 = 08 ) OR
016900*            (( 受−保険種別 = 01 ) AND
016910*            (  受−保険者番号(3:1) NOT = "3" )))
016920*             MOVE 受−有効和暦 TO 資格取得和暦Ｗ
016930*             MOVE 受−有効年   TO 資格取得年Ｗ
016940*             MOVE 受−有効月   TO 資格取得月Ｗ
016950*             MOVE 受−有効日   TO 資格取得日Ｗ
016960*         ELSE
016970*             MOVE 受−資格和暦 TO 資格取得和暦Ｗ
016980*             MOVE 受−資格年   TO 資格取得年Ｗ
016990*             MOVE 受−資格月   TO 資格取得月Ｗ
017000*             MOVE 受−資格日   TO 資格取得日Ｗ
017010*         END-IF
017020*         IF (資格取得和暦Ｗ NOT = ZERO) AND
017030*            (資格取得年Ｗ   NOT = ZERO) AND
017040*            (資格取得月Ｗ   NOT = ZERO) AND
017050*            (資格取得日Ｗ   NOT = ZERO)
017060*             EVALUATE 資格取得和暦Ｗ
017070*             WHEN 3
017080*                 MOVE NC"○"  TO 資格昭和チェックＷ
017090*             WHEN 4
017100*                 MOVE NC"○"  TO 資格平成チェックＷ
017110*             END-EVALUATE
017120*         END-IF
017130* 市町村番号 受給者番号
017140         IF 受−助成種別 NOT = ZERO
017150             MOVE 受−費用負担者番号助成 TO 費用負担者番号Ｗ
017160             MOVE 受−受益者番号助成     TO 受益者番号助成Ｗ
      *             STRING 受−費用負担者番号助成 DELIMITED BY SPACE
      *                    受−受益者番号助成     DELIMITED BY SPACE
      *               INTO 福祉番号分割Ｗ
      *             END-STRING
017160*             MOVE 受−受益者番号助成     TO 福祉番号分割Ｗ
      *             STRING "福祉 "                DELIMITED BY SIZE
      *                    福祉番号分割Ｗ(1:3)    DELIMITED BY SIZE
      *                    "-"                    DELIMITED BY SIZE
      *                    福祉番号分割Ｗ(4:2)    DELIMITED BY SIZE
      *                    "-"                    DELIMITED BY SIZE
      *                    福祉番号分割Ｗ(6:10)   DELIMITED BY SIZE
      *               INTO 福祉番号Ｗ
      *             END-STRING
017170         END-IF
017180*         IF ( 受−公費種別 = 05 )
017190*             MOVE 受−費用負担者番号     TO 番号Ｗ
017210*         END-IF
017220     END-READ.
      *労災・自賠・生保の時、被保険者欄に患者情報を入れる
014790         IF 受−保険種別 = 70 OR 80 OR 85
014830             EVALUATE 受−患者性別
014840             WHEN 1
014850                 MOVE NC"○"   TO 被保険者男チェックＷ
014860             WHEN 2
014870                 MOVE NC"○"   TO 被保険者女チェックＷ
014880             END-EVALUATE
014814             MOVE 受−患者カナ TO 被保険者カナＷ
014815             MOVE 受−患者氏名 TO 被保険者氏名Ｗ
014900             EVALUATE 受−患者和暦
014910             WHEN 1
014920                 MOVE NC"○"   TO 被保険者明治チェックＷ
014930             WHEN 2
014940                 MOVE NC"○"   TO 被保険者大正チェックＷ
014950             WHEN 3
014960                 MOVE NC"○"   TO 被保険者昭和チェックＷ
014970             WHEN 4
014980                 MOVE NC"○"   TO 被保険者平成チェックＷ
014990             END-EVALUATE
015000             MOVE 受−患者年   TO 被保険者年Ｗ
015010             MOVE 受−患者月   TO 被保険者月Ｗ
015020             MOVE 受−患者日   TO 被保険者日Ｗ
015320             IF 受−患者郵便番号１ = "000"
015330                 MOVE SPACE              TO 被保険者郵便番号１Ｗ
015340                 MOVE SPACE              TO 被保険者郵便番号２Ｗ
015350             ELSE
015360                 MOVE 受−患者郵便番号１ TO 被保険者郵便番号１Ｗ
015370                 MOVE 受−患者郵便番号２ TO 被保険者郵便番号２Ｗ
015380             END-IF
015390             MOVE 受−患者電話番号       TO 被保険者電話番号Ｗ
015400             MOVE 受−患者住所１         TO 印刷被保険者住所１Ｗ
015410             MOVE 受−患者住所２         TO 印刷被保険者住所２Ｗ
               END-IF.
017230*================================================================*
017240 請求先情報取得 SECTION.
017250*
017260****************************************************
017270* 連結データから保険者マスタより請求先を取得する。 *
017280* ※保−請求先情報区分=1の場合請求先マスタを使用   *
017290* ● 保険者番号...保険者番号Ｗに格納               *
017300* ● 名称........ 請求先名称Ｗに格納               *
017310* ● 郵便番号１.. 請求先郵便番号１Ｗに格納         *
017320* ● 郵便番号２.. 請求先郵便番号２Ｗに格納         *
017330* ● 住所１.......請求先住所１Ｗに格納             *
017340* ● 住所２.......請求先住所２Ｗに格納             *
017350****************************************************
017360     MOVE SPACE          TO 保険者番号Ｗ.
017370     MOVE SPACE          TO 請求先名称Ｗ.
017380     MOVE SPACE          TO 支部名Ｗ.
017390     MOVE SPACE          TO 請求先郵便番号１Ｗ.
017400     MOVE SPACE          TO 請求先郵便番号２Ｗ.
017410     MOVE SPACE          TO 請求先住所１Ｗ.
017420     MOVE SPACE          TO 請求先住所２Ｗ.
017430     MOVE SPACE          TO 請求先電話番号Ｗ.
017440     MOVE SPACE          TO 印刷保険者呼名Ｗ.
017450     MOVE SPACE          TO 請求先名支部名Ｗ
017460*
017470     MOVE 保険種別ＷＲ   TO 保−保険種別.
017480     MOVE 保険者番号ＷＲ TO 保−保険者番号.
017490     READ 保険者マスタ
017500     INVALID KEY
017510         IF ( 施術和暦年月ＷＲ >= 42004 ) AND ( 保険種別ＷＲ = 05 )
017520             MOVE 保険種別ＷＲ   TO 市−公費種別
017530             MOVE 保険者番号ＷＲ TO 市−市町村番号
017540             READ 市町村マスタ
017550             INVALID KEY
017560                 MOVE SPACE      TO 請求先名称Ｗ
017570                 MOVE SPACE      TO 支部名Ｗ
017580                 MOVE ZERO       TO 接尾語区分Ｗ
017590             NOT INVALID KEY
017600                 MOVE 市−市町村番号  TO 保険者番号Ｗ
017610                 MOVE 市−市町村名称  TO 請求先名称Ｗ
017620                 MOVE 市−支部部署名  TO 支部名Ｗ
017630                 MOVE 市−郵便番号１  TO 請求先郵便番号１Ｗ
017640                 MOVE 市−郵便番号２  TO 請求先郵便番号２Ｗ
017650                 MOVE 市−住所１      TO 請求先住所１Ｗ
017660                 MOVE 市−住所２      TO 請求先住所２Ｗ
017670                 MOVE 市−電話番号    TO 請求先電話番号Ｗ
017680                 MOVE ZERO            TO 接尾語区分Ｗ
017690             END-READ
017700         ELSE
017710             MOVE SPACE      TO 請求先名称Ｗ
017720             MOVE SPACE      TO 支部名Ｗ
017730             MOVE ZERO       TO 接尾語区分Ｗ
017740         END-IF
017750     NOT INVALID KEY
017760         MOVE 保−保険者番号  TO 保険者番号Ｗ
017770         MOVE 保−保険者名称  TO 請求先名称Ｗ
017780         MOVE 保−支部部署名  TO 支部名Ｗ
017790         MOVE 保−郵便番号１  TO 請求先郵便番号１Ｗ
017800         MOVE 保−郵便番号２  TO 請求先郵便番号２Ｗ
017810         MOVE 保−住所１      TO 請求先住所１Ｗ
017820         MOVE 保−住所２      TO 請求先住所２Ｗ
017830         MOVE 保−電話番号    TO 請求先電話番号Ｗ
017840         MOVE 保−接尾語区分  TO 接尾語区分Ｗ
017850     END-READ.
           IF 保険種別ＷＲ = 85
              MOVE 施術和暦年月ＷＲ TO 生保−施術和暦年月
              MOVE 患者コードＷＲ   TO 生保−患者コード
              READ 生保情報Ｆ
              NOT INVALID KEY
019480           MOVE 生保−負担者番号    TO 保険者番号Ｗ
019490           MOVE 生保−生保市町村名  TO 請求先名称Ｗ
019500           MOVE SPACE               TO 支部名Ｗ
019510           MOVE 生保−生保送付先郵便番号１  TO 請求先郵便番号１Ｗ
019520           MOVE 生保−生保送付先郵便番号２  TO 請求先郵便番号２Ｗ
020220           MOVE 生保−生保送付先住所１      TO 請求先住所１Ｗ
020230           MOVE 生保−生保送付先住所２      TO 請求先住所２Ｗ
                 MOVE SPACE              TO 記号Ｗ
                 MOVE 生保−生保記号番号 TO 番号Ｗ
              END-READ
           END-IF.
      *
017860     EVALUATE 保険種別ＷＲ
017870     WHEN 2
017880     WHEN 6
017890         IF 接尾語区分Ｗ = 1
017900            MOVE SPACE              TO 印刷保険者呼名Ｗ
017910         ELSE
017920            MOVE "社会保険事務所"   TO 印刷保険者呼名Ｗ
017930         END-IF
017940     WHEN 3
017950         MOVE "健康保険組合"   TO 印刷保険者呼名Ｗ
017960     WHEN OTHER
017970         MOVE SPACE TO 印刷保険者呼名Ｗ
017980     END-EVALUATE.
017990     IF 印刷保険者呼名Ｗ NOT = SPACE
018000         STRING 請求先名称Ｗ DELIMITED BY SPACE
018010                保険者呼名Ｗ DELIMITED BY SPACE
018020           INTO 請求先名称Ｗ
018030         END-STRING
018040     END-IF.
018050*組合と共済は支部名も印字する
018060     EVALUATE 保険種別ＷＲ
018070     WHEN 03
018080     WHEN 04
018090         STRING 請求先名称Ｗ DELIMITED BY SPACE
018100                "  "         DELIMITED BY SIZE
018110                支部名Ｗ     DELIMITED BY SPACE
018120           INTO 請求先名支部名Ｗ
018130         END-STRING
018140     WHEN OTHER
018150         MOVE 請求先名称Ｗ TO 請求先名支部名Ｗ
018160     END-EVALUATE.
018170*================================================================*
018180 負傷データ取得 SECTION.
018190*
018200**************************************************
018210* 連結データから負傷データＦより以下の情報を取得 *
018220* ● 負傷名...部位＋負傷種別にて加工して格納     *
018230* ● 負傷年.......負傷年Ｗ                       *
018240* ● 負傷月.......負傷月Ｗ                       *
018250* ● 負傷日.......負傷日Ｗ                       *
018260* ● 施術終了年...終了年Ｗ                       *
018270* ● 施術終了月...終了月Ｗ                       *
018280* ● 施術終了日...終了日Ｗ                       *
018290**************************************************
018300     MOVE 施術和暦ＷＲ       TO 負−施術和暦.
018310     MOVE 施術年ＷＲ         TO 負−施術年.
018320     MOVE 施術月ＷＲ         TO 負−施術月.
018330     MOVE 患者コードＷＲ     TO 負−患者コード.
018340     READ 負傷データＦ
018350     INVALID KEY
018360         CONTINUE
018370*            /* ありえない */
018380     NOT INVALID KEY
018390         MOVE ZERO                         TO 部位数Ｗ
018400         MOVE 負−部位数                   TO 部位数Ｗ
018410         PERFORM VARYING 部位ＣＮＴ FROM 1 BY 1
018420                 UNTIL ( 部位ＣＮＴ > 部位数Ｗ )
018430*********************************************
018440* 注）全柔...負傷種別＋部位にて加工して格納 *
018450*********************************************
018460* 負傷種別
018470             MOVE SPACE                     TO 負傷名称Ｗ
018480             MOVE 03                        TO 名−区分コード
018490             MOVE 負−負傷種別(部位ＣＮＴ)  TO 名−名称コード
018500             READ 名称マスタ
018510             INVALID KEY
018520                 MOVE SPACE    TO 負傷名称Ｗ
018530             NOT INVALID KEY
018540*                 MOVE 名−略称 TO 負傷名称Ｗ
018550                 MOVE 名−正式名称 TO 負傷名称Ｗ
018560             END-READ
018570* 部位
018580             MOVE SPACE                    TO 負傷名Ｗ(部位ＣＮＴ)
018590             PERFORM 名称埋込処理
018600             MOVE 負−負傷年(部位ＣＮＴ)   TO 負傷年Ｗ(部位ＣＮＴ)
018610             MOVE 負−負傷月(部位ＣＮＴ)   TO 負傷月Ｗ(部位ＣＮＴ)
018620             MOVE 負−負傷日(部位ＣＮＴ)   TO 負傷日Ｗ(部位ＣＮＴ)
018630*             IF 負−負傷年(部位ＣＮＴ) NOT = ZERO 
018640*                MOVE "."                   TO 負傷年月日区切Ｗ(部位ＣＮＴ)
018650*             END-IF
018660*
018670             MOVE 負−開始年(部位ＣＮＴ)   TO 施術開始年Ｗ(部位ＣＮＴ)
018680             MOVE 負−開始月(部位ＣＮＴ)   TO 施術開始月Ｗ(部位ＣＮＴ)
018690             MOVE 負−開始日(部位ＣＮＴ)   TO 施術開始日Ｗ(部位ＣＮＴ)
018700*             IF 負−開始年(部位ＣＮＴ) NOT = ZERO 
018710*                MOVE "."                   TO 施開年月日区切Ｗ(部位ＣＮＴ)
018720*             END-IF
018730*
018740             MOVE 負−終了年(部位ＣＮＴ)   TO 施術終了年Ｗ(部位ＣＮＴ)
018750             MOVE 負−終了月(部位ＣＮＴ)   TO 施術終了月Ｗ(部位ＣＮＴ)
018760             MOVE 負−終了日(部位ＣＮＴ)   TO 施術終了日Ｗ(部位ＣＮＴ)
018770*             IF 負−終了年(部位ＣＮＴ) NOT = ZERO 
018780*                MOVE "."                   TO 施終年月日区切Ｗ(部位ＣＮＴ)
018790*             END-IF
018800*転帰
018810             EVALUATE 負−転帰区分(部位ＣＮＴ)
018820             WHEN 1
018830             WHEN 2
018840                 MOVE NC"○"               TO 治癒チェックＷ(部位ＣＮＴ)
018850             WHEN 3
018860                 MOVE NC"○"               TO 中止チェックＷ(部位ＣＮＴ)
018870             WHEN 4
018880                 MOVE NC"○"               TO 転医チェックＷ(部位ＣＮＴ)
018890             WHEN 9
018900                 MOVE NC"○"               TO 継続チェックＷ(部位ＣＮＴ)
018910             END-EVALUATE
018920*             IF 負−転帰区分(部位ＣＮＴ) NOT = 9
018930*                 MOVE 04                        TO 名−区分コード
018940*                 MOVE 負−転帰区分(部位ＣＮＴ)  TO 名−名称コード
018950*                 READ 名称マスタ
018960*                 INVALID KEY
018970*                     MOVE SPACE    TO 転帰Ｗ(部位ＣＮＴ)
018980*                 NOT INVALID KEY
018990*                     MOVE 名−略称 TO 転帰Ｗ(部位ＣＮＴ)
019000*                 END-READ
019010*             END-IF
019020             PERFORM 負傷データ退避
019030         END-PERFORM
019040     END-READ.
019050*================================================================*
019060 施術記録取得 SECTION.
019070*
019080************************************************************
019090* 連結データから負傷データＦより以下の情報を取得           *
019100* ● 施術開始年月日...該当する部位に対して当月最初の施術日 *
019110************************************************************
019120     MOVE 施術和暦ＷＲ  TO 施記−施術和暦.
019130     MOVE 施術年ＷＲ    TO 施記−施術年.
019140     MOVE 施術月ＷＲ    TO 施記−施術月.
019150     MOVE ZERO            TO 施記−施術日.
019160     MOVE ZERO            TO 施記−患者番号.
019170     MOVE SPACE           TO 施記−枝番.
019180     START 施術記録Ｆ   KEY IS >= 施記−施術和暦年月日
019190                                  施記−患者コード.
019200     IF 状態キー = "00"
019210         MOVE SPACE  TO 終了フラグ２
019220         PERFORM 施術記録Ｆ読込
019230         PERFORM UNTIL ( 終了フラグ２       = "YES" ) OR
019240                       ( 施記−施術和暦 NOT = 施術和暦ＷＲ ) OR
019250                       ( 施記−施術年   NOT = 施術年ＷＲ   ) OR
019260                       ( 施記−施術月   NOT = 施術月ＷＲ   )
019270*            **************
019280*            * 開始年月日 *
019290*            **************
019300             PERFORM VARYING 部位ＣＮＴ FROM 1 BY 1
019310                     UNTIL ( 部位ＣＮＴ > 部位数Ｗ )
019320            EVALUATE TRUE ALSO TRUE ALSO TRUE ALSO TRUE ALSO TRUE
019330            WHEN 施記−負傷種別(部位ＣＮＴ) = 負傷種別Ｗ(部位ＣＮＴ) ALSO
019340                 施記−部位(部位ＣＮＴ)     = 部位Ｗ(部位ＣＮＴ)     ALSO
019350                 施記−左右区分(部位ＣＮＴ) = 左右区分Ｗ(部位ＣＮＴ) ALSO
019360                 施記−負傷位置番号(部位ＣＮＴ)
019370                                       = 負傷位置番号Ｗ(部位ＣＮＴ)  ALSO
019380                 開始年月日取得フラグ(部位ＣＮＴ) = SPACE
019390                   MOVE 施記−施術年     TO 施術開始年Ｗ(部位ＣＮＴ)
019400                   MOVE 施記−施術月     TO 施術開始月Ｗ(部位ＣＮＴ)
019410                   MOVE 施記−施術日     TO 施術開始日Ｗ(部位ＣＮＴ)
019420                   MOVE "YES"       TO 開始年月日取得フラグ(部位ＣＮＴ)
019430*
019440            WHEN OTHER
019450                CONTINUE
019460            END-EVALUATE
019470             END-PERFORM
019480             PERFORM 施術記録Ｆ読込
019490         END-PERFORM
019500     END-IF.
019510*================================================================*
019520 施術記録Ｆ読込 SECTION.
019530*
019540     READ 施術記録Ｆ NEXT
019550     AT END
019560         MOVE "YES" TO 終了フラグ２
019570     END-READ.
024400*================================================================*
024401 カルテコメント取得 SECTION.
024402*
024403************************************************************
024404* カルテファイルより以下のカルテコメントを取得             *
024405* ● 同意医師情報　氏名・住所・医療機関・電話番号          *
024406* ● 同意年月日                                            *
024407* ● フリーコメント                                        *
024408************************************************************
024409     MOVE 10            TO カ表−会コード.
024410     MOVE ZERO          TO カ表−区分.
024412     MOVE 施術和暦ＷＲ  TO カ表−施術和暦.
024413     MOVE 施術年ＷＲ    TO カ表−施術年.
024414     MOVE 施術月ＷＲ    TO カ表−施術月.
024416     MOVE 患者番号ＷＲ  TO カ表−患者番号.
024417     MOVE 枝番ＷＲ      TO カ表−枝番.
024432     READ カルテファイル
024433     INVALID KEY
024443         MOVE SPACE                          TO 同意医師名Ｗ
024453         MOVE SPACE                          TO 同意元号Ｗ
024457         MOVE ZERO                           TO 同意年Ｗ
024458         MOVE ZERO                           TO 同意月Ｗ
024459         MOVE ZERO                           TO 同意日Ｗ
024460         MOVE SPACE                          TO 症状Ｗ
024460         MOVE SPACE                          TO 処置Ｗ
024461     NOT INVALID KEY 
024464         MOVE カ表コメ−同意医師名           TO 同意医師名Ｗ
024471         MOVE カ表コメ−同意和暦             TO 元−元号区分
024475         READ 元号マスタ
024476         INVALID KEY
024477             MOVE SPACE                      TO 同意元号Ｗ
024478         NOT INVALID KEY
024479             MOVE 元−元号名称               TO 同意元号Ｗ
024480         END-READ
024481         MOVE カ表コメ−同意年               TO 同意年Ｗ
024482         MOVE カ表コメ−同意月               TO 同意月Ｗ
024483         MOVE カ表コメ−同意日               TO 同意日Ｗ
024484         MOVE カ表コメ−フリーコメント       TO 処置Ｗ
024484         MOVE カ表コメ−初検の所見           TO 症状Ｗ
024485     END-READ.
019580*================================================================*
019590 負傷原因取得 SECTION.
019600*
019610********************************************************************
019620*  負傷原因コードが同じものは、1行にまとめて印字する。
019630*  例: @A 家で転んだ.
019640*     負傷原因コードが同じものをまとめ、テーブルにセット
019650*     (ただし、部位を飛んで同じものは、2行になる)
019660********************************************************************
019670     MOVE  ZERO   TO  カウンタ カウンタ２.
019680     PERFORM VARYING 部位ＣＮＴ FROM 1 BY 1
019690*/登録部位数以上の行に印刷出来ない不具合の修正/090313
019700             UNTIL ( 部位ＣＮＴ > 7 )
019710*             UNTIL ( 部位ＣＮＴ > 部位数Ｗ )
019720*
019730****        IF ( 負傷原因患者番号Ｗ(部位ＣＮＴ)  NOT = ZERO )  AND
019740        IF ( 負傷原因連番Ｗ(部位ＣＮＴ)      NOT = ZERO )
019750*
019760           IF カウンタ = ZERO
019770               MOVE 1   TO  カウンタ カウンタ２
019780               MOVE 負傷原因患者番号Ｗ(部位ＣＮＴ) TO 負傷患者番号Ｗ(カウンタ)  負傷患者番号ＣＷ
019790               MOVE 負傷原因連番Ｗ(部位ＣＮＴ)     TO 負傷連番Ｗ(カウンタ)   負傷連番ＣＷ
019800               MOVE 部位ＣＮＴ                   TO 負傷原因部位Ｗ(カウンタ カウンタ２)
019810           ELSE
019820              IF ( 負傷原因患者番号Ｗ(部位ＣＮＴ)  = 負傷患者番号ＣＷ )  AND
019830                 ( 負傷原因連番Ｗ(部位ＣＮＴ)      = 負傷連番ＣＷ     )
019840                 COMPUTE カウンタ２ = カウンタ２  +  1
019850                 MOVE 部位ＣＮＴ                  TO 負傷原因部位Ｗ(カウンタ カウンタ２)
019860              ELSE
019870                 COMPUTE カウンタ = カウンタ  +  1
019880                 MOVE 1   TO  カウンタ２
019890                 MOVE 負傷原因患者番号Ｗ(部位ＣＮＴ) TO 負傷患者番号Ｗ(カウンタ)  負傷患者番号ＣＷ
019900                 MOVE 負傷原因連番Ｗ(部位ＣＮＴ)     TO 負傷連番Ｗ(カウンタ)  負傷連番ＣＷ
019910                 MOVE 部位ＣＮＴ                   TO 負傷原因部位Ｗ(カウンタ カウンタ２)
019920              END-IF
019930           END-IF
019940        END-IF
019950     END-PERFORM.
019960**************************************************************************
019970*  負傷原因マスタより文章取得
019980**************************************************************************
019990     MOVE  ZERO   TO  カウンタ カウンタ２.
020000     PERFORM VARYING カウンタ FROM 1 BY 1
020010             UNTIL ( カウンタ > 9 )  OR ( 負傷連番Ｗ(カウンタ) = ZERO )
020020** 健保は 区分 01
020030*         MOVE 01                        TO 負原−区分コード
020040*/健保：０１、労災：０２、自賠責：０３
020050         EVALUATE 受−保険種別
020060         WHEN 70
020070             MOVE 2 TO 負原−区分コード
020080         WHEN 80
020090             MOVE 3 TO 負原−区分コード
020100         WHEN OTHER
020110             MOVE 1 TO 負原−区分コード
020120         END-EVALUATE
020130         MOVE 負傷患者番号Ｗ(カウンタ)  TO 負原−患者番号
020140         MOVE 負傷連番Ｗ(カウンタ)      TO 負原−負傷原因連番
020150         READ 負傷原因Ｆ
020160         NOT INVALID KEY
020170             INITIALIZE 負傷原因ＷＴ
020180             MOVE 負原−負傷原因ＣＭ(1) TO  負傷原因１ＷＴ
020190             MOVE 負原−負傷原因ＣＭ(2) TO  負傷原因２ＷＴ
020200             MOVE 負原−負傷原因ＣＭ(3) TO  負傷原因３ＷＴ
020210             MOVE 負原−負傷原因ＣＭ(4) TO  負傷原因４ＷＴ
020220             MOVE 負原−負傷原因ＣＭ(5) TO  負傷原因５ＷＴ
020230             PERFORM VARYING カウンタ２ FROM 1 BY 1
020240                     UNTIL ( カウンタ２ > 9 )  OR 
020250                           ( 負傷原因部位Ｗ(カウンタ カウンタ２) = ZERO )
020260                EVALUATE 負傷原因部位Ｗ(カウンタ カウンタ２)
020270                WHEN 1
020280                   MOVE "@"  TO  負傷原因ナンバーＷ１(カウンタ２)
020290                WHEN 2
020300                   MOVE "A"  TO  負傷原因ナンバーＷ１(カウンタ２)
020310                WHEN 3
020320                   MOVE "B"  TO  負傷原因ナンバーＷ１(カウンタ２)
020330                WHEN 4
020340                   MOVE "C"  TO  負傷原因ナンバーＷ１(カウンタ２)
020350                WHEN 5
020360                   MOVE "D"  TO  負傷原因ナンバーＷ１(カウンタ２)
020350                WHEN 6
020360                   MOVE "E"  TO  負傷原因ナンバーＷ１(カウンタ２)
020350                WHEN 7
020360                   MOVE "F"  TO  負傷原因ナンバーＷ１(カウンタ２)
020370                WHEN OTHER
020380                   CONTINUE
020390                END-EVALUATE
020400             END-PERFORM
020410*
020420             IF 負原−負傷原因入力区分 = 1
020430                 STRING 負傷原因ナンバーＮＷ  DELIMITED BY SPACE
020440                        負傷原因１ＷＴ  DELIMITED BY SIZE
020450                        負傷原因２ＷＴ  DELIMITED BY SIZE
020460                        負傷原因３ＷＴ  DELIMITED BY SIZE
020470                        負傷原因４ＷＴ  DELIMITED BY SIZE
020480                        負傷原因５ＷＴ  DELIMITED BY SIZE
020490                        INTO 負傷原因内容合成Ｗ(カウンタ)
020500                 END-STRING
020510             ELSE
020520                 INSPECT 負傷原因ＷＴ REPLACING ALL 全角空白 BY 半角空白
020530                 MOVE SPACE TO 文字１Ｗ 文字２Ｗ
020540                 MOVE 負傷原因ナンバーＮＷ TO 文字１Ｗ
020550                 MOVE 負傷原因１ＷＴ       TO 文字２Ｗ
020560                 CALL プログラム名Ｗ WITH C LINKAGE
020570                      USING BY REFERENCE 文字１Ｗ
020580                            BY REFERENCE 文字２Ｗ
020590                 MOVE 負傷原因２ＷＴ       TO 文字２Ｗ
020600                 CALL プログラム名Ｗ WITH C LINKAGE
020610                      USING BY REFERENCE 文字１Ｗ
020620                            BY REFERENCE 文字２Ｗ
020630                 MOVE 負傷原因３ＷＴ       TO 文字２Ｗ
020640                 CALL プログラム名Ｗ WITH C LINKAGE
020650                      USING BY REFERENCE 文字１Ｗ
020660                            BY REFERENCE 文字２Ｗ
020670                 MOVE 負傷原因４ＷＴ       TO 文字２Ｗ
020680                 CALL プログラム名Ｗ WITH C LINKAGE
020690                      USING BY REFERENCE 文字１Ｗ
020700                            BY REFERENCE 文字２Ｗ
020710                 MOVE 負傷原因５ＷＴ       TO 文字２Ｗ
020720                 CALL プログラム名Ｗ WITH C LINKAGE
020730                      USING BY REFERENCE 文字１Ｗ
020740                            BY REFERENCE 文字２Ｗ
020750                  MOVE 文字１Ｗ TO 負傷原因内容合成Ｗ(カウンタ)
020760             END-IF
020770*
020780         END-READ
020790     END-PERFORM.
020800*
020810     PERFORM 負傷原因セット.
020820*
020830*================================================================*
020840 詳細モード負傷原因処理 SECTION.
020850*
020860*******************************************************************
020870* 連印−負傷印刷行により、負傷原因データの並び替えを行う。
020880* ( 負傷原因情報Ｗを初期化し、退避済みの負傷原因情報ＳＷから
020890*         並び替えを行い、負傷原因情報Ｗを再設定する。)
020900*******************************************************************
020910*
020920     INITIALIZE 負傷原因情報Ｗ.
020930*
020940     PERFORM VARYING 詳細ＣＮＴ FROM 1 BY 1
020950                                UNTIL ( 詳細ＣＮＴ > 7)
020960*
020970        IF ( 連印−負傷印刷行(詳細ＣＮＴ) NOT = ZERO) AND
020980           ( 連印−原因印刷区分(詳細ＣＮＴ)   = 1)
020990*
021000           MOVE 連印−負傷印刷行(詳細ＣＮＴ) TO 印刷行ＳＷ
021010*
021020           MOVE 負傷患者番号ＳＷ(詳細ＣＮＴ) TO 負傷原因患者番号Ｗ(印刷行ＳＷ)
021030           MOVE 負傷連番ＳＷ(詳細ＣＮＴ) TO 負傷原因連番Ｗ(印刷行ＳＷ)
021040        END-IF
021050*
021060     END-PERFORM.
021070*
021080*================================================================*
021090 原因行セット SECTION.
021100*/0610
021110* 指定された開始行から印刷するようにセットし直す。
021120* １０行.
021130*
021140     MOVE SPACE                  TO 負傷原因Ｗテーブル２.
021150     MOVE ZERO                   TO カウンタ.
021160     IF 連印−原因開始行 = ZERO
021170         MOVE 1                  TO カウンタ２
021180     ELSE
021190         MOVE 連印−原因開始行   TO カウンタ２
021200     END-IF.
021210     PERFORM VARYING カウンタ FROM 1 BY 1
021220             UNTIL ( カウンタ > 10 ) OR (カウンタ２ > 10)
021230         MOVE 負傷原因Ｗ(カウンタ) TO 負傷原因Ｗ２(カウンタ２)
021240         COMPUTE カウンタ２ = カウンタ２ + 1
021250     END-PERFORM.
021260*
021270     PERFORM VARYING カウンタ FROM 1 BY 1
021280               UNTIL カウンタ > 10
021290         MOVE 負傷原因Ｗ２(カウンタ) TO 負傷原因Ｗ(カウンタ)
021300     END-PERFORM.
021310*================================================================*
021320 詳細モード負傷処理 SECTION.
021330*
021340*******************************************************************
021350* 連印−負傷印刷行により、負傷データの並び替えを行う。
021360* ( 負傷情報Ｗを初期化し、退避済みの負傷情報ＳＷから
021370*         並び替えを行い、負傷情報Ｗを再設定する。)
021380*******************************************************************
021390*
021400     INITIALIZE 負傷情報Ｗ.
021410*
021420     PERFORM VARYING 詳細ＣＮＴ FROM 1 BY 1
021430                                UNTIL ( 詳細ＣＮＴ > 7)
021440*
021450        IF 連印−負傷印刷行(詳細ＣＮＴ) NOT = ZERO
021460*
021470           MOVE 連印−負傷印刷行(詳細ＣＮＴ) TO 印刷行ＳＷ
021480*
021490           IF 連印−部位印刷区分(詳細ＣＮＴ) = 1
021500*
021510              MOVE 負傷名ＳＷ(詳細ＣＮＴ) TO 負傷名Ｗ(印刷行ＳＷ)
021520              MOVE 負傷年ＳＷ(詳細ＣＮＴ) TO 負傷年Ｗ(印刷行ＳＷ)
021530              MOVE 負傷月ＳＷ(詳細ＣＮＴ) TO 負傷月Ｗ(印刷行ＳＷ)
021540              MOVE 負傷日ＳＷ(詳細ＣＮＴ) TO 負傷日Ｗ(印刷行ＳＷ)
021550              MOVE 施術開始年ＳＷ(詳細ＣＮＴ) TO 施術開始年Ｗ(印刷行ＳＷ)
021560              MOVE 施術開始月ＳＷ(詳細ＣＮＴ) TO 施術開始月Ｗ(印刷行ＳＷ)
021570              MOVE 施術開始日ＳＷ(詳細ＣＮＴ) TO 施術開始日Ｗ(印刷行ＳＷ)
021580           END-IF
021590*
021600           IF 連印−転帰印刷区分(詳細ＣＮＴ) = 1
021610              MOVE 施術終了年ＳＷ(詳細ＣＮＴ) TO 施術終了年Ｗ(印刷行ＳＷ)
021620              MOVE 施術終了月ＳＷ(詳細ＣＮＴ) TO 施術終了月Ｗ(印刷行ＳＷ)
021630              MOVE 施術終了日ＳＷ(詳細ＣＮＴ) TO 施術終了日Ｗ(印刷行ＳＷ)
021640              MOVE 治癒チェックＳＷ(詳細ＣＮＴ) TO 治癒チェックＷ(印刷行ＳＷ)
021650              MOVE 中止チェックＳＷ(詳細ＣＮＴ) TO 中止チェックＷ(印刷行ＳＷ)
021660              MOVE 継続チェックＳＷ(詳細ＣＮＴ) TO 継続チェックＷ(印刷行ＳＷ)
021670              MOVE 転医チェックＳＷ(詳細ＣＮＴ) TO 転医チェックＷ(印刷行ＳＷ)
021680           END-IF
021690        END-IF
021700*
021710     END-PERFORM.
021720*
021730*================================================================*
021740 負傷データ退避 SECTION.
021750*
021760*********************************************************************
021770* @ 負傷原因取得のため、負傷データＦから負傷原因Ｗに退避する。
021780* A 詳細モード用  連印−負傷行印刷により、印刷位置を並び替えるため、
021790*                  負傷情報Ｗ  から負傷情報ＳＷに、
021800*                  負傷原因Ｗ  から負傷原因ＳＷに退避する。
021810*********************************************************************
021820*
021830     MOVE 負−負傷患者番号(部位ＣＮＴ) TO 負傷原因患者番号Ｗ(部位ＣＮＴ).
021840     MOVE 負−負傷連番(部位ＣＮＴ)     TO 負傷原因連番Ｗ(部位ＣＮＴ).
021850*--------------------------------------------------------------------*
021860     MOVE 負傷名Ｗ(部位ＣＮＴ) TO 負傷名ＳＷ(部位ＣＮＴ).
021870*
021880     MOVE 負傷年Ｗ(部位ＣＮＴ) TO 負傷年ＳＷ(部位ＣＮＴ).
021890     MOVE 負傷月Ｗ(部位ＣＮＴ) TO 負傷月ＳＷ(部位ＣＮＴ).
021900     MOVE 負傷日Ｗ(部位ＣＮＴ) TO 負傷日ＳＷ(部位ＣＮＴ).
021910*
021920     MOVE 施術開始年Ｗ(部位ＣＮＴ) TO 施術開始年ＳＷ(部位ＣＮＴ).
021930     MOVE 施術開始月Ｗ(部位ＣＮＴ) TO 施術開始月ＳＷ(部位ＣＮＴ).
021940     MOVE 施術開始日Ｗ(部位ＣＮＴ) TO 施術開始日ＳＷ(部位ＣＮＴ).
021950*
021960     MOVE 施術終了年Ｗ(部位ＣＮＴ) TO 施術終了年ＳＷ(部位ＣＮＴ).
021970     MOVE 施術終了月Ｗ(部位ＣＮＴ) TO 施術終了月ＳＷ(部位ＣＮＴ).
021980     MOVE 施術終了日Ｗ(部位ＣＮＴ) TO 施術終了日ＳＷ(部位ＣＮＴ).
021990*
022000     MOVE 治癒チェックＷ(部位ＣＮＴ) TO 治癒チェックＳＷ(部位ＣＮＴ).
022010     MOVE 中止チェックＷ(部位ＣＮＴ) TO 中止チェックＳＷ(部位ＣＮＴ).
022020     MOVE 継続チェックＷ(部位ＣＮＴ) TO 継続チェックＳＷ(部位ＣＮＴ).
022030     MOVE 転医チェックＷ(部位ＣＮＴ) TO 転医チェックＳＷ(部位ＣＮＴ).
022040*     MOVE 施術累計回数Ｗ(部位ＣＮＴ) TO 施術累計回数ＳＷ(部位ＣＮＴ).
022050*
022060     MOVE 負傷原因患者番号Ｗ(部位ＣＮＴ) TO 負傷患者番号ＳＷ(部位ＣＮＴ).
022070     MOVE 負傷原因連番Ｗ(部位ＣＮＴ)     TO 負傷連番ＳＷ(部位ＣＮＴ).
022080*
022090*================================================================*
022100 負傷原因セット SECTION.
022110*
022120**************************************************************************
022130*  文章が1行を超える時は、複数行に分解する。
022140**************************************************************************
022150     MOVE  ZERO   TO  カウンタ カウンタ２.
022160     PERFORM VARYING カウンタ FROM 1 BY 1
022170             UNTIL ( カウンタ > 9 )  OR ( 負傷原因内容合成Ｗ(カウンタ) = SPACE )
022180*
022190          INITIALIZE 負傷原因内容分解ＸＷ
022200          MOVE 負傷原因内容合成Ｗ(カウンタ)   TO 負傷原因内容分解ＸＷ
022210          IF  負傷原因内容１ＸＷ  NOT = SPACE
022220              COMPUTE カウンタ２ = カウンタ２  +  1
022230              MOVE 負傷原因内容１ＸＷ  TO 負傷原因Ｗ(カウンタ２)
022240          END-IF
022250          IF  負傷原因内容２ＸＷ  NOT = SPACE
022260              COMPUTE カウンタ２ = カウンタ２  +  1
022270              MOVE 負傷原因内容２ＸＷ  TO 負傷原因Ｗ(カウンタ２)
022280          END-IF
022290          IF  負傷原因内容３ＸＷ  NOT = SPACE
022300              COMPUTE カウンタ２ = カウンタ２  +  1
022310              MOVE 負傷原因内容３ＸＷ  TO 負傷原因Ｗ(カウンタ２)
022320          END-IF
022370*
022380     END-PERFORM.
022390*
022400*================================================================*
022410 印刷処理 SECTION.
022420*
022430     EVALUATE 印刷モードＦＷＲ
022440     WHEN 0
022450         PERFORM 印刷処理２
022460         PERFORM 印刷処理３
022470     WHEN 1
022480         PERFORM 印刷処理２
022490     WHEN 2
022500         PERFORM 印刷処理３
022510     WHEN 4
022520         IF 連印−保険証印刷区分 = 1
022530             PERFORM 印刷処理２
022540         END-IF
022550             PERFORM 印刷処理３
022560     END-EVALUATE.
022570*================================================================*
022580 印刷処理２ SECTION.
022590*
022600     MOVE "YGN662P"  TO  定義体名Ｐ.
022610     MOVE "GRP001"   TO  項目群名Ｐ.
022620     WRITE YGN662P.
022630*     WRITE 印刷レコード.
022640     PERFORM エラー処理Ｐ.
022650*================================================================*
022660 印刷処理３ SECTION.
022670*
022680     MOVE "YGN662P"  TO  定義体名Ｐ.
022690     MOVE "GRP002"   TO  項目群名Ｐ.
022700     WRITE YGN662P.
022710*     WRITE 印刷レコード.
022720     PERFORM エラー処理Ｐ.
022730*================================================================*
022740 エラー処理Ｐ SECTION.
022750*
022760     IF 通知情報Ｐ NOT = "00"
022770         DISPLAY NC"帳票エラー"              UPON CONS
022780         DISPLAY NC"項目群名Ｐ：" 項目群名Ｐ UPON CONS
022790         DISPLAY NC"通知情報Ｐ：" 通知情報Ｐ UPON CONS
022800         DISPLAY NC"拡張制御Ｐ：" 拡張制御Ｐ UPON CONS
022810         DISPLAY NC"数字１文字入力しＥＮＴＥＲキーを押してください"
022820                                             UPON CONS
022830*-----------------------------------------*
022840         CALL "actcshm"  WITH C LINKAGE
022850*-----------------------------------------*
022860         ACCEPT  キー入力 FROM CONS
022870         PERFORM ファイル閉鎖
022880         EXIT PROGRAM
022890     END-IF.
022900*================================================================*
022910 名称埋込処理 SECTION.
022920*
022930     EVALUATE 受−保険種別
022940     WHEN 05
022950         MOVE 2          TO レセ−レセ種別
022960     WHEN 70
022970         MOVE 4          TO レセ−レセ種別
022980     WHEN 80
022990         MOVE 5          TO レセ−レセ種別
023000     WHEN 85
023010         MOVE 7          TO レセ−レセ種別
023020     WHEN 90
023030         MOVE 6          TO レセ−レセ種別
023040     WHEN 91
023050         MOVE 8          TO レセ−レセ種別
023060     WHEN OTHER
023070         MOVE 1          TO レセ−レセ種別
023080     END-EVALUATE.
023090     MOVE 受−施術和暦 TO レセ−施術和暦.
023100     MOVE 受−施術年   TO レセ−施術年.
023110     MOVE 受−施術月   TO レセ−施術月.
023120     MOVE 受−患者番号 TO レセ−患者番号.
023130     MOVE 受−枝番     TO レセ−枝番.
023140     READ レセプトＦ
023150     NOT INVALID KEY
023160*
023170         STRING レセ−部位名称１(部位ＣＮＴ)  DELIMITED BY SPACE
023180                レセ−部位名称２(部位ＣＮＴ)  DELIMITED BY SPACE
023190                負傷名称Ｗ                    DELIMITED BY SPACE
023200           INTO 負傷名Ｗ(部位ＣＮＴ)
023210         END-STRING
023220     END-READ.
023230*
023240*================================================================*
023250  テスト印刷 SECTION.
023260*
023270     MOVE ALL "9" TO 患者番号 市町村番号 受給者番号 保険者番号 番号 患者電話番号
023280                     患者郵便番号１ 患者郵便番号２.
023290     MOVE NC"○"  TO 社保チェック 組合チェック 共済チェック 国保チェック
023310                     後高チェック 日雇チェック 船員チェック 
023310                     高１チェック 高２チェック 高３チェック
023310                     ０割チェック １割チェック ２割チェック ３割チェック
023320                     患者男チェック 患者女チェック 資格昭和チェック 資格平成チェック
023330                     明治チェック 大正チェック 昭和チェック 平成チェック
023360                     治癒チェック１ 治癒チェック２ 治癒チェック３ 治癒チェック４ 治癒チェック５
023370                     中止チェック１ 中止チェック２ 中止チェック３ 中止チェック４ 中止チェック５
023380                     転医チェック１ 転医チェック２ 転医チェック３ 転医チェック４ 転医チェック５.
023390     MOVE 99      TO 患者年 患者月 患者日 助成負担割合
023400                     負傷年１ 負傷年２ 負傷年３ 負傷年４ 負傷年５
023410                     負傷月１ 負傷月２ 負傷月３ 負傷月４ 負傷月５
023420                     負傷日１ 負傷日２ 負傷日３ 負傷日４ 負傷日５
023430                     施術開始年１ 施術開始年２ 施術開始年３ 施術開始年４ 施術開始年５
023440                     施術開始月１ 施術開始月２ 施術開始月３ 施術開始月４ 施術開始月５
023450                     施術開始日１ 施術開始日２ 施術開始日３ 施術開始日４ 施術開始日５
023460                     施術終了年１ 施術終了年２ 施術終了年３ 施術終了年４ 施術終了年５
023470                     施術終了月１ 施術終了月２ 施術終了月３ 施術終了月４ 施術終了月５
023480                     施術終了日１ 施術終了日２ 施術終了日３ 施術終了日４ 施術終了日５
023490                     有効年 有効月 有効日 資格取得年 資格取得月 資格取得日.
023500     MOVE ALL "静" TO 事業所住所１ 事業所住所２ 事業所名称１ 事業所名称２ 請求先住所１ 請求先住所２
023510                      請求先名称１ 請求先名称２
023520                      記号 被保険者氏名 患者氏名 患者住所１ 患者住所２.
023540     MOVE ALL NC"静" TO 続柄 保険種別
023550                        負傷名１ 負傷名２ 負傷名３ 負傷名４ 負傷名５.
           PERFORM VARYING カウンタ FROM 1 BY 1
                     UNTIL カウンタ > 8
              MOVE ALL "静"   TO 負傷原因(カウンタ) 
           END-PERFORM.
           PERFORM VARYING カウンタ FROM 1 BY 1
                     UNTIL カウンタ > 15
              MOVE ALL "静"   TO 初回処置(カウンタ)
           END-PERFORM.
           PERFORM VARYING カウンタ FROM 1 BY 1
                     UNTIL カウンタ > 20
              MOVE ALL "静"   TO 初検時の症状(カウンタ)
           END-PERFORM.
023560*================================================================*
023570******************************************************************
023580 END PROGRAM YGN662.
023590******************************************************************
