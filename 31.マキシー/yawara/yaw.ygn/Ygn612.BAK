000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YGN612.
000060 AUTHOR.                 rc@Kq
000070*
000080*----------------------------------------------------------------*
000090*         Qn     Zvgi_+޳ޔŁj
000100*         MED = YAW610 YGN612P
000110*----------------------------------------------------------------*
000120 DATE-WRITTEN.           2016-04-06
000130 DATE-COMPILED.          2016-04-06
000140*----------------------------------------------------------------*
000150******************************************************************
000160*            ENVIRONMENT         DIVISION                        *
000170******************************************************************
000180 ENVIRONMENT             DIVISION.
000190 CONFIGURATION           SECTION.
000200 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000210 OBJECT-COMPUTER.        FMV-DESKPOWER.
000220 SPECIAL-NAMES.          CONSOLE  IS  CONS
000230                         SYSERR   IS  MSGBOX.
000240 INPUT-OUTPUT            SECTION.
000250 FILE-CONTROL.
000260     SELECT  ی҃}X^    ASSIGN      TO        HOKENSL
000270                             ORGANIZATION             IS  INDEXED
000280                             ACCESS MODE              IS  DYNAMIC
000290                             RECORD KEY               IS  ہ|ی
000300                                                          ہ|یҔԍ
000310                             ALTERNATE RECORD KEY     IS  ہ|ی
000320                                                          ہ|یҖ
000330                                                          ہ|یҔԍ
000340                             FILE STATUS              IS  ԃL[
000350                             LOCK        MODE         IS  AUTOMATIC.
000360     SELECT  }X^      ASSIGN      TO        GENGOUL
000370                             ORGANIZATION             IS  INDEXED
000380                             ACCESS MODE              IS  DYNAMIC
000390                             RECORD KEY               IS  |敪
000400                             FILE STATUS              IS  ԃL[
000410                             LOCK        MODE         IS  AUTOMATIC.
000420     SELECT  ̃}X^      ASSIGN      TO        MEISYOL
000430                             ORGANIZATION             IS  INDEXED
000440                             ACCESS MODE              IS  DYNAMIC
000450                             RECORD KEY               IS  |敪R[h
000460                                                          |̃R[h
000470                             FILE STATUS              IS  ԃL[
000480                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  Zvge      ASSIGN      TO        RECEPTL
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  Z|{paN
000170                                                          Z|҃R[h
000180                                                          Z|Z
000190                             ALTERNATE RECORD KEY     IS  Z|҃R[h
000200                                                          Z|{paN
000210                                                          Z|Z
000220                             ALTERNATE RECORD KEY     IS  Z|aN
000230                                                          Z|{paN
000240                                                          Z|҃R[h
000250                                                          Z|Z
000260                             ALTERNATE RECORD KEY     IS  Z|aN
000270                                                          Z|Z
000280                                                          Z|یҔԍ
000290                                                          Z|҃R[h
000300                                                          Z|{paN
000310                             ALTERNATE RECORD KEY     IS  Z|aN
000320                                                          Z|یҔԍ
000330                                                          Z|҃R[h
000340                                                          Z|Z
000350                                                          Z|{paN
000360                             FILE STATUS              IS  ԃL[
000370                             LOCK        MODE         IS  AUTOMATIC.
000550     SELECT  }X^  ASSIGN      TO        SEIGYOL
000560                             ORGANIZATION             IS  INDEXED
000570                             ACCESS MODE              IS  DYNAMIC
000580                             RECORD KEY               IS  |敪
000590                             FILE STATUS              IS  ԃL[
000600                             LOCK        MODE         IS  AUTOMATIC.
000610     SELECT  {p}X^ ASSIGN      TO        SEJOHOL
000620                             ORGANIZATION             IS  INDEXED
000630                             ACCESS MODE              IS  DYNAMIC
000640                             RECORD KEY               IS  {|{pԍ
000650                             FILE STATUS              IS  ԃL[
000660                             LOCK        MODE         IS  AUTOMATIC.
000670     SELECT  }X^    ASSIGN      TO        SEIKYUSL
000680                             ORGANIZATION             IS  INDEXED
000690                             ACCESS MODE              IS  DYNAMIC
000700                             RECORD KEY               IS  |ی
000710                                                          |یҔԍ
000720                             FILE STATUS              IS  ԃL[
000730                             LOCK    MODE             IS  AUTOMATIC.
000740     SELECT  o߃}X^      ASSIGN      TO        KEIKAL
000750                             ORGANIZATION             IS  INDEXED
000760                             ACCESS MODE              IS  DYNAMIC
000770                             RECORD KEY               IS  o|敪R[h
000780                                                          o|o߃R[h
000790                             FILE STATUS              IS  ԃL[
000800                             LOCK        MODE         IS  AUTOMATIC.
000810     SELECT  hcǗ}X^  ASSIGN      TO        IDKANRL
000820                             ORGANIZATION             IS  INDEXED
000830                             ACCESS MODE              IS  DYNAMIC
000840                             RECORD KEY               IS  hcǁ|hc敪
000850                                                          hcǁ|{pԍ
000860                                                          hcǁ|ی
000870                                                          hcǁ|یҔԍ
000880                             ALTERNATE RECORD KEY     IS  hcǁ|{phcԍ
000890                                                          hcǁ|hc敪
000900                                                          hcǁ|{pԍ
000910                                                          hcǁ|ی
000920                                                          hcǁ|یҔԍ
000930                             FILE STATUS              IS  ԃL[
000940                             LOCK        MODE         IS  AUTOMATIC.
000950     SELECT  s}X^    ASSIGN      TO        SITYOSNL
000960                             ORGANIZATION             IS  INDEXED
000970                             ACCESS MODE              IS  DYNAMIC
000980                             RECORD KEY               IS  s|
000990                                                          s|sԍ
001000                             ALTERNATE RECORD KEY     IS  s|
001010                                                          s|s
001020                                                          s|sԍ
001030                             FILE STATUS              IS  ԃL[
001040                             LOCK        MODE         IS  AUTOMATIC.
001050     SELECT  fҏe    ASSIGN      TO        JUSINJL
001060                             ORGANIZATION             IS  INDEXED
001070                             ACCESS MODE              IS  DYNAMIC
001080                             RECORD KEY               IS  |{paN
001090                                                          |҃R[h
001100                             ALTERNATE RECORD KEY     IS  |{paN
001110                                                          |҃Ji
001120                                                          |҃R[h
001130                             ALTERNATE RECORD KEY     IS  |҃R[h
001140                                                          |{paN
001150                             ALTERNATE RECORD KEY     IS  |{paN
001160                                                          |ی
001170                                                          |یҔԍ
001180                                                          |҃R[h
001190                             ALTERNATE RECORD KEY     IS  |{paN
001200                                                          |
001210                                                          |pSҔԍ
001220                                                          |҃R[h
001230                             ALTERNATE RECORD KEY     IS  |{paN
001240                                                          |
001250                                                          |pSҔԍ
001260                                                          |҃R[h
001270                             ALTERNATE RECORD KEY     IS  |aN
001280                                                          |{paN
001290                                                          |҃R[h
001300                             FILE STATUS              IS  ԃL[
001310                             LOCK        MODE         IS  AUTOMATIC.
000180     SELECT  fҏQe  ASSIGN      TO        JUSINJ2L
000190                             ORGANIZATION             IS INDEXED
000200                             ACCESS MODE              IS DYNAMIC
000210                             RECORD KEY               IS Q|{paN
000220                                                         Q|҃R[h
000230                             ALTERNATE RECORD KEY     IS Q|Ώۋ敪
000240                                                         Q|aN
000250                                                         Q|{paN
000260                                                         Q|҃R[h
000270                             ALTERNATE RECORD KEY     IS Q|Ώۋ敪
000280                                                         Q|aN
000290                                                         Q|{paN
000300                                                         Q|҃R[h
000310                             FILE STATUS              IS  ԃL[
000320                             LOCK        MODE         IS  AUTOMATIC.
001320     SELECT  {pL^e      ASSIGN      TO        SEKIROKL
001330                             ORGANIZATION             IS  INDEXED
001340                             ACCESS MODE              IS  DYNAMIC
001350                             RECORD KEY               IS  {L|{paN
001360                                                          {L|҃R[h
001370                             ALTERNATE RECORD KEY     IS  {L|҃R[h
001380                                                          {L|{paN
001390                             FILE STATUS              IS  ԃL[
001400                             LOCK        MODE         IS  AUTOMATIC.
001410     SELECT  f[^e    ASSIGN      TO        HUSYOUL
001420                             ORGANIZATION             IS  INDEXED
001430                             ACCESS MODE              IS  DYNAMIC
001440                             RECORD KEY               IS  |{paN
001450                                                          |҃R[h
001460                             ALTERNATE RECORD KEY     IS  |҃R[h
001470                                                          |{paN
001480                             FILE STATUS              IS  ԃL[
001490                             LOCK        MODE         IS  AUTOMATIC.
001500     SELECT  e      ASSIGN      TO        HUGEINL
001510                             ORGANIZATION             IS  INDEXED
001520                             ACCESS MODE              IS  DYNAMIC
001530                             RECORD KEY               IS  |敪R[h
001540                                                          |R[h
001550                             FILE STATUS              IS  ԃL[
001560                             LOCK        MODE         IS  AUTOMATIC.
001570     SELECT  t@C    ASSIGN      TO        MEMOL
001580                             ORGANIZATION             IS  INDEXED
001590                             ACCESS MODE              IS  DYNAMIC
001600                             RECORD KEY               IS  |敪
001610                                                          |҃R[h
001620                                                          |{paN
001630                             ALTERNATE RECORD KEY     IS  |敪
001640                                                          |{paN
001650                                                          |҃R[h
001660                             ALTERNATE RECORD KEY     IS  |҃R[h
001670                                                          |{paN
001680                                                          |敪
001690                             FILE STATUS              IS  ԃL[
001700                             LOCK        MODE         IS  AUTOMATIC.
000530     SELECT  }X^      ASSIGN      TO        RYOUKINL
000540                             ORGANIZATION             IS  INDEXED
000550                             ACCESS MODE              IS  DYNAMIC
000560                             RECORD KEY               IS  |敪R[h
000570                                                          |ʃR[h
000580                                                          |JnaN.
001340     SELECT  }X^    ASSIGN      TO        KAIJOHOL
001350                             ORGANIZATION             IS  INDEXED
001360                             ACCESS MODE              IS  DYNAMIC
001370                             RECORD KEY               IS  |_I敪
                                                                |R[h
001380                                                          |ی
001390                                                          |ύXaN
001400                             ALTERNATE RECORD KEY     IS  |_I敪
                                                                |ڍtJi
001410                                                          |R[h
001420                                                          |ی
001430                                                          |ύXaN
001440                             FILE STATUS              IS  ԃL[
001450                             LOCK        MODE         IS  AUTOMATIC.
001710     SELECT  t@C    ASSIGN      TO     GS-PRTF002
001720                             SYMBOLIC    DESTINATION  IS "PRT"
001730                             FORMAT                   IS  `̖o
001740                             GROUP                    IS  ڌQo
001750                             PROCESSING  MODE         IS  ʂo
001760                             UNIT        CONTROL      IS  go
001770                             FILE        STATUS       IS  ʒmo.
001780******************************************************************
001790*                      DATA DIVISION                             *
001800******************************************************************
001810 DATA                    DIVISION.
001820 FILE                    SECTION.
001830*                           mqk  RQOn
001840 FD  ی҃}X^        BLOCK   CONTAINS   1   RECORDS.
001850     COPY HOKENS          OF  XFDLIB  JOINING      AS  PREFIX.
001860*                           mqk  PQWn
001870 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001880     COPY GENGOU          OF  XFDLIB  JOINING      AS  PREFIX.
001890*                           mqk  PQWn
001900 FD  ̃}X^          BLOCK   CONTAINS   1   RECORDS.
001910     COPY MEISYO          OF  XFDLIB  JOINING      AS  PREFIX.
      *                          mqk  PTRUn
       FD  Zvge          BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   Z  AS  PREFIX.
001950*                           mqk  QTUn
001960 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001970     COPY SEIGYO          OF  XFDLIB  JOINING      AS  PREFIX.
001980*                           mqk  PQWn
001990 FD  {p}X^          BLOCK   CONTAINS   1   RECORDS.
002000     COPY SEJOHO         OF  XFDLIB  JOINING   {   AS  PREFIX.
002010*                           mqk  PQWn
002020 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002030     COPY SEIKYUS         OF  XFDLIB  JOINING      AS  PREFIX.
002040*                           mqk  PQWn
002050 FD  o߃}X^          BLOCK   CONTAINS   1   RECORDS.
002060     COPY KEIKA          OF  XFDLIB  JOINING   o   AS  PREFIX.
002070*                           mqk  PQWn
002080 FD  hcǗ}X^          BLOCK   CONTAINS   1   RECORDS.
002090     COPY IDKANR          OF  XFDLIB  JOINING   hc   AS  PREFIX.
002100*                           mqk  QTUn
002110 FD  s}X^          BLOCK   CONTAINS   1   RECORDS.
002120     COPY SITYOSN        OF  XFDLIB  JOINING   s   AS  PREFIX.
002130*                           mqk  RQOn
002140 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
002150     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
002560*                          mqk  1024n
000340 FD  fҏQe        BLOCK   CONTAINS   1   RECORDS.
000350     COPY JUSINJ2          OF  XFDLIB  JOINING   Q   AS  PREFIX.
002160*                           mqk  QTUn
002170 FD  {pL^e          BLOCK   CONTAINS   1   RECORDS.
002180     COPY SEKIROK         OF  XFDLIB  JOINING   {L AS  PREFIX.
002190*                           mqk  PQWn
002200 FD  f[^e        BLOCK   CONTAINS   1   RECORDS.
002210     COPY HUSYOU          OF  XFDLIB  JOINING      AS  PREFIX.
002220*                           mqk  PQWn
002230 FD  e         BLOCK   CONTAINS   1   RECORDS.
002240     COPY HUGEIN          OF  XFDLIB  JOINING      AS  PREFIX.
002250*                           mqk  WRQn
002260 FD  t@C        BLOCK CONTAINS 1     RECORDS.
002270     COPY MEMO           OF    XFDLIB JOINING  AS PREFIX.
002020*
002030 FD  }X^         BLOCK   CONTAINS   1   RECORDS.
002040     COPY RYOUKIN         OF  XFDLIB  JOINING      AS  PREFIX.
002050     COPY RYOUKNA         OF  XFDLIB  JOINING   ` AS  PREFIX.
002060     COPY RYOUKNB         OF  XFDLIB  JOINING   a AS  PREFIX.
002070     COPY RYOUKNC         OF  XFDLIB  JOINING   b AS  PREFIX.
002080     COPY RYOUKND         OF  XFDLIB  JOINING   c AS  PREFIX.
002090     COPY RYOUKNE         OF  XFDLIB  JOINING   d AS  PREFIX.
002100     COPY RYOUKNF         OF  XFDLIB  JOINING   e AS  PREFIX.
002420*                           mqk  USOn
002430 FD  }X^        BLOCK   CONTAINS   1   RECORDS.
002440     COPY KAIJOHO         OF  XFDLIB  JOINING      AS  PREFIX.
002280*
002290 FD  t@C.
002300     COPY YGN612P        OF  XMDLIB.
002310*----------------------------------------------------------------*
002320******************************************************************
002330*                WORKING-STORAGE SECTION                         *
002340******************************************************************
002350 WORKING-STORAGE         SECTION.
002360 01 L[                           PIC X     VALUE SPACE.
002370 01 ԃL[                           PIC X(2)  VALUE SPACE.
002380 01 ItO                         PIC X(3)  VALUE SPACE.
002390 01 ItOQ                       PIC X(3)  VALUE SPACE.
002400 01 EotO                         PIC X(3)  VALUE SPACE.
002410 01 tO                         PIC X(3)  VALUE SPACE.
002420 01 ptO                         PIC X(3)  VALUE SPACE.
002430 01 t@C                         PIC N(6)  VALUE SPACE.
002440 01 Zvgofv                     PIC X(8)  VALUE SPACE.
002450 01 󔒂v                             PIC X(2)  VALUE SPACE.
002460 01 Oav                           PIC 9     VALUE ZERO.
002470 01 Jgv                     PIC 9(1)  VALUE ZERO.
001363 01 Sp                           PIC X(2)  VALUE X"8140".
001364 01 p                           PIC X(2)  VALUE X"2020".
002480*
002490 01 JE^                           PIC 9(2)  VALUE ZERO.
002500 01 JE^Q                         PIC 9(2)  VALUE ZERO.
002510 01 ʂbms                         PIC 9     VALUE ZERO.
002520 01 Ҕԍv                         PIC 9(6)  VALUE ZERO.
002530 01 ̂v                         PIC N(6)  VALUE SPACE.
002540 01 ʖ̂v                         PIC N(12) VALUE SPACE.
002550 01 ʒv                           PIC 9(2)  VALUE 1.
002590**
002600** ϔCp
002610 01 ϔCtO                     PIC X(3)  VALUE SPACE.
002620 01 ϔC敪v                         PIC 9     VALUE ZERO.
002630*
002640** ER敪p
002650 01 敪v                 PIC 9 VALUE ZERO.
002660 01 R敪v                 PIC 9 VALUE ZERO.
002670*
002680** }Ԕp
002690 01 JnfÓ蓮敪v               PIC 9    VALUE ZERO.
002700*
002710** Zi̓t敪p (0:ŏIʉ@A1:A9:󎚂Ȃ)
002720 01 Zvgt敪v                 PIC 9 VALUE ZERO.
002730 01 Zvgғt敪v             PIC 9 VALUE ZERO.
002740*
002750** Ôݗp
002760 01 ČtO                     PIC X(3)  VALUE SPACE.
002770 01 OtO                         PIC X(3)  VALUE SPACE.
002780*
002790** Sp
002800 01 Sv                         PIC 9(2)  VALUE ZERO.
002810 01 tv                         PIC 9(2)  VALUE ZERO.
002820 01 Sv                           PIC 9(3)  VALUE ZERO.
002830 01 Œv                         PIC N     VALUE SPACE.
002840*
002850** ŏJnNp
002860 01 ŏJnaNv.
002870    03 ŏJnav                  PIC 9(1)  VALUE ZERO.
002880    03 ŏJnNv                    PIC 9(2)  VALUE ZERO.
002890    03 ŏJnv                    PIC 9(2)  VALUE ZERO.
002900*
002910* ޔp
002920 01 INvs.
002930    03 INvs                      PIC 9(2)  VALUE ZERO.
002940    03 Ivs                      PIC 9(2)  VALUE ZERO.
002950    03 Ivs                      PIC 9(2)  VALUE ZERO.
002960* ޔp
002970 01 Nvs.
002980    03 avs                    PIC 9     VALUE ZERO.
002990    03 Nvs                      PIC 9(2)  VALUE ZERO.
003000    03 vs                      PIC 9(2)  VALUE ZERO.
003010    03 vs                      PIC 9(2)  VALUE ZERO.
003020*
003030* p
003040 01 vs.
003050    03 Pvs                  PIC X(60) VALUE SPACE.
003060    03 Qvs                  PIC X(60) VALUE SPACE.
003070    03 Rvs                  PIC X(60) VALUE SPACE.
003080    03 Svs                  PIC X(60) VALUE SPACE.
003090    03 Tvs                  PIC X(60) VALUE SPACE.
003100    03 io[vs.
003110       05 io[vP         PIC X(2)  OCCURS 9 VALUE SPACE.
003120    03 io[mv  REDEFINES io[vs PIC X(18).
003130 01 Ҕԍbv                   PIC 9(6)  VALUE ZERO.
003140 01 AԂbv                       PIC 9(4)  VALUE ZERO.
003150 01 sak.
003160    03 R[hsak            OCCURS 9.
003170       05 Ҕԍv               PIC 9(6)  VALUE ZERO.
003180       05 AԂv                   PIC 9(4)  VALUE ZERO.
003190       05 ʂv               PIC 9  OCCURS 9 VALUE ZERO.
003200 01 ev.
003210    03 ev              PIC X(318) OCCURS 9 VALUE SPACE.
003670    03 ewv.
003680       05 ePwv           PIC X(80)  VALUE SPACE.
003690       05 eQwv           PIC X(80)  VALUE SPACE.
003690       05 eRwv           PIC X(80)  VALUE SPACE.
003700       05 eSwv           PIC X(78)  VALUE SPACE.
003260*
003270* Zp
003280 01 Zvs.
003290    03 ZJEg                PIC 9    VALUE ZERO.
003300    03 ԍJE^                    PIC 9    VALUE ZERO.
003310    03 ZWcvs  OCCURS 3.
003320       05 Z敪vs             PIC 9    VALUE ZERO.
003330       05 Zvs               PIC 9(2) VALUE ZERO.
003340       05 Zvs               PIC 9(2) VALUE ZERO.
003350    03 ZWcmv  OCCURS 3.
003360       05 Z؂v                   PIC N(1) VALUE SPACE.
003370       05 Zev                   PIC N(3) VALUE SPACE.
003380       05 ZmvP             PIC N(1) VALUE SPACE.
003390       05 ZmvQ             PIC N(1) VALUE SPACE.
003400       05 Œv                     PIC N(1) VALUE SPACE.
003410       05 ZmvP             PIC N(1) VALUE SPACE.
003420       05 ZmvQ             PIC N(1) VALUE SPACE.
003430       05 Œv                     PIC N(1) VALUE SPACE.
003440    03 ZPv                PIC N(10) VALUE SPACE.
003450    03 ZQv                PIC N(10) VALUE SPACE.
003460    03 ZRv                PIC N(10) VALUE SPACE.
003070    03 Z؂v                  PIC X     VALUE SPACE.
003080    03 Zv                    PIC 9(2)  VALUE ZERO.
003090    03 Zv                    PIC 9(2)  VALUE ZERO.
003470*
003480 01 ԍv                         PIC 9.
003490 01 ԍq REDEFINES ԍv.
003500    03 ԍvP                    PIC X.
003510*
003520 01 Spԍv                     PIC N.
003530 01 Spԍq REDEFINES Spԍv.
003540    03 SpԍvP                PIC X(2).
003550*
003560** {ϊ
003570 01 v                             PIC 9(2).
003580 01 q REDEFINES v.
003590    03 vP                        PIC X(1).
003600    03 vQ                        PIC X(1).
003610*
003620 01 vZNv.
003630    03 vZav                      PIC 9(1)  VALUE ZERO.
003640    03 vZNv                        PIC S9(2)  VALUE ZERO.
003650    03 vZv                        PIC S9(2)  VALUE ZERO.
003660    03 vZv                        PIC S9(2)  VALUE ZERO.
003670 01 JnNQv.
003680    03 JnaQv                    PIC 9(1)  VALUE ZERO.
003690    03 JnNQv                      PIC 9(2)  VALUE ZERO.
003700    03 JnQv                      PIC 9(2)  VALUE ZERO.
003710    03 JnQv                      PIC 9(2)  VALUE ZERO.
003720    03 JnNv                    PIC S9(4) VALUE ZERO.
003730 01 INQv.
003740    03 IaQv                    PIC 9(1)  VALUE ZERO.
003750    03 INQv                      PIC 9(2)  VALUE ZERO.
003760    03 IQv                      PIC 9(2)  VALUE ZERO.
003770    03 IQv                      PIC 9(2)  VALUE ZERO.
003780    03 INv                    PIC S9(4) VALUE ZERO.
003790*
003800** p
003810 01 {pNv                       PIC 9(4)  VALUE ZERO.
003820 01 v                               PIC 9(3)  VALUE ZERO.
003830 01 ]v                               PIC 9(3)  VALUE ZERO.
003840*
003850** Z܂Ƃߗp
003860 01 Z܂Ƃ߃tO               PIC X(3)  VALUE SPACE.
003870 01 ʗ̂v                     PIC N(4)  VALUE SPACE.
003880*
003890** ZEvp( N(38)Œj
003900 01 ̌o߂v.
003910    03 ̌oߍsv                  PIC X(76) OCCURS 2 VALUE SPACE.
003920 01 ̌o߂mv REDEFINES ̌o߂v.
003930    03 ̌oߍsmv                PIC N(38) OCCURS 2.
003940*
003950** 敪
003960 01 Z敪v             PIC 9    VALUE ZERO.
002580 01 ZR敪v             PIC 9    VALUE ZERO.
003970*
004770******************************
004780* T  Ev  ҏWp *
004790******************************
004800 01 ʂTv.
004840   03 JnTv.
004850      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
004870      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
         03 ʂPv                         PIC X(1).
004890   03 ÂTv.
            05 ʂQv                      PIC X(1).
004900      05 ÒPTv                  PIC ZZZZ.
            05 ZLPv                  PIC X(1).
004920      05 É񐔂Tv                  PIC ZZ.
            05 CR[Pv                  PIC X(1).
004940      05 ×Tv                    PIC ZZ,ZZZ.
         03 ʂRv                         PIC X(1).
         03 ZLPv                     PIC X(1).
         03 ʂSv                         PIC X(1).
004960   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLQv                  PIC X(1).
004970      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Qv                  PIC X(1).
004990      05 㪖@Tv                  PIC ZZZZ.
         03 ʂTv                         PIC X(1).
         03 ZLQv                     PIC X(1).
         03 ʂUv                         PIC X(1).
005010   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLRv                  PIC X(1).
005020      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Rv                  PIC X(1).
005040      05 㪖@Tv                  PIC ZZZZ.
         03 ʂVv                         PIC X(1).
         03 ZLRv                     PIC X(1).
         03 ʂWv                         PIC X(1).
005060   03 dÂTv.
            05 dÒPTv                  PIC Z(2).
            05 ZLSv                  PIC X(1).
005070      05 dÉ񐔂Tv                  PIC ZZ.
            05 CR[Sv                  PIC X(1).
005090      05 d×Tv                    PIC ZZZZ.
            05 ʂXv                      PIC X(1).
         03 ʂPOv                       PIC X(1).
         03 ZLTv                     PIC X(1).
005130   03 ʗTv                     PIC X(3).
         03 ZLUv                     PIC X(1).
005170   03 Tv                   PIC 9.9.
         03 CR[Tv                     PIC X(1).
005190   03 vTv                   PIC ZZ,ZZZ.
      *
003980****************
003990* AڑҔ *
004000****************
004010*    ************
004020*    * L[ *
004030*    ************
004040 01 Zvgރf[^vq.
004050    03 Zvgނvq                PIC X(4)  VALUE SPACE.
004060*
004070 01 Ώۃf[^vq.
004080    03 {paNvq.
004090       05 {pavq                  PIC 9(1)  VALUE ZERO.
004100       05 {pNvq                    PIC 9(2)  VALUE ZERO.
004110       05 {pvq                    PIC 9(2)  VALUE ZERO.
004120    03 یʂvq                     PIC 9(2)  VALUE ZERO.
004130    03 یҔԍvq                   PIC X(10) VALUE SPACE.
004140    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004150    03 pSҔԍvq               PIC X(10) VALUE SPACE.
004160    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004170    03 pSҔԍvq           PIC X(10) VALUE SPACE.
004180    03 {lƑ敪vq                 PIC 9(1)  VALUE ZERO.
004190    03 ҃Jivq                     PIC X(50) VALUE SPACE.
004200    03 ҃R[hvq.
004210       05 Ҕԍvq                  PIC 9(6)  VALUE ZERO.
004220       05 }Ԃvq                      PIC X(1)  VALUE SPACE.
004230*
004240*    ************
004250*    *  *
004260*    ************
004270*    ̗
004280***********************
004290 01 Pvq.
004300   03 vq.
004310      05 Svq               PIC 9(3)    VALUE ZERO.
004320      05 vq                 PIC 9(5)    VALUE ZERO.
004330      05 Zvq             PIC 9(5)    VALUE ZERO.
         03 kvq                    PIC 9(4)    VALUE ZERO.
004340   03 Čvq                    PIC 9(5)    VALUE ZERO.
004350   03 Âvq.
004360      05 Ëvq               PIC 9(2)V9  VALUE ZERO.
004370      05 É񐔂vq               PIC 9(2)    VALUE ZERO.
004380      05 ×vq                 PIC 9(5)    VALUE ZERO.
004390      05 ÉZvq             PIC 9(5)    VALUE ZERO.
004400   03 qZvq            PIC 9(5)    VALUE ZERO.
004410   03 {p񋟗vq            PIC 9(5)    VALUE ZERO.
004420   03 vvq                      PIC 9(6)    VALUE ZERO.
004430   03 ꕔSvq                PIC 9(6)    VALUE ZERO.
004440   03 zvq                  PIC 9(6)    VALUE ZERO.
004450   03 tvq                  PIC 9(1)    VALUE ZERO.
004460   03 󋋎ҕSzvq              PIC 9(6)    VALUE ZERO.
004470   03 zvq              PIC 9(6)    VALUE ZERO.
004480*
004490* ʖ̗
004500***********************
004510 01 Qvq.
004520   03 񏈒uvq    OCCURS   9.
004530      05 񏈒uvq             PIC 9(5)    VALUE ZERO.
004540*
004550* ̗
004560***********************
004570 01 Rvq.
004580**********
004590* P *
004600**********
004610   03 ʂPvq.
004620      05 ÂPvq.
004630         07 ÒPPvq              PIC 9(4)    VALUE ZERO.
004640         07 É񐔂Pvq              PIC 9(2)    VALUE ZERO.
004650         07 ×Pvq                PIC 9(5)    VALUE ZERO.
004660      05 㪖@Pvq.
004670         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004680         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
004690      05 㪖@Pvq.
004700         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004710         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
004720      05 dÂPvq.
004730         07 dÉ񐔂Pvq              PIC 9(2)    VALUE ZERO.
004740         07 d×Pvq                PIC 9(4)    VALUE ZERO.
004750      05 vPvq                     PIC 9(6)    VALUE ZERO.
004760      05 Pvq               PIC 9(3)    VALUE ZERO.
004770      05 vPvq               PIC 9(6)    VALUE ZERO.
004780**********
004790* Q *
004800**********
004810   03 ʂQvq.
004820      05 ÂQvq.
004830         07 ÒPQvq              PIC 9(4)    VALUE ZERO.
004840         07 É񐔂Qvq              PIC 9(2)    VALUE ZERO.
004850         07 ×Qvq                PIC 9(5)    VALUE ZERO.
004860      05 㪖@Qvq.
004870         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
004880         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
004890      05 㪖@Qvq.
004900         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
004910         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
004920      05 dÂQvq.
004930         07 dÉ񐔂Qvq              PIC 9(2)    VALUE ZERO.
004940         07 d×Qvq                PIC 9(4)    VALUE ZERO.
004950      05 vQvq                     PIC 9(6)    VALUE ZERO.
004960      05 Qvq               PIC 9(3)    VALUE ZERO.
004970      05 vQvq               PIC 9(6)    VALUE ZERO.
004980******************
004990* Rʁ^W *
005000******************
005010   03 ʂRWvq.
005020      05 ÂRWvq.
005030         07 ÒPRWvq              PIC 9(4)  VALUE ZERO.
005040         07 É񐔂RWvq              PIC 9(2)  VALUE ZERO.
005050         07 ×RWvq                PIC 9(5)  VALUE ZERO.
005060      05 㪖@RWvq.
005070         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005080         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005090      05 㪖@RWvq.
005100         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005110         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005120      05 dÂRWvq.
005130         07 dÉ񐔂RWvq              PIC 9(2)  VALUE ZERO.
005140         07 d×RWvq                PIC 9(4)  VALUE ZERO.
005150      05 vRWvq                     PIC 9(6)  VALUE ZERO.
005160      05 ʍvRWvq             PIC 9(6)  VALUE ZERO.
005170      05 RWvq               PIC 9(3)  VALUE ZERO.
005180      05 vRWvq               PIC 9(6)  VALUE ZERO.
005190******************
005200* Rʁ^PO *
005210******************
005220   03 ʂROvq.
005230      05 JnROvq.
005240         07 JnROvq            PIC 9(2)  VALUE ZERO.
005250         07 JnROvq            PIC 9(2)  VALUE ZERO.
005260      05 ÂROvq.
005270         07 ÒPROvq              PIC 9(4)  VALUE ZERO.
005280         07 É񐔂ROvq              PIC 9(2)  VALUE ZERO.
005290         07 ×ROvq                PIC 9(5)  VALUE ZERO.
005300      05 㪖@ROvq.
005310         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
005320         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005330      05 㪖@ROvq.
005340         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
005350         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005360      05 dÂROvq.
005370         07 dÉ񐔂ROvq              PIC 9(2)  VALUE ZERO.
005380         07 d×ROvq                PIC 9(4)  VALUE ZERO.
005390      05 vROvq                     PIC 9(6)  VALUE ZERO.
005400      05 ROvq               PIC 9(3)  VALUE ZERO.
005410      05 vROvq               PIC 9(6)  VALUE ZERO.
005420****************
005430* Sʁ^T *
005440****************
005450   03 ʂSTvq.
005460      05 ÂSTvq.
005470         07 ÒPSTvq              PIC 9(4)  VALUE ZERO.
005480         07 É񐔂STvq              PIC 9(2)  VALUE ZERO.
005490         07 ×STvq                PIC 9(5)  VALUE ZERO.
005500      05 㪖@STvq.
005510         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005520         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005530      05 㪖@STvq.
005540         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005550         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005560      05 dÂSTvq.
005570         07 dÉ񐔂STvq              PIC 9(2)  VALUE ZERO.
005580         07 d×STvq                PIC 9(4)  VALUE ZERO.
005590      05 vSTvq                     PIC 9(6)  VALUE ZERO.
005600      05 ʍvSTvq             PIC 9(6)  VALUE ZERO.
005610      05 STvq               PIC 9(3)  VALUE ZERO.
005620      05 vSTvq               PIC 9(6)  VALUE ZERO.
005630****************
005640* Sʁ^W *
005650****************
005660   03 ʂSWvq.
005670      05 JnSWvq.
005680         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005690         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005700      05 ÂSWvq.
005710         07 ÒPSWvq              PIC 9(4)  VALUE ZERO.
005720         07 É񐔂SWvq              PIC 9(2)  VALUE ZERO.
005730         07 ×SWvq                PIC 9(5)  VALUE ZERO.
005740      05 㪖@SWvq.
005750         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
005760         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
005770      05 㪖@SWvq.
005780         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
005790         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
005800      05 dÂSWvq.
005810         07 dÉ񐔂SWvq              PIC 9(2)  VALUE ZERO.
005820         07 d×SWvq                PIC 9(4)  VALUE ZERO.
005830      05 vSWvq                     PIC 9(6)  VALUE ZERO.
005840      05 ʍvSWvq             PIC 9(6)  VALUE ZERO.
005850      05 SWvq               PIC 9(3)  VALUE ZERO.
005860      05 vSWvq               PIC 9(6)  VALUE ZERO.
005870******************
005880* Sʁ^PO *
005890******************
005900   03 ʂSOvq.
005910      05 JnSOvq.
005920         07 JnSOvq            PIC 9(2)  VALUE ZERO.
005930         07 JnSOvq            PIC 9(2)  VALUE ZERO.
005940      05 ÂSOvq.
005950         07 ÒPSOvq              PIC 9(4)  VALUE ZERO.
005960         07 É񐔂SOvq              PIC 9(2)  VALUE ZERO.
005970         07 ×SOvq                PIC 9(5)  VALUE ZERO.
005980      05 㪖@SOvq.
005990         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006000         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006010      05 㪖@SOvq.
006020         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006030         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006040      05 dÂSOvq.
006050         07 dÉ񐔂SOvq              PIC 9(2)  VALUE ZERO.
006060         07 d×SOvq                PIC 9(4)  VALUE ZERO.
006070      05 vSOvq                     PIC 9(6)  VALUE ZERO.
006080      05 SOvq               PIC 9(3)  VALUE ZERO.
006090      05 vSOvq               PIC 9(6)  VALUE ZERO.
006100********************
006110* Tʁ^QDT *
006120********************
006130   03 ʂTQvq.
006140      05 ÂTQvq.
006150         07 ÒPTQvq              PIC 9(4)  VALUE ZERO.
006160         07 É񐔂TQvq              PIC 9(2)  VALUE ZERO.
006170         07 ×TQvq                PIC 9(5)  VALUE ZERO.
006180      05 㪖@TQvq.
006190         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006200         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006210      05 㪖@TQvq.
006220         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006230         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006240      05 dÂTQvq.
006250         07 dÉ񐔂TQvq              PIC 9(2)  VALUE ZERO.
006260         07 d×TQvq                PIC 9(4)  VALUE ZERO.
006270      05 vTQvq                     PIC 9(6)  VALUE ZERO.
006280      05 ʍvTQvq             PIC 9(6)  VALUE ZERO.
006290      05 TQvq               PIC 9(3)  VALUE ZERO.
006300      05 vTQvq               PIC 9(6)  VALUE ZERO.
006310****************
006320* Tʁ^T *
006330****************
006340   03 ʂTTvq.
006350      05 JnTTvq.
006360         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006370         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006380      05 ÂTTvq.
006390         07 ÒPTTvq              PIC 9(4)  VALUE ZERO.
006400         07 É񐔂TTvq              PIC 9(2)  VALUE ZERO.
006410         07 ×TTvq                PIC 9(5)  VALUE ZERO.
006420      05 㪖@TTvq.
006430         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006440         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006450      05 㪖@TTvq.
006460         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006470         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006480      05 dÂTTvq.
006490         07 dÉ񐔂TTvq              PIC 9(2)  VALUE ZERO.
006500         07 d×TTvq                PIC 9(4)  VALUE ZERO.
006510      05 vTTvq                     PIC 9(6)  VALUE ZERO.
006520      05 ʍvTTvq             PIC 9(6)  VALUE ZERO.
006530      05 TTvq               PIC 9(3)  VALUE ZERO.
006540      05 vTTvq               PIC 9(6)  VALUE ZERO.
006550****************
006560* Tʁ^W *
006570****************
006580   03 ʂTWvq.
006590      05 JnTWvq.
006600         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006610         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006620      05 ÂTWvq.
006630         07 ÒPTWvq              PIC 9(4)  VALUE ZERO.
006640         07 É񐔂TWvq              PIC 9(2)  VALUE ZERO.
006650         07 ×TWvq                PIC 9(5)  VALUE ZERO.
006660      05 㪖@TWvq.
006670         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006680         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
006690      05 㪖@TWvq.
006700         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006710         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
006720      05 dÂTWvq.
006730         07 dÉ񐔂TWvq              PIC 9(2)  VALUE ZERO.
006740         07 d×TWvq                PIC 9(4)  VALUE ZERO.
006750      05 vTWvq                     PIC 9(6)  VALUE ZERO.
006760      05 ʍvTWvq             PIC 9(6)  VALUE ZERO.
006770      05 TWvq               PIC 9(3)  VALUE ZERO.
006780      05 vTWvq               PIC 9(6)  VALUE ZERO.
006790******************
006800* Tʁ^PO *
006810******************
006820   03 ʂTOvq.
006830      05 JnTOvq.
006840         07 JnTOvq            PIC 9(2)  VALUE ZERO.
006850         07 JnTOvq            PIC 9(2)  VALUE ZERO.
006860      05 ÂTOvq.
006870         07 ÒPTOvq              PIC 9(4)  VALUE ZERO.
006880         07 É񐔂TOvq              PIC 9(2)  VALUE ZERO.
006890         07 ×TOvq                PIC 9(5)  VALUE ZERO.
006900      05 㪖@TOvq.
006910         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
006920         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
006930      05 㪖@TOvq.
006940         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
006950         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
006960      05 dÂTOvq.
006970         07 dÉ񐔂TOvq              PIC 9(2)  VALUE ZERO.
006980         07 d×TOvq                PIC 9(4)  VALUE ZERO.
006990      05 vTOvq                     PIC 9(6)  VALUE ZERO.
007000      05 TOvq               PIC 9(3)  VALUE ZERO.
007010      05 vTOvq               PIC 9(6)  VALUE ZERO.
007020*
007030**************
007040* {p *
007050**************
007060 01 {pv.
007070    03 _tԍv                    PIC X(22)  VALUE SPACE.
007080    03 ڍtԍv              PIC X(16)  VALUE SPACE.
007090    03 \҃Jiv                    PIC X(50)  VALUE SPACE.
007100    03 \Җv                      PIC X(50)  VALUE SPACE.
007120    03 ڍ@v                      PIC X(50)  VALUE SPACE.
          03 s{ihrv                PIC X(2)   VALUE SPACE.
007130    03 {pZv.
007140       05 {pZPv               PIC X(50)  VALUE SPACE.
007150       05 {pZQv               PIC X(50)  VALUE SPACE.
007160    03 {pX֔ԍv.
007170       05 {pX֔ԍPv           PIC X(3)   VALUE SPACE.
007180       05 {pX֔ԍQv           PIC X(4)   VALUE SPACE.
007190    03 {pdbԍv                PIC X(15)  VALUE SPACE.
007200    03 z󗝔ԍv                PIC X(15)  VALUE SPACE.
007210    03 󗝔Nv.
007220       05 󗝔Nv                     PIC 9(2)   VALUE ZERO.
007230       05 󗝌v                     PIC 9(2)   VALUE ZERO.
007240       05 󗝓v                     PIC 9(2)   VALUE ZERO.
007250    03 ŏIʉ@Nv.
007260       05 ŏIʉ@Nv                 PIC 9(2)   VALUE ZERO.
007270       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
007280       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
007290    03 _tNv.
007300       05 _tNv                   PIC 9(2)   VALUE ZERO.
007310       05 _tv                   PIC 9(2)   VALUE ZERO.
007320       05 _tv                   PIC 9(2)   VALUE ZERO.
007330    03 ҈ϔCNv.
007340       05 ҈ϔCNv                 PIC 9(2)   VALUE ZERO.
007350       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007360       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007370    03 {phcv                    PIC X(12)  VALUE SPACE.
007380    03 s{phcv                PIC X(12)  VALUE SPACE.
007390    03 ڍtv                PIC X(50)  VALUE SPACE.
007400    03 v.
007410       05 sv.
007420          07 sPv          PIC X(18)  VALUE SPACE.
007430          07 sQv          PIC X(18)  VALUE SPACE.
007440          07 sRv          PIC X(4)   VALUE SPACE.
007450       05 sxXv.
007460          07 sxXPv      PIC X(12)  VALUE SPACE.
007470          07 sxXQv      PIC X(12)  VALUE SPACE.
007480          07 sxXRv      PIC X(16)  VALUE SPACE.
007490       05 aʂv                   PIC 9(1)   VALUE ZERO.
007500       05 aʃRgv           PIC N(2)   VALUE SPACE.
007510*       05 aʃ`FbNv.
007520*          07 `FbNv            PIC N(1)  VALUE SPACE.
007530*          07 ʃ`FbNv            PIC N(1)  VALUE SPACE.
007540       05 ԍv                   PIC X(10)  VALUE SPACE.
007550       05 `lv                 PIC X(80)  VALUE SPACE.
007560       05 `lJiv             PIC X(80)  VALUE SPACE.
007570       05 sxXv               PIC X(60)  VALUE SPACE.
          03 x@.
             05 Z@֖v.
                07 Z@֖Pv            PIC X(8)  VALUE SPACE.
                07 Z@֖Qv            PIC X(8)  VALUE SPACE.
                07 Z@֖Rv            PIC X(8)  VALUE SPACE.
                07 Z@֖Sv            PIC X(8)  VALUE SPACE.
                07 Z@֖Tv            PIC X(8)  VALUE SPACE.
             05 xXv.
                07 xXPv                PIC X(12) VALUE SPACE.
                07 xXQv                PIC X(12) VALUE SPACE.
                07 xXRv                PIC X(12) VALUE SPACE.
                07 xXSv                PIC X(12) VALUE SPACE.
             05 U`FbNv               PIC N(1)  VALUE SPACE.
             05 ʃ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
             05 s`FbNv               PIC N(1)  VALUE SPACE.
             05 Ƀ`FbNv               PIC N(1)  VALUE SPACE.
             05 _`FbNv               PIC N(1)  VALUE SPACE.
             05 {X`FbNv               PIC N(1)  VALUE SPACE.
             05 xX`FbNv               PIC N(1)  VALUE SPACE.
             05 {x`FbNv             PIC N(1)  VALUE SPACE.
007580**************
007590* fҏ *
007600**************
007610 01 fҏv.
007620    03 {pNv.
007630       05 {pNv                     PIC 9(2)   VALUE ZERO.
007640       05 {pv                     PIC 9(2)   VALUE ZERO.
007650*    03 Lv                          PIC N(12)  VALUE SPACE.
007570    03 Lv.
007580       05 Lv                   PIC N(12)  VALUE SPACE.
007660*
          03 Lԍv.
             05 Lԍwv                 PIC X(40) VALUE SPACE.
007670    03 ԍv.
007680       05 ԍv                   PIC X(15)  VALUE SPACE.
007690       05 FILLER                       PIC X(15)  VALUE SPACE.
007700*    03 ԍv.
007710*       05 ԍPv                 PIC X(10)  VALUE SPACE.
007720*       05 ԍQv                 PIC X(10)  VALUE SPACE.
007730*       05 FILLER                       PIC X(10)  VALUE SPACE.
007740*
007750    03 یҔԍv.
007760       05 یҔԍv             PIC X(8)   VALUE SPACE.
007770       05 FILLER                       PIC X(2)   VALUE SPACE.
007780*
007790    03 sԍv.
007800       05 sԍv             PIC X(8)   VALUE SPACE.
007810       05 FILLER                       PIC X(2)   VALUE SPACE.
007820    03 󋋎Ҕԍv.
007830       05 󋋎Ҕԍv             PIC X(7)   VALUE SPACE.
007840       05 FILLER                       PIC X(13)  VALUE SPACE.
007850*
007860    03 sԍv.
007870       05 sԍv         PIC X(8)   VALUE SPACE.
007880       05 FILLER                       PIC X(2)   VALUE SPACE.
007890    03 󋋎Ҕԍv.
007900       05 󋋎Ҕԍv         PIC X(7)   VALUE SPACE.
             05 󋋎ҔԍQv       PIC X(8)   VALUE SPACE.
007910*       05 FILLER                       PIC X(13)  VALUE SPACE.
007920*
007340    03 於̂v                    PIC X(56) VALUE SPACE.
007930*    03 於̂v.
007940*       05 於̂Pv           PIC X(40)  VALUE SPACE.
007950*       05 於̂Qv           PIC X(40)  VALUE SPACE.
007960*
007970    03 یʂv                      PIC 9(2)   VALUE ZERO.
007980    03 یҏv.
007990       05 ی҃Jiv               PIC X(50)  VALUE SPACE.
008000       05 یҎv               PIC X(50)  VALUE SPACE.
008010       05 یҐʂv               PIC N(1)   VALUE SPACE.
008020       05 X֔ԍv.
008030          07 X֔ԍPv              PIC X(3)   VALUE SPACE.
008040          07 X֔ԍQv              PIC X(4)   VALUE SPACE.
008050       05 یҏZPv             PIC X(50)  VALUE SPACE.
008060       05 یҏZQv             PIC X(50)  VALUE SPACE.
008990       05 dbԍv                   PIC X(35)  VALUE SPACE.
008070    03 ҏv.
008080       05 ҃Jiv                   PIC X(50)  VALUE SPACE.
008090       05 Ҏv                   PIC X(50)  VALUE SPACE.
008100       05 Ґʂv                   PIC N(1)   VALUE SPACE.
008110       05 ʃ`FbNv.
008120          07 j`FbNv              PIC N(1)  VALUE SPACE.
008130          07 `FbNv              PIC N(1)  VALUE SPACE.
008140       05 җX֔ԍv.
008150          07 җX֔ԍPv          PIC X(3)   VALUE SPACE.
008160          07 җX֔ԍQv          PIC X(4)   VALUE SPACE.
008170       05 ҏZPv                 PIC X(50)  VALUE SPACE.
008180       05 ҏZQv                 PIC X(50)  VALUE SPACE.
008990       05 ғdbԍv               PIC X(35)  VALUE SPACE.
008190       05 a`FbNv.
008200          07 `FbNv            PIC N(1)  VALUE SPACE.
008210          07 吳`FbNv            PIC N(1)  VALUE SPACE.
008220          07 a`FbNv            PIC N(1)  VALUE SPACE.
008230          07 `FbNv            PIC N(1)  VALUE SPACE.
008240          07 v                    PIC N(2)  VALUE SPACE.
008250       05 ҔNv                     PIC 9(2)  VALUE ZERO.
008260       05 Ҍv                     PIC 9(2)  VALUE ZERO.
008270       05 ғv                     PIC 9(2)  VALUE ZERO.
008280       05 v.
008290          07 v                PIC N(4)  VALUE SPACE.
008300          07 FILLER                    PIC X(4)  VALUE SPACE.
008310*
008320*       05 v                   PIC X(80) OCCURS 19 VALUE SPACE.
      */pΉ/110421
             05 v OCCURS 29.
                07 wv              PIC X(80)  VALUE SPACE.
008330*
008340*    03 یʃ`FbNv.
008350*       05 Ѝ`FbNv               PIC N(1)  VALUE SPACE.
008360*       05 `FbNv               PIC N(1)  VALUE SPACE.
008370*       05 Vl`FbNv               PIC N(1)  VALUE SPACE.
008380*       05 ސE`FbNv               PIC N(1)  VALUE SPACE.
008390*       05 `FbNv               PIC N(1)  VALUE SPACE.
008400*       05 g`FbNv               PIC N(1)  VALUE SPACE.
008410*       05 D`FbNv               PIC N(1)  VALUE SPACE.
008420*       05 σ`FbNv               PIC N(1)  VALUE SPACE.
008430*       05 q`FbNv             PIC N(1)  VALUE SPACE.
008440*       05 Oۃ`FbNv           PIC N(1)  VALUE SPACE.
007390    03 یʃ`FbNv.
007400       05 Еۃ`FbNv               PIC N(1)  VALUE SPACE.
007410       05 D`FbNv               PIC N(1)  VALUE SPACE.
007420       05 g`FbNv               PIC N(1)  VALUE SPACE.
007430       05 ۃ`FbNv               PIC N(1)  VALUE SPACE.
             05 σ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv                 PIC N(1)  VALUE SPACE.
             05 ސE`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
008600    03 یʔԍv                  PIC X(1)  VALUE SPACE.
008610*
          03 {l`FbNv                  PIC N(1)   VALUE SPACE.
          03 Ƒ`FbNv                  PIC N(1)   VALUE SPACE.
          03 Pƃ`FbNv                  PIC N(1)   VALUE SPACE.
          03 Q`FbNv                  PIC N(1)   VALUE SPACE.
          03 `FbNv                  PIC N(1)   VALUE SPACE.
          03 V`FbNv                  PIC N(1)   VALUE SPACE.
          03 U΃`FbNv                  PIC N(1)   VALUE SPACE.
          03 t`FbNv.
             05 V`FbNv               PIC N(1)  VALUE SPACE.
             05 W`FbNv               PIC N(1)  VALUE SPACE.
             05 X`FbNv               PIC N(1)  VALUE SPACE.
             05 PO`FbNv             PIC N(1)  VALUE SPACE.
008450*
008460    03 {lƑ`FbNv.
008470       05 {O`FbNv               PIC N(1)  VALUE SPACE.
008480       05 ƊO`FbNv               PIC N(1)  VALUE SPACE.
008490*
008500*    03 t`FbNv.
008510*       05 tW`FbNv             PIC N(1)  VALUE SPACE.
008520*       05 tX`FbNv             PIC N(1)  VALUE SPACE.
008530*       05 tPO`FbNv           PIC N(1)  VALUE SPACE.
008540*
008550    03 ʋ敪`FbNv.
008560       05 OX`FbNv             PIC N(1)  VALUE SPACE.
008570       05 OW`FbNv             PIC N(1)  VALUE SPACE.
008580       05 OO`FbNv               PIC N(1)  VALUE SPACE.
008590*
008600    03 Lv                      PIC X(3)  VALUE SPACE.
008610*
008620****************
008630* f[^e *
008640****************
008650 01 v.
008660    03 ʐv                        PIC 9(1)  VALUE ZERO.
008670    03 ʏv  OCCURS   9.
008680       05 ʂbmsv                 PIC 9(1)  VALUE ZERO.
008690       05 ʃR[hv.
008700          07 ʂv                PIC 9(2)  VALUE ZERO.
008710          07 ʂv                    PIC 9(2)  VALUE ZERO.
008720          07 E敪v                PIC 9(1)  VALUE ZERO.
008730          07 ʒuԍv            PIC 9(2)  VALUE ZERO.
008740       05 v                     PIC N(18) VALUE SPACE.
008750       05 Nv.
008760          07 Nv                  PIC 9(2)  VALUE ZERO.
008770          07 v                  PIC 9(2)  VALUE ZERO.
008780          07 v                  PIC 9(2)  VALUE ZERO.
008790       05 Nv.
008800          07 Nv                  PIC 9(2)  VALUE ZERO.
008810          07 v                  PIC 9(2)  VALUE ZERO.
008820          07 v                  PIC 9(2)  VALUE ZERO.
008830       05 JnNv.
008840          07 JnNv                  PIC 9(2)  VALUE ZERO.
008850          07 Jnv                  PIC 9(2)  VALUE ZERO.
008860          07 Jnv                  PIC 9(2)  VALUE ZERO.
008870       05 INv.
008880          07 INv                  PIC 9(2)  VALUE ZERO.
008890          07 Iv                  PIC 9(2)  VALUE ZERO.
008900          07 Iv                  PIC 9(2)  VALUE ZERO.
008910       05 v                     PIC 9(2)  VALUE ZERO.
008920       05 ]A敪v                   PIC 9(1)  VALUE ZERO.
008930       05 ]A敪`FbNv.
008940          07 `FbNv            PIC N(1)  VALUE SPACE.
008950          07 ~`FbNv            PIC N(1)  VALUE SPACE.
008960          07 ]`FbNv            PIC N(1)  VALUE SPACE.
008970       05 ]Av                       PIC N(2)  VALUE SPACE.
008980       05 JnN擾tO         PIC X(3)  VALUE SPACE.
008990       05 ʋ؂v                   PIC X(1)  VALUE SPACE.
009000       05 oߗ̂v.
009010          07 oߗ̂v            PIC N(5)  VALUE SPACE.
009020          07 FILLER                    PIC X(2)  VALUE SPACE.
009030    03 oߕʂv                      PIC N(1)  VALUE SPACE.
009030    03 o߂bl                        PIC N(4)  VALUE SPACE.
009040    03 őv                    PIC 9(2)  VALUE ZERO.
009050*    03 敪v                      PIC N(2)  VALUE SPACE.
009060    03 VK`FbNv                  PIC N(1)  VALUE SPACE.
009070    03 p`FbNv                  PIC N(1)  VALUE SPACE.
          03 {pv.
             05 {p`FbNv   OCCURS 31 PIC N(1)  VALUE SPACE.
009080    03 v                    PIC 9(2)  VALUE ZERO.
009090*
009100** ϔCNݒp
009110    03 p]AtO                  PIC X(3)  VALUE SPACE.
009120*
008890****************
008900* { *
008910****************
008920 01 {v.
008930    03 㪖@Pv                    PIC 9(4)  VALUE ZERO.
008940    03 㪖@Pv                    PIC 9(4)  VALUE ZERO.
008950    03 dÒPv                      PIC 9(4)  VALUE ZERO.
009130************
009140*  *
009150************
009160 01 v.
009170    03 񐔂v                         PIC 9(2)    VALUE ZERO.
009180    03 Zv.
009190       05 ԊO`FbNv                PIC N(1) VALUE SPACE.
009200       05 x`FbNv                  PIC N(1) VALUE SPACE.
009210       05 [`FbNv                  PIC N(1) VALUE SPACE.
009220       05 ԊOv                        PIC N(3) VALUE SPACE.
009230       05 xv                          PIC N(2) VALUE SPACE.
009240       05 [v                          PIC N(2) VALUE SPACE.
009250       05 Zev                  PIC N(10) VALUE SPACE.
009260    03 ÉZv.
009270       05 ԃ`FbNv                  PIC N(1) VALUE SPACE.
009280       05 Ð[`FbNv              PIC N(1) VALUE SPACE.
009290       05 H`FbNv                  PIC N(1) VALUE SPACE.
009300       05 \J`FbNv              PIC N(1) VALUE SPACE.
009310    03 q`FbNv.
009320       05 `FbNv                    PIC N(1) VALUE SPACE.
009330       05 `FbNv                    PIC N(1) VALUE SPACE.
009340       05 `FbNv                    PIC N(1) VALUE SPACE.
009350       05 v                        PIC N(1) VALUE SPACE.
009360       05 v                        PIC N(1) VALUE SPACE.
009370       05 v                        PIC N(1) VALUE SPACE.
009380    03 vv                             PIC 9(7) VALUE ZERO.
009390    03 񏈒uvv                   PIC 9(6) VALUE ZERO.
009400    03 񏈒u`FbNv.
009410       05 `FbNv                PIC N(1) VALUE SPACE.
009420       05 Œ藿`FbNv                PIC N(1) VALUE SPACE.
009430       05 {×`FbNv                PIC N(1) VALUE SPACE.
009440************
009450* l *
009460************
009470 01 lv.
009480    03 KpPv                           PIC N(38) VALUE SPACE.
009490    03 KpQv                           PIC N(38) VALUE SPACE.
009500*    03 KpRv                        PIC N(38) VALUE SPACE.
009510*    03 KpSv                        PIC N(38) VALUE SPACE.
009520*    03 o߃Rgv                     PIC N(60) VALUE SPACE.
009530*
009540******************
009550* Zvg񐔗p *
009560******************
009570 01 񐔂v                                PIC 9(2)  VALUE ZERO.
      *
       01 Ev{pv                       PIC X(100) VALUE SPACE.
       01 {pv.
          03 {pQv                      PIC X(1)  VALUE SPACE.
          03 {pPv                      PIC X(1)  VALUE SPACE.
009580***
009590 01 .
009600     03 `̖o                     PIC X(8) VALUE SPACE.
009610     03 ڌQo                     PIC X(8) VALUE SPACE.
009620     03 ʂo                     PIC X(2) VALUE SPACE.
009630     03 go.
009640         05 [o.
009650             07 ړo             PIC X(1) VALUE SPACE.
009660             07 ړso             PIC 9(3) VALUE ZERO.
009670         05 ڍאo                 PIC X(2) VALUE SPACE.
009680     03 ʒmo                     PIC X(2) VALUE SPACE.
009690     03 jbgo                   PIC X(8) VALUE SPACE.
009700*
009710 01 vZ@Nv                     PIC 9(2) VALUE ZERO.
009720* tvnqj
009730 01 aINv                       PIC 9(4) VALUE ZERO.
009740 01 vZ@.
009750    03 vZ@N                    PIC 9(4) VALUE ZERO.
009760    03 vZ@                  PIC 9(4) VALUE ZERO.
009770 01 vZ@q REDEFINES vZ@.
009780    03 vZ@I                      PIC 9(2).
009790    03 vZ@t                      PIC 9(6).
009800    03 vZ@tq REDEFINES vZ@t.
009810       05 vZ@N                   PIC 9(4).
009820       05 vZ@Nq REDEFINES vZ@N.
009830         07 vZ@N                   PIC 9(2).
009840         07 vZ@                   PIC 9(2).
009850       05 vZ@                     PIC 9(2).
009860*
      * C Agp
       01  Pv        PIC X(4096).
       01  Qv        PIC X(512).
       01  vOv  PIC X(8)  VALUE "strmoji2".
014774*
       01 vOv     PIC X(8) VALUE "MOJI2".
      *
009870******************************************************************
009880*                          A                              *
009890******************************************************************
009900*
009760**********************
009770* bZ[W\L[ *
009780**********************
009790 01 A|L[ IS EXTERNAL.
009800    03  A|bZ[W               PIC N(20).
009810*
009910**  ʓ̓f[^
009920 01 A|̓f[^ϔC IS EXTERNAL.
009930    03 A|ϔC                     PIC 9.
       01 A|̓f[^db IS EXTERNAL.
          03 A|db                     PIC 9.
       01 A|vr[ IS EXTERNAL.
          03 A|vr[敪          PIC 9.
009950*
009960************
009970* L[ *
009980************
009990 01 A|Zvgރf[^ IS EXTERNAL.
010000    03 A|Zvg                 PIC X(4).
010010*
010020 01 A|Ώۃf[^ IS EXTERNAL.
010030    03 A|{pN.
010040       05 A|{pa                  PIC 9(1).
010050       05 A|{pN                    PIC 9(2).
010060       05 A|{p                    PIC 9(2).
010070    03 A|҃R[h.
010080       05 A|Ҕԍ                  PIC 9(6).
010090       05 A|}                      PIC X(1).
010100    03 A|ی                     PIC 9(2).
010110    03 A|یҔԍ                   PIC X(10).
010120    03 A|                     PIC 9(2).
010130    03 A|pSҔԍ               PIC X(10).
010140    03 A|                     PIC 9(2).
010150    03 A|pSҔԍ           PIC X(10).
010160    03 A|҃Ji                     PIC X(20).
010170    03 A|{lƑ敪                 PIC 9(1).
013600*
013610 01 A|L[ IS EXTERNAL.
013620    03 A|ی                  PIC 9(2).
013630*
014230************************
014240* EvZbg     *
014250************************
014260 01 AE|L[ IS EXTERNAL.
014270    03 AE|{pN.
014280       05 AE|{pa               PIC 9.
014290       05 AE|{pN                 PIC 9(2).
014300       05 AE|{p                 PIC 9(2).
014310    03  AE|҃R[h.
014320       05 AE|Ҕԍ               PIC 9(6).
014330       05 AE|}                   PIC X.
014340    03 AE|                    PIC 9(2).
014350    03 AE|Ev                    PIC X(126) OCCURS 30.
014340    03 AE|敪                  PIC 9(1).
013680*
013540** RJ
013550 01 Aԁ|L[ IS EXTERNAL.
013560    03 Aԁ|{pN.
013570       05 Aԁ|{pa             PIC 9.
013580       05 Aԁ|{pN               PIC 9(2).
013590       05 Aԁ|{p               PIC 9(2).
013600    03  Aԁ|҃R[h.
013610       05 Aԁ|Ҕԍ             PIC 9(6).
013620       05 Aԁ|}                 PIC X.
013630    03 Aԁ|ΏۃtO              PIC X(3).
013640    03 Aԁ|Ԍv.
013650       05 Aԁ|Ԃv               PIC 9(2) OCCURS 9.
013660*
      * Íp
       01 AÍ|Í IS EXTERNAL.
          03 AÍ|͏.
             05 AÍ|L               PIC X(24).
             05 AÍ|ԍ               PIC X(30).
             05 AÍ|Í.
                07 AÍ|ÍҔԍ    PIC X(6).
                07 AÍ|ÍL    PIC X.
                07 AÍ|Íԍ    PIC X.
                07 AÍ|ÍL        PIC X(24).
                07 AÍ|Íԍ        PIC X(30).
          03 AÍ|o͏.
             05 AÍ|L       PIC X(24).
             05 AÍ|ԍ       PIC X(30).
006510*
014762************************
014763* Z
014764************************
014765 01 AZ|L[ IS EXTERNAL.
014766    03 AZ|{pN.
014767       05 AZ|{pa               PIC 9.
014768       05 AZ|{pN                 PIC 9(2).
014769       05 AZ|{p                 PIC 9(2).
014770    03  AZ|҃R[h.
014771       05 AZ|Ҕԍ               PIC 9(6).
014772       05 AZ|}                   PIC X.
014773    03 AZ|ΏۃtO                PIC X(3).
006510*
000540************************************
000550* v^t@C쐬p           *
000560************************************
000570 01 gAoqse|쐬f[^ IS EXTERNAL.
000580     03 gAoqse|t@C           PIC X(8).
000590     03 gAoqse|vr[敪       PIC 9.
000600     03 gAoqse|[vO     PIC X(8).
000610     03 gAoqse|I[oC         PIC X(8).
000993************************************
000994* v^t@C쐬p       *
000995************************************
000996 01 gAoqse|쐬f[^ IS EXTERNAL.
000997     03 gAoqse|p         PIC X(8).
006490*
014121******************************************************************
014122*                      PROCEDURE  DIVISION                       *
014130******************************************************************
014140 PROCEDURE               DIVISION.
014150************
014160*           *
014170*    *
014180*           *
014190************
002570     PERFORM v^t@C쐬.
014200     PERFORM .
014210************
014220*           *
014230* 又     *
014240*           *
014250************
014260* 
014270     PERFORM AڑҔ.
014280     PERFORM Zbg.
014290     PERFORM .
014300************
014310*           *
014320* I   *
014330*           *
014340************
014350     PERFORM f҈敪XV.
014360     PERFORM I.
014370     MOVE ZERO  TO PROGRAM-STATUS.
014380     EXIT PROGRAM.
014390*
014400*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
014410*================================================================*
014420*                                                        *
002860*================================================================*
002870 v^t@C쐬 SECTION.
002880*================================================================*
002890*   /  /
002900     MOVE SPACE TO gAoqse|쐬f[^.
002910     INITIALIZE gAoqse|쐬f[^.
002225     MOVE SPACE TO gAoqse|쐬f[^.
002226     INITIALIZE gAoqse|쐬f[^.
002920*
002930*
002940*-- ύXӏ --------------------------------------*
002230*   gppʃZbg
           MOVE "RECE"                TO gAoqse|p.
002970*   gpv^t@CZbg
002971     MOVE "PRTF002"             TO gAoqse|t@C.
002972*
002973*   gp钠[vOZbg
002974     MOVE "YGN612"             TO gAoqse|[vO.
002975*
002976*-------------------------------------------------------*
002980*
002990*   / vr[敪Zbg /
003000     MOVE A|vr[敪  TO gAoqse|vr[敪.
003010*
003020     CALL   "CRTPRTF".
003030     CANCEL "CRTPRTF".
003040*
014430*================================================================*
014440  SECTION.
014450*================================================================*
014460     PERFORM t@CI[v.
014470*    /* ݓt擾 */
014480     ACCEPT vZ@t FROM DATE.
014490*    /* 1980`2079N̊ԂŐݒ */
014500     IF ( vZ@N > 80 )
014510        MOVE 19 TO vZ@I
014520     ELSE
014530        MOVE 20 TO vZ@I
014540     END-IF.
014550     PERFORM Jg擾.
014560     PERFORM aIN擾.
014570     COMPUTE vZ@Nv = vZ@N - 1988.
014580*
014590*================================================================*
014600 t@CI[v SECTION.
014610*================================================================*
014620     OPEN INPUT   ی҃}X^
014630         MOVE NC"ی" TO t@C.
014640         PERFORM I[v`FbN.
014650     OPEN INPUT   }X^
014660         MOVE NC"" TO t@C.
014670         PERFORM I[v`FbN.
014680     OPEN INPUT   ̃}X^
014690         MOVE NC"" TO t@C.
014700         PERFORM I[v`FbN.
007560     OPEN INPUT   Zvge
007570         MOVE NC"Z" TO t@C.
007580         PERFORM I[v`FbN.
014740     OPEN INPUT   }X^
014750         MOVE NC"" TO t@C.
014760         PERFORM I[v`FbN.
014770     OPEN INPUT   {p}X^
014780         MOVE NC"{" TO t@C.
014790         PERFORM I[v`FbN.
014830     OPEN INPUT   o߃}X^
014840         MOVE NC"o" TO t@C.
014850         PERFORM I[v`FbN.
014860     OPEN INPUT   hcǗ}X^.
014870         MOVE NC"hc" TO t@C.
014880         PERFORM I[v`FbN.
014890     OPEN INPUT s}X^.
014900         MOVE NC"s" TO t@C.
014910         PERFORM I[v`FbN.
014920     OPEN INPUT   {pL^e.
014930         MOVE NC"{Le" TO t@C.
014940         PERFORM I[v`FbN.
014950     OPEN INPUT   f[^e.
014960         MOVE NC"" TO t@C.
014970         PERFORM I[v`FbN.
014980     OPEN INPUT   e.
014990         MOVE NC"" TO t@C.
015000         PERFORM I[v`FbN.
015010     OPEN INPUT t@C.
015020         MOVE NC"" TO t@C.
015030         PERFORM I[v`FbN.
014460     OPEN INPUT }X^.
014470         MOVE NC"" TO t@C.
014480         PERFORM I[v`FbN.
014940     OPEN INPUT   }X^.
014950         MOVE NC"}X^" TO t@C.
014960         PERFORM I[v`FbN.
015560     OPEN INPUT   fҏQe.
015570         MOVE NC"fҏQe" TO t@C.
015580         PERFORM I[v`FbN.
015040*
015050     OPEN I-O   fҏe.
015060         MOVE NC"" TO t@C.
015070         PERFORM I[v`FbN.
015080     OPEN I-O   t@C
015090         PERFORM G[o.
015100*================================================================*
015110 I[v`FbN SECTION.
015120*
015130     IF ( ԃL[  NOT =  "00" )
015140        DISPLAY t@C NC"eI[vG[" UPON CONS
015150        DISPLAY NC"ԃL[F" ԃL[         UPON CONS
015160        DISPLAY NC"P͂dmsdqL[Ă"
015170                                                UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015180        ACCEPT  L[ FROM CONS
015190        PERFORM t@C
015200        EXIT PROGRAM.
015210*================================================================*
015220 Jg擾 SECTION.
015230*================================================================*
015240     MOVE ZEROS TO |敪.
015250     READ }X^
015260     NOT INVALID KEY
015270         MOVE |Jg         TO Jgv
015280         MOVE |Z敪 TO 敪v
015290         MOVE |ZR敪 TO R敪v
015300         MOVE |Zvgt敪     TO Zvgt敪v
015310         MOVE |Zvgғt敪 TO Zvgғt敪v
015320     END-READ.
015330*
015340*================================================================*
015350 aIN擾 SECTION.
015360*================================================================*
015370*     DISPLAY NC"Jgv"  Jgv UPON MSGBOX.
015380     MOVE Jgv TO |敪.
015390     READ }X^
015400     INVALID KEY
015410         DISPLAY NC"wao^Ă܂" UPON CONS
015420         DISPLAY NC"P͂dmsdqL[Ă"
015430                                                  UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015440         ACCEPT  L[ FROM CONS
015450         PERFORM I
015460         EXIT PROGRAM
015470     NOT INVALID KEY
015480         COMPUTE Oav = Jgv - 1
015490         MOVE Oav TO |敪
015500         READ }X^
015510         INVALID KEY
015520             DISPLAY NC"wao^Ă܂" UPON CONS
015530             DISPLAY NC"P͂dmsdqL[Ă"
015540                                                      UPON CONS
000080*-----------------------------------------*
000090             CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015550             ACCEPT  L[ FROM CONS
015560             PERFORM I
015570             EXIT PROGRAM
015580         NOT INVALID KEY
015590             MOVE |IN TO aINv
015600         END-READ
015610     END-READ.
015620*
015630*================================================================*
015640*                              又                            *
015650*================================================================*
015660 AڑҔ SECTION.
015670*================================================================*
015680     MOVE A|Zvg       TO Zvgނvq.
015690*
015700     MOVE A|{pa           TO {pavq.
015710     MOVE A|{pN             TO {pNvq.
015720     MOVE A|{p             TO {pvq.
015730     MOVE A|ی           TO یʂvq.
015740     MOVE A|یҔԍ         TO یҔԍvq.
015750     MOVE A|           TO ʂvq.
015760     MOVE A|pSҔԍ     TO pSҔԍvq.
015770     MOVE A|           TO ʂvq.
015780     MOVE A|pSҔԍ TO pSҔԍvq.
015790     MOVE A|{lƑ敪       TO {lƑ敪vq.
015800     MOVE A|҃Ji           TO ҃Jivq.
015810     MOVE A|Ҕԍ           TO Ҕԍvq.
015820     MOVE A|}               TO }Ԃvq.
015830*
016086*================================================================*
016092*================================================================*
016093 Zbg SECTION.
016094*
016095     PERFORM ڏ.
016100*
           PERFORM {擾.
016120     PERFORM 擾.
016130     PERFORM fҏ擾.
016140     PERFORM f[^擾.
016150     PERFORM 擾.
016160     PERFORM {pL^擾.
016190     PERFORM Z擾.
016200     PERFORM ϔCN擾.
           PERFORM {p擾.
           PERFORM {phc擾.
           PERFORM {擾.
016110     PERFORM {p擾.
016210*
016790*
016791*-----------------------------------------------*
016800     IF ( 敪v  NOT = 1 ) AND ( Z敪v NOT = 1 )
016813        IF ( 敪v = 3 OR 4 )
016815           PERFORM Ώ۔菈
016817        ELSE
016820           PERFORM 擾
016821        END-IF
016830     END-IF.
016831*-----------------------------------------------*
016020     PERFORM oߎ擾.
016832*
016370     PERFORM Zvg񐔎擾.
016380**
016390********************
016400* fҏZbg *
016410********************
016448*
016450     MOVE {pNv            TO {pN.
016460     MOVE {pv            TO {p.
016470*
016480     MOVE {phcv        TO {phc.
           IF (یʂvq = 03 OR 04 OR 09) OR
              ((یʂvq = 01) AND
               (|یҔԍ = "133033" OR "133280" OR "133231" OR "133264" OR "133298"))
016480         MOVE _tԍv(6:4)  TO {phc
           END-IF.
016550*
016560     IF ( Zvgނvq = "JYOS" ) OR
016570        ( Z܂Ƃ߃tO = "YES" )
016580        IF ( sԍv(1:2) = "99" )
016590           MOVE SPACE                TO SҔԍ
016600        ELSE
016610           MOVE sԍv TO SҔԍ
016620        END-IF
016630        IF ( 󋋎Ҕԍv(1:1) = "*"  ) OR
016640           ( 󋋎Ҕԍv(1:2) = "" )
016650           MOVE  SPACE               TO 󋋎Ҕԍ
016660        ELSE
      */󋋎ҔԍWȏ̏ꍇg𖳎Ĉ/110425
                 IF 󋋎ҔԍQv = SPACE
                    MOVE 󋋎Ҕԍv   TO 󋋎ҔԍR
                 ELSE
                    MOVE 󋋎Ҕԍv       TO 󋋎ҔԍQ
                 END-IF
016760        END-IF
016770     END-IF.
016580     IF ( sԍv(3:2) = "20" )
              IF 󋋎ҔԍQv NOT = SPACE
                 MOVE 󋋎Ҕԍv(1:8)  TO 󋋎Ҕԍ
                 MOVE 󋋎Ҕԍv(9:7)  TO 󋋎ҔԍP
              ELSE
                 MOVE 󋋎Ҕԍv   TO 󋋎ҔԍR
              END-IF
           END-IF.
016780*
      *     MOVE یʔԍv     TO ی.
           MOVE "|||||||||||||||"  TO .
           EVALUATE یʔԍv
           WHEN 1
           WHEN 2
               IF {lƑ敪vq = 1
                  MOVE "A"          TO EDIT-COLOR OF 
               ELSE
                  MOVE "R"          TO EDIT-COLOR OF 
               END-IF
           WHEN 3
               MOVE "Y"             TO EDIT-COLOR OF 
           WHEN 4
           WHEN 5
               MOVE "B"             TO EDIT-COLOR OF 
           WHEN 6
               MOVE "F"             TO EDIT-COLOR OF 
           END-EVALUATE.
015190     MOVE Еۃ`FbNv     TO Еۃ`FbN.
015210     MOVE g`FbNv     TO g`FbN.
015220     MOVE ۃ`FbNv     TO ۃ`FbN.
           MOVE σ`FbNv     TO σ`FbN.
           MOVE `FbNv       TO `FbN.
           MOVE ސE`FbNv     TO ސE`FbN.
           MOVE `FbNv     TO `FbN.
015230     MOVE V`FbNv     TO V`FbN.
015240     MOVE W`FbNv     TO W`FbN.
015250     MOVE X`FbNv     TO X`FbN.
015260     MOVE PO`FbNv   TO PO`FbN.
      *
           MOVE {l`FbNv     TO {l`FbN.
           MOVE Ƒ`FbNv     TO Ƒ`FbN.
           MOVE Pƃ`FbNv     TO Pƃ`FbN.
           MOVE Q`FbNv     TO Q`FbN.
           MOVE `FbNv     TO `FbN.
           MOVE V`FbNv     TO V`FbN.
           MOVE U΃`FbNv     TO U΃`FbN.
016990     MOVE یҔԍv   TO یҔԍ یҔԍP.
           IF ( Lv(1:1) = NC"" )
              MOVE  SPACE          TO  Lv
           END-IF.
           IF ( ԍv(1:1) = "*"  ) OR
              ( ԍv(1:2) = "" )
              MOVE  SPACE          TO  ԍv
           END-IF.
      *
           INSPECT Lv  REPLACING ALL "@" BY "  ".
           EVALUATE TRUE
           WHEN (Lv NOT = SPACE) AND (ԍv NOT = SPACE)
               MOVE SPACE TO ItOQ
               PERFORM VARYING JE^ FROM 24 BY -1
                 UNTIL (JE^ <= ZERO) OR (ItOQ NOT = SPACE)
                   IF Lv(JE^:1) NOT = SPACE
                       MOVE Lv TO Lԍv
                       MOVE "E"   TO Lԍv(JE^ + 1:2)
                       MOVE ԍv TO Lԍv(JE^ + 3:40 - JE^ - 2)
                       MOVE "YES"  TO ItOQ
                   END-IF
               END-PERFORM
               MOVE Lԍv TO Lԍ
           WHEN Lv NOT = SPACE
               MOVE Lv TO Lԍ
           WHEN ԍv NOT = SPACE
               MOVE ԍv TO Lԍ
           END-EVALUATE.
017210*
017220     EVALUATE Zvgނvq
017240     WHEN "JYOS"
017250**        MOVE ҃Jiv          TO ی҃Ji
017260         MOVE Ҏv          TO یҎ
017270         MOVE ҏZPv        TO ZP
017280         MOVE ҏZQv        TO ZQ
      */ X֔ԍEdbԍǉ /42505
               IF ({paNvq >= 42505) AND (A|db = 1)
                  IF (|_X֓dbԍ = 0 OR 2) AND
                     ((җX֔ԍPv NOT = SPACE) OR (җX֔ԍQv NOT = SPACE))
017280               MOVE ""              TO X
017260               MOVE җX֔ԍPv  TO X֔ԍP
017270               MOVE җX֔ԍQv  TO X֔ԍQ
017280               MOVE "-"               TO X֋
                  END-IF
                  IF |_X֓dbԍ = 0 OR 3
017260               MOVE ғdbԍv    TO dbԍ
                  END-IF
               END-IF
017290     WHEN OTHER
017300**        MOVE ی҃Jiv      TO ی҃Ji
017310         MOVE یҎv      TO یҎ
017320         MOVE یҏZPv    TO ZP
017330         MOVE یҏZQv    TO ZQ
      */ X֔ԍEdbԍǉ /42505
               IF ({paNvq >= 42505) AND (A|db = 1)
                  IF (|_X֓dbԍ = 0 OR 2) AND
                     ((X֔ԍPv NOT = SPACE) OR (X֔ԍQv NOT = SPACE))
017280               MOVE ""          TO X
017260               MOVE X֔ԍPv  TO X֔ԍP
017270               MOVE X֔ԍQv  TO X֔ԍQ
017280               MOVE "-"           TO X֋
                  END-IF
                  IF |_X֓dbԍ = 0 OR 3
                     IF dbԍv NOT = SPACE
017260                   MOVE dbԍv    TO dbԍ
                     ELSE
017260                   MOVE ғdbԍv    TO dbԍ
                     END-IF
                  END-IF
               END-IF
017340     END-EVALUATE.
      *     IF (X֔ԍP NOT = SPACE) OR (X֔ԍQ NOT = SPACE)
      *         MOVE "-" TO X֔ԍ
      *     END-IF.
017350*
           IF ( A|ی > 50 ) AND
              (Q|یҎ NOT = SPACE)
016940        MOVE Q|یҎ TO یҎ
           END-IF.
017360**     MOVE ҃Jiv          TO ҃Ji.
017370     MOVE Ҏv          TO Ҏ.
017380*     MOVE Ґʂv          TO Ґ.
017390     MOVE j`FbNv        TO j`FbN.
017400     MOVE `FbNv        TO `FbN.
017410*     MOVE v              TO .
017420     MOVE `FbNv      TO `FbN.
017430     MOVE 吳`FbNv      TO 吳`FbN.
017440     MOVE a`FbNv      TO a`FbN.
017450     MOVE `FbNv      TO `FbN.
017460     MOVE ҔNv            TO ҔN.
017470     MOVE Ҍv            TO Ҍ.
017480     MOVE ғv            TO ғ.
017585*
017590     MOVE v(1)       TO P.
017600     MOVE v(2)       TO Q.
017610     MOVE v(3)       TO R.
017620     MOVE v(4)       TO S.
017630     MOVE v(5)       TO T.
017610     MOVE v(6)       TO U.
017670*
017680********************
017690* f[^Zbg *
017700********************
017710* P *
017720**********
017730     MOVE v(1)       TO P.
017740     MOVE Nv(1)       TO NP.
017750     MOVE v(1)       TO P.
017760     MOVE v(1)       TO P.
017770     MOVE Nv(1)       TO NP.
017780     MOVE v(1)       TO P.
017790     MOVE v(1)       TO P.
017800     MOVE JnNv(1)       TO JnNP.
017810     MOVE Jnv(1)       TO JnP.
017820     MOVE Jnv(1)       TO JnP.
017830     MOVE INv(1)       TO INP.
017840     MOVE Iv(1)       TO IP.
017850     MOVE Iv(1)       TO IP.
017860     MOVE `FbNv(1) TO `FbNP.
017870     MOVE ~`FbNv(1) TO ~`FbNP.
017880     MOVE ]`FbNv(1) TO ]`FbNP.
017890*     MOVE ]Av(1)         TO ]AP.
017900**********
017910* Q *
017920**********
017930     MOVE v(2)       TO Q.
017940     MOVE Nv(2)       TO NQ.
017950     MOVE v(2)       TO Q.
017960     MOVE v(2)       TO Q.
017970     MOVE Nv(2)       TO NQ.
017980     MOVE v(2)       TO Q.
017990     MOVE v(2)       TO Q.
018000     MOVE JnNv(2)       TO JnNQ.
018010     MOVE Jnv(2)       TO JnQ.
018020     MOVE Jnv(2)       TO JnQ.
018030     MOVE INv(2)       TO INQ.
018040     MOVE Iv(2)       TO IQ.
018050     MOVE Iv(2)       TO IQ.
018060     MOVE `FbNv(2) TO `FbNQ.
018070     MOVE ~`FbNv(2) TO ~`FbNQ.
018080     MOVE ]`FbNv(2) TO ]`FbNQ.
018090*     MOVE ]Av(2)         TO ]AQ.
018100**********
018110* R *
018120**********
018130     MOVE v(3)       TO R.
018140     MOVE Nv(3)       TO NR.
018150     MOVE v(3)       TO R.
018160     MOVE v(3)       TO R.
018170     MOVE Nv(3)       TO NR.
018180     MOVE v(3)       TO R.
018190     MOVE v(3)       TO R.
018200     MOVE JnNv(3)       TO JnNR.
018210     MOVE Jnv(3)       TO JnR.
018220     MOVE Jnv(3)       TO JnR.
018230     MOVE INv(3)       TO INR.
018240     MOVE Iv(3)       TO IR.
018250     MOVE Iv(3)       TO IR.
018260     MOVE `FbNv(3) TO `FbNR.
018270     MOVE ~`FbNv(3) TO ~`FbNR.
018280     MOVE ]`FbNv(3) TO ]`FbNR.
018290*     MOVE ]Av(3)         TO ]AR.
018300**********
018310* S *
018320**********
018330     MOVE v(4)       TO S.
018340     MOVE Nv(4)       TO NS.
018350     MOVE v(4)       TO S.
018360     MOVE v(4)       TO S.
018370     MOVE Nv(4)       TO NS.
018380     MOVE v(4)       TO S.
018390     MOVE v(4)       TO S.
018400     MOVE JnNv(4)       TO JnNS.
018410     MOVE Jnv(4)       TO JnS.
018420     MOVE Jnv(4)       TO JnS.
018430     MOVE INv(4)       TO INS.
018440     MOVE Iv(4)       TO IS.
018450     MOVE Iv(4)       TO IS.
018460     MOVE `FbNv(4) TO `FbNS.
018470     MOVE ~`FbNv(4) TO ~`FbNS.
018480     MOVE ]`FbNv(4) TO ]`FbNS.
018490*     MOVE ]Av(4)         TO ]AS.
018500**********
018510* T *
018520**********
018530     MOVE v(5)       TO T.
018540     MOVE Nv(5)       TO NT.
018550     MOVE v(5)       TO T.
018560     MOVE v(5)       TO T.
018570     MOVE Nv(5)       TO NT.
018580     MOVE v(5)       TO T.
018590     MOVE v(5)       TO T.
018600     MOVE JnNv(5)       TO JnNT.
018610     MOVE Jnv(5)       TO JnT.
018620     MOVE Jnv(5)       TO JnT.
018630     MOVE INv(5)       TO INT.
018640     MOVE Iv(5)       TO IT.
018650     MOVE Iv(5)       TO IT.
018660     MOVE `FbNv(5) TO `FbNT.
018670     MOVE ~`FbNv(5) TO ~`FbNT.
018680     MOVE ]`FbNv(5) TO ]`FbNT.
018690*     MOVE ]Av(5)         TO ]AT.
018700****************
018710* ʖ *
018720****************
018730     MOVE v(1)       TO P.
018740     MOVE v(2)       TO Q.
018750     MOVE v(3)       TO R.
018760     MOVE v(4)       TO S.
018770     MOVE v(5)       TO T.
018820**************
018830* o߃Zbg *
018840**************
018850     PERFORM VARYING ʂbms FROM 1 BY 1
018870             UNTIL ( ʂbms > 5 )
018900         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
018910     END-PERFORM.
018920*****************************************
018930*     VKEp`FbNɂ        *
018940*   VK...L p...Ȃ *
018950*****************************************
018960     MOVE VK`FbNv    TO VK`FbN.
018970     MOVE p`FbNv    TO p`FbN.
018990********************
019000* f[^Zbg *
019010********************
019020*    ****************************************************************
019030*    * ijijijɂĂ͘AڂZbg *
019040*    ****************************************************************
019050     MOVE vq                   TO  .
           MOVE kvq                   TO  k.
019070     MOVE ԊO`FbNv             TO  ԊO`FbN.
019080     MOVE x`FbNv               TO  x`FbN.
019090     MOVE [`FbNv               TO  [`FbN.
019100     MOVE Zvq               TO  Z.
           IF (ԊO`FbNv NOT = SPACE) OR ([`FbNv NOT = SPACE) OR
              (x`FbNv NOT = SPACE)
019110        IF ( Zvs(1) NOT = ZERO ) OR
019120           ( Zvs(1) NOT = ZERO )
019130           MOVE Zvs(1)         TO  Z
019140           MOVE Zvs(1)         TO  Z
                 MOVE "{p"                TO Zbl
                 MOVE ":"                       TO Z
019150        END-IF
           END-IF.
019160     MOVE Čvq                   TO  Č.
019170     MOVE Ëvq                 TO  Ë.
019180     MOVE É񐔂vq                 TO  É.
019190     MOVE ×vq                   TO  ×.
019200     MOVE ԃ`FbNv               TO  ԃ`FbN.
019210     MOVE H`FbNv               TO  H`FbN.
019230     MOVE \J`FbNv           TO  \J`FbN.
019240     MOVE ÉZvq               TO  ÉZ.
019250     MOVE `FbNv                 TO  `FbN.
019260     MOVE `FbNv                 TO  `FbN.
019270     MOVE `FbNv                 TO  `FbN.
019310     MOVE qZvq           TO  qZ.
019320     MOVE {p񋟗vq           TO  {p񋟗.
019330     MOVE vv                       TO  v.
019340********************
019350* 񏈒uZbg *
019360********************
019370     PERFORM VARYING ʂbms FROM 1 BY 1
019380***             UNTIL ( ʂbms > ʐv )
019390             UNTIL ( ʂbms > 5 )
019400         MOVE 񏈒uvq(ʂbms) TO 񏈒u(ʂbms)
019410     END-PERFORM.
019420     MOVE 񏈒uvv         TO 񏈒uv.
019430*
019440     MOVE {×`FbNv            TO {×`FbN.
019450     MOVE `FbNv            TO `FbN.
019460     MOVE Œ藿`FbNv            TO Œ藿`FbN.
019470********************
019480* Zbg *
019490********************
019500*    **********
019510*    * P *
019520*    **********
019530     MOVE ÒPPvq             TO ÒPP.
019540     MOVE É񐔂Pvq             TO É񐔂P.
019550     MOVE ×Pvq               TO ×P.
019560     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
019570     MOVE 㪖@Pvq             TO 㪖@P.
019580     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
019590     MOVE 㪖@Pvq             TO 㪖@P.
019600     MOVE dÉ񐔂Pvq             TO dÉ񐔂P.
019610     MOVE d×Pvq               TO d×P.
019620     MOVE vPvq                 TO vP.
019630     IF ( Pvq NOT = ZERO )
019640        COMPUTE P = Pvq / 100
019650     END-IF.
019660     MOVE vPvq           TO vP.
019670*    **********
019680*    * Q *
019690*    **********
019700     MOVE ÒPQvq             TO ÒPQ.
019710     MOVE É񐔂Qvq             TO É񐔂Q.
019720     MOVE ×Qvq               TO ×Q.
019730     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
019740     MOVE 㪖@Qvq             TO 㪖@Q.
019750     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
019760     MOVE 㪖@Qvq             TO 㪖@Q.
019770     MOVE dÉ񐔂Qvq             TO dÉ񐔂Q.
019780     MOVE d×Qvq               TO d×Q.
019790     MOVE vQvq                 TO vQ.
019800     IF ( Qvq NOT = ZERO )
019810        COMPUTE Q = Qvq / 100
019820     END-IF.
019830     MOVE vQvq           TO vQ.
019840*    ****************
019850*    * Rʁ^W *
019860*    ****************
019870     MOVE ÒPRWvq             TO ÒPRW.
019880     MOVE É񐔂RWvq             TO É񐔂RW.
019890     MOVE ×RWvq               TO ×RW.
019900     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
019910     MOVE 㪖@RWvq             TO 㪖@RW.
019920     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
019930     MOVE 㪖@RWvq             TO 㪖@RW.
019940     MOVE dÉ񐔂RWvq             TO dÉ񐔂RW.
019950     MOVE d×RWvq               TO d×RW.
019960     MOVE vRWvq                 TO vRW.
019970     MOVE ʍvRWvq         TO ʍvRW.
019980     IF ( RWvq NOT = ZERO )
019990        COMPUTE RW = RWvq / 100
020000     END-IF.
020010     MOVE vRWvq           TO vRW.
      */  0.70.6 /42505
      *     IF ({paNvq >= 42505)
      *        MOVE "60"                      TO RW
      *        MOVE "0.6"                     TO ʂRW
      *        MOVE "==="                     TO RW ʒRW
      *     END-IF.
020020*    ****************
020030*    * Rʁ^10 *
020040*    ****************
020050***     MOVE JnROvq           TO JnRO.
020060     MOVE JnROvq           TO JnRO.
020070     MOVE ÒPROvq             TO ÒPRO.
020080     MOVE É񐔂ROvq             TO É񐔂RO.
020090     MOVE ×ROvq               TO ×RO.
020100     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
020110     MOVE 㪖@ROvq             TO 㪖@RO.
020120     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
020130     MOVE 㪖@ROvq             TO 㪖@RO.
020140     MOVE dÉ񐔂ROvq             TO dÉ񐔂RO.
020150     MOVE d×ROvq               TO d×RO.
020160     MOVE vROvq                 TO vRO.
020170     IF ( ROvq NOT = ZERO )
020180        COMPUTE RO = ROvq / 100
020190     END-IF.
020200     MOVE vROvq           TO vRO.
020210*    ****************
020220*    * Sʁ^T *
020230*    ****************
020240     MOVE ÒPSTvq             TO ÒPST.
020250     MOVE É񐔂STvq             TO É񐔂ST.
020260     MOVE ×STvq               TO ×ST.
020270     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
020280     MOVE 㪖@STvq             TO 㪖@ST.
020290     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
020300     MOVE 㪖@STvq             TO 㪖@ST.
020310     MOVE dÉ񐔂STvq             TO dÉ񐔂ST.
020320     MOVE d×STvq               TO d×ST.
020330     MOVE vSTvq                 TO vST.
020340     MOVE ʍvSTvq         TO ʍvST.
020350     IF ( STvq NOT = ZERO )
020360        COMPUTE ST = STvq / 100
020370     END-IF.
020380     MOVE vSTvq           TO vST.
020390*    ****************
020400*    * Sʁ^W *
020410*    ****************
020420***     MOVE JnSWvq           TO JnSW.
020430     MOVE JnSWvq           TO JnSW.
020440     MOVE ÒPSWvq             TO ÒPSW.
020450     MOVE É񐔂SWvq             TO É񐔂SW.
020460     MOVE ×SWvq               TO ×SW.
020470     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
020480     MOVE 㪖@SWvq             TO 㪖@SW.
020490     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
020500     MOVE 㪖@SWvq             TO 㪖@SW.
020510     MOVE dÉ񐔂SWvq             TO dÉ񐔂SW.
020520     MOVE d×SWvq               TO d×SW.
020530     MOVE vSWvq                 TO vSW.
020540     MOVE ʍvSWvq         TO ʍvSW.
020550     IF ( SWvq NOT = ZERO )
020560        COMPUTE SW = SWvq / 100
020570     END-IF.
020580     MOVE vSWvq           TO vSW.
      */  0.70.6 /42505
      *     IF ({paNvq >= 42505)
      *        MOVE "60"                      TO SW
      *        MOVE "0.6"                     TO ʂSW
      *        MOVE "==="                     TO SW ʒSW
      *     END-IF.
020590*    ****************
020600*    * Sʁ^10 *
020610*    ****************
020620***     MOVE JnSOvq           TO JnSO.
020630     MOVE JnSOvq           TO JnSO.
020640     MOVE ÒPSOvq             TO ÒPSO.
020650     MOVE É񐔂SOvq             TO É񐔂SO.
020660     MOVE ×SOvq               TO ×SO.
020670     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
020680     MOVE 㪖@SOvq             TO 㪖@SO.
020690     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
020700     MOVE 㪖@SOvq             TO 㪖@SO.
020710     MOVE dÉ񐔂SOvq             TO dÉ񐔂SO.
020720     MOVE d×SOvq               TO d×SO.
020730     MOVE vSOvq                 TO vSO.
020740     IF ( SOvq NOT = ZERO )
020750        COMPUTE SO = SOvq / 100
020760     END-IF.
020770     MOVE vSOvq           TO vSO.
020780*
021200*    ****************
021210*    * Tʁ^W *
021220*    ****************
021220     MOVE SPACE TO ʂTv.
021230     IF vTWvq NOT = ZERO
      */t
021560        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TWvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTWvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TWvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TWvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TWvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TWvq / dÉ񐔂TWvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TWvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TWvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
              MOVE "x"                          TO ZLTv
      */  0.70.6 /42505
              IF ({paNvq >= 42505)
021290           MOVE "0.6 "                    TO ʗTv
              ELSE
021290           MOVE "0.7 "                    TO ʗTv
              END-IF
      */
021680        IF TWvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TWvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTWvq           TO vTv
021720        MOVE ʂTv                     TO ʂTW
021490     END-IF.
021400*    ****************
021410*    * Tʁ^10 *
021420*    ****************
021530     MOVE SPACE TO ʂTv.
021540     IF vTOvq NOT = ZERO
      */t
021560        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TOvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTOvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TOvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TOvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TOvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TOvq / dÉ񐔂TOvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TOvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TOvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
      *        ZLTv ʗTv
      */
021680        IF TOvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TOvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTOvq           TO vTv
021720        MOVE ʂTv                     TO ʂTO
021730     END-IF.
021600************************************************************************
021610*------------------------------------------------------------------------------------*
021620* ʁiTʖڂׂ̖ꍇ́AKpɃRg󎚂j
021630     IF ( vTTvq NOT = ZERO ) OR
021640        ( vTWvq NOT = ZERO ) OR
021650        ( vTOvq NOT = ZERO )
021660        MOVE  NC"Tʖڐ"   TO ʂTKp
021670     END-IF.
021680*------------------------------------------------------------------------------------*
021690*
021700     MOVE Z|v                   TO v.
021710*
021720     EVALUATE Zvgނvq
021730     WHEN "ROUJ"
021750           MOVE Sv             TO S
021760           MOVE NC""                 TO Œ
021860        MOVE Z|z            TO z
021870     WHEN "JYOS"
021880        MOVE Z|󋋎ҕSz        TO ꕔS
021890        MOVE Z|z        TO z
021900     WHEN OTHER
021940        MOVE Z|z            TO z
021920        MOVE Sv                TO S
021930        MOVE NC""                    TO Œ
      */Ў҂̏ꍇAz̕S͂OɂB
              IF |iؖ敪 = 9
                  MOVE ZERO TO S
              END-IF
021950     END-EVALUATE.
021960*
021970********************
021980* KpZbg       *
021990********************
           IF | >= 50
              MOVE NC""                    TO 
           END-IF.
022000     MOVE KpPv                     TO KpP.
022010     MOVE KpQv                     TO KpQ.
022140*
022150*------------------------------------------------------------------------------------*
022160* ʁiZȂŁA{̃Zɂ܂Ƃ߂鎞Az͏݁EKpQɏʈ󎚁j
022170*
022180     IF ( Z܂Ƃ߃tO = "YES" )
022230*
      */l̃Z܂Ƃ߂͖{̋z/110119
      */25N4_ސ쌧̑SĂ̎sł܂Ƃ߂/130408
004050*        IF |pSҔԍ(3:3) = "144" OR "145"
004050        IF (|pSҔԍ(3:3) = "144" OR "145") AND (|{paN <  42504) OR
                 (|pSҔԍ(3:2) = "14")           AND (|{paN >= 42504)
                  CONTINUE
              ELSE
022250            MOVE Z|v TO v
      */S󎚂
022260*            MOVE Z|󋋎ҕSz TO ꕔS
022270            COMPUTE z = Z|v - Z|󋋎ҕSz
022320        END-IF
022330*
022331        IF ʗ̂v NOT = SPACE
022340           STRING KpQv           DELIMITED BY SPACE
022350                  NC""             DELIMITED BY SIZE
022360                  ʗ̂v     DELIMITED BY SPACE
022370                  INTO KpQ
022380           END-STRING
022381        END-IF
022390     END-IF.
022432*------------------------------------------------------------------------------------*
022469*
022470**********************
022471* {pf[^Zbg *
022472**********************
           MOVE s{ihrv   TO s{ԍ.
022473     MOVE _tԍv           TO _tԍ.
022475     MOVE {pX֔ԍPv     TO {pX֔ԍP.
022480     MOVE {pX֔ԍQv     TO {pX֔ԍQ.
022490*
022500     MOVE {pZv           TO {pZP.
022540*
022560     MOVE {pdbԍv       TO {pdbԍ.
022580     MOVE ڍ@v             TO ڍ@.
022581     MOVE \Җv             TO \Җ.
022600     MOVE \҃Jiv           TO \҃Ji.
022610*
022630     EVALUATE یʂvq
           WHEN 01
               IF |یҔԍ = "133033" OR "133280" OR "133231" OR "133264" OR "133298"
                   MOVE NC"" TO ϔC 
               END-IF
           WHEN 03
           WHEN 04
           WHEN 09
               MOVE NC"" TO ϔC 
           WHEN 02
           WHEN 06
           WHEN 07
               MOVE NC"" TO ϔCȂ
022650     END-EVALUATE.
022660*
022670* ϔCȊO AND ȌꍇAs󎚂
022680*     IF ( ϔCtO = "FUR" )
           IF (( |ی = 01 ) AND
               ( |یҔԍ(1:2) NOT = "10" AND "04" AND "11" AND "16" AND "17" AND "26") AND
               ( |یҔԍ NOT = "133033" OR "133280" OR "133231" OR "133264" OR "133298")) OR
021590        (( |ی = 08 ) AND
               ( |یҔԍ(3:2) NOT = "10" AND "04" AND "11" AND "16" AND "17" AND "26")) OR
              ( |ی = 05 ) OR
              (( |ی = 02 OR 06 OR 07 ) AND ( |یҔԍ(3:2) NOT = "10" ))
              DISPLAY |ی |یҔԍ UPON CONS
021590         MOVE ԍv         TO ԍ
021600         MOVE `lv       TO `l
               MOVE `lJiv   TO `lJi
               MOVE Z@֖Pv     TO Z@֖P
               MOVE Z@֖Qv     TO Z@֖Q
               MOVE Z@֖Rv     TO Z@֖R
               MOVE Z@֖Sv     TO Z@֖S
               MOVE xXPv         TO xXP
               MOVE xXQv         TO xXQ
               MOVE xXRv         TO xXR
               MOVE xXSv         TO xXS
               MOVE U`FbNv     TO U`FbN
               MOVE ʃ`FbNv     TO ʃ`FbN
               MOVE `FbNv     TO `FbN
               MOVE s`FbNv     TO s`FbN
               MOVE Ƀ`FbNv     TO Ƀ`FbN
               MOVE _`FbNv     TO _`FbN
               MOVE {X`FbNv     TO {X`FbN
               MOVE xX`FbNv     TO xX`FbN
               MOVE {x`FbNv   TO {x`FbN
           END-IF.
022830*
           MOVE 於̂v           TO یҖ̂P.
      *
022840* / _tE҈ϔC /
022850     MOVE _tNv             TO 󗝔N.
022860     MOVE _tv             TO 󗝌.
022870     MOVE _tv             TO 󗝓.
022880* ( ϔCN 邩 )
022890     IF ( A|ϔC  = ZERO )
022900        MOVE ҈ϔCNv       TO ϔCN
022910        MOVE ҈ϔCv       TO ϔC
022920        MOVE ҈ϔCv       TO ϔC
022930     END-IF.
022940*
018560******************
018570* {Zbg *
018580******************
018590     MOVE 㪖@Pv          TO  㪖@P.
018600     MOVE 㪖@Pv          TO  㪖@P.
018610     MOVE dÒPv            TO  dÒP.
022980*-------------------------------------------------------------------------*
022990*---  ZEvăZbǵÄZbgSECTION ̍Ōɂ邱ƁI -----*
023000     PERFORM ZEvăZbg.
023010*-------------------------------------------------------------------------*
022950******     PERFORM eXg󎚏.
022960*
023020*
023030*================================================================*
023040 ڏ SECTION.
023050*================================================================*
023060     INITIALIZE {pv.
023070     INITIALIZE fҏv.
023080     INITIALIZE v.
023090     INITIALIZE lv.
023100     INITIALIZE Pvq.
023110     INITIALIZE Qvq.
023120     INITIALIZE Rvq.
023130     MOVE SPACE TO YGN612P.
023140*****     INITIALIZE YGN612P.
023150*
021920*================================================================*
021930 {擾 SECTION.
023130*
           IF ʂvq NOT = ZERO
              MOVE 3          TO Z|Z
           ELSE
              EVALUATE ʂvq
              WHEN 05
                  MOVE 2          TO Z|Z
              WHEN OTHER
                  MOVE 1          TO Z|Z
              END-EVALUATE
           END-IF.
019550     MOVE {pavq   TO Z|{pa.
019560     MOVE {pNvq     TO Z|{pN.
019570     MOVE {pvq     TO Z|{p.
019580     MOVE Ҕԍvq   TO Z|Ҕԍ.
019590     MOVE }Ԃvq       TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
      *
028780     MOVE {pavq       TO |{pa.
028790     MOVE {pNvq         TO |{pN.
028800     MOVE {pvq         TO |{p.
028810     MOVE ҃R[hvq     TO |҃R[h.
028820     READ fҏe
019630     INVALID KEY
              MOVE SPACE     TO |R[h
              INITIALIZE        |R[h
           END-READ.
      *
026460     MOVE {pavq       TO Q|{pa.
026470     MOVE {pNvq         TO Q|{pN.
026480     MOVE {pvq         TO Q|{p.
026490     MOVE ҃R[hvq     TO Q|҃R[h.
026500     READ fҏQe
           INVALID KEY
              MOVE SPACE           TO Q|R[h
           END-READ.
      *
027790     MOVE {pavq       TO |{pa.
027800     MOVE {pNvq         TO |{pN.
027810     MOVE {pvq         TO |{p.
027820     MOVE ҃R[hvq     TO |҃R[h.
027830     READ f[^e
019630     INVALID KEY
              MOVE SPACE     TO |R[h
              INITIALIZE        |R[h
027870     NOT INVALID KEY
027900         MOVE |ʐ                   TO ʐv
           END-READ.
021940*
023160*================================================================*
023170 {p擾 SECTION.
023180*================================================================*
023190**************************************************
023200* {@f[^gpAȉ̏擾           *
023210*  _tԍ.. _tԍvɊi[             *
023220*  ԍ ... ڍtԍvɊi[       *
023230*  \Җ ... \ҖvɊi[               *
023240*  Z1,2   ...{pZ1,2vɊi[          *
023250*  dbԍ ... {pdbԍvɊi[         *
023260**************************************************
023270     MOVE ZERO  TO {|{pԍ.
023280     READ {p}X^
023290     INVALID KEY
023300         CONTINUE
023310     NOT INVALID KEY
023370*
023371         MOVE {|V_tԍ TO _tԍv
023372*
023380         MOVE {|ڍtԍ TO ڍtԍv
023390*
023400         MOVE {|X֔ԍP       TO {pX֔ԍPv
023410         MOVE {|X֔ԍQ       TO {pX֔ԍQv
023420         MOVE {|\҃Ji       TO \҃Jiv
023430         MOVE {|\Җ         TO \Җv
      */ڍ@Ƒ\ҖʂɂB
023440         MOVE {|ڍ@         TO ڍ@v
023530         STRING {|ZP       DELIMITED BY SPACE
023540                {|ZQ       DELIMITED BY SPACE
023550                INTO {pZv
023560         END-STRING
023570*
023580         MOVE {|dbԍ         TO {pdbԍv
023600** U
020770         MOVE {|s     TO sv
020780         MOVE {|sxX TO sxXv
023730*
023740         MOVE {|a         TO aʂv
023750         MOVE {|ԍ         TO ԍv
023760         MOVE {|`l       TO `lv
023770         MOVE {|`lJi   TO `lJiv
               MOVE {|s{ihr   TO s{ihrv
023920     END-READ.
      *
022630*     IF ( ϔCtO = "YES" )
024670*** }X^
024700*         MOVE ZERO             TO  |_I敪
024690*         MOVE 50               TO  |R[h
024700*         MOVE ZERO             TO  |ی
024710*         MOVE {paNvq TO  |ύXaN
024720*         START }X^ KEY IS <  |_I敪
034410*                                      |R[h
      *                                      |ی
      *                                      |ύXaN
034420*                                      REVERSED
034430*         END-START
034440*         IF ( ԃL[ = "00" )
034460*             READ }X^ NEXT
      *             END-READ
      *             IF |R[h NOT = 50
024740*                MOVE SPACE                   TO v
      *             ELSE
024740*                MOVE |s      TO sv
024750*                MOVE |sxX  TO sxXv
024760*                MOVE |a          TO aʂv
024770*                MOVE |ԍ          TO ԍv
024780*                MOVE |`l        TO `lv
024790*                MOVE |`lJi    TO `lJiv
      *             END-IF
      *         END-IF
      *     END-IF.
023930*
      */͐ÛݑΉ
           MOVE NC"" TO U`FbNv.
      *
           EVALUATE aʂv
           WHEN 1
               MOVE NC"" TO ʃ`FbNv
           WHEN 2
               MOVE NC"" TO `FbNv
           END-EVALUATE.
      *
009745     IF sv NOT = SPACE
009746        PERFORM VARYING JE^ FROM 40 BY -1
009747                  UNTIL (sv(JE^:1) NOT = SPACE) OR
009748                        (JE^ <= ZERO)
009749            CONTINUE
009750        END-PERFORM
009751        IF JE^ > 4
009752           IF sv(JE^ - 3 : 4)  = "s"
009753              MOVE  sv(1:JE^ - 4)   TO Z@֖v
009754              MOVE NC"" TO s`FbNv
009755           ELSE
009756              IF sv(JE^ - 3 : 4)  = ""
009757                 MOVE  sv(1:JE^ - 4)   TO Z@֖v
009758                 MOVE NC"" TO Ƀ`FbNv
009759              ELSE
009760                 IF sv(JE^ - 3 : 4)  = "_"
009761                    MOVE  sv(1:JE^ - 4)   TO Z@֖v
009762                    MOVE NC"" TO _`FbNv
009763                 ELSE
009764                    MOVE  sv  TO Z@֖v
009765                 END-IF
009766              END-IF
009767           END-IF
009768        ELSE
009769           MOVE  sv  TO Z@֖v
009770        END-IF
009771     END-IF.
009779*
009780     IF sxXv NOT = SPACE
009781        PERFORM VARYING JE^ FROM 40 BY -1
009782                  UNTIL (sxXv(JE^:1) NOT = SPACE) OR
009783                        (JE^ <= ZERO)
009784            CONTINUE
009785        END-PERFORM
009786        IF JE^ >= 4
009787           IF sxXv(JE^ - 3 : 4)  = "{X"
009788              MOVE  sxXv(1:JE^ - 4)   TO xXv
009789              MOVE NC"" TO {X`FbNv
009790           ELSE
009791              IF sxXv(JE^ - 3 : 4)  = "xX"
009792                 MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                 MOVE NC"" TO xX`FbNv
009794              ELSE
009791                 IF sxXv(JE^ - 3 : 4)  = "x"
009792                    MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                    MOVE NC"" TO {x`FbNv
009794                 ELSE
009791                     IF sxXv(JE^ - 3 : 4)  = "{"
009792                        MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                        MOVE NC"" TO {x`FbNv
009794                     ELSE
009800                         MOVE  sxXv  TO xXv
009801                     END-IF
009804                 END-IF
009805              END-IF
009806           END-IF
009807        ELSE
009808           MOVE  sxXv  TO xXv
009809        END-IF
009810     END-IF.
      *
025190*================================================================*
025200 fҏ擾 SECTION.
025210*================================================================*
025220**************************************************
025230* Af[^fҏeȉ̏擾 *
025240*  {pN ..... {pNvɊi[                 *
025250*  {p ..... {pvɊi[                 *
025260*  Ҕԍ.... ҔԍvɊi[ecAԗp   *
025270*  L ....... LvɊi[                   *
025280*  ԍ ....... ԍvɊi[                   *
025290*  یҔԍ . یҔԍvɊi[             *
025300*  ی ... یʂvɊi[               *
025310*  ی҃Ji.ی҃JivɊi[           *
025320*  یҎ.یҎvɊi[           *
025330*  ZP ......یҏZPvɊi[         *
025340*  ZQ ......یҏZQvɊi[         *
025350*  ҃Ji ....҃JivɊi[               *
025360*  Ҏ ....ҎvɊi[               *
025370*  Ґ ....敪ɂ`FbN""i[ *
025380*  Ҙa ....aɂ`FbN""i[ *
025390*  ҔN ......ҔNvɊi[                 *
025400*  Ҍ ......ҌvɊi[                 *
025410*  ғ ......ғvɊi[                 *
025420*   ........̃}X^葱vɎ擾     *
025430**************************************************
           IF |R[h NOT = SPACE
025530         MOVE |{pN       TO {pNv
025540         MOVE |{p       TO {pv
025550         MOVE |Ҕԍ     TO Ҕԍv
025560*         MOVE |L         TO Lv
025570*         MOVE |ԍ         TO ԍv
               MOVE SPACE TO AÍ|Í
      *
      *    / AÍ|͏Zbg /
               MOVE |L       TO AÍ|L
               MOVE |ԍ       TO AÍ|ԍ
               MOVE |Í TO AÍ|Í
      *     
               CALL   vOv
               CANCEL vOv
      *
               MOVE AÍ|L TO Lv
               MOVE AÍ|ԍ TO ԍv
025580         MOVE |یҔԍ   TO یҔԍv
025590         MOVE |ی     TO یʂv
025600** Sy؂̎}ԍ폜
025610         IF ( |ی = 01 ) AND ( |یҔԍ(1:6) = "133033" )
025620            MOVE |یҔԍ(1:6)  TO یҔԍv
025630         END-IF
025640**
025650         MOVE |ی҃Ji TO ی҃Jiv
025660         MOVE |یҎ TO یҎv
025670         MOVE |X֔ԍP   TO X֔ԍPv
025680         MOVE |X֔ԍQ   TO X֔ԍQv
025690         MOVE |ZP       TO یҏZPv
025700         MOVE |ZQ       TO یҏZQv
      */ dbԍǉ /42505
               IF |dbԍ NOT = SPACE
                  STRING "db:"        DELIMITED BY SIZE
                         |dbԍ   DELIMITED BY SPACE
                    INTO dbԍv
                  END-STRING
               END-IF
025710         MOVE |҃Ji     TO ҃Jiv
025720         MOVE |Ҏ     TO Ҏv
025730         MOVE |җX֔ԍP  TO җX֔ԍPv
025740         MOVE |җX֔ԍQ  TO җX֔ԍQv
025750         MOVE |ҏZP      TO ҏZPv
025760         MOVE |ҏZQ      TO ҏZQv
      */ dbԍǉ /42505
               IF |ғdbԍ NOT = SPACE
                  STRING "db:"            DELIMITED BY SIZE
                         |ғdbԍ   DELIMITED BY SPACE
                    INTO ғdbԍv
                  END-STRING
               END-IF
025770         MOVE |pSҔԍ     TO sԍv
025780         MOVE |vҔԍVl     TO 󋋎Ҕԍv
025790         MOVE |pSҔԍ TO sԍv
025800         MOVE |vҔԍ     TO 󋋎Ҕԍv
025810*
025820         EVALUATE |یҐ
025830         WHEN 1
025840             MOVE NC"j"  TO یҐʂv
025850         WHEN 2
025860             MOVE NC""  TO یҐʂv
025870         END-EVALUATE
025880*
025890         EVALUATE |Ґ
025900         WHEN 1
025910             MOVE NC"j"  TO Ґʂv
025920         WHEN 2
025930             MOVE NC""  TO Ґʂv
025940         END-EVALUATE
025950         EVALUATE |Ґ
025960         WHEN 1
025970             MOVE NC""  TO j`FbNv
025980         WHEN 2
025990             MOVE NC""  TO `FbNv
026000         END-EVALUATE
026010*
026020         EVALUATE |Ҙa
026030         WHEN 1
026040             MOVE NC""  TO `FbNv
026050         WHEN 2
026060             MOVE NC""  TO 吳`FbNv
026070         WHEN 3
026080             MOVE NC""  TO a`FbNv
026090         WHEN 4
026100             MOVE NC""  TO `FbNv
026110         END-EVALUATE
026220*
026230         MOVE |ҔN  TO ҔNv
026240         MOVE |Ҍ  TO Ҍv
026250         MOVE |ғ  TO ғv
026260* 
026270         EVALUATE یʂvq 
026280* q͖"{l"
026290         WHEN 09
026300              MOVE NC"{l"    TO v
026310* ސE
026320         WHEN  08
026330             IF ( {lƑ敪vq = 1 ) AND ( |ю呱 = 1 )
026340                MOVE NC"ю"  TO v
026350             ELSE
026360                PERFORM ƑZbg
026370             END-IF
026380* 
026390         WHEN 01
026400             IF ( {lƑ敪vq = 1 )
026410                MOVE NC"ю"    TO v
026420             ELSE
026430                PERFORM ƑZbg
026440             END-IF
026450         WHEN OTHER
026460             IF ( {lƑ敪vq = 1 )
026470                MOVE NC"{l"    TO v
026480             ELSE
026490                PERFORM ƑZbg
026500             END-IF
026510         END-EVALUATE
026520**
026530         PERFORM یʃZbg
026540*
026550         IF ( ʂvq = 05 )
026560            IF ( {paNvq >= 41410 )
026570               PERFORM VlSƏZbg
026580            END-IF
026590         ELSE
026600            PERFORM ʋ敪Zbg
026610         END-IF
026620**
026630         EVALUATE Zvgނvq
026640         WHEN "JYOS"
026650            MOVE SPACE    TO Z܂Ƃ߃tO
026660         WHEN OTHER
026670            IF ( | NOT = ZERO )
026680               PERFORM Z܂Ƃߔ
026681*              / L
026683               IF ( Z܂Ƃ߃tO = "YES" ) AND
026684                  ( | = 53 ) AND
026685                  ( |pSҔԍ(1:4) = "9914" )
026686                  MOVE "8 0"   TO Lv
026687               END-IF
026690            ELSE
026700               MOVE SPACE TO Z܂Ƃ߃tO
026710            END-IF
026720         END-EVALUATE
026730*
026740     END-IF.
026800*
026810*================================================================*
026820 ƑZbg SECTION.
026830*
026840     MOVE 05          TO |敪R[h.
026850     MOVE |    TO |̃R[h.
026860     READ ̃}X^
026870     INVALID KEY
026880         MOVE SPACE    TO v
026890     NOT INVALID KEY
026900         MOVE | TO v
026910     END-READ.
026920*
026930*================================================================*
026940 یʃZbg SECTION.
026950*
022660     EVALUATE |ی
022670     WHEN 01
              IF ((یʂvq = 01) AND
                  (|یҔԍ = "133033" OR "133280" OR "133231" OR "133264" OR "133298"))
022740           MOVE NC""        TO g`FbNv
                 MOVE 2             TO یʔԍv
              ELSE
022690           MOVE NC""        TO ۃ`FbNv
                 MOVE 4             TO یʔԍv
              END-IF
022700     WHEN 02
022710     WHEN 06
022750     WHEN 07
022720        MOVE NC""        TO Еۃ`FbNv
              MOVE 1             TO یʔԍv
022730     WHEN 03
022740        MOVE NC""        TO g`FbNv
              MOVE 2             TO یʔԍv
022750*     WHEN 07
022760*        MOVE NC""        TO D`FbNv
           WHEN 04
              MOVE NC""        TO σ`FbNv
              MOVE 3             TO یʔԍv
           WHEN 09
              MOVE NC""        TO `FbNv
              MOVE 3             TO یʔԍv
           WHEN 08
              MOVE NC""        TO ސE`FbNv
              MOVE 5             TO یʔԍv
           WHEN 05
              MOVE NC""        TO `FbNv
              MOVE 6             TO یʔԍv
022770     END-EVALUATE
      */{Ƌ敪͂ǂꂩPɁB
      *     IF | = ZERO
               MOVE NC"" TO Pƃ`FbNv
      *     ELSE
      *         MOVE NC"" TO Q`FbNv
      *     END-IF
           IF |ی = 05
               EVALUATE |ʋ敪
               WHEN 1
                   MOVE NC"" TO `FbNv
               WHEN 3
                   MOVE NC"" TO V`FbNv
               END-EVALUATE
           ELSE
028984         EVALUATE |ʋ敪
               WHEN 1
               WHEN 2
                   MOVE NC"" TO `FbNv
               WHEN 3
                   MOVE NC"" TO V`FbNv
028991         WHEN 6
                   MOVE NC"" TO U΃`FbNv
               WHEN OTHER
                   IF |{lƑ敪 = 1
                       MOVE NC"" TO {l`FbNv
                   ELSE
                       MOVE NC"" TO Ƒ`FbNv
                   END-IF
028999         END-EVALUATE
           END-IF.
           MOVE Z|S TO Sv.
           EVALUATE Z|S
           WHEN ZERO
               MOVE NC"" TO PO`FbNv
           WHEN 1
               MOVE NC"" TO X`FbNv
      */_ސ쌧E쌧̏ꍇAO҂ṔAtWɂB(PS邽߁A҂PAی҂WAPƂȂ)
               IF (|ی     = 01 AND (|یҔԍ(1:2) = "14" OR "20")) OR
                  (|ی NOT = 01 AND (|یҔԍ(3:2) = "14" OR "20"))
                   IF (|ی NOT = 05 ) AND (|ʋ敪 = 1)
                       MOVE SPACE  TO X`FbNv
                       MOVE NC"" TO W`FbNv
                   END-IF
               END-IF
           WHEN 2
               MOVE NC"" TO W`FbNv
           WHEN 3
               MOVE NC"" TO V`FbNv
           END-EVALUATE.
027300*
027310*================================================================*
027320 VlSƏZbg SECTION.
027330*
027382     EVALUATE |VlSƏ
027383     WHEN 2
027385        MOVE NC""  TO OW`FbNv
027386     WHEN 3
027388        MOVE NC""  TO OW`FbNv
027389     WHEN OTHER
027391        MOVE NC""  TO OX`FbNv
027392     END-EVALUATE.
027395*
027400*================================================================*
027410 ʋ敪Zbg SECTION.
027420*
027430     EVALUATE |ʋ敪
027440     WHEN 1
027450          MOVE NC""    TO OX`FbNv
027460     WHEN 2
027470          MOVE NC""    TO OW`FbNv
027471     WHEN 3
027472          MOVE NC""    TO OW`FbNv
027480     WHEN 6
027490          MOVE NC""    TO OO`FbNv
027500     WHEN OTHER
027510          IF ( {lƑ敪vq = 1 )
027520             MOVE NC"" TO {O`FbNv
027530          ELSE
027540             MOVE NC"" TO ƊO`FbNv
027550          END-IF
027560     END-EVALUATE.
027570*
027580*================================================================*
027890*================================================================*
027891 Z܂Ƃߔ SECTION.
027892*---------------------------------------------------------------------------*
027893* s}X^ǂ݁AZ܂Ƃߋ敪PłA{̕یہEސE
027894* ̎́AtOYES (z݂ň󎚁j
027895*iFls̏Q́A{̕یiیnj̃ZvgPŐAZ͂Ȃj
027896*---------------------------------------------------------------------------*
027897*
027898     MOVE SPACE TO Z܂Ƃ߃tO.
027899     MOVE SPACE TO ʗ̂v.
027900*
           IF ( Z|{̂܂Ƃߋ敪 = 1 )
037975         MOVE "YES" TO Z܂Ƃ߃tO
027910         MOVE 02            TO |敪R[h
027911         MOVE |  TO |̃R[h
027912         READ ̃}X^
027913         NOT INVALID KEY
027914             MOVE |  TO ʗ̂v
027915         END-READ
037977     END-IF.
027937*
027954*================================================================*
027955 f[^擾 SECTION.
027956*================================================================*
027957**************************************************
027958* Af[^畉f[^eȉ̏擾 *
027959*  ...ʁ{ʂɂĉHĊi[     *
027960*  N.......Nv                       *
027961*  .......v                       *
027970*  .......v                       *
027980*  JnN.......Nv                       *
027990*  Jn.......v                       *
028000*  Jn.......v                       *
028010*  IN.......INv                       *
028020*  I.......Iv                       *
028030*  I.......Iv                       *
028040*  .......v                       *
028050*  ]A敪 ....敪ɂ`FbN""i[ *
028060*  q ....敪ɂ`FbN""i[ *
028070*  o߃R[h...o߃}X^擾             *
028080**************************************************
028090     MOVE SPACE              TO p]AtO.
           IF |R[h NOT = SPACE
028190         MOVE |ʐ                   TO ʐv
028200         PERFORM VARYING ʂbms FROM 1 BY 1
028210                 UNTIL ( ʂbms > ʐv )
028220             MOVE |(ʂbms) TO ʂv(ʂbms)
028230             MOVE |(ʂbms)     TO ʂv(ʂbms)
028240             MOVE |E敪(ʂbms) TO E敪v(ʂbms)
028250             MOVE |ʒuԍ(ʂbms)
028260                                           TO ʒuԍv(ʂbms)
028270********************************************************
028280* jS_...ʖ1+ʁ{ʖ2ɂĉHĊi[ *
028290********************************************************
028300* 
028310             MOVE SPACE                     TO ̂v
028320             MOVE 03                        TO |敪R[h
028330             MOVE |(ʂbms)  TO |̃R[h
028340             READ ̃}X^
028350             INVALID KEY
028360                 MOVE SPACE        TO ̂v
028370             NOT INVALID KEY
028380                 MOVE | TO ̂v
028390             END-READ
028400* 
020710             MOVE SPACE                    TO v(ʂbms)
032680*
032690             PERFORM ʖ̖
028590*
028600             MOVE |N(ʂbms)   TO Nv(ʂbms)
028610             MOVE |(ʂbms)   TO v(ʂbms)
028620             MOVE |(ʂbms)   TO v(ʂbms)
028630             MOVE |JnN(ʂbms)   TO Nv(ʂbms)
028640             MOVE |Jn(ʂbms)   TO v(ʂbms)
028650             MOVE |Jn(ʂbms)   TO v(ʂbms)
028660             IF ( |]A敪(ʂbms) = 9 )
028670                 MOVE 99                   TO INv(ʂbms)
028680                 MOVE 99                   TO Iv(ʂbms)
028690                 MOVE 99                   TO Iv(ʂbms)
028700                 MOVE "YES"                TO p]AtO
028710             ELSE
028720                 MOVE |IN(ʂbms)   TO INv(ʂbms)
028730                 MOVE |I(ʂbms)   TO Iv(ʂbms)
028740                 MOVE |I(ʂbms)   TO Iv(ʂbms)
028750             END-IF
028760* oߗ̎擾
028770             MOVE 01                         TO o|敪R[h
028780             MOVE |o߃R[h(ʂbms) TO o|o߃R[h
028790             READ o߃}X^
028800             INVALID KEY
028810                 MOVE ZERO            TO ʂbmsv(ʂbms)
028820                 MOVE SPACE           TO ʋ؂v(ʂbms)
028830                 MOVE SPACE           TO oߗ̂v(ʂbms)
028840             NOT INVALID KEY
028850                 EVALUATE ʂbms
028860                 WHEN 1
028870                     MOVE NC"@" TO oߕʂv
028880                 WHEN 2
028890                     MOVE NC"A" TO oߕʂv
028900                 WHEN 3
028910                     MOVE NC"B" TO oߕʂv
028920                 WHEN 4
028930                     MOVE NC"C" TO oߕʂv
028940                 WHEN 5
028950                     MOVE NC"D" TO oߕʂv
028960                 END-EVALUATE
028970                 STRING  oߕʂv     DELIMITED BY SPACE
028980                         o|oߗ   DELIMITED BY SPACE
028990                        INTO oߗ̂v(ʂbms)
029000                 END-STRING
029010             END-READ
029020*
029030             MOVE |]A敪(ʂbms) TO ]A敪v(ʂbms)
029040             EVALUATE |]A敪(ʂbms)
029050             WHEN 1
029060             WHEN 2
029070                 MOVE NC""               TO `FbNv(ʂbms)
029080             WHEN 3
029090                 MOVE NC""               TO ~`FbNv(ʂbms)
029100             WHEN 4
029110                 MOVE NC""               TO ]`FbNv(ʂbms)
029120             END-EVALUATE
029130*
029140*             EVALUATE |]A敪(ʂbms)
029150*             WHEN 1
029160*             WHEN 2
029170*                 MOVE NC""               TO ]Av(ʂbms)
029180*             WHEN 3
029190*                 MOVE NC"~"               TO ]Av(ʂbms)
029200*             WHEN 4
029210*                 MOVE NC"]"               TO ]Av(ʂbms)
029220*             WHEN OTHER
029230*                 MOVE NC"p"               TO ]Av(ʂbms)
029240*             END-EVALUATE
029250*
                    MOVE Z|ʎ(ʂbms) TO v(ʂbms)
029260         END-PERFORM
029270* VK/p `FbN
033380         EVALUATE Z|Z敪
               WHEN 1
033390             MOVE NC""                   TO VK`FbNv
               WHEN 2
033410             MOVE NC""                   TO p`FbNv
033400         WHEN 3
033390             MOVE NC""                   TO VK`FbNv
033410             MOVE NC""                   TO p`FbNv
               WHEN OTHER
033410             MOVE NC""                   TO p`FbNv
033420         END-EVALUATE
      *         IF Z|Z敪 = 1 OR 3
      *            MOVE NC"VK"                   TO 敪v
      *         ELSE
      *            MOVE NC"p"                   TO 敪v
      *         END-IF
029390* }Ԕp
029400         MOVE |JnfÓ蓮敪 TO  JnfÓ蓮敪v
029410*
029420* 敪
029430         MOVE |Z敪 TO Z敪v
027880         MOVE |ZR敪 TO ZR敪v
029440*
029450     END-IF.
032350*================================================================*
032360 ʖ̖ SECTION.
032370*
006490     STRING Z|ʖ̂P(ʂbms)  DELIMITED BY SPACE
009980            ̂v                    DELIMITED BY SPACE
006500            Z|ʖ̂Q(ʂbms)  DELIMITED BY SPACE
006520       INTO v(ʂbms)
006570     END-STRING.
032570*
029630*================================================================*
029640 擾 SECTION.
029650*================================================================*
029660********************
029670* f[^Zbg *
029680********************
029690*    ****************************************************************
029700*    * ijijijɂĂ͘AڂZbg *
029710*    ****************************************************************
029720     MOVE Z|                 TO vq.
029730     IF ( Z|ԊO = 1 )
029740         MOVE NC""                   TO ԊO`FbNv
029750     END-IF.
029760     IF ( Z|x = 1 )
029770         MOVE NC""                   TO x`FbNv
029780     END-IF.
029790     IF ( Z|[ = 1 )
029800         MOVE NC""                   TO [`FbNv
029810     END-IF.
           MOVE Z|k           TO kvq.
029820*
029830     MOVE Z|Z             TO  Zvq.
029840     MOVE Z|Č                 TO  Čvq.
029850     MOVE Z|Ë               TO  Ëvq.
029860     MOVE Z|É               TO  É񐔂vq.
029870     MOVE Z|×                 TO  ×vq.
029880     MOVE Z|ÉZ             TO  ÉZvq.
029890*
029900     IF ( Z| = 1 )
029910         MOVE NC""                   TO ԃ`FbNv
029920     END-IF.
029930*     IF ( Z|ԊO = 1 )
029940*         MOVE NC""                   TO Ð[`FbNv
029950*     END-IF.
029960     IF ( Z|\J = 1 )
029970         MOVE NC""                   TO \J`FbNv
029980     END-IF.
029990     IF ( Z|H = 1 )
030000         MOVE NC""                   TO H`FbNv
030010     END-IF.
030020*
030030     MOVE Z|qZ         TO  qZvq.
030040*
030050     IF ( Z| = 1 )
030060         MOVE NC""                   TO `FbNv
030070     END-IF.
030080     IF ( Z| = 1 )
030090         MOVE NC""                   TO `FbNv
030100     END-IF.
030110     IF ( Z| = 1 )
030120         MOVE NC""                   TO `FbNv
030130     END-IF.
030140*
030150     MOVE Z|{p񋟗         TO {p񋟗vq.
030160* v
030170     MOVE Z|v                   TO vv.
030180********************
030190* 񏈒uZbg *
030200********************
030210     PERFORM VARYING ʂbms FROM 1 BY 1
030220             UNTIL ( ʂbms > ʐv )
030230         MOVE Z|񏈒u(ʂbms) TO 񏈒uvq(ʂbms)
030240         IF ( Z|񏈒u(ʂbms) NOT = ZERO )
030250            EVALUATE |(ʂbms)
030260* PEŖoE
030270            WHEN 1
030280            WHEN 2
030290            WHEN 3
030300                MOVE NC""       TO {×`FbNv
030310* EPE܁E܍Sk
030320            WHEN 4
030330            WHEN 5
030340            WHEN 7
030350                MOVE NC""       TO `FbNv
030360* sS܁EsS܍Sk
030370            WHEN 6
030380            WHEN 8
030390                MOVE NC""       TO Œ藿`FbNv
030400            END-EVALUATE
030410         END-IF
030420     END-PERFORM.
030430     MOVE Z|񏈒uv    TO 񏈒uvv.
030440********************
030450* Zbg *
030460********************
030470*    **********
030480*    * P *
030490*    **********
030500     MOVE Z|ÒPP             TO ÒPPvq.
030510     MOVE Z|É񐔂P             TO É񐔂Pvq.
030520     MOVE Z|×P               TO ×Pvq.
030530     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
030540     MOVE Z|㪖@P             TO 㪖@Pvq.
030550     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
030560     MOVE Z|㪖@P             TO 㪖@Pvq.
030570     MOVE Z|dÉ񐔂P             TO dÉ񐔂Pvq.
030580     MOVE Z|d×P               TO d×Pvq.
030590     MOVE Z|vP                 TO vPvq.
030600     MOVE Z|P           TO Pvq.
030610     MOVE Z|vP           TO vPvq.
030620*    **********
030630*    * Q *
030640*    **********
030650     MOVE Z|ÒPQ             TO ÒPQvq.
030660     MOVE Z|É񐔂Q             TO É񐔂Qvq.
030670     MOVE Z|×Q               TO ×Qvq.
030680     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
030690     MOVE Z|㪖@Q             TO 㪖@Qvq.
030700     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
030710     MOVE Z|㪖@Q             TO 㪖@Qvq.
030720     MOVE Z|dÉ񐔂Q             TO dÉ񐔂Qvq.
030730     MOVE Z|d×Q               TO d×Qvq.
030740     MOVE Z|vQ                 TO vQvq.
030750     MOVE Z|Q           TO Qvq.
030760     MOVE Z|vQ           TO vQvq.
030770*    ****************
030780*    * Rʁ^W *
030790*    ****************
030800     MOVE Z|ÒPRW             TO ÒPRWvq.
030810     MOVE Z|É񐔂RW             TO É񐔂RWvq.
030820     MOVE Z|×RW               TO ×RWvq.
030830     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
030840     MOVE Z|㪖@RW             TO 㪖@RWvq.
030850     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
030860     MOVE Z|㪖@RW             TO 㪖@RWvq.
030870     MOVE Z|dÉ񐔂RW             TO dÉ񐔂RWvq.
030880     MOVE Z|d×RW               TO d×RWvq.
030890     MOVE Z|vRW                 TO vRWvq.
030900     MOVE Z|ʍvRW         TO ʍvRWvq.
030910     MOVE Z|RW           TO RWvq.
030920     MOVE Z|vRW           TO vRWvq.
030930*    ****************
030940*    * Rʁ^10 *
030950*    ****************
030960     MOVE Z|JnRO           TO JnROvq.
030970     MOVE Z|JnRO           TO JnROvq.
030980     MOVE Z|ÒPRO             TO ÒPROvq.
030990     MOVE Z|É񐔂RO             TO É񐔂ROvq.
031000     MOVE Z|×RO               TO ×ROvq.
031010     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
031020     MOVE Z|㪖@RO             TO 㪖@ROvq.
031030     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
031040     MOVE Z|㪖@RO             TO 㪖@ROvq.
031050     MOVE Z|dÉ񐔂RO             TO dÉ񐔂ROvq.
031060     MOVE Z|d×RO               TO d×ROvq.
031070     MOVE Z|vRO                 TO vROvq.
031080     MOVE Z|RO           TO ROvq.
031090     MOVE Z|vRO           TO vROvq.
031100*    ****************
031110*    * Sʁ^T *
031120*    ****************
031130     MOVE Z|ÒPST             TO ÒPSTvq.
031140     MOVE Z|É񐔂ST             TO É񐔂STvq.
031150     MOVE Z|×ST               TO ×STvq.
031160     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
031170     MOVE Z|㪖@ST             TO 㪖@STvq.
031180     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
031190     MOVE Z|㪖@ST             TO 㪖@STvq.
031200     MOVE Z|dÉ񐔂ST             TO dÉ񐔂STvq.
031210     MOVE Z|d×ST               TO d×STvq.
031220     MOVE Z|vST                 TO vSTvq.
031230     MOVE Z|ʍvST         TO ʍvSTvq.
031240     MOVE Z|ST           TO STvq.
031250     MOVE Z|vST           TO vSTvq.
031260*    ****************
031270*    * Sʁ^W *
031280*    ****************
031290     MOVE Z|JnSW           TO JnSWvq.
031300     MOVE Z|JnSW           TO JnSWvq.
031310     MOVE Z|ÒPSW             TO ÒPSWvq.
031320     MOVE Z|É񐔂SW             TO É񐔂SWvq.
031330     MOVE Z|×SW               TO ×SWvq.
031340     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
031350     MOVE Z|㪖@SW             TO 㪖@SWvq.
031360     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
031370     MOVE Z|㪖@SW             TO 㪖@SWvq.
031380     MOVE Z|dÉ񐔂SW             TO dÉ񐔂SWvq.
031390     MOVE Z|d×SW               TO d×SWvq.
031400     MOVE Z|vSW                 TO vSWvq.
031410     MOVE Z|ʍvSW         TO ʍvSWvq.
031420     MOVE Z|SW           TO SWvq.
031430     MOVE Z|vSW           TO vSWvq.
031440*    ****************
031450*    * Sʁ^10 *
031460*    ****************
031470     MOVE Z|JnSO           TO JnSOvq.
031480     MOVE Z|JnSO           TO JnSOvq.
031490     MOVE Z|ÒPSO             TO ÒPSOvq.
031500     MOVE Z|É񐔂SO             TO É񐔂SOvq.
031510     MOVE Z|×SO               TO ×SOvq.
031520     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
031530     MOVE Z|㪖@SO             TO 㪖@SOvq.
031540     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
031550     MOVE Z|㪖@SO             TO 㪖@SOvq.
031560     MOVE Z|dÉ񐔂SO             TO dÉ񐔂SOvq.
031570     MOVE Z|d×SO               TO d×SOvq.
031580     MOVE Z|vSO                 TO vSOvq.
031590     MOVE Z|SO           TO SOvq.
031600     MOVE Z|vSO           TO vSOvq.
031610*    *****************
031620*    * Tʁ^2.5 *
031630*    *****************
031640     MOVE Z|ÒPTQ             TO ÒPTQvq.
031650     MOVE Z|É񐔂TQ             TO É񐔂TQvq.
031660     MOVE Z|×TQ               TO ×TQvq.
031670     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
031680     MOVE Z|㪖@TQ             TO 㪖@TQvq.
031690     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
031700     MOVE Z|㪖@TQ             TO 㪖@TQvq.
031710     MOVE Z|dÉ񐔂TQ             TO dÉ񐔂TQvq.
031720     MOVE Z|d×TQ               TO d×TQvq.
031730     MOVE Z|vTQ                 TO vTQvq.
031740     MOVE Z|ʍvTQ         TO ʍvTQvq.
031750     MOVE Z|TQ           TO TQvq.
031760     MOVE Z|vTQ           TO vTQvq.
031770*    ****************
031780*    * Tʁ^T *
031790*    ****************
031800     MOVE Z|JnTT           TO JnTTvq.
031810     MOVE Z|JnTT           TO JnTTvq.
031820     MOVE Z|ÒPTT             TO ÒPTTvq.
031830     MOVE Z|É񐔂TT             TO É񐔂TTvq.
031840     MOVE Z|×TT               TO ×TTvq.
031850     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
031860     MOVE Z|㪖@TT             TO 㪖@TTvq.
031870     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
031880     MOVE Z|㪖@TT             TO 㪖@TTvq.
031890     MOVE Z|dÉ񐔂TT             TO dÉ񐔂TTvq.
031900     MOVE Z|d×TT               TO d×TTvq.
031910     MOVE Z|vTT                 TO vTTvq.
031920     MOVE Z|ʍvTT         TO ʍvTTvq.
031930     MOVE Z|TT           TO TTvq.
031940     MOVE Z|vTT           TO vTTvq.
031950*    ****************
031960*    * Tʁ^W *
031970*    ****************
031980     MOVE Z|JnTW           TO JnTWvq.
031990     MOVE Z|JnTW           TO JnTWvq.
032000     MOVE Z|ÒPTW             TO ÒPTWvq.
032010     MOVE Z|É񐔂TW             TO É񐔂TWvq.
032020     MOVE Z|×TW               TO ×TWvq.
032030     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
032040     MOVE Z|㪖@TW             TO 㪖@TWvq.
032050     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
032060     MOVE Z|㪖@TW             TO 㪖@TWvq.
032070     MOVE Z|dÉ񐔂TW             TO dÉ񐔂TWvq.
032080     MOVE Z|d×TW               TO d×TWvq.
032090     MOVE Z|vTW                 TO vTWvq.
032100     MOVE Z|ʍvTW         TO ʍvTWvq.
032110     MOVE Z|TW           TO TWvq.
032120     MOVE Z|vTW           TO vTWvq.
032130*    ****************
032140*    * Tʁ^10 *
032150*    ****************
032160     MOVE Z|JnTO           TO JnTOvq.
032170     MOVE Z|JnTO           TO JnTOvq.
032180     MOVE Z|ÒPTO             TO ÒPTOvq.
032190     MOVE Z|É񐔂TO             TO É񐔂TOvq.
032200     MOVE Z|×TO               TO ×TOvq.
032210     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
032220     MOVE Z|㪖@TO             TO 㪖@TOvq.
032230     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
032240     MOVE Z|㪖@TO             TO 㪖@TOvq.
032250     MOVE Z|dÉ񐔂TO             TO dÉ񐔂TOvq.
032260     MOVE Z|d×TO               TO d×TOvq.
032270     MOVE Z|vTO                 TO vTOvq.
032280     MOVE Z|TO           TO TOvq.
032290     MOVE Z|vTO           TO vTOvq.
032300*
032310*================================================================*
032320 {pL^擾 SECTION.
032330*================================================================*
032340************************************************************
032350* Pf[^畉f[^eȉ̏擾           *
032360*  Z .....敪ɂ`FbN""i[... *
032370*  ÉZ .....敪ɂ`FbN""i[... *
032380************************************************************
032390     MOVE  SPACE  TO  ČtO.
032400     PERFORM VARYING ʂbms FROM 1 BY 1 UNTIL ʂbms > ʐv
032410         IF ( {pNv = Nv(ʂbms) ) AND
032420            ( {pv = v(ʂbms) )
032430             MOVE Ҕԍvq          TO {L|Ҕԍ
032440             MOVE }Ԃvq              TO {L|}
032450             MOVE {pavq          TO {L|{pa
032460             MOVE Nv(ʂbms)  TO JnNv(ʂbms) {L|{pN
032470             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
032480             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
032490         ELSE
032500             MOVE Ҕԍvq          TO {L|Ҕԍ
032510             MOVE }Ԃvq              TO {L|}
032520             MOVE {pavq          TO {L|{pa
032530             MOVE {pNvq            TO {L|{pN
032540             MOVE {pvq            TO {L|{p
032550             MOVE ZERO                  TO {L|{p
032560         END-IF
032570         START {pL^e   KEY IS >= {L|҃R[h
032580                                      {L|{paN
032590         END-START
032600         IF ( ԃL[ = "00" )
32620             MOVE ZERO  TO INvs
032630             MOVE ZERO  TO Ivs
032640             MOVE ZERO  TO Ivs
032650             MOVE SPACE TO ItOQ
032660             PERFORM {pL^eǍ
032670             IF  ( ItOQ      = SPACE   ) AND
032680                 ( {L|҃R[h  = ҃R[hvq ) AND
032690                 ( {L|{pa    = {pavq   ) AND
032700                 ( {L|{pN      = {pNvq     ) AND
032710                 ( {L|{p      = {pvq     ) 
032720*
032730*        ****************************************************************
032740*        * JnN ( ̕ʂłȂA
032750*                      ł}Ԃ鎞́Aŏ̎{pJn)*
032760*        ****************************************************************
032770                 IF ( {pNv NOT = Nv(ʂbms) ) OR
032780                    ( {pv NOT = v(ʂbms) ) OR
032790                    ( JnfÓ蓮敪v = 1 )
032800                     MOVE {L|{pN   TO JnNv(ʂbms)
032810                     MOVE {L|{p   TO Jnv(ʂbms)
032820                     MOVE {L|{p   TO Jnv(ʂbms)
032830                 END-IF
032840             END-IF
032850             PERFORM UNTIL ( ItOQ         = "YES"            ) OR
032860                           ( {L|҃R[h NOT = ҃R[hvq   ) OR
032870                           ( {L|{pa   NOT = {pavq     ) OR
032880                           ( {L|{pN     NOT = {pNvq       ) OR
032890                           ( {L|{p     NOT = {pvq       ) OR
032900                           ( {L|{p         > Iv(ʂbms))
032910*               **********
032920*               *  *
032930*               **********
032950                MOVE {L|{pN               TO INvs
032960                MOVE {L|{p               TO Ivs
032970                MOVE {L|{p               TO Ivs
032980*
032990                PERFORM {pL^eǍ
033000            END-PERFORM
033010        END-IF
033020*       **************************
033030*       * pFINZbg *
033040*       **************************
033050        IF ( ]A敪v(ʂbms) = 9 )
033060            MOVE INvs    TO INv(ʂbms)
033070            MOVE Ivs    TO Iv(ʂbms)
033080            MOVE Ivs    TO Iv(ʂbms)
033090        END-IF
033100        IF ( INv(ʂbms) > 󗝔Nv )
033110            MOVE INv(ʂbms) TO 󗝔Nv
033120            MOVE Iv(ʂbms) TO 󗝌v
033130            MOVE Iv(ʂbms) TO 󗝓v
033140        END-IF
033150     END-PERFORM.
033160*
033170** ----- Ô݂𔻒 -----------*
033180*
033190*     MOVE Ҕԍvq          TO {L|Ҕԍ.
033200*     MOVE }Ԃvq              TO {L|}.
033210*     MOVE {pavq          TO {L|{pa.
033220*     MOVE {pNvq            TO {L|{pN.
033230*     MOVE {pvq            TO {L|{p.
033240*     MOVE ZERO                  TO {L|{p.
033250*     START {pL^e   KEY IS >= {L|҃R[h
033260*                                  {L|{paN
033270*     END-START.
033280*     IF ( ԃL[ = "00" )
033290*             MOVE SPACE TO ItOQ
033300*             PERFORM {pL^eǍ
033310*             IF  ( ItOQ      = SPACE   ) AND
033320*                 ( {L|҃R[h  = ҃R[hvq ) AND
033330*                 ( {L|{pa    = {pavq   ) AND
033340*                 ( {L|{pN      = {pNvq     ) AND
033350*                 ( {L|{p      = {pvq     ) 
033360** {pJnČǂ
033370*                 IF ( {L|Č = 1 )
033380*                    MOVE "YES"  TO  ČtO
033390*                 END-IF
033400**
033410*             END-IF
033420*     END-IF.
033430*     IF ( ČtO = "YES" )
033440*        PERFORM Ôݔ
033450*     END-IF.
033460*
033470** ----- 񐔂JEg -----------*
033480*
033490     MOVE ZERO                  TO 񐔂v.
033500     MOVE Ҕԍvq          TO {L|Ҕԍ.
033510     MOVE }Ԃvq              TO {L|}.
033520     MOVE {pavq          TO {L|{pa.
033530     MOVE {pNvq            TO {L|{pN.
033540     MOVE {pvq            TO {L|{p.
033550     MOVE ZERO                  TO {L|{p.
033560     START {pL^e   KEY IS >= {L|҃R[h
033570                                  {L|{paN
033580     END-START.
033590     IF ( ԃL[ = "00" )
033600        PERFORM {pL^eǍ
033610        PERFORM UNTIL ( ItOQ         = "YES"            ) OR
033620                      ( {L|҃R[h NOT = ҃R[hvq   ) OR
033630                      ( {L|{pa   NOT = {pavq     ) OR
033640                      ( {L|{pN     NOT = {pNvq       ) OR
033650                      ( {L|{p     NOT = {pvq       )
033660             IF ( {L|fË敪 = 2 )
033670                ADD  1      TO  񐔂v
033680             END-IF
033690*
033700             PERFORM {pL^eǍ
033710        END-PERFORM
033720     END-IF.
033730*
033740*================================================================*
033750 Ôݔ SECTION.
033760*
033770*** O̒ʉ@ 
033780     MOVE  SPACE            TO OtO.
033790     MOVE |҃R[h    TO {L|҃R[h.
033800     MOVE |{pa      TO {L|{pa.
033810     MOVE |{pN        TO {L|{pN.
033820     MOVE |{p        TO {L|{p.
033830     MOVE 1                 TO {L|{p.
033840     START {pL^e   KEY IS <  {L|҃R[h
033850                                  {L|{paN
033860                                  REVERSED
033870     END-START.
033880     IF ( ԃL[ = "00" )
033890         MOVE SPACE  TO ItOQ
033900         PERFORM {pL^eǍ
033910         IF ( ItOQ      = SPACE  ) AND
033920            ( {L|҃R[h  = |҃R[h ) AND
033930            ( {L|fË敪    = 2 ) 
033940*
033950            PERFORM O
033960**** KpPgp
033970            IF ( OtO = "YES" )
033980               MOVE NC"Ô"    TO  KpPv
033990            END-IF
034000**
034010         END-IF
034020     END-IF.
034030*
034040*================================================================*
034050 O  SECTION.
034060*
034070*** ǂݍ񂾎{pL^̔NAOǂ (N̍ 1 ?)
034080      MOVE  SPACE  TO  OtO.
034090      INITIALIZE  vZNv JnNQv INQv.
034100**
034110      MOVE |{pa    TO IaQv.
034120      MOVE |{pN      TO INQv.
034130      MOVE |{p      TO IQv.
034140      MOVE {L|{pa  TO JnaQv.
034150      MOVE {L|{pN    TO JnNQv.
034160      MOVE {L|{p    TO JnQv.
034170*
034180      EVALUATE TRUE
034190       WHEN (JnaQv = IaQv) AND (JnNQv = INQv)
034200            PERFORM  Or
034210       WHEN (JnaQv = IaQv) AND (JnNQv NOT = INQv)
034220            PERFORM  OrN
034230       WHEN  JnaQv NOT = IaQv 
034240            PERFORM  Or
034250      END-EVALUATE.
034260*
034270      IF ( vZv = 1 )
034280         MOVE  "YES"  TO  OtO
034290      END-IF.
034300*
034310*================================================================*
034320 Or  SECTION.
034330*
034340     IF ( IQv >  JnQv )
034350        COMPUTE vZv = IQv - JnQv
034360     ELSE
034370        MOVE ZERO TO vZv
034380     END-IF.
034390*
034400*================================================================*
034410 OrN  SECTION.
034420*
034430     IF ( INQv >  JnNQv )
034440        COMPUTE vZNv = INQv - JnNQv
034450        COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
034460     ELSE
034470        MOVE ZERO TO vZv
034480     END-IF.
034490*
034500*================================================================*
034510 Or  SECTION.
034520*
034530     MOVE JnaQv TO |敪.
034540     READ }X^
034550     NOT INVALID KEY
034560         MOVE |JnN TO JnNv
034570     END-READ.
034580     MOVE IaQv TO |敪.
034590     READ }X^
034600     NOT INVALID KEY
034610         MOVE |JnN TO INv
034620     END-READ.
034630**
034640     IF ( JnNv NOT = ZERO ) AND ( INv NOT = ZERO )
034650        COMPUTE JnNv = JnNv + JnNQv - 1
034660        COMPUTE INv = INv + INQv - 1
034670*
034680        IF ( INv =  JnNv )
034690           PERFORM  Or
034700        ELSE
034710           IF ( INv >  JnNv )
034720              COMPUTE vZNv = INv - JnNv
034730              COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
034740           ELSE
034750              MOVE ZERO TO vZv
034760           END-IF
034770        END-IF
034780     ELSE
034790        MOVE ZERO TO vZv
034800     END-IF.
034810*
035810*================================================================*
035820 Z擾 SECTION.
035830*================================================================*
035840*****************************************************************
035850** Z鎞AKpɁutԁv󎚂B
035860**   ̈󎚂͌3܂ŉ\
035870*****************************************************************
035880     IF ( Z|ԊO = 1 ) OR ( Z|[ = 1 ) OR
035890        ( Z|x   = 1 )
035900*
035910         MOVE Ҕԍvq          TO {L|Ҕԍ
035920         MOVE }Ԃvq              TO {L|}
035930         MOVE {pavq          TO {L|{pa
035940         MOVE {pNvq            TO {L|{pN
035950         MOVE {pvq            TO {L|{p
035960         MOVE ZERO                  TO {L|{p
035970         START {pL^e   KEY IS >= {L|҃R[h
035980                                      {L|{paN
035990         END-START
036000         IF ( ԃL[ = "00" )
036010             MOVE ZERO  TO ZJEg
036020             MOVE SPACE TO ItOQ
036030             PERFORM {pL^eǍ
036040             PERFORM UNTIL ( ItOQ         = "YES"           ) OR
036050                           ( {L|҃R[h NOT = ҃R[hvq  ) OR
036060                           ( {L|{pa   NOT = {pavq    ) OR
036070                           ( {L|{pN     NOT = {pNvq      ) OR
036080                           ( {L|{p     NOT = {pvq      ) 
036090               IF  ( {L|Z = 1 OR 2 OR 3 ) AND
036100                   ( {L|fË敪 = 2 )
036110                   COMPUTE ZJEg = ZJEg  + 1
036120                   IF ( ZJEg <= 3 )
036130                       MOVE {L|Z TO Z敪vs(ZJEg)
036140                       MOVE {L|t   TO Zvs(ZJEg)
036150                       MOVE {L|t   TO Zvs(ZJEg)
036160                   END-IF
036170               END-IF
036180               PERFORM {pL^eǍ
036190             END-PERFORM
036200******* Z̎KpɃZbg
033380            IF ( Zvs(1) NOT = ZERO ) OR ( Zvs(1) NOT = ZERO ) 
                      MOVE Zvs(1) TO Zv
                      MOVE ":"               TO Z؂v
                      MOVE Zvs(1) TO Zv
                  END-IF
033380            IF ( Zvs(2) NOT = ZERO ) OR ( Zvs(2) NOT = ZERO ) 
031910                PERFORM ZKpZbg
                  END-IF
034020         END-IF
036230*
036240     END-IF.
036250*
036260*================================================================*
036270 ZKpZbg SECTION.
036280*
036290     PERFORM VARYING ԍJE^ FROM 1 BY 1
036300              UNTIL  ԍJE^ > 3
036310         IF ( Zvs(ԍJE^)  = ZERO )  AND 
036320            ( Zvs(ԍJE^)  = ZERO ) 
036330             CONTINUE
036340         ELSE
036350* Œ荀
036360             EVALUATE Z敪vs(ԍJE^) 
036370             WHEN 1
036380                MOVE NC"ԊO"   TO Zev(ԍJE^)
036390             WHEN 2
036400                MOVE NC"x@"   TO Zev(ԍJE^)
036410             WHEN 3
036420                MOVE NC"[@"   TO Zev(ԍJE^)
036430             END-EVALUATE
036440*
036450             MOVE NC"F"          TO Z؂v(ԍJE^)
036460             MOVE NC""          TO Œv(ԍJE^)
036470             MOVE NC""          TO Œv(ԍJE^)
036480*
036490**** {ϊ
036500* 
036510             MOVE Zvs(ԍJE^)  TO  v
036520             IF ( v >= 10 )
036530                 MOVE vP    TO ԍvP
036540                 PERFORM {ϊ
036550                 MOVE Spԍv  TO ZmvP(ԍJE^)
036560                 MOVE vQ    TO ԍvP
036570                 PERFORM {ϊ
036580                 MOVE Spԍv  TO ZmvQ(ԍJE^)
036590             ELSE
036600                 MOVE vQ    TO ԍvP
036610                 PERFORM {ϊ
036620                 MOVE Spԍv  TO ZmvQ(ԍJE^)
036630             END-IF
036640* 
036650             MOVE Zvs(ԍJE^)  TO  v
036660             MOVE vP    TO ԍvP
036670             PERFORM {ϊ
036680             MOVE Spԍv  TO ZmvP(ԍJE^)
036690             MOVE vQ    TO ԍvP
036700             PERFORM {ϊ
036710             MOVE Spԍv  TO ZmvQ(ԍJE^)
036720** 
036730        END-IF
036740     END-PERFORM.
036750*
036760     MOVE  ZWcmv(1)   TO ZPv. 
036770     MOVE  ZWcmv(2)   TO ZQv. 
036780     MOVE  ZWcmv(3)   TO ZRv. 
036790*
036800**** KpPQgpiRLڂœKpPgĂ鎞́AKpQj
036810     IF ( Zvs(2)  = ZERO ) AND ( Zvs(2)  = ZERO ) 
036820         CONTINUE
036830     ELSE
036840         IF ( KpPv  = SPACE )
036850               STRING NC"Z"       DELIMITED BY SIZE
036860                      ZPv   DELIMITED BY SIZE
036870                      ZQv   DELIMITED BY SIZE
036880                      ZRv   DELIMITED BY SIZE
036890                      INTO KpPv
036900               END-STRING
036910         ELSE
036920               STRING NC"Z"       DELIMITED BY SIZE
036930                      ZPv   DELIMITED BY SIZE
036940                      ZQv   DELIMITED BY SIZE
036950                      ZRv   DELIMITED BY SIZE
036960                      INTO KpQv
036970               END-STRING
036980         END-IF
036990     END-IF.
037000*
037010*================================================================*
037020 {ϊ SECTION.
037030*
037040     MOVE NC"O"     TO Spԍv.
037050     CALL "htoz" WITH C LINKAGE
037060                        USING ԍvP SpԍvP.
037070*
037080*================================================================*
037090 ϔCN擾 SECTION.
037100*================================================================*
037110** ---// ̎󗝔Nɂ́AŏIʉ@ĂׁAޔ //----
037120     MOVE 󗝔Nv   TO ŏIʉ@Nv.
037130     MOVE 󗝌v   TO ŏIʉ@v.
037140     MOVE 󗝓v   TO ŏIʉ@v.
037150***
037160* (_t)
037170*
037180*/ pʂȂꍇ́A_tNɍŏIʉ@ݒ
037190*     IF ( p]AtO NOT = "YES" ) AND
037200*        ( Zvgt敪v NOT = 9 )
037210*        MOVE ZERO TO Zvgt敪v 
037220*     END-IF.
037230*
037240     EVALUATE Zvgt敪v 
037250*    /  ŏIʉ@ /
037260     WHEN ZERO
037270         MOVE ŏIʉ@Nv TO _tNv
037280         MOVE ŏIʉ@v TO _tv
037290         MOVE ŏIʉ@v TO _tv
037300*    /   /
037310     WHEN 1 
037320         PERFORM 擾
037330         MOVE 󗝔Nv     TO _tNv
037340         MOVE 󗝌v     TO _tv
037350         MOVE 󗝓v     TO _tv
037360*    /  󎚂Ȃ /
037370     WHEN 9
037380         MOVE ZERO         TO _tNv
037390         MOVE ZERO         TO _tv
037400         MOVE ZERO         TO _tv
037410*    /  ̑́AŏIʉ@ /
037420     WHEN OTHER
037430         MOVE ŏIʉ@Nv TO _tNv
037440         MOVE ŏIʉ@v TO _tv
037450         MOVE ŏIʉ@v TO _tv
037460     END-EVALUATE.
037470**
037480* (ґ)
037490*
037500*/ pʂȂꍇ́AϔCNɍŏIʉ@ݒ
037510     IF ( p]AtO NOT = "YES" ) AND
037520        ( Zvgғt敪v NOT = 9 )
037530        MOVE ZERO TO Zvgғt敪v 
037540     END-IF.
037550*
037560     EVALUATE Zvgғt敪v 
037570*    /  ŏIʉ@ /
037580     WHEN ZERO
037590         MOVE ŏIʉ@Nv TO ҈ϔCNv
037600         MOVE ŏIʉ@v TO ҈ϔCv
037610         MOVE ŏIʉ@v TO ҈ϔCv
037620*    /   /
037630     WHEN 1 
037640         PERFORM 擾
037650         MOVE 󗝔Nv     TO ҈ϔCNv
037660         MOVE 󗝌v     TO ҈ϔCv
037670         MOVE 󗝓v     TO ҈ϔCv
037680*    /  󎚂Ȃ /
037690     WHEN 9
037700         MOVE ZERO         TO ҈ϔCNv
037710         MOVE ZERO         TO ҈ϔCv
037720         MOVE ZERO         TO ҈ϔCv
037730*    /  ̑́AŏIʉ@ /
037740     WHEN OTHER
037750         MOVE ŏIʉ@Nv TO ҈ϔCNv
037760         MOVE ŏIʉ@v TO ҈ϔCv
037770         MOVE ŏIʉ@v TO ҈ϔCv
037780     END-EVALUATE.
037790*
037800*================================================================*
037810 擾 SECTION.
037820*
037830     MOVE {pNvq   TO 󗝔Nv.
037840     MOVE {pvq   TO 󗝌v.
037850     MOVE {pavq TO |敪.
037860     READ }X^
037870     NOT INVALID KEY
037880         MOVE |JnN TO {pNv
037890     END-READ.
037900     IF ( {pNv NOT = ZERO )
037910        COMPUTE {pNv = {pNv + {pNvq - 1
037920     END-IF.
037930*
037940     EVALUATE {pvq
037950     WHEN 4
037960     WHEN 6
037970     WHEN 9
037980     WHEN 11
037990         MOVE 30 TO 󗝓v
038000     WHEN 2
038010         DIVIDE 4 INTO {pNv GIVING    v
038020                                    REMAINDER ]v
038030         END-DIVIDE
038040         IF ( ]v = ZERO )
038050             MOVE 29 TO 󗝓v
038060         ELSE
038070             MOVE 28 TO 󗝓v
038080         END-IF
038090     WHEN 1
038100     WHEN 3
038110     WHEN 5
038120     WHEN 7
038130     WHEN 8
038140     WHEN 10
038150     WHEN 12
038160         MOVE 31 TO 󗝓v
038170     WHEN OTHER
038180          CONTINUE
038190     END-EVALUATE.
038200*
038210*================================================================*
038220 擾 SECTION.
038230*================================================================*
038240********************************************************************
038250*  R[ĥ́A1sɂ܂Ƃ߂Ĉ󎚂B
038260*  : @A Ƃœ].
038270*     R[ĥ܂Ƃ߁Ae[uɃZbg
038280*     (Aʂœ̂́A2sɂȂ)
038290********************************************************************
038300     MOVE  ZERO   TO  JE^ JE^Q.
038310     PERFORM VARYING ʂbms FROM 1 BY 1
038320             UNTIL ( ʂbms > ʐv )
038330*
038340****        IF ( |Ҕԍ(ʂbms)  NOT = ZERO )  AND
038350        IF ( |A(ʂbms)      NOT = ZERO )
038360*
038370           IF ( JE^ = ZERO )
038380              MOVE 1   TO  JE^ JE^Q
038390              MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
038400              MOVE |A(ʂbms)     TO AԂv(JE^)   AԂbv
038410              MOVE ʂbms                   TO ʂv(JE^ JE^Q)
038420           ELSE
038430              IF ( |Ҕԍ(ʂbms)  = Ҕԍbv )  AND
038440                 ( |A(ʂbms)      = AԂbv     )
038450                 COMPUTE JE^Q = JE^Q  +  1
038460                 MOVE ʂbms                  TO ʂv(JE^ JE^Q)
038470              ELSE
038480                 COMPUTE JE^ = JE^  +  1
038490                 MOVE 1   TO  JE^Q
038500                 MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
038510                 MOVE |A(ʂbms)     TO AԂv(JE^)  AԂbv
038520                 MOVE ʂbms                   TO ʂv(JE^ JE^Q)
038530              END-IF
038540           END-IF
038550        END-IF
038560     END-PERFORM.
038570*************************************************************************
038580*  }X^蕶͎擾
038590*************************************************************************
038600     MOVE  ZERO   TO  JE^ JE^Q.
038610     PERFORM VARYING JE^ FROM 1 BY 1
038620             UNTIL ( JE^ > 9 )  OR ( AԂv(JE^) = ZERO )
038630** ۂ 敪 01
038640         MOVE 01                        TO |敪R[h
038650         MOVE Ҕԍv(JE^)  TO |Ҕԍ
038660         MOVE AԂv(JE^)      TO |A
038670         READ e
038680         NOT INVALID KEY
038690             INITIALIZE vs
038700             MOVE |bl(1) TO  Pvs
038710             MOVE |bl(2) TO  Qvs
038720             MOVE |bl(3) TO  Rvs
038730             MOVE |bl(4) TO  Svs
038740             MOVE |bl(5) TO  Tvs
038750             PERFORM VARYING JE^Q FROM 1 BY 1
038760                     UNTIL ( JE^Q > 9 )  OR 
038770                           ( ʂv(JE^ JE^Q) = ZERO )
038780                EVALUATE ʂv(JE^ JE^Q)
038790                WHEN 1
038800                   MOVE "@"  TO  io[vP(JE^Q)
038810                WHEN 2
038820                   MOVE "A"  TO  io[vP(JE^Q)
038830                WHEN 3
038840                   MOVE "B"  TO  io[vP(JE^Q)
038850                WHEN 4
038860                   MOVE "C"  TO  io[vP(JE^Q)
038870                WHEN 5
038880                   MOVE "D"  TO  io[vP(JE^Q)
038850                WHEN 6
038860                   MOVE "E"  TO  io[vP(JE^Q)
038870                WHEN 7
038880                   MOVE "F"  TO  io[vP(JE^Q)
038890                WHEN OTHER
038900                   CONTINUE
038910                END-EVALUATE
038920             END-PERFORM
038930*
039012             IF |͋敪 = 1
039013                 STRING io[mv  DELIMITED BY SPACE
039014                        Pvs  DELIMITED BY SIZE
039015                        Qvs  DELIMITED BY SIZE
039016                        Rvs  DELIMITED BY SIZE
039017                        Svs  DELIMITED BY SIZE
039018                        Tvs  DELIMITED BY SIZE
039019                        INTO ev(JE^)
039020                 END-STRING
039021             ELSE
005946                 INSPECT vs REPLACING ALL Sp BY p
                       MOVE SPACE TO Pv Qv
                       MOVE io[mv TO Pv
                       MOVE Pvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Qvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Rvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Svs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Tvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                        MOVE Pv TO ev(JE^)
039030             END-IF
039031*
039032         END-READ
039033     END-PERFORM.
039040*
039050     PERFORM Zbg.
039060*
039070*================================================================*
039080 Zbg SECTION.
039090*
039100*************************************************************************
039110*  ͂1s𒴂鎞́AsɕB
039120*************************************************************************
039130     MOVE  ZERO   TO  JE^ JE^Q.
039140     PERFORM VARYING JE^ FROM 1 BY 1
039150       UNTIL ( JE^ > 9 ) OR ( ev(JE^) = SPACE )
039160*
031170          INITIALIZE ewv
031180          MOVE ev(JE^)   TO ewv
031190          IF  ePwv  NOT = SPACE
031200              COMPUTE JE^Q = JE^Q  +  1
031210              MOVE ePwv  TO v(JE^Q)
031220          END-IF
031230          IF  eQwv  NOT = SPACE
031240              COMPUTE JE^Q = JE^Q  +  1
031250              MOVE eQwv  TO v(JE^Q)
031260          END-IF
031270          IF  eRwv  NOT = SPACE
031280              COMPUTE JE^Q = JE^Q  +  1
031290              MOVE eRwv  TO v(JE^Q)
031300          END-IF
034690          IF  eSwv  NOT = SPACE
034700              COMPUTE JE^Q = JE^Q  +  1
034710              MOVE eSwv  TO v(JE^Q)
034720          END-IF
039310*
039320     END-PERFORM.
039330*
041450*================================================================*
041460 Zvg񐔎擾 SECTION.
041470*================================================================*
041480*************************************************************************
041490**-------- Zvg̑ XX  ̉񐔂߂B----------**
041500*  ʂ̊JnNŁAԏ(Â)NƎ{pNƂ̍1𑫂
041510*  () JnN10N7  Ŏ{pN10N10́A4
041520*  () JnN10N10 Ŏ{pN10N10́A1
041530*************************************************************************
041540*
041550     MOVE ZERO     TO 񐔂v.
041560*
041570     PERFORM JnNŏ擾.
041580     PERFORM ̌擾.
041590     MOVE vZv TO 񐔂v.
041600*
041610*================================================================*
041620 JnNŏ擾  SECTION.
041630*
041640** --// ʂ̊JnNŁAԏ(Â)N߂. //--**
041650*
041660     MOVE ALL "9" TO ŏJnaNv.
041670*
041680     PERFORM VARYING ʂbms FROM 1 BY 1
041690             UNTIL ( ʂbms > ʐv )
041700         IF ( |JnaN(ʂbms) NOT = ZERO ) AND
041710            ( |JnaN(ʂbms) <  ŏJnaNv )
041720            MOVE |JnaN(ʂbms) TO ŏJnaNv
041730         END-IF
041740     END-PERFORM.
041750*
041760*================================================================*
041770 ̌擾  SECTION.
041780*********************************************************** 
041790*   JnNƎ{pNƂ̍̌߂B
041800*    (ÕWbNAZNV𗘗p)
041810*********************************************************** 
041820*
041830      INITIALIZE  vZNv JnNQv INQv.
041840*
041850      IF ( ŏJnaNv NOT =  ALL "9" )
041860*
041870         MOVE {pavq    TO IaQv
041880         MOVE {pNvq      TO INQv
041890         MOVE {pvq      TO IQv
041900         MOVE ŏJnav  TO JnaQv
041910         MOVE ŏJnNv    TO JnNQv
041920         MOVE ŏJnv    TO JnQv
041930*
041940         EVALUATE TRUE
041950         WHEN (JnaQv = IaQv) AND (JnNQv = INQv)
041960              PERFORM  Or
041970         WHEN (JnaQv = IaQv) AND (JnNQv NOT = INQv)
041980              PERFORM  OrN
041990         WHEN  JnaQv NOT = IaQv 
042000              PERFORM  Or
042010         END-EVALUATE
042020*
042030         COMPUTE vZv =  vZv + 1
042040*
042050      END-IF.
042060*
042070*================================================================*
042080 {pL^eǍ SECTION.
042090*================================================================*
042100     READ {pL^e NEXT
042110     AT END
042120         MOVE "YES" TO ItOQ
042130     END-READ.
042140*
042150*================================================================*
042160  SECTION.
042170*================================================================*
042180     MOVE "YGN612P"  TO  `̖o.
042190     MOVE "SCREEN"   TO  ڌQo.
042200     WRITE YGN612P.
042210     PERFORM G[o.
042220*================================================================*
042230 G[o SECTION.
042240*
042250     IF ( ʒmo NOT = "00" )
042260         DISPLAY NC"[G["              UPON CONS
042270         DISPLAY NC"ڌQoF" ڌQo UPON CONS
042280         DISPLAY NC"ʒmoF" ʒmo UPON CONS
042290         DISPLAY NC"goF" go UPON CONS
042300         DISPLAY NC"P͂dmsdqL[Ă"
042310                                             UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
042320         ACCEPT  L[ FROM CONS
042330         PERFORM t@C
042340         MOVE 99  TO PROGRAM-STATUS
042350         EXIT PROGRAM
042360     END-IF.
042370*================================================================*
042380*                           I                             *
042390*================================================================*
042400 f҈敪XV SECTION.
042410*================================================================*
042420** //  fҏë敪ɂPZbgAXVB//  
042430*
042440     MOVE {pavq       TO |{pa.
042450     MOVE {pNvq         TO |{pN.
042460     MOVE {pvq         TO |{p.
042470     MOVE ҃R[hvq     TO |҃R[h.
042480     READ fҏe
042490     NOT INVALID KEY
042500         IF ( Zvgނvq = "JYOS" )
042510            MOVE  1  TO  |Z敪
042520         ELSE
042530            MOVE  1  TO  |Z敪
042540         END-IF
042550         REWRITE  |R[h
042560         END-REWRITE
042570         IF ( ԃL[ NOT = "00" )
042580            MOVE NC"f" TO t@C
042590            PERFORM G[\
042600         END-IF
042610     END-READ.
042620*
038490*================================================================*
038500 ZEvăZbg SECTION.
043230*---------------------------------------------------------------*
043240* Evt@CΒȒOɍăZbgB
043250* iΉȂA܂蒷R͂̂܂܁j
043260*---------------------------------------------------------------*
           PERFORM Ev擾.
           MOVE AE|Ev(1)    TO RP.
           MOVE AE|Ev(2)    TO RQ.
           MOVE AE|Ev(3)    TO RR.
           MOVE AE|Ev(4)    TO RS.
           MOVE AE|Ev(5)    TO RT.
           MOVE AE|Ev(6)    TO RU.
           MOVE AE|Ev(7)    TO RV.
           MOVE AE|Ev(8)    TO RW.
038680*
042820*
044960*================================================================*
044961 Ώ۔菈 SECTION.
044963*------------------------------------------------------------------------------------*
044964* }X^́u敪v 3 iRʈȏj̎ARʈȏォ肵āA
044965* ̎̂݁AB
044966*------------------------------------------------------------------------------------*
044967*
044979     MOVE  SPACE TO  AZ|L[.
044980     INITIALIZE      AZ|L[.
044981     MOVE {pavq  TO  AZ|{pa.
044982     MOVE {pNvq    TO  AZ|{pN.
044983     MOVE {pvq    TO  AZ|{p.
044984     MOVE Ҕԍvq  TO  AZ|Ҕԍ.
044985     MOVE }Ԃvq      TO  AZ|}.
044986     CALL   "RECEHUGE".
044987     CANCEL "RECEHUGE".
044989*
044990     IF AZ|ΏۃtO = "YES"
044991        PERFORM 擾
044992     END-IF.
044993*
042830*================================================================*
042840*================================================================*
042850 G[\ SECTION.
042860*
042870     DISPLAY NC"t@CG[F" t@C   UPON CONS.
042880     DISPLAY NC"ԃL[" ԃL[                 UPON CONS.
042890     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
042900     DISPLAY NC"P͂dmsdqL[Ă"
042910                                                   UPON CONS.
003321*-----------------------------------------*
003322     CALL "actcshm"  WITH C LINKAGE.
003323*-----------------------------------------*
042920     ACCEPT  L[ FROM CONS
042930     PERFORM t@C.
042940     EXIT PROGRAM.
042950*================================================================*
042960 I SECTION.
042970*================================================================*
042980     PERFORM t@C.
042990*================================================================*
043000 t@C SECTION.
043010*
043020     CLOSE t@C.
043030     CLOSE ی҃}X^     }X^          ̃}X^
043040           }X^      {p}X^
043050           o߃}X^       s}X^        fҏe
043060           {pL^e       f[^e        e
043070           hcǗ}X^   t@C        }X^
043080           Zvge       fҏQe.
043090*
043100*================================================================*
043110*================================================================*
043120 eXg󎚏 SECTION.
043130*
           MOVE NC"" TO  Pƃ`FbN {l`FbN `FbN σ`FbN `FbN
           Еۃ`FbN g`FbN PO`FbN X`FbN Q`FbN U΃`FbN W`FbN
           V`FbN `FbN ސE`FbN ۃ`FbN Ƒ`FbN V`FbN j`FbN
           `FbN 吳`FbN `FbN a`FbN `FbN {p`FbNP {p`FbNQ
           {p`FbNR {p`FbNS {p`FbNT {p`FbNU {p`FbNV {p`FbNW
           {p`FbNX {p`FbNPO {p`FbNPP {p`FbNPQ {p`FbNPR
           {p`FbNPS {p`FbNPT {p`FbNPU {p`FbNPV {p`FbNPW
           {p`FbNPX {p`FbNQO {p`FbNQP {p`FbNQQ {p`FbNQR
           {p`FbNQS {p`FbNQT {p`FbNQU {p`FbNQV {p`FbNQW
           {p`FbNQX {p`FbNRO {p`FbNRP [`FbN ԊO`FbN x`FbN
           Œ藿`FbN `FbN {×`FbN ԃ`FbN \J`FbN H`FbN `FbN
           `FbN ϔC ϔCȂ ʃ`FbN U`FbN `FbN s`FbN Ƀ`FbN
           _`FbN {X`FbN xX`FbN {x`FbN `FbNP ~`FbNP ]`FbNP
           `FbNQ ~`FbNQ ]`FbNQ `FbNR ~`FbNR ]`FbNR `FbNS
           ~`FbNS ]`FbNS `FbNT ~`FbNT ]`FbNT VK`FbN p`FbN
           .
           MOVE ALL "X" TO SҔԍ 󋋎ҔԍQ X֔ԍP X֋ X֔ԍQ 
           {phc یҔԍ Lԍ ZP ZQ P
           Q R S T U ʂTW ʂTO `lJi `l
           RP RQ RR RS RT RU ڍ@
           ԍ _tԍ xXP xXQ xXR xXS Z@֖P Z@֖Q Z@֖R
           Z@֖S {pX֔ԍP {pX֔ԍQ {pZP {pZQ
           یҎ Ҏ {pdbԍ \҃Ji \Җ 
           .
           MOVE ALL NC"m" TO P Q R S T
           oߗ(1) oߗ(2) oߗ(3) oߗ(4) oߗ(5) KpP KpQ ʂTKp
           .
           MOVE ALL "9" TO  {p {pN JnNP JnP JnP INP IP IP NP
           P P NP P P P JnNQ JnQ JnQ INQ
           IQ IQ NQ Q Q NQ Q Q Q JnNR
           JnR JnR INR IR IR NR R R NR R
           R R JnNS JnS JnS INS IS IS NS S
           S NS S S S JnNT JnT JnT INT IT
           IT NT T T NT T T T  k
           Ë Č É × qZ ÉZ Z {p񋟗 v
           񏈒uv ÒPP É񐔂P ×P 㪖@񐔂P 㪖@P 㪖@񐔂P 㪖@P
           dÉ񐔂P d×P vP P vP ÒPQ É񐔂Q ×Q 㪖@񐔂Q
           㪖@Q 㪖@񐔂Q 㪖@Q dÉ񐔂Q d×Q vQ Q vQ
           ÒPRW É񐔂RW ×RW 㪖@񐔂RW 㪖@RW 㪖@񐔂RW 㪖@RW
           dÉ񐔂RW d×RW vRW ʍvRW RW vRW JnRO
           JnRO ÒPRO É񐔂RO ×RO 㪖@񐔂RO 㪖@RO 㪖@񐔂RO
           㪖@RO dÉ񐔂RO d×RO vRO RO vRO JnSW
           JnSW ÒPSW É񐔂SW ×SW 㪖@񐔂SW 㪖@SW 㪖@񐔂SW
           㪖@SW dÉ񐔂SW d×SW vSW ʍvSW SW vSW
           JnSO JnSO ÒPSO É񐔂SO ×SO 㪖@񐔂SO 㪖@SO
           㪖@񐔂SO 㪖@SO dÉ񐔂SO d×SO vSO SO vSO 
           󗝔N 󗝌 󗝓 ϔCN ϔC ϔC ҔN Ҍ ғ
      *     v ꕔS S z 
           .
044180*================================================================*
       {p擾 SECTION.
      *
      *     MOVE SPACE TO {pv.
028350     MOVE Ҕԍvq          TO {L|Ҕԍ
028360     MOVE }Ԃvq              TO {L|}
028370     MOVE {pavq          TO {L|{pa
028380     MOVE {pNvq            TO {L|{pN
028390     MOVE {pvq            TO {L|{p
028400     MOVE ZERO                  TO {L|{p
028420     START {pL^e   KEY IS >= {L|҃R[h
028430                                  {L|{paN
028440     END-START
028450     IF ԃL[ = "00"
030910         MOVE SPACE TO ItOQ
030920         PERFORM {pL^eǍ
030930         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030940                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030950                       ( {L|{pa   NOT = {pavq    ) OR
030960                       ( {L|{pN     NOT = {pNvq      ) OR
030970                       ( {L|{p     NOT = {pvq      )
                   MOVE NC"" TO {p`FbNv({L|{p)
                   PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
           MOVE {p`FbNv(1)  TO {p`FbNP.
           MOVE {p`FbNv(2)  TO {p`FbNQ.
           MOVE {p`FbNv(3)  TO {p`FbNR.
           MOVE {p`FbNv(4)  TO {p`FbNS.
           MOVE {p`FbNv(5)  TO {p`FbNT.
           MOVE {p`FbNv(6)  TO {p`FbNU.
           MOVE {p`FbNv(7)  TO {p`FbNV.
           MOVE {p`FbNv(8)  TO {p`FbNW.
           MOVE {p`FbNv(9)  TO {p`FbNX.
           MOVE {p`FbNv(10) TO {p`FbNPO.
           MOVE {p`FbNv(11) TO {p`FbNPP.
           MOVE {p`FbNv(12) TO {p`FbNPQ.
           MOVE {p`FbNv(13) TO {p`FbNPR.
           MOVE {p`FbNv(14) TO {p`FbNPS.
           MOVE {p`FbNv(15) TO {p`FbNPT.
           MOVE {p`FbNv(16) TO {p`FbNPU.
           MOVE {p`FbNv(17) TO {p`FbNPV.
           MOVE {p`FbNv(18) TO {p`FbNPW.
           MOVE {p`FbNv(19) TO {p`FbNPX.
           MOVE {p`FbNv(20) TO {p`FbNQO.
           MOVE {p`FbNv(21) TO {p`FbNQP.
           MOVE {p`FbNv(22) TO {p`FbNQQ.
           MOVE {p`FbNv(23) TO {p`FbNQR.
           MOVE {p`FbNv(24) TO {p`FbNQS.
           MOVE {p`FbNv(25) TO {p`FbNQT.
           MOVE {p`FbNv(26) TO {p`FbNQU.
           MOVE {p`FbNv(27) TO {p`FbNQV.
           MOVE {p`FbNv(28) TO {p`FbNQW.
           MOVE {p`FbNv(29) TO {p`FbNQX.
           MOVE {p`FbNv(30) TO {p`FbNRO.
           MOVE {p`FbNv(31) TO {p`FbNRP.
037520*================================================================*
021810 擾 SECTION.
021820*
           IF (یʂvq = 05) OR (یʂvq >= 50)
030800         MOVE یʂvq   TO s|
030810         MOVE یҔԍvq TO s|sԍ
030820         READ s}X^
030830         INVALID KEY
030840             MOVE SPACE      TO 於̂v
030850         NOT INVALID KEY
021950             IF یʂvq = 05
022160                 STRING s|s DELIMITED BY SPACE
023960*                        " a"          DELIMITED BY SIZE
022200                        INTO 於̂v
022210                 END-STRING
                   ELSE
022160                 STRING s|s DELIMITED BY SPACE
023960*                        " a"        DELIMITED BY SIZE
022200                        INTO 於̂v
022210                 END-STRING
                   END-IF
               END-READ
           ELSE
021880         MOVE یʂvq   TO ہ|ی
021890         MOVE یҔԍvq TO ہ|یҔԍ
021900         READ ی҃}X^
021910         INVALID KEY
021920             MOVE SPACE      TO 於̂v
021930         NOT INVALID KEY
021940* ЕہAق́uЉیv
021950             EVALUATE یʂvq 
021960             WHEN 02
021970             WHEN 06
021980                  IF ( ہ|ڔ敪 = 1 )
021990*                      MOVE ہ|یҖ    TO 於̂v
022160                      STRING ہ|یҖ DELIMITED BY SPACE
022110                             ہ|x DELIMITED BY SPACE
023960*                             " a"          DELIMITED BY SIZE
022200                             INTO 於̂v
022210                      END-STRING
022000                  ELSE
022010                     STRING ہ|یҖ  DELIMITED BY SPACE
022020                           "Љی" DELIMITED BY SIZE
023960*                           "  a"           DELIMITED BY SIZE
022030                           INTO 於̂v
022040                     END-STRING
022050                  END-IF
022060* g͎x܂ň
022070             WHEN 03
                        IF ہ|x = SPACE
022080                      STRING ہ|یҖ     DELIMITED BY SPACE
022090                             "Ngی"     DELIMITED BY SIZE
023960*                             " a"              DELIMITED BY SIZE
022120                             INTO 於̂v
022130                      END-STRING
                        ELSE
022080                      STRING ہ|یҖ     DELIMITED BY SPACE
022090                             "Ngی"     DELIMITED BY SIZE
018100                             "  "               DELIMITED BY SIZE
022110                             ہ|x     DELIMITED BY SPACE
023960*                             " a"              DELIMITED BY SIZE
022120                             INTO 於̂v
022130                      END-STRING
                        END-IF
022140* ς͎x܂ň
022150             WHEN 04
024700*/               {wZUEώƒc(34130021)̏ꍇA"ϑg"tȂB
024710                 IF ( ہ|یҔԍ = "34130021" )
022160                     STRING ہ|یҖ DELIMITED BY SPACE
023960*                            " a"          DELIMITED BY SIZE
022200                            INTO 於̂v
022210                     END-STRING
024730                 ELSE
                           IF ہ|x = SPACE
022160                         STRING ہ|یҖ     DELIMITED BY SPACE
022170                                "ϑg"         DELIMITED BY SIZE
023960*                                " a"              DELIMITED BY SIZE
022200                                INTO 於̂v
022210                         END-STRING
                           ELSE
022160                         STRING ہ|یҖ     DELIMITED BY SPACE
022170                                "ϑg"         DELIMITED BY SIZE
018100                                "  "               DELIMITED BY SIZE
022190                                ہ|x     DELIMITED BY SPACE
023960*                                " a"              DELIMITED BY SIZE
022200                                INTO 於̂v
022210                         END-STRING
                           END-IF
                       END-IF
022220             WHEN OTHER
022230*                 MOVE ہ|یҖ   TO 於̂v
022160                 STRING ہ|یҖ DELIMITED BY SPACE
023960*                        " a"          DELIMITED BY SIZE
022200                        INTO 於̂v
022210                 END-STRING
022240             END-EVALUATE
022250         END-READ
           END-IF.
022260*
022270*================================================================*
       {phc擾 SECTION.
      *
026770*********************************************
026780** hcǗ}X^@{phc擾B
026790*********************************************
026800     EVALUATE یʂvq 
026810* 
026820         WHEN 01
026830            MOVE یҔԍvq(1:2)  TO hcǁ|ی
026840* 
026850         WHEN 04
026840* ސE
026850         WHEN 08
026860* 
026870         WHEN 05
026880            MOVE یҔԍvq(3:2)  TO hcǁ|ی
026890     END-EVALUATE.
026900**   / {pID /
026910     MOVE 01                     TO hcǁ|hc敪.
026920     MOVE ZERO                   TO hcǁ|{pԍ.
026940     MOVE SPACE                  TO hcǁ|یҔԍ.
026950     READ hcǗ}X^
026960     NOT INVALID KEY
026970         MOVE hcǁ|{phcԍ   TO {phcv
026980     END-READ.
022270*================================================================*
036380 {擾 SECTION.
036390*
036400     MOVE 01                TO `|敪R[h.
036410     MOVE ZERO              TO `|.
036420     MOVE ZERO              TO `|.
036430     MOVE ZERO              TO `|E敪.
036440     MOVE ZERO              TO `|ʒuԍ.
036450     MOVE {pavq      TO `|Jna.
036460     MOVE {pNvq        TO `|JnN.
036470     MOVE {pvq        TO `|Jn.
036480     START }X^ KEY IS <= |敪R[h
036490                                |ʃR[h
036500                                |JnaN
036510                                REVERSED
036520     END-START.
036530     READ }X^ NEXT
036540     NOT AT END
036550         MOVE `|㪖@   TO 㪖@Pv
036560         MOVE `|㪖@   TO 㪖@Pv
036570         MOVE `|d×     TO dÒPv
036580     END-READ.
036590*
040580*================================================================*
040590 Ev擾 SECTION.
040600*
040610* Ev擾 "TEKIYBUN" Ă. 
040620     MOVE  SPACE TO  AE|L[.
040630     INITIALIZE      AE|L[.
040640     MOVE {pavq  TO  AE|{pa.
040650     MOVE {pNvq    TO  AE|{pN.
040660     MOVE {pvq    TO  AE|{p.
040670     MOVE Ҕԍvq  TO  AE|Ҕԍ.
040680     MOVE }Ԃvq      TO  AE|}.
040700*     MOVE 63            TO  AE|.
039370     MOVE 56            TO  AE|.
015000     IF (ZR敪v NOT = 1 )
               MOVE R敪v TO AE|敪
           ELSE
               MOVE 1                  TO AE|敪
015050     END-IF.
040710*
040720     CALL   "TEKIYBUN".
040730     CANCEL "TEKIYBUN".
040740*
040820*================================================================*
040830 oߎ擾 SECTION.
040840*================================================================*
036040     MOVE  SPACE TO  Aԁ|L[.
036050     INITIALIZE      Aԁ|L[.
036060     MOVE {pavq  TO  Aԁ|{pa.
036070     MOVE {pNvq    TO  Aԁ|{pN.
036080     MOVE {pvq    TO  Aԁ|{p.
036090     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
036100     MOVE }Ԃvq      TO  Aԁ|}.
036110*
036120     CALL   "CHOUKI".
036130     CANCEL "CHOUKI".
036140*
      */PEŖoE͓]Aɂ炸Rȏ́uǍDvA
      */ȊOׂ͂āuǍDvɂ@@@@@@@@@@@@@@@@/151217
031620     PERFORM VARYING ʂbms FROM 1 BY 1
031630             UNTIL ( ʂbms > ʐv )
028850              EVALUATE ʂbms
028860              WHEN 1
028870                  MOVE NC"@" TO oߕʂv
028880              WHEN 2
028890                  MOVE NC"A" TO oߕʂv
028900              WHEN 3
028910                  MOVE NC"B" TO oߕʂv
028920              WHEN 4
028930                  MOVE NC"C" TO oߕʂv
028940              WHEN 5
028950                  MOVE NC"D" TO oߕʂv
028960              END-EVALUATE
              IF |(ʂbms) = 01 OR 02 OR 03
040850*           IF ( |]A敪(ʂbms) NOT = 1 AND 2)
040900              IF ( Aԁ|Ԃv(ʂbms)  >= 3 )
040910                 MOVE NC"ǍD" TO  o߂bl
040920              ELSE
040930                 MOVE NC"ǍD"     TO  o߂bl
040940              END-IF
              ELSE
040930              MOVE NC"ǍD"     TO  o߂bl
040950*           END-IF
              END-IF
028970              STRING  oߕʂv     DELIMITED BY SPACE
028980                      o߂bl       DELIMITED BY SPACE
028990                 INTO oߗ̂v(ʂbms)
029000              END-STRING
           END-PERFORM.
040960*
036600*================================================================*
044190******************************************************************
044200 END PROGRAM YGN612.
044210******************************************************************
