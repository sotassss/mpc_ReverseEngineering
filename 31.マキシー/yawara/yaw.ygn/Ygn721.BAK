000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YGN721.
000060 AUTHOR.                 rc@Kq
000070*
000080*----------------------------------------------------------------*
000090*         Jeijyް쐬z_+޳ޔ
000100*         MED = YGN720 
000110*----------------------------------------------------------------*
000120 DATE-WRITTEN.           2016-04-07
000130 DATE-COMPILED.          2016-04-07
      *
000140*----------------------------------------------------------------*
000150******************************************************************
000160*            ENVIRONMENT         DIVISION                        *
000170******************************************************************
000180 ENVIRONMENT             DIVISION.
000190 CONFIGURATION           SECTION.
000200 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000210 OBJECT-COMPUTER.        FMV-DESKPOWER.
000220 SPECIAL-NAMES.          CONSOLE  IS  CONS
000230                         SYSERR   IS  MSGBOX.
000240 INPUT-OUTPUT            SECTION.
000250 FILE-CONTROL.
000260     SELECT  }X^      ASSIGN      TO        GENGOUL
000270                             ORGANIZATION             IS  INDEXED
000280                             ACCESS MODE              IS  DYNAMIC
000290                             RECORD KEY               IS  |敪
000300                             FILE STATUS              IS  ԃL[
000310                             LOCK        MODE         IS  AUTOMATIC.
000320     SELECT  fҏe    ASSIGN      TO        JUSINJL
000330                             ORGANIZATION             IS  INDEXED
000340                             ACCESS MODE              IS  DYNAMIC
000350                             RECORD KEY               IS  |{paN
000360                                                          |҃R[h
000370                             ALTERNATE RECORD KEY     IS  |{paN
000380                                                          |҃Ji
000390                                                          |҃R[h
000400                             ALTERNATE RECORD KEY     IS  |҃R[h
000410                                                          |{paN
000420                             ALTERNATE RECORD KEY     IS  |{paN
000430                                                          |ی
000440                                                          |یҔԍ
000450                                                          |҃R[h
000460                             ALTERNATE RECORD KEY     IS  |{paN
000470                                                          |
000480                                                          |pSҔԍ
000490                                                          |҃R[h
000500                             ALTERNATE RECORD KEY     IS  |{paN
000510                                                          |
000520                                                          |pSҔԍ
000530                                                          |҃R[h
000540                             ALTERNATE RECORD KEY     IS  |aN
000550                                                          |{paN
000560                                                          |҃R[h
000570                             FILE STATUS              IS  ԃL[
000580                             LOCK        MODE         IS  AUTOMATIC.
000590     SELECT  f[^e    ASSIGN      TO        HUSYOUL
000600                             ORGANIZATION             IS  INDEXED
000610                             ACCESS MODE              IS  DYNAMIC
000620                             RECORD KEY               IS  |{paN
000630                                                          |҃R[h
000640                             ALTERNATE RECORD KEY     IS  |҃R[h
000650                                                          |{paN
000660                             FILE STATUS              IS  ԃL[
000670                             LOCK        MODE         IS  AUTOMATIC.
000680     SELECT  {pL^e      ASSIGN      TO      SEKIROKL
000690                             ORGANIZATION        IS  INDEXED
000700                             ACCESS MODE         IS  DYNAMIC
000710                             RECORD KEY          IS  {L|{paN
000720                                                     {L|҃R[h
000730                             ALTERNATE RECORD KEY IS {L|҃R[h
000740                                                     {L|{paN
000750                             FILE STATUS              IS  ԃL[
000760                             LOCK        MODE         IS  AUTOMATIC.
000770     SELECT  t@C    ASSIGN      TO        MEMOL
000780                             ORGANIZATION             IS  INDEXED
000790                             ACCESS MODE              IS  DYNAMIC
000800                             RECORD KEY               IS  |敪
000810                                                          |҃R[h
000820                                                          |{paN
000830                             ALTERNATE RECORD KEY     IS  |敪
000840                                                          |{paN
000850                                                          |҃R[h
000860                             ALTERNATE RECORD KEY     IS  |҃R[h
000870                                                          |{paN
000880                                                          |敪
000890                             FILE STATUS              IS  ԃL[
000900                             LOCK        MODE         IS  AUTOMATIC.
000910     SELECT  Zvge      ASSIGN      TO        RECEPTL
000920                             ORGANIZATION             IS  INDEXED
000930                             ACCESS MODE              IS  DYNAMIC
000940                             RECORD KEY               IS  Z|{paN
000950                                                          Z|҃R[h
000960                                                          Z|Z
000970                             ALTERNATE RECORD KEY     IS  Z|҃R[h
000980                                                          Z|{paN
000990                                                          Z|Z
001000                             ALTERNATE RECORD KEY     IS  Z|aN
001010                                                          Z|{paN
001020                                                          Z|҃R[h
001030                                                          Z|Z
001040                             ALTERNATE RECORD KEY     IS  Z|aN
001050                                                          Z|Z
001060                                                          Z|یҔԍ
001070                                                          Z|҃R[h
001080                                                          Z|{paN
001090                             ALTERNATE RECORD KEY     IS  Z|aN
001100                                                          Z|یҔԍ
001110                                                          Z|҃R[h
001120                                                          Z|Z
001130                                                          Z|{paN
001140                             FILE STATUS              IS  ԃL[
001150                             LOCK        MODE         IS  AUTOMATIC.
001160     SELECT  vf[^e    ASSIGN      TO        KAIKEIL
001170                             ORGANIZATION             IS  INDEXED
001180                             ACCESS MODE              IS  DYNAMIC
001190                             RECORD KEY               IS  |{paN
001200                                                          |҃R[h
001210                             ALTERNATE RECORD KEY     IS  |҃R[h
001220                                                          |{paN
001230                             FILE STATUS              IS  ԃL[
001240                             LOCK        MODE         IS  AUTOMATIC.
001250     SELECT  ƃt@CP  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W7211L.DAT"
001260                             ORGANIZATION             IS  INDEXED
001270                             ACCESS                   IS  DYNAMIC
001280                             RECORD      KEY          IS  P|{paN
001290                                                          P|҃R[h
001300                             ALTERNATE RECORD KEY     IS  P|{paN
001310                                                          P|҃Ji
001320                                                          P|҃R[h
001330                             ALTERNATE RECORD KEY     IS  P|҃R[h
001340                                                          P|{paN
001350                             ALTERNATE RECORD KEY     IS  P|҃Ji
001360                                                          P|҃R[h
001370                                                          P|{paN
001380                             FILE        STATUS       IS  ԃL[
001390                             LOCK        MODE         IS  AUTOMATIC.
001400     SELECT  ƃt@CQ  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W7212L.DAT"
001410                             ORGANIZATION             IS  INDEXED
001420                             ACCESS                   IS  DYNAMIC
001430                             RECORD      KEY          IS  Q|{paN
001440                                                          Q|҃R[h
001450                             FILE        STATUS       IS  ԃL[
001460                             LOCK        MODE         IS  AUTOMATIC.
001610******************************************************************
001620*                      DATA DIVISION                             *
001630******************************************************************
001640 DATA                    DIVISION.
001650 FILE                    SECTION.
001660*                           mqk  PQWn
001670 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001680     COPY GENGOU          OF  XFDLIB  JOINING      AS  PREFIX.
001690*                           mqk  RQOn
001700 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
001710     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
001720*                           mqk  QTUn
001730 FD  {pL^e          BLOCK   CONTAINS   1   RECORDS.
001740    COPY SEKIROK         OF  XFDLIB  JOINING   {L AS  PREFIX.
001750*                           mqk  PQWn
001760 FD  f[^e        BLOCK   CONTAINS   1   RECORDS.
001770     COPY HUSYOU          OF  XFDLIB  JOINING      AS  PREFIX.
001780*                           mqk  WRQn
001790 FD  t@C        BLOCK CONTAINS 1     RECORDS.
001800     COPY MEMO           OF    XFDLIB JOINING  AS PREFIX.
001810*                          mqk  PTRUn
001820 FD  Zvge          BLOCK   CONTAINS   1   RECORDS.
001830     COPY RECEPT          OF  XFDLIB  JOINING   Z  AS  PREFIX.
001840*                           mqk  TPQn
001850 FD  vf[^e        BLOCK   CONTAINS   1   RECORDS.
001860     COPY KAIKEI     OF  XFDLIB  JOINING      AS  PREFIX.
001870**************************
001880* ƃt@CP^Je *
001890**************************
001900*                         mqk  QVQn
001910 FD  ƃt@CP RECORD  CONTAINS 272 CHARACTERS.
001920 01 P|R[h.
001930    03 P|R[hL[.
001940       05 P|{paN.
001950          07 P|{pa               PIC 9.
001960          07 P|{pN.
001970             09 P|{pN              PIC 9(2).
001980             09 P|{p              PIC 9(2).
001990          07 P|{p                 PIC 9(2).
002000       05 P|҃R[h.
002010          07 P|Ҕԍ                PIC 9(6).
002020          07 P|}                    PIC X(1).
002030    03 P|R[hf[^.
002100       05 P|҃Ji                   PIC X(50).
002110       05 P|Ҏ                   PIC X(50).
002130       05 P|.
001550          07 P|z                PIC 9(5).
                07 P|                    OCCURS 4.
001550             09 P|z             PIC 9(5).
001550          07 P|̑                  PIC 9(5).
001550          07 P|㪖@                  PIC 9(5).
001550          07 P|q                PIC 9(5).
001550          07 P|×                  PIC 9(5).
002300          07 P|pz                  PIC 9(6).
002270          07 P|ꕔS              PIC 9(5).
002280          07 P|Rg                PIC X(100).
002310       05 FILLER                           PIC X(2).
002320*
002330*                         mqk  PQWn
002340 FD  ƃt@CQ RECORD  CONTAINS 128 CHARACTERS.
002350 01 Q|R[h.
002360    03 Q|R[hL[.
002370       05 Q|{paN.
002380          07 Q|{pa                PIC 9.
002390          07 Q|{pN.
002400             09 Q|{pN               PIC 9(2).
002410             09 Q|{p               PIC 9(2).
002420       05 Q|҃R[h.
002430          07 Q|Ҕԍ                PIC 9(6).
002440          07 Q|}                    PIC X(1).
002450    03 Q|R[hf[^.
002610       05 Q|z                     PIC 9(6).
002620       05 Q|                     PIC 9(6).
             05 Q|                       OCCURS 4.
001550          07 Q|z                PIC 9(6).
001550       05 Q|̑                     PIC 9(6).
001550       05 Q|㪖@                     PIC 9(6).
001550       05 Q|q                   PIC 9(6).
001550       05 Q|×                     PIC 9(6).
002600       05 Q|pz                     PIC 9(6).
002710       05 FILLER                           PIC X(50).
002720*
003570*----------------------------------------------------------------*
003580******************************************************************
003590*                WORKING-STORAGE SECTION                         *
003600******************************************************************
003610 WORKING-STORAGE         SECTION.
003620 01 L[                           PIC X    VALUE SPACE.
003630 01 ԃL[                           PIC X(2) VALUE SPACE.
003640 01 ItO                         PIC X(3) VALUE SPACE.
003650 01 ItOQ                       PIC X(3) VALUE SPACE.
003660 01 ItOR                       PIC X(3) VALUE SPACE.
003670 01 t@C                         PIC N(2) VALUE SPACE.
003680 01 sL[v                         PIC X(4) VALUE SPACE.
003690 01 {pL^Lv                       PIC X(3) VALUE SPACE.
003700 01 ptO                         PIC X(3) VALUE SPACE.
003710 01 ΏۃtO                         PIC X(3) VALUE SPACE.
003720 01 ʂbms                         PIC 9    VALUE ZERO.
003730 01 JE^                           PIC 9    VALUE ZERO.
003740 01 tO                     PIC 9    VALUE ZERO.
003750 01 tO                         PIC X(3) VALUE SPACE.
003760* **************
003770* * ڑҔp 
003780* **************
003790 01 Ҕڂvq.
003800    03 {paNvq.
003810       05 {pavq                 PIC 9(1) VALUE ZERO.
003820       05 {pNvq                   PIC 9(2) VALUE ZERO.
003830       05 {pvq                   PIC 9(2) VALUE ZERO.
003840    03 {pvq                      PIC 9(2) VALUE ZERO.
003850    03 Jnvo                      PIC 9(2) VALUE ZERO.
003860    03 Ivo                      PIC 9(2) VALUE ZERO.
003870    03 JnaNvq.
003880       05 JnaNvq.
003890          07 Jnavq              PIC 9(1) VALUE ZERO.
003900          07 JnNvq                PIC 9(2) VALUE ZERO.
003910          07 Jnvq                PIC 9(2) VALUE ZERO.
003920       05 Jnvq                   PIC 9(2) VALUE ZERO.
003930    03 IaNvq.
003940       05 IaNvq.
003950          07 Iavq              PIC 9(1) VALUE ZERO.
003960          07 INvq                PIC 9(2) VALUE ZERO.
003970          07 Ivq                PIC 9(2) VALUE ZERO.
003980       05 Ivq                   PIC 9(2) VALUE ZERO.
004000    03 یʂvq                    PIC 9(2) VALUE ZERO.
004010    03 ҃R[hvq.
004020       05 Ҕԍvq                 PIC 9(6) VALUE ZERO.
004030       05 }Ԃvq                     PIC X(1) VALUE SPACE.
004040    03 {lƑ敪vq                PIC 9(1) VALUE ZERO.
004050*
004060    03 vq                    PIC 9(2) VALUE ZERO.
004070*
004080 01 SҔԍv.
004090    03 @ʔԍv                      PIC X(2) VALUE SPACE.
004100    03 FILLER                          PIC X(8) VALUE SPACE.
004110 01 ޔڂfv.
004120   03 Zvgނv                 PIC X(4).
004130   03 Zvgނfv               PIC X(4).
004140   03 Zvgʂfv               PIC 9(2).
004150*
004160 01 .
004170    03 vq                    PIC 9(4)  VALUE ZERO.
004180    03 kvq                    PIC 9(4)  VALUE ZERO.
004190    03 Zvq                PIC 9(4)  VALUE ZERO.
004200    03 xvq                      PIC 9     VALUE ZERO.
004210    03 [vq                      PIC 9     VALUE ZERO.
004220    03 ԊOvq                    PIC 9     VALUE ZERO.
004230    03 fÎvq                    PIC 9(2)  VALUE ZERO.
004240    03 fÕvq                    PIC 9(2)  VALUE ZERO.
          03 kvq              PIC 9(4)  VALUE ZERO.
004250    03 Čvq                    PIC 9(4)  VALUE ZERO.
004260    03 ÖԂvq                  PIC 9     VALUE ZERO.
004270    03 ÓHvq                  PIC 9     VALUE ZERO.
004280    03 Ö\vq                  PIC 9     VALUE ZERO.
004290    03 É񐔂vq                  PIC 9(2)  VALUE ZERO.
004300    03 Ëvq                  PIC 9(3)V9 VALUE ZERO.
004310    03 ×vq                    PIC 9(6)  VALUE ZERO.
004320    03 ÉZvq                PIC 9(5)  VALUE ZERO.
004330    03 d㪗vq                    PIC 9(4)  VALUE ZERO.
004340    03 ꕔSvq                PIC 9(5)  VALUE ZERO.
004350    03 qZvq            PIC 9(5)  VALUE ZERO.
004360    03 {p񋟗vq            PIC 9(6)  VALUE ZERO.
004370    03 ʂv                        OCCURS 7.
004380       05 񏈒uvq             PIC 9(4)  VALUE ZERO.
004390       05 ×vq                 PIC 9(4)  VALUE ZERO.
004400       05 㪗vq                 PIC 9(4)  VALUE ZERO.
004410       05 㪗vq                 PIC 9(4)  VALUE ZERO.
004420       05 d×vq                 PIC 9(4)  VALUE ZERO.
004430       05 ʌvvq                 PIC 9(4)  VALUE ZERO.
004440       05 vq                   PIC 9     VALUE ZERO.
004450    03 vq                      PIC 9(2)  OCCURS 7 VALUE ZERO.
004460    03 㪖@ROvq              PIC 9(4)  VALUE ZERO.
004470    03 㪖@RWvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@SOvq              PIC 9(4)  VALUE ZERO.
004490    03 㪖@STvq              PIC 9(4)  VALUE ZERO.
004500    03 㪖@SWvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@TOvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@TQvq              PIC 9(4)  VALUE ZERO.
004490    03 㪖@TTvq              PIC 9(4)  VALUE ZERO.
004500    03 㪖@TWvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@UOvq              PIC 9(4)  VALUE ZERO.
004500    03 㪖@UWvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@VOvq              PIC 9(4)  VALUE ZERO.
004500    03 㪖@VWvq              PIC 9(4)  VALUE ZERO.
004510    03 㪖@ROvq              PIC 9(4)  VALUE ZERO.
004520    03 㪖@RWvq              PIC 9(4)  VALUE ZERO.
004530    03 㪖@SOvq              PIC 9(4)  VALUE ZERO.
004540    03 㪖@STvq              PIC 9(4)  VALUE ZERO.
004550    03 㪖@SWvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@TOvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@TQvq              PIC 9(4)  VALUE ZERO.
004490    03 㪖@TTvq              PIC 9(4)  VALUE ZERO.
004500    03 㪖@TWvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@UOvq              PIC 9(4)  VALUE ZERO.
004500    03 㪖@UWvq              PIC 9(4)  VALUE ZERO.
004480    03 㪖@VOvq              PIC 9(4)  VALUE ZERO.
004500    03 㪖@VWvq              PIC 9(4)  VALUE ZERO.
004560    03 d×ROvq                PIC 9(4)  VALUE ZERO.
004570    03 d×RWvq                PIC 9(4)  VALUE ZERO.
004580    03 d×SOvq                PIC 9(4)  VALUE ZERO.
004590    03 d×STvq                PIC 9(4)  VALUE ZERO.
004600    03 d×SWvq                PIC 9(4)  VALUE ZERO.
004480    03 d×TOvq                PIC 9(4)  VALUE ZERO.
004480    03 d×TQvq                PIC 9(4)  VALUE ZERO.
004490    03 d×TTvq                PIC 9(4)  VALUE ZERO.
004500    03 d×TWvq                PIC 9(4)  VALUE ZERO.
004480    03 d×UOvq                PIC 9(4)  VALUE ZERO.
004500    03 d×UWvq                PIC 9(4)  VALUE ZERO.
004480    03 d×VOvq                PIC 9(4)  VALUE ZERO.
004500    03 d×VWvq                PIC 9(4)  VALUE ZERO.
004610    03 ×ROvq                PIC 9(4)  VALUE ZERO.
004620    03 ×RWvq                PIC 9(4)  VALUE ZERO.
004630    03 ×SOvq                PIC 9(4)  VALUE ZERO.
004640    03 ×STvq                PIC 9(4)  VALUE ZERO.
004650    03 ×SWvq                PIC 9(4)  VALUE ZERO.
004480    03 ×TOvq                PIC 9(4)  VALUE ZERO.
004480    03 ×TQvq                PIC 9(4)  VALUE ZERO.
004490    03 ×TTvq                PIC 9(4)  VALUE ZERO.
004500    03 ×TWvq                PIC 9(4)  VALUE ZERO.
004480    03 ×UOvq                PIC 9(4)  VALUE ZERO.
004500    03 ×UWvq                PIC 9(4)  VALUE ZERO.
004480    03 ×VOvq                PIC 9(4)  VALUE ZERO.
004500    03 ×VWvq                PIC 9(4)  VALUE ZERO.
004660    03 㪗vvq                  PIC 9(4)  VALUE ZERO.
004670    03 㪗vvq                  PIC 9(4)  VALUE ZERO.
004680    03 d×vvq                  PIC 9(4)  VALUE ZERO.
002100*
       01 Wvv.
001600    03 vv                      PIC 9(6)  VALUE ZERO.
          03 v                        OCCURS 4.
001600       05 vv                   PIC 9(6)  VALUE ZERO.
001800    03 Ìvv                      PIC 9(6)  VALUE ZERO.
001810    03 㪖@vv                      PIC 9(6)  VALUE ZERO.
001830    03 dÌvv                      PIC 9(6)  VALUE ZERO.
001830    03 pvv                      PIC 9(6)  VALUE ZERO.
004690*
004770** p
004780 01 {pNv                     PIC 9(4)  VALUE ZERO.
004790 01 v                             PIC 9(3)  VALUE ZERO.
004800 01 ]v                             PIC 9(3)  VALUE ZERO.
004810*
004820*/fobNp
004830 01 .
004840   03  PIC 9(2) VALUE ZERO.
004850   03  PIC 9(2) VALUE ZERO.
004860   03 b PIC 9(2) VALUE ZERO.
004870 01 v PIC 9(6) VALUE ZERO.
004880******************************************************************
004890*                          A                              *
004900******************************************************************
004910*
004920************
004930* ̓L[ *
004940************
004950*
004960 01 A|̓f[^xfmVQO IS EXTERNAL.
004970    03 A|JnaN.
004980       05 A|Jna                  PIC 9(1).
004990       05 A|JnN                    PIC 9(2).
005000       05 A|Jn                    PIC 9(2).
005010       05 A|Jn                    PIC 9(2).
005020    03 A|IaN.
005030       05 A|Ia                  PIC 9(1).
005040       05 A|IN                    PIC 9(2).
005050       05 A|I                    PIC 9(2).
005060       05 A|I                    PIC 9(2).
005080    03 A|ی                     PIC 9(2).
005090    03 A|{lƑ敪                 PIC 9(1).
005100    03 A|҃R[h.
005110       05 A|Ҕԍ                  PIC 9(6).
005120       05 A|}                      PIC X(1).
005140    03 A|                     PIC 9(2).
005420**********************
005430* bZ[W\L[ *
005440**********************
005450 01 A|L[ IS EXTERNAL.
005460    03  A|bZ[W                 PIC N(20).
005470**
005660******************************************************************
005670*                      PROCEDURE  DIVISION                       *
005680******************************************************************
005690 PROCEDURE               DIVISION.
005700************
005710*           *
005720*    *
005730*           *
005740************
005750     PERFORM .
005760************
005770*           *
005780* 又     *
005790*           *
005800************
005810     MOVE ZERO TO tO.
005940     PERFORM ƃt@C쐬
005970     IF tO = ZERO
006000         MOVE  NC"@̑ΏۂɂȂf[^܂B" TO A|bZ[W
006010         CALL   "MSG001"
006020         CANCEL "MSG001"
006040         MOVE 01   TO PROGRAM-STATUS
006050     ELSE
006060         MOVE ZERO TO PROGRAM-STATUS
006080     END-IF.
006090************
006100*           *
006110* I   *
006120*           *
006130************
006140     PERFORM I.
006150*     MOVE ZERO TO PROGRAM-STATUS.
006160     EXIT PROGRAM.
006170*
006180*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
006190*================================================================*
006200  SECTION.
006210*
006220     PERFORM t@CI[v.
006230* Aڂ̑Ҕ
006240     INITIALIZE Ҕڂvq.
006260     MOVE A|ی      TO یʂvq.
006270     MOVE A|Ҕԍ      TO Ҕԍvq.
006280     MOVE A|}          TO }Ԃvq.
006290     MOVE A|Jna      TO Jnavq.
006300     MOVE A|JnN        TO JnNvq.
006310     MOVE A|Jn        TO Jnvq.
006320     MOVE A|Jn        TO Jnvq.
006330     MOVE A|Ia      TO Iavq.
006340     MOVE A|IN        TO INvq.
006350     MOVE A|I        TO Ivq.
006360     MOVE A|I        TO Ivq.
006370     MOVE A|{lƑ敪  TO {lƑ敪vq.
006380*
006390     MOVE A|      TO vq.
006400*================================================================*
006410 t@CI[v SECTION.
006420*
006430     OPEN INPUT   }X^
006440         MOVE NC"" TO t@C.
006450         PERFORM I[v`FbN.
006460     OPEN INPUT fҏe.
006470         MOVE NC"fҏe" TO t@C.
006480         PERFORM I[v`FbN.
006490     OPEN INPUT f[^e.
006500         MOVE NC"f[^e" TO t@C.
006510         PERFORM I[v`FbN.
006520     OPEN INPUT {pL^e.
006530         MOVE NC"{pL^e"   TO t@C.
006540         PERFORM I[v`FbN.
006550     OPEN INPUT t@C.
006560         MOVE NC""         TO t@C.
006570         PERFORM I[v`FbN.
006580     OPEN INPUT Zvge.
006590         MOVE NC"Z"         TO t@C.
006600         PERFORM I[v`FbN.
006610     OPEN INPUT vf[^e.
006620         MOVE NC"v" TO t@C.
006630         PERFORM I[v`FbN.
006640*================================================================*
006650 I[v`FbN SECTION.
006660*
006670     IF ԃL[  NOT =  "00"
006680         DISPLAY t@C NC"eI[vG[" UPON CONS
006690         DISPLAY NC"ԃL[F" ԃL[         UPON CONS
006700         DISPLAY NC"P͂dmsdqL[Ă"
006710                                                 UPON CONS
006720*-----------------------------------------*
006730         CALL "actcshm"  WITH C LINKAGE
006740*-----------------------------------------*
006750         ACCEPT  L[ FROM CONS
006760         PERFORM t@C
006770         MOVE 99 TO PROGRAM-STATUS
006780         EXIT PROGRAM.
006790*================================================================*
006800 t@C SECTION.
006810*
006820     CLOSE }X^  fҏe f[^e {pL^e
006830           t@C Zvge  vf[^e.
006840*================================================================*
006850 I SECTION.
006860*
006870     PERFORM t@C.
006880*================================================================*
006890 G[\ SECTION.
006900*
006910     DISPLAY NC"ԃL[" ԃL[  UPON CONS.
006920     DISPLAY NC"Tt@CG[F" t@C   UPON CONS.
006930     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
006940     DISPLAY NC"P͂dmsdqL[Ă"                                                                    UPON CONS.
006950*-----------------------------------------*
006960     CALL "actcshm"  WITH C LINKAGE.
006970*-----------------------------------------*
006980     ACCEPT  L[ FROM CONS.
006990     PERFORM t@C.
007000     MOVE 99 TO PROGRAM-STATUS.
007010     EXIT PROGRAM.
007020*================================================================*
007030 fҏeǍ SECTION.
007040*
007050     READ fҏe NEXT
007060     AT END
007070         MOVE "YES" TO ItO
007080     END-READ.
007090*================================================================*
007100 ƃt@C쐬 SECTION.
007110*
007120     OPEN OUTPUT ƃt@CP
007130          MOVE NC"P" TO t@C
007140          PERFORM I[v`FbN
007150     OPEN OUTPUT ƃt@CQ
007160          MOVE NC"Q" TO t@C
007170          PERFORM I[v`FbN
007180*
007190     MOVE Jnavq      TO |{pa.
007200     MOVE JnNvq        TO |{pN.
007210     MOVE Jnvq        TO |{p.
007220     MOVE SPACE             TO |҃Ji.
007230     MOVE SPACE             TO |҃R[h.
007240     START fҏe   KEY IS >= |{paN
007250                                    |҃Ji
007260                                    |҃R[h
007270     END-START.
007280     IF ԃL[ = "00"
007290         MOVE SPACE  TO ItO
007300         PERFORM fҏeǍ
007310         PERFORM UNTIL ( ItO = "YES" ) OR
007320                       ( |{paN > IaNvq )
007330*/Ώۏ̔
007340                 IF ((یʂvq     NOT = ZERO)              AND
007350                     (یʂvq     NOT = |ی))     OR
007360                    ((Ҕԍvq    NOT = ZERO)               AND
007370                     (҃R[hvq   NOT = |҃R[h))   OR
007380                    (({lƑ敪vq NOT = ZERO)              AND
007390                     ({lƑ敪vq NOT = |{lƑ敪)) OR
007400                     (|ی         = 70 OR 80 OR 90)
007410*/ΏۊO
007420                     CONTINUE
007430                 ELSE
007440*/vqۗ
007450                     MOVE "YES" TO ΏۃtO
007460                     IF vq NOT = ZERO
007470                         PERFORM 
007480                     END-IF
007490                     IF ΏۃtO = "YES"
007500                         PERFORM f[^`FbN
007510                         IF sL[v = "YES"
007520                             MOVE |{paN TO {paNvq
007530                             IF |{paN = JnaNvq
007540                                 MOVE Jnvq TO Jnvo
007550                             ELSE
007560                                 MOVE 1          TO Jnvo
007570                             END-IF
007580                             IF |{paN = IaNvq
007590                                 MOVE Ivq TO Ivo
007600                             ELSE
007610                                 PERFORM 擾
007620                             END-IF
007630                             PERFORM PR[hZbg
007640*/Ώۃf[^̂݌vZ悤ɕύX
007650                             IF tO = "YES"
007660                                 PERFORM QR[hZbg
007670                             END-IF
                               END-IF
007690                     END-IF
007700                 END-IF
007710                 PERFORM fҏeǍ
007720         END-PERFORM
007730     END-IF.
007740     CLOSE ƃt@CP ƃt@CQ.
007750*================================================================*
007760 PR[hZbg SECTION.
007770*
007780     MOVE SPACE TO tO.
007790     INITIALIZE P|R[h.
007860     MOVE |҃R[h   TO P|҃R[h.
007870     MOVE |҃Ji     TO P|҃Ji.
007880     MOVE |Ҏ     TO P|Ҏ.
007890     PERFORM VARYING {pvq FROM Jnvo BY 1
007900             UNTIL ( {pvq > Ivo )
007910         INITIALIZE P|
007920         MOVE |Ҕԍ  TO |Ҕԍ {L|Ҕԍ
007930         MOVE |}      TO |}     {L|}
007940         MOVE |{pa  TO |{pa {L|{pa
007950         MOVE |{pN    TO |{pN   {L|{pN
007960         MOVE |{p    TO |{p   {L|{p
007970         MOVE {pvq    TO |{p   {L|{p
007980         READ vf[^e
007990         NOT INVALID KEY
008050             MOVE "YES" TO tO
008060*
008390             READ {pL^e
008420             END-READ
008630             PERFORM 擾
008080             PERFORM ڂƌvZ
008090             PERFORM ƃt@CZbg
008100             PERFORM PR[h
008110         END-READ
008120     END-PERFORM.
008290*================================================================*
008300 ƃt@CZbg SECTION.
008310*
008320     MOVE |{pa       TO P|{pa |{pa.
008330     MOVE |{pN         TO P|{pN |{pN.
008340     MOVE |{p         TO P|{p |{p.
008350     MOVE {pvq         TO P|{p |{p.
008370     MOVE 1                  TO |敪.
008380     MOVE |҃R[h     TO |҃R[h.
008390     READ t@C
008400     NOT INVALID KEY
008410        MOVE |{pRg TO P|Rg
           END-READ.
008450*================================================================*
008460 ƂQt@CZbg SECTION.
008470*
008480     MOVE |{pa       TO Q|{pa.
008490     MOVE |{pN         TO Q|{pN.
008500     MOVE |{p         TO Q|{p.
           MOVE vv           TO Q|.
013060     PERFORM VARYING JE^ FROM 1 BY 1
013070             UNTIL ( JE^ > 4 )
               MOVE vv(JE^)    TO Q|z(JE^)
           END-PERFORM.
           MOVE {p񋟗vq TO Q|̑.
           MOVE qZvq TO Q|q.
           MOVE 㪖@vv           TO Q|㪖@.
           MOVE Ìvv           TO Q|×.
008570*================================================================*
008580 QR[hZbg SECTION.
008590*
008600     INITIALIZE Q|R[h.
           INITIALIZE Wvv.
008620     MOVE |҃R[h   TO Q|҃R[h.
           PERFORM VARYING {pvq FROM 1 BY 1
                   UNTIL ( {pvq > 31 )
               INITIALIZE P|
009770         MOVE |Ҕԍ  TO |Ҕԍ
009780         MOVE |}      TO |}
009790         MOVE |{pa  TO |{pa
009800         MOVE |{pN    TO |{pN
009810         MOVE |{p    TO |{p
009820         MOVE {pvq    TO |{p
009830         READ vf[^e
               NOT INVALID KEY
                   PERFORM Wv
               END-READ
           END-PERFORM.
008630     PERFORM 擾Q.
008780     PERFORM ƂQt@CZbg.
008790     PERFORM QR[h.
010900*================================================================*
010910 擾 SECTION.
010920*
010930***********************************************
010940* f[^Zbg                            *
010950***********************************************
010960*    ****************************************************************
010970*    * ijijijɂĂ͘AڂZbg *
010980*    ****************************************************************
010990     MOVE |             TO  vq.
011000*
011010     MOVE |Z         TO  Zvq.
           MOVE |k       TO  kvq.
011050     MOVE |Č             TO  Čvq.
011080     MOVE |×             TO  ×vq.
011090     MOVE |ÉZ         TO  ÉZvq.
011130*
011140     MOVE |qZ     TO  P|q.
011150*
011160     MOVE |{p񋟗     TO  P|̑.
      *
           COMPUTE P|z = vq + Zvq + Čvq + kvq.
      *
           COMPUTE P|×   = ×vq + ÉZvq.
011360*
           MOVE |ꕔS     TO P|ꕔS.
008440     MOVE |pz         TO P|pz.
010980*================================================================*
010990 擾Q SECTION.
011000*
011010     IF | NOT = ZERO
011020        MOVE  3   TO Z|Z
011030     ELSE
011040        IF | NOT = ZERO
011050           MOVE  2   TO Z|Z
011060        ELSE
011040           IF |ی = 90
011070              MOVE  6   TO Z|Z
                 ELSE
011070              MOVE  1   TO Z|Z
011080           END-IF
011080        END-IF
011090     END-IF.
011100     MOVE |{pa  TO Z|{pa.
011110     MOVE |{pN    TO Z|{pN.  
011120     MOVE |{p    TO Z|{p.  
011130     MOVE |Ҕԍ  TO Z|Ҕԍ.
011140     MOVE |}      TO Z|}.    
011150     READ Zvge
011160     NOT INVALID KEY
011180        MOVE Z|v         TO Q|pz
011190        MOVE Z|z     TO Q|z
011200     END-READ.
013010*================================================================*
013020 ڂƌvZ SECTION.
013030***********************************************
013040* f[^Zbg                            *
013050***********************************************
013060     PERFORM VARYING JE^ FROM 1 BY 1
013070             UNTIL ( JE^ > 4 )
013080         MOVE |񏈒u(JE^) TO 񏈒uvq(JE^)
013270     END-PERFORM.
013290*
015910     MOVE |×P     TO ×vq(1).
015920     MOVE |×Q     TO ×vq(2).
015930     MOVE |×RW   TO ×RWvq.
015940     MOVE |×RO   TO ×ROvq.
015950     COMPUTE ×vq(3)   = ×RWvq   + ×ROvq.
015960     MOVE |×ST   TO ×STvq.
015970     MOVE |×SW   TO ×SWvq.
015980     MOVE |×SO   TO ×SOvq.
015990     COMPUTE ×vq(4)   = ×STvq   + ×SWvq   + ×SOvq.
013060     PERFORM VARYING JE^ FROM 1 BY 1
013070             UNTIL ( JE^ > 4 )
013080         COMPUTE P|z(JE^) = 񏈒uvq(JE^) + ×vq(JE^)
013270     END-PERFORM.
013400********************
013410* Zbg *
013420********************
013430     MOVE |㪖@P             TO 㪗vq(1).
013440     MOVE |㪖@Q             TO 㪗vq(2).
013450     MOVE |㪖@RW           TO 㪖@RWvq.
013460     MOVE |㪖@RO           TO 㪖@ROvq.
013470     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
013480     MOVE |㪖@ST           TO 㪖@STvq.
013490     MOVE |㪖@SW           TO 㪖@SWvq.
013500     MOVE |㪖@SO           TO 㪖@SOvq.
013510     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
013480     MOVE |㪖@TQ           TO 㪖@TQvq.
013480     MOVE |㪖@TT           TO 㪖@TTvq.
013490     MOVE |㪖@TW           TO 㪖@TWvq.
013500     MOVE |㪖@TO           TO 㪖@TOvq.
013510     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq + 㪖@TOvq.
013450     MOVE |㪖@UW           TO 㪖@UWvq.
013460     MOVE |㪖@UO           TO 㪖@UOvq.
013470     COMPUTE 㪗vq(6)   = 㪖@UWvq  + 㪖@UOvq.
013450     MOVE |㪖@VW           TO 㪖@VWvq.
013460     MOVE |㪖@VO           TO 㪖@VOvq.
013470     COMPUTE 㪗vq(7)   = 㪖@VWvq  + 㪖@VOvq.
011690     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) +
                                  㪗vq(5) + 㪗vq(6) + 㪗vq(7).
013740*
013750     MOVE |㪖@P             TO 㪗vq(1).
013760     MOVE |㪖@Q             TO 㪗vq(2).
013770     MOVE |㪖@RW           TO 㪖@RWvq.
013780     MOVE |㪖@RO           TO 㪖@ROvq.
013790     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
013800     MOVE |㪖@ST           TO 㪖@STvq.
013810     MOVE |㪖@SW           TO 㪖@SWvq.
013820     MOVE |㪖@SO           TO 㪖@SOvq.
013830     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
013800     MOVE |㪖@TQ           TO 㪖@TQvq.
013800     MOVE |㪖@TT           TO 㪖@TTvq.
013810     MOVE |㪖@TW           TO 㪖@TWvq.
013820     MOVE |㪖@TO           TO 㪖@TOvq.
013830     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq + 㪖@TOvq.
013770     MOVE |㪖@UW           TO 㪖@UWvq.
013780     MOVE |㪖@UO           TO 㪖@UOvq.
013790     COMPUTE 㪗vq(6)   = 㪖@UWvq  + 㪖@UOvq.
013770     MOVE |㪖@VW           TO 㪖@VWvq.
013780     MOVE |㪖@VO           TO 㪖@VOvq.
013790     COMPUTE 㪗vq(7)   = 㪖@VWvq  + 㪖@VOvq.
011800     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) +
                                  㪗vq(5) + 㪗vq(6) + 㪗vq(7).
013860*
013870     MOVE |d×P             TO d×vq(1).
013880     MOVE |d×Q             TO d×vq(2).
013890     MOVE |d×RW           TO d×RWvq.
013900     MOVE |d×RO           TO d×ROvq.
013910     COMPUTE d×vq(3)  = d×RWvq  + d×ROvq.
013920     MOVE |d×ST           TO d×STvq.
013930     MOVE |d×SW           TO d×SWvq.
013940     MOVE |d×SO           TO d×SOvq.
013950     COMPUTE d×vq(4)  = d×STvq  + d×SWvq  + d×SOvq.
013920     MOVE |d×TQ           TO d×TQvq.
013920     MOVE |d×TT           TO d×TTvq.
013930     MOVE |d×TW           TO d×TWvq.
013940     MOVE |d×TO           TO d×TOvq.
013950     COMPUTE d×vq(5)  = d×TQvq + d×TTvq + d×TWvq + d×TOvq.
013890     MOVE |d×UW           TO d×UWvq.
013900     MOVE |d×UO           TO d×UOvq.
013910     COMPUTE d×vq(6)  = d×UWvq  + d×UOvq.
013890     MOVE |d×VW           TO d×VWvq.
013900     MOVE |d×VO           TO d×VOvq.
013910     COMPUTE d×vq(7)  = d×VWvq  + d×VOvq.
           COMPUTE d×vvq = d×vq(1) + d×vq(2) + d×vq(3) + d×vq(4) +
                                  d×vq(5) + d×vq(6) + d×vq(7).
           COMPUTE P|㪖@ = 㪗vvq + 㪗vvq + d×vvq.
013970*
011370*================================================================*
011380 Wv SECTION.
011390***********************************************
011400* f[^Zbg                            *
011410***********************************************
010990     MOVE |             TO  vq.
011000*
011010     MOVE |Z         TO  Zvq.
           MOVE |k       TO  kvq.
011050     MOVE |Č             TO  Čvq.
011080     MOVE |×             TO  ×vq.
011090     MOVE |ÉZ         TO  ÉZvq.
011140     COMPUTE qZvq = qZvq + |qZ.
011160     COMPUTE {p񋟗vq = {p񋟗vq + |{p񋟗.
           COMPUTE vv = vv + vq + Zvq + Čvq + kvq.
           COMPUTE Ìvv = ×vq + ÉZvq.
      *
011450     MOVE |×P     TO ×vq(1).
011460     MOVE |×Q     TO ×vq(2).
011470     MOVE |×RW   TO ×RWvq.
011480     MOVE |×RO   TO ×ROvq.
011490     COMPUTE ×vq(3)   = ×RWvq   + ×ROvq.
011500     MOVE |×ST   TO ×STvq.
011510     MOVE |×SW   TO ×SWvq.
011520     MOVE |×SO   TO ×SOvq.
011530     COMPUTE ×vq(4)   = ×STvq   + ×SWvq   + ×SOvq.
013060     PERFORM VARYING JE^ FROM 1 BY 1
013070             UNTIL ( JE^ > 4 )
013080         COMPUTE vv(JE^) = vv(JE^) + |񏈒u(JE^) + ×vq(JE^)
013270     END-PERFORM.
011570********************
011580* Zbg *
011590********************
011600     MOVE |㪖@P             TO 㪗vq(1).
011610     MOVE |㪖@Q             TO 㪗vq(2).
011620     MOVE |㪖@RW           TO 㪖@RWvq.
011630     MOVE |㪖@RO           TO 㪖@ROvq.
011640     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
011650     MOVE |㪖@ST           TO 㪖@STvq.
011660     MOVE |㪖@SW           TO 㪖@SWvq.
011670     MOVE |㪖@SO           TO 㪖@SOvq.
011680     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
013480     MOVE |㪖@TQ           TO 㪖@TQvq.
013480     MOVE |㪖@TT           TO 㪖@TTvq.
013490     MOVE |㪖@TW           TO 㪖@TWvq.
013500     MOVE |㪖@TO           TO 㪖@TOvq.
013510     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq + 㪖@TOvq.
013450     MOVE |㪖@UW           TO 㪖@UWvq.
013460     MOVE |㪖@UO           TO 㪖@UOvq.
013470     COMPUTE 㪗vq(6)   = 㪖@UWvq  + 㪖@UOvq.
013450     MOVE |㪖@VW           TO 㪖@VWvq.
013460     MOVE |㪖@VO           TO 㪖@VOvq.
013470     COMPUTE 㪗vq(7)   = 㪖@VWvq  + 㪖@VOvq.
011690     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) +
                                  㪗vq(5) + 㪗vq(6) + 㪗vq(7).
011700*
011710     MOVE |㪖@P             TO 㪗vq(1).
011720     MOVE |㪖@Q             TO 㪗vq(2).
011730     MOVE |㪖@RW           TO 㪖@RWvq.
011740     MOVE |㪖@RO           TO 㪖@ROvq.
011750     COMPUTE 㪗vq(3)   = 㪖@RWvq  + 㪖@ROvq.
011760     MOVE |㪖@ST           TO 㪖@STvq.
011770     MOVE |㪖@SW           TO 㪖@SWvq.
011780     MOVE |㪖@SO           TO 㪖@SOvq.
011790     COMPUTE 㪗vq(4)   = 㪖@STvq  + 㪖@SWvq  + 㪖@SOvq.
013800     MOVE |㪖@TQ           TO 㪖@TQvq.
013800     MOVE |㪖@TT           TO 㪖@TTvq.
013810     MOVE |㪖@TW           TO 㪖@TWvq.
013820     MOVE |㪖@TO           TO 㪖@TOvq.
013830     COMPUTE 㪗vq(5)   = 㪖@TQvq + 㪖@TTvq + 㪖@TWvq + 㪖@TOvq.
013770     MOVE |㪖@UW           TO 㪖@UWvq.
013780     MOVE |㪖@UO           TO 㪖@UOvq.
013790     COMPUTE 㪗vq(6)   = 㪖@UWvq  + 㪖@UOvq.
013770     MOVE |㪖@VW           TO 㪖@VWvq.
013780     MOVE |㪖@VO           TO 㪖@VOvq.
013790     COMPUTE 㪗vq(7)   = 㪖@VWvq  + 㪖@VOvq.
011800     COMPUTE 㪗vvq = 㪗vq(1) + 㪗vq(2) + 㪗vq(3) + 㪗vq(4) +
                                  㪗vq(5) + 㪗vq(6) + 㪗vq(7).
011810*
011820     MOVE |d×P             TO d×vq(1).
011830     MOVE |d×Q             TO d×vq(2).
011840     MOVE |d×RW           TO d×RWvq.
011850     MOVE |d×RO           TO d×ROvq.
011860     COMPUTE d×vq(3)  = d×RWvq  + d×ROvq.
011870     MOVE |d×ST           TO d×STvq.
011880     MOVE |d×SW           TO d×SWvq.
011890     MOVE |d×SO           TO d×SOvq.
011900     COMPUTE d×vq(4)  = d×STvq  + d×SWvq  + d×SOvq.
013920     MOVE |d×TQ           TO d×TQvq.
013920     MOVE |d×TT           TO d×TTvq.
013930     MOVE |d×TW           TO d×TWvq.
013940     MOVE |d×TO           TO d×TOvq.
013950     COMPUTE d×vq(5)  = d×TQvq + d×TTvq + d×TWvq + d×TOvq.
013890     MOVE |d×UW           TO d×UWvq.
013900     MOVE |d×UO           TO d×UOvq.
013910     COMPUTE d×vq(6)  = d×UWvq  + d×UOvq.
013890     MOVE |d×VW           TO d×VWvq.
013900     MOVE |d×VO           TO d×VOvq.
013910     COMPUTE d×vq(7)  = d×VWvq  + d×VOvq.
           COMPUTE dÌvv = d×vq(1) + d×vq(2) + d×vq(3) + d×vq(4) +
                              d×vq(5) + d×vq(6) + d×vq(7).
           COMPUTE 㪖@vv = 㪖@vv + 㪗vvq + 㪗vvq + dÌvv.
011920*
           COMPUTE pvv = pvv + |pz.
      *
018960*================================================================*
018970 PR[h SECTION.
018980*
018990     WRITE P|R[h
019000     INVALID KEY
019010         MOVE NC"P"  TO t@C
019020         PERFORM G[\
019030     END-WRITE.
019040     MOVE 1 TO tO.
019050*================================================================*
019060 QR[h SECTION.
019070*
019080     WRITE Q|R[h
019090     INVALID KEY
019100         MOVE NC"Q"  TO t@C
019110         PERFORM G[\
019120     END-WRITE.
019290*================================================================*
019300 f[^`FbN SECTION.
019310*
019320     MOVE SPACE          TO sL[v.
019330* *****************************************************************
019340* * ʗL`FbNFʐ = 0 ̏ꍇf[^쐬ΏۂƂȂ *
019350* *****************************************************************
019360     MOVE |{pa   TO |{pa.
019370     MOVE |{pN     TO |{pN.
019380     MOVE |{p     TO |{p.
019390     MOVE |Ҕԍ   TO |Ҕԍ.
019400     MOVE |}       TO |}.
019410     READ f[^e
019420     INVALID KEY
019430         MOVE SPACE  TO sL[v
019440     NOT INVALID KEY
019450         IF |ʐ NOT = ZERO
019460*        *************************************************************
019470*        * {pL^`FbNFʉ@ = 0 ̏ꍇf[^쐬ΏۂƂȂ *
019480*        *************************************************************
019490             MOVE |Ҕԍ  TO {L|Ҕԍ
019500             MOVE |}      TO {L|}
019510             MOVE |{pa  TO {L|{pa
019520             MOVE |{pN    TO {L|{pN
019530             MOVE |{p    TO {L|{p
019540             MOVE ZERO          TO {L|{p
019550             START {pL^e   KEY IS >= {L|҃R[h
019560                                          {L|{paN
019570             END-START
019580             IF ԃL[ = "00"
019590                 MOVE SPACE TO ItOQ
019600                 MOVE SPACE TO {pL^Lv
019610                 PERFORM {pL^eǍ
019620                 PERFORM UNTIL (ItOQ         = "YES"         ) OR
019630                               ({L|҃R[h NOT = |҃R[h) OR
019640                               ({L|{pa   NOT = |{pa  ) OR
019650                               ({L|{pN     NOT = |{pN    ) OR
019660                               ({L|{p     NOT = |{p    ) OR
019670                               ({pL^Lv         = "YES"         )
019680                     MOVE "YES"  TO {pL^Lv
019690                     MOVE "YES"  TO sL[v
019700                 END-PERFORM
019710             ELSE
019720                 MOVE SPACE  TO sL[v
019730             END-IF
019740         ELSE
019750             MOVE SPACE  TO sL[v
019760         END-IF
019770     END-READ.
019780*
019790*================================================================*
019800 {pL^eǍ SECTION.
019810*
019820     READ {pL^e NEXT
019830     AT END
019840         MOVE "YES"  TO ItOQ
019850     END-READ.
019860*================================================================*
019870  SECTION.
019880*
019890     MOVE SPACE TO ΏۃtO
019900*/JЎӂ̃f[^͑ΏۊO
019910     IF |ی NOT = 70 AND 80
019920         EVALUATE vq
019930         WHEN 01
019940             PERFORM 
019950         WHEN 02
019960             PERFORM Â̂ݔ
019970         WHEN 03
019980             PERFORM I
019990         WHEN 04
020000             PERFORM 
020010             IF ΏۃtO = "YES"
020020                 PERFORM I
020030             END-IF
020040         WHEN OTHER
020050             CONTINUE
020060         END-EVALUATE
020070     END-IF.
020080*================================================================*
020090  SECTION.
020100*
020110     MOVE |Ҕԍ  TO {L|Ҕԍ
020120     MOVE |}      TO {L|}
020130     MOVE |{pa  TO {L|{pa
020140     MOVE |{pN    TO {L|{pN
020150     MOVE |{p    TO {L|{p
020160     MOVE ZERO          TO {L|{p
020170     START {pL^e   KEY IS >= {L|҃R[h
020180                                  {L|{paN
020190     END-START
020200     IF ԃL[ = "00"
020210         MOVE SPACE TO ItOR
020220         PERFORM {pL^eǍ
020230         PERFORM UNTIL (ItOR         = "YES"         ) OR
020240                       ({L|҃R[h NOT = |҃R[h) OR
020250                       ({L|{pa   NOT = |{pa  ) OR
020260                       ({L|{pN     NOT = |{pN    ) OR
020270                       ({L|{p     NOT = |{p    )
020280*
020290             IF {L|fË敪 = 2
020300                 MOVE "YES" TO ΏۃtO
020310                 MOVE "YES" TO ItOR
020320             END-IF
020330             PERFORM {pL^eǍ
020340         END-PERFORM
020350     END-IF.
020360*================================================================*
020370 Â̂ݔ SECTION.
020380*
020390     MOVE |Ҕԍ  TO {L|Ҕԍ
020400     MOVE |}      TO {L|}
020410     MOVE |{pa  TO {L|{pa
020420     MOVE |{pN    TO {L|{pN
020430     MOVE |{p    TO {L|{p
020440     MOVE ZERO          TO {L|{p
020450     START {pL^e   KEY IS >= {L|҃R[h
020460                                  {L|{paN
020470     END-START
020480     IF ԃL[ = "00"
020490         MOVE SPACE TO ItOR
020500         PERFORM {pL^eǍ
020510         PERFORM UNTIL (ItOR         = "YES"         ) OR
020520                       ({L|҃R[h NOT = |҃R[h) OR
020530                       ({L|{pa   NOT = |{pa  ) OR
020540                       ({L|{pN     NOT = |{pN    ) OR
020550                       ({L|{p     NOT = |{p    )
020560*
020570             IF {L|fË敪 = 1
020580                 MOVE "YES" TO ΏۃtO
020590             ELSE
020600                 MOVE SPACE TO ΏۃtO
020610                 MOVE "YES" TO ItOR
020620             END-IF
020630             PERFORM {pL^eǍ
020640         END-PERFORM
020650     END-IF.
020660*================================================================*
020670 I SECTION.
020680*
020690     MOVE "YES" TO ΏۃtO.
020700*
020710     MOVE |{pa   TO |{pa.
020720     MOVE |{pN     TO |{pN.
020730     MOVE |{p     TO |{p.
020740     MOVE |Ҕԍ   TO |Ҕԍ.
020750     MOVE |}       TO |}.
020760     READ f[^e
020770     INVALID KEY
020780         MOVE SPACE  TO ΏۃtO
020790     NOT INVALID KEY
020800         IF |ʐ = ZERO
020810             MOVE SPACE TO ΏۃtO
020820         ELSE
020830             PERFORM VARYING ʂbms FROM 1 BY 1
020840                      UNTIL (ʂbms > |ʐ)
020850                 IF |]A敪(ʂbms) = 9 OR 5
020860                     MOVE SPACE TO ΏۃtO
020870                 END-IF
020880             END-PERFORM
020890         END-IF
020900     END-READ.
020910*================================================================*
020920 擾 SECTION.
020930*
020940     MOVE {pavq TO |敪.
020950     READ }X^
020960     NOT INVALID KEY
020970         MOVE |JnN TO {pNv
020980     END-READ.
020990     IF {pNv NOT = ZERO
021000        COMPUTE {pNv = {pNv + {pNvq - 1
021010     END-IF.
021020*
021030     EVALUATE {pvq
021040     WHEN 4
021050     WHEN 6
021060     WHEN 9
021070     WHEN 11
021080         MOVE 30 TO Ivo
021090     WHEN 2
021100         DIVIDE 4 INTO {pNv GIVING    v
021110                                    REMAINDER ]v
021120         END-DIVIDE
021130         IF ]v = ZERO
021140             MOVE 29 TO Ivo
021150         ELSE
021160             MOVE 28 TO Ivo
021170         END-IF
021180     WHEN 1
021190     WHEN 3
021200     WHEN 5
021210     WHEN 7
021220     WHEN 8
021230     WHEN 10
021240     WHEN 12
021250         MOVE 31 TO Ivo
021260     WHEN OTHER
021270          CONTINUE
021280     END-EVALUATE.
021290*
022250*================================================================*
022260******************************************************************
022270 END PROGRAM YGN721.
022280******************************************************************
