000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YGN586.
000060 AUTHOR.                 rc  Kq
000070*
000080*----------------------------------------------------------------*
000090*  y_{޳ޔŁ@Qnp ×{z
000100*  yz
000110*       MED = YGN580 YGN586P 
000120*----------------------------------------------------------------*
000130 DATE-WRITTEN.           2016-05-24
000140 DATE-COMPILED.          2016-05-24
000150*----------------------------------------------------------------*
000160******************************************************************
000170*            ENVIRONMENT         DIVISION                        *
000180******************************************************************
000190 ENVIRONMENT             DIVISION.
000200 CONFIGURATION           SECTION.
000210 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000220 OBJECT-COMPUTER.        FMV-DESKPOWER.
000230 SPECIAL-NAMES.          CONSOLE  IS  CONS
000240                         SYSERR   IS  MSGBOX.
000250 INPUT-OUTPUT            SECTION.
000260 FILE-CONTROL.
000390     SELECT  {p}X^ ASSIGN     TO        SEJOHOL
000400                             ORGANIZATION             IS  INDEXED
000410                             ACCESS MODE              IS  DYNAMIC
000420                             RECORD KEY               IS  {|{pԍ
000430                             FILE STATUS              IS  ԃL[
000440                             LOCK        MODE         IS  AUTOMATIC.
000450     SELECT  ی҃}X^    ASSIGN      TO        HOKENSL
000460                             ORGANIZATION             IS  INDEXED
000470                             ACCESS MODE              IS  DYNAMIC
000480                             RECORD KEY               IS  ہ|ی
000490                                                          ہ|یҔԍ
000500                             ALTERNATE RECORD KEY     IS  ہ|ی
000510                                                          ہ|یҖ
000520                                                          ہ|یҔԍ
000530                             FILE STATUS              IS  ԃL[
000540                             LOCK        MODE         IS  AUTOMATIC.
000950     SELECT  s}X^    ASSIGN      TO        SITYOSNL
000960                             ORGANIZATION             IS  INDEXED
000970                             ACCESS MODE              IS  DYNAMIC
000980                             RECORD KEY               IS  s|
000990                                                          s|sԍ
001000                             ALTERNATE RECORD KEY     IS  s|
001010                                                          s|s
001020                                                          s|sԍ
001030                             FILE STATUS              IS  ԃL[
001040                             LOCK        MODE         IS  AUTOMATIC.
001530     SELECT  hcǗ}X^    ASSIGN      TO        IDKANRL
001540                             ORGANIZATION             IS  INDEXED
001550                             ACCESS MODE              IS  DYNAMIC
001560                             RECORD KEY               IS  hcǁ|hc敪
001570                                                          hcǁ|{pԍ
001580                                                          hcǁ|ی
001590                                                          hcǁ|یҔԍ
001600                             ALTERNATE RECORD KEY     IS  hcǁ|{phcԍ
001610                                                          hcǁ|hc敪
001620                                                          hcǁ|{pԍ
001630                                                          hcǁ|ی
001640                                                          hcǁ|یҔԍ
001650                             FILE STATUS              IS  ԃL[
001660                             LOCK        MODE         IS  AUTOMATIC.
000620     SELECT  ƃt@CP  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W5851L.DAT"
000630                             ORGANIZATION             IS  INDEXED
000640                             ACCESS                   IS  DYNAMIC
000650                             RECORD      KEY          IS  P|ی敪
000670                                                          P|یҔԍ
000660                                                          P|敪
001460                             ALTERNATE RECORD KEY     IS  P|یҔԍ
001290                                                          P|敪
000680                             FILE        STATUS       IS  ԃL[
000690                             LOCK        MODE         IS  AUTOMATIC.
000700     SELECT  t@C    ASSIGN      TO     GS-PRTF001
000710                             SYMBOLIC    DESTINATION  IS "PRT"
000720                             FORMAT                   IS  `̖o
000730                             GROUP                    IS  ڌQo
000740                             PROCESSING  MODE         IS  ʂo
000750                             UNIT        CONTROL      IS  go
000760                             FILE        STATUS       IS  ʒmo.
000770******************************************************************
000780*                      DATA DIVISION                             *
000790******************************************************************
000800 DATA                    DIVISION.
000810 FILE                    SECTION.
000880*                           mqk  USOn
000890 FD  {p}X^    BLOCK   CONTAINS   1   RECORDS.
000900     COPY SEJOHO         OF  XFDLIB  JOINING    { AS  PREFIX.
000910*                           mqk  RQOn
000920 FD  ی҃}X^        BLOCK   CONTAINS   1   RECORDS.
000930     COPY HOKENS          OF  XFDLIB  JOINING      AS  PREFIX.
002100*                           mqk  QTUn
002110 FD  s}X^          BLOCK   CONTAINS   1   RECORDS.
002120     COPY SITYOSN        OF  XFDLIB  JOINING   s   AS  PREFIX.
002500*                           mqk  PQWn
002510 FD  hcǗ}X^          BLOCK   CONTAINS   1   RECORDS.
002520     COPY IDKANR    OF  XFDLIB  JOINING   hc   AS  PREFIX.
000970*
001660 FD  ƃt@CP RECORD  CONTAINS 64 CHARACTERS.
001670 01  P|R[h.
001680   03  P|R[hL[.
001760     05  P|ی敪                PIC 9(1).
001690     05  P|یҔԍ.
001700       07 P|@ʔԍ               PIC X(2).
001710       07 P|۔.
001720         09 P|s{ԍ         PIC X(2).
001730         09 P|۔ԍ               PIC X(3).
001740         09 P|ؔԍ             PIC X.
001750         09 FILLER                     PIC X(2).
001770     05  P|敪                    PIC 9.
001780   03  P|R[hf[^.
001760     05  P|ی                PIC 9(2).
001790     05  P|                    PIC 9(4).
001800     05  P|                    PIC 9(4).
001810     05  P|pz                  PIC 9(7).
001810     05  P|Sz                  PIC 9(7).
001810     05  P|z                  PIC 9(7).
001820     05  FILLER                        PIC X(21).
001150*
001160 FD  t@C.
001170     COPY YGN586P        OF  XMDLIB.
001180******************************************************************
001190*                WORKING-STORAGE SECTION                         *
001200******************************************************************
001210 WORKING-STORAGE         SECTION.
001220 01 L[                           PIC X    VALUE SPACE.
001230 01 ԃL[                           PIC X(2) VALUE SPACE.
001240 01 ItO                         PIC X(3) VALUE SPACE.
001250 01 ItOQ                       PIC X(3) VALUE SPACE.
001260 01 ItOR                       PIC X(3) VALUE SPACE.
001280 01 t@Cv                       PIC N(2) VALUE SPACE.
001210 01 I[vtO                     PIC X(3)   VALUE SPACE.
001300 01 sL[v                         PIC X(4) VALUE SPACE.
001340 01 {paNv.
001350    03 {pav                      PIC 9.
001360    03 {pNv.
001370       05 {pNv                     PIC 9(2).
001380       05 {pv                     PIC 9(2).
001390 01 {pv                           PIC 9(2).
001400 01 aNv.
001410    03 Nv                        PIC 9(2).
001420    03 v                        PIC 9(2).
001430    03 v                        PIC 9(2).
001440 01 ̂v                         PIC N(2) VALUE SPACE.
001450 01 JE^                           PIC 9(2) VALUE ZERO.
001460 01 bms                     PIC 9(2) VALUE ZERO.
001470 01 v.
001480    03 o^ԍR[hv.
001490       05 v                         PIC X(2)  VALUE SPACE.
001500       05 o^ԍvo.
001510          07 nv                    PIC X(2)  VALUE SPACE.
001520          07 o^ԍv                PIC X(5) VALUE SPACE.
001530       05 FILLER                       PIC X(11)  VALUE SPACE.
001930    03 {pX֔ԍv.
001940       05 {pX֔ԍPv           PIC X(3)   VALUE SPACE.
001950       05 {pX֔ԍQv           PIC X(4)   VALUE SPACE.
001540    03 {pZv                    PIC X(50) VALUE SPACE.
001550    03 {pZPv                  PIC X(50) VALUE SPACE.
001560    03 {pZQv                  PIC X(50) VALUE SPACE.
001570    03 ڍ@v                      PIC X(50) VALUE SPACE.
001580    03 \҃Jiv                    PIC X(50) VALUE SPACE.
001580    03 \Җv                      PIC X(50) VALUE SPACE.
001920    03 {pdbԍv                PIC X(15) VALUE SPACE.
001610    03 vzv.
001620        05 یҖ̂v.
001630           07 یҖ̂v         PIC N(12) VALUE SPACE.
001640       05 یXv                 PIC 9(3)  VALUE ZERO.
001650       05 ۓXv                 PIC 9(4)  VALUE ZERO.
001660       05 ۔pzXv               PIC 9(7)  VALUE ZERO.
001660       05 ەSzXv               PIC 9(7)  VALUE ZERO.
001660       05 ېzXv               PIC 9(7)  VALUE ZERO.
001670       05 یVv                 PIC 9(3)  VALUE ZERO.
001680       05 ۓVv                 PIC 9(4)  VALUE ZERO.
001690       05 ۔pzVv               PIC 9(7)  VALUE ZERO.
001660       05 ەSzVv               PIC 9(7)  VALUE ZERO.
001660       05 ېzVv               PIC 9(7)  VALUE ZERO.
001700       05 یv                   PIC 9(3)  VALUE ZERO.
001710       05 ۓv                   PIC 9(4)  VALUE ZERO.
001720       05 ۔pzv                 PIC 9(7)  VALUE ZERO.
001660       05 ەSzv                 PIC 9(7)  VALUE ZERO.
001660       05 ېzv                 PIC 9(7)  VALUE ZERO.
001730       05 یUv                 PIC 9(3)  VALUE ZERO.
001740       05 ۓUv                 PIC 9(4)  VALUE ZERO.
001750       05 ۔pzUv               PIC 9(7)  VALUE ZERO.
001660       05 ەSzUv               PIC 9(7)  VALUE ZERO.
001660       05 ېzUv               PIC 9(7)  VALUE ZERO.
001790       05 ޖ{v                   PIC 9(3)  VALUE ZERO.
001800       05 ޖ{v                   PIC 9(4)  VALUE ZERO.
001810       05 ޖ{pzv                 PIC 9(7)  VALUE ZERO.
001660       05 ޖ{Szv                 PIC 9(7)  VALUE ZERO.
001660       05 ޖ{zv                 PIC 9(7)  VALUE ZERO.
001880       05 މƌv                   PIC 9(3)  VALUE ZERO.
001890       05 މƓv                   PIC 9(4)  VALUE ZERO.
001900       05 މƔpzv                 PIC 9(7)  VALUE ZERO.
001660       05 މƕSzv                 PIC 9(7)  VALUE ZERO.
001660       05 މƐzv                 PIC 9(7)  VALUE ZERO.
001910       05 ސEUv                 PIC 9(3)  VALUE ZERO.
001920       05 ސEUv                 PIC 9(4)  VALUE ZERO.
001930       05 ސEpzUv               PIC 9(7)  VALUE ZERO.
001660       05 ސESzUv               PIC 9(7)  VALUE ZERO.
001660       05 ސEzUv               PIC 9(7)  VALUE ZERO.
001640       05 ㍂Xv                 PIC 9(3)  VALUE ZERO.
001650       05 ㍂Xv                 PIC 9(4)  VALUE ZERO.
001660       05 ㍂pzXv               PIC 9(7)  VALUE ZERO.
001660       05 ㍂SzXv               PIC 9(7)  VALUE ZERO.
001660       05 ㍂zXv               PIC 9(7)  VALUE ZERO.
001670       05 ㍂Vv                 PIC 9(3)  VALUE ZERO.
001680       05 ㍂Vv                 PIC 9(4)  VALUE ZERO.
001690       05 ㍂pzVv               PIC 9(7)  VALUE ZERO.
001660       05 ㍂SzVv               PIC 9(7)  VALUE ZERO.
001660       05 ㍂zVv               PIC 9(7)  VALUE ZERO.
008660 01 {phcv                       PIC X(15)  VALUE SPACE.
001980 01 Őv                             PIC 9(1)  VALUE ZERO.
001990 01 Słv                             PIC 9(1)  VALUE ZERO.
002000 01 於̂v.
002010    03 於̂v                PIC X(36) VALUE SPACE.
002020    03 FILLER                          PIC X(4) VALUE SPACE.
002030 01 یҔԍv.
002040    03 یҖ@ʔԍv                PIC X(2)  VALUE SPACE.
002050    03 یҔԍPv.
002060       05 یҌR[hv             PIC X(2)  VALUE SPACE.
002070       05 یҔԍQv               PIC X(6)  VALUE SPACE.
002080 01 یԍv                         PIC X(3)  VALUE SPACE.
002090 01 یʂv                         PIC 9(2)  VALUE ZERO.
002100 01 ʂv                         PIC 9(2)  VALUE ZERO.
002110 01 {lƑ敪v                     PIC 9(1)  VALUE ZERO.
002120 01 pSҔԍv                   PIC X(10) VALUE SPACE.
002130 01 tv                         PIC 9(2)  VALUE ZERO.
002160 01 v                             PIC N(5)  VALUE SPACE.
002170 01 ی҈v                       PIC N(3)  VALUE SPACE.
002180 01 یҖ̂v.
002190    03 یҖ̂v            PIC N(20) VALUE SPACE.
002200 01 یҖ̂v.
002210    03 یҖ̂Pv              PIC X(16) VALUE SPACE.
002220    03 یҖ̂Qv              PIC X(16) VALUE SPACE.
002430*
002440 01 .
002450     03 `̖o                     PIC X(8) VALUE SPACE.
002460     03 ڌQo                     PIC X(8) VALUE SPACE.
002470     03 ʂo                     PIC X(2) VALUE SPACE.
002480     03 go.
002490         05 [o.
002500             07 ړo             PIC X(1).
002510             07 ړso             PIC 9(3).
002520         05 ڍאo                 PIC X(2).
002530     03 ʒmo                     PIC X(2) VALUE SPACE.
002540     03 jbgo                   PIC X(8) VALUE SPACE.
002710*
002720******************************************************************
002730*                          A                              *
002740******************************************************************
002750*
001830********************
001840* bZ[W\L[ *
001850********************
001860 01 A|L[ IS EXTERNAL.
001870    03  A|bZ[W             PIC N(20).
002760****************
002770* ʓ͏ *
002780****************
       01 A|̓f[^xfmTWO IS EXTERNAL.
          03 A|{paN.
             05 A|{pa               PIC 9(1).
             05 A|{pN.
                07 A|{pN              PIC 9(2).
                07 A|{p              PIC 9(2).
003240*
       01 A|̓f[^xfmTWT IS EXTERNAL GLOBAL.
          03 A|aN.
             05 A|a               PIC 9(1).
             05 A|N                 PIC 9(2).
             05 A|                 PIC 9(2).
             05 A|                 PIC 9(2).
          03 A|یҔԍ                PIC X(10).
      *
       01 A|vr[ IS EXTERNAL GLOBAL.
          03 A|vr[敪            PIC 9.
      *
000540************************************
000550* v^t@C쐬p           *
000560************************************
000570 01 gAoqse|쐬f[^ IS EXTERNAL.
000580     03 gAoqse|t@C           PIC X(8).
000590     03 gAoqse|vr[敪       PIC 9.
000600     03 gAoqse|[vO     PIC X(8).
000610     03 gAoqse|I[oC         PIC X(8).
003250******************************************************************
003260*                      PROCEDURE  DIVISION                       *
003270******************************************************************
003280 PROCEDURE               DIVISION.
003290************
003300*           *
003310*    *
003320*           *
003330************
002560     MOVE SPACE TO I[vtO.
002570     PERFORM v^t@C쐬.
003340     PERFORM .
003350************
003360*           *
003370* 又     *
003380*           *
003390************
003400     PERFORM .
003410************
003420*           *
003430* I   *
003440*           *
003450************
003460     PERFORM I.
003470     EXIT PROGRAM.
003480*
003490*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
002860*================================================================*
002870 v^t@C쐬 SECTION.
002880*================================================================*
002890*   /  /
002900     MOVE SPACE TO gAoqse|쐬f[^.
002910     INITIALIZE gAoqse|쐬f[^.
002920*
002930*
002940*-- ύXӏ --------------------------------------*
002970*   gpv^t@CZbg
002971     MOVE "PRTF001"             TO gAoqse|t@C.
002972*
002973*   gp钠[vOZbg
002974     MOVE "YGN586"             TO gAoqse|[vO.
002975*
002976*-------------------------------------------------------*
002980*
002990*   / vr[敪Zbg /
003000     MOVE A|vr[敪 TO gAoqse|vr[敪.
003010*
003020     CALL   "CRTPRTF".
003030     CANCEL "CRTPRTF".
003040*
003500*================================================================*
003510  SECTION.
003520*
003590     OPEN INPUT {p}X^.
003600             MOVE NC"{" TO t@Cv.
003610             PERFORM I[v`FbN.
003620     OPEN INPUT ی҃}X^.
003630         MOVE NC"ی҃}X^" TO t@Cv.
003640         PERFORM I[v`FbN.
014890     OPEN INPUT s}X^.
014900         MOVE NC"s" TO t@Cv.
014910         PERFORM I[v`FbN.
015070     OPEN INPUT  hcǗ}X^.
015080         MOVE NC"hc" TO t@Cv.
015090         PERFORM I[v`FbN.
003680*     OPEN I-O   t@C.
003690*         MOVE NC"t@C" TO t@Cv.
003700*         PERFORM G[o.
003710*
003840     PERFORM AڑҔ.
003850*
003860*================================================================*
003870 I[v`FbN SECTION.
003880*
003890     IF ԃL[  NOT =  "00"
003900         DISPLAY t@Cv NC"eI[vG[" UPON CONS
003910         DISPLAY NC"ԃL[F" ԃL[           UPON CONS
003920         DISPLAY NC"P͂dmsdqL[Ă"
003930                                                   UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
003940         ACCEPT  L[ FROM CONS
003950         PERFORM t@C
003960         EXIT PROGRAM.
004340*================================================================*
004350 I[v SECTION.
004360*
004370     OPEN I-O   t@C.
004380*================================================================*
004390 {p}X^Ǎ SECTION.
004400*
004410     MOVE ZERO TO {|{pԍ.
004420     READ {p}X^
004430     INVALID KEY
004440         MOVE NC"{" TO t@Cv
004450         PERFORM G[\q
004460         PERFORM t@C
004470         MOVE 99 TO PROGRAM-STATUS
004480         EXIT PROGRAM
004490     NOT INVALID KEY
004500*****         MOVE {|۔ԍ         TO {pR[hv
004510         MOVE {|V_tԍ     TO o^ԍR[hv
004520         MOVE {|䒠n     TO nv
004640         MOVE {|X֔ԍP       TO {pX֔ԍPv
004650         MOVE {|X֔ԍQ       TO {pX֔ԍQv
004530         MOVE {|ZP           TO {pZPv
004540         MOVE {|ZQ           TO {pZQv
004550         MOVE {|ڍ@         TO ڍ@v
004730         MOVE {|\҃Ji       TO \҃Jiv
004560         MOVE {|\Җ         TO \Җv
004750         MOVE {|dbԍ         TO {pdbԍv
004570     END-READ.
026770*********************************************
026780** hcǗ}X^@{phc擾B
026790*********************************************
026900**   / {pID /
026910     MOVE 01                     TO hcǁ|hc敪.
026920     MOVE ZERO                   TO hcǁ|{pԍ.
026930     MOVE 10                     TO hcǁ|ی.
026940     MOVE SPACE                  TO hcǁ|یҔԍ.
026950     READ hcǗ}X^
026960     NOT INVALID KEY
026970         MOVE hcǁ|{phcԍ   TO {phcv
026980     END-READ.
004580*
004630*================================================================*
004640 t@C SECTION.
004650*
003570     IF ( I[vtO = "YES" )
003580         CLOSE t@C
003590     ELSE
003600         MOVE  NC"@@f[^OłBmFĉB" TO A|bZ[W
003610         CALL   "MSG001"
003620         CANCEL "MSG001"
003630     END-IF.
003640*
004660     CLOSE  {p}X^  ی҃}X^  s}X^  hcǗ}X^.
004680*================================================================*
004690 I SECTION.
004700*
004710     PERFORM t@C.
004720*================================================================*
004730 AڑҔ SECTION.
004740*
004750     MOVE A|{pa   TO {pav.
004751     MOVE A|{pN     TO {pNv.
004760     MOVE A|{p     TO {pv.
004751     MOVE A|N     TO Nv.
004760     MOVE A|     TO v.
004760     MOVE A|     TO v.
004770     MOVE A|یҔԍ TO یҔԍv.
004790*
004800*================================================================*
004810  SECTION.
004820*
004830     PERFORM {p}X^Ǎ.
004840     OPEN INPUT ƃt@CP.
004850         MOVE NC"P" TO t@Cv.
004860         PERFORM I[v`FbN.
004880     MOVE SPACE TO ItOQ.
004890     MOVE یҔԍv   TO P|یҔԍ.
004910     MOVE ZERO           TO P|敪.
004920     START ƃt@CP KEY IS >= P|یҔԍ
004930                                    P|敪
004950     END-START.
004960     IF ԃL[ = "00"
004970         PERFORM ƃt@CPǍ
004980         MOVE SPACE TO vzv
004990         INITIALIZE    vzv
005770         IF P|ی = 5
                   PERFORM s擾
               ELSE
                   PERFORM 擾
               END-IF
005000         MOVE P|یҔԍ     TO یҔԍv
005010         PERFORM UNTIL (P|یҔԍ NOT = یҔԍv) OR
005020                       (ItOQ     NOT = SPACE)
005030             PERFORM WvP
005040             PERFORM ƃt@CPǍ
005050         END-PERFORM
005060         PERFORM R[hZbg
      *****         PERFORM eXg
005070         PERFORM ׈
005080     END-IF
005090     CLOSE ƃt@CP.
005100*================================================================*
005110 ƃt@CPǍ SECTION.
005120*
005130     READ ƃt@CP NEXT
005140     AT END
005150         MOVE "YES" TO ItOQ
005160         INITIALIZE P|R[h
005170     END-READ.
005180*================================================================*
005190 WvP SECTION.
005200*
005210     MOVE P|ی TO یʂv.
005220     EVALUATE P|ی
           WHEN 1
005230         EVALUATE P|敪
005240         WHEN  1
005250             MOVE P|   TO یXv
005260             MOVE P|   TO ۓXv
005270             MOVE P|pz TO ۔pzXv
005270             MOVE P|Sz TO ەSzXv
005270             MOVE P|z TO ېzXv
005280         WHEN  2
005290             MOVE P|   TO یVv
005300             MOVE P|   TO ۓVv
005310             MOVE P|pz TO ۔pzVv
005270             MOVE P|Sz TO ەSzVv
005270             MOVE P|z TO ېzVv
005320         WHEN  3
005330             MOVE P|   TO یv
005340             MOVE P|   TO ۓv
005350             MOVE P|pz TO ۔pzv
005270             MOVE P|Sz TO ەSzv
005270             MOVE P|z TO ېzv
005360         WHEN  4
005370             MOVE P|   TO یUv
005380             MOVE P|   TO ۓUv
005390             MOVE P|pz TO ۔pzUv
005270             MOVE P|Sz TO ەSzUv
005270             MOVE P|z TO ېzUv
005400         END-EVALUATE
005440     WHEN 8
005450         EVALUATE P|敪
005460         WHEN 0
005470             MOVE P|   TO ޖ{v
005480             MOVE P|   TO ޖ{v
005490             MOVE P|pz TO ޖ{pzv
005270             MOVE P|Sz TO ޖ{Szv
005270             MOVE P|z TO ޖ{zv
005500         WHEN 1
005590             MOVE P|   TO މƌv
005600             MOVE P|   TO މƓv
005610             MOVE P|pz TO މƔpzv
005270             MOVE P|Sz TO މƕSzv
005270             MOVE P|z TO މƐzv
005620         WHEN 2
005630             MOVE P|   TO ސEUv
005640             MOVE P|   TO ސEUv
005650             MOVE P|pz TO ސEpzUv
005270             MOVE P|Sz TO ސESzUv
005270             MOVE P|z TO ސEzUv
005660         END-EVALUATE
           WHEN 5
005450         EVALUATE P|敪
005240         WHEN  1
005250             MOVE P|   TO ㍂Xv
005260             MOVE P|   TO ㍂Xv
005270             MOVE P|pz TO ㍂pzXv
005270             MOVE P|Sz TO ㍂SzXv
005270             MOVE P|z TO ㍂zXv
005280         WHEN  2
005290             MOVE P|   TO ㍂Vv
005300             MOVE P|   TO ㍂Vv
005310             MOVE P|pz TO ㍂pzVv
005270             MOVE P|Sz TO ㍂SzVv
005270             MOVE P|z TO ㍂zVv
005700         END-EVALUATE
           WHEN OTHER
005250         MOVE P|   TO ㍂Xv
005260         MOVE P|   TO ㍂Xv
005270         MOVE P|pz TO ㍂pzXv
005270         MOVE P|Sz TO ㍂SzXv
005270         MOVE P|z TO ㍂zXv
           END-EVALUATE.
005720*================================================================*
005730 R[hZbg SECTION.
005740*
005750     MOVE SPACE TO YGN586P.
005760     INITIALIZE YGN586P.
005780     MOVE 於̂v     TO یҖ.
005790     MOVE {pNv         TO {pN.
005800     MOVE {pv         TO {p.
005790     MOVE Nv         TO N.
005800     MOVE v         TO .
005800     MOVE v         TO .
           IF یʂv = 01 OR 08 OR 05
005810         MOVE یҔԍv TO یҔԍ
           ELSE
               MOVE NC""   TO 
               MOVE NC""       TO (1)
               MOVE NC""       TO (2)
           END-IF.
005820*     MOVE o^ԍvo     TO o^ԍ.
           MOVE {phcv(3:6)    TO o^ԍ.
005680     MOVE {pX֔ԍPv   TO X֔ԍP.
005690     MOVE {pX֔ԍQv   TO X֔ԍQ.
           IF {pX֔ԍPv NOT = SPACE
               MOVE ""             TO XւP
               MOVE "-"              TO XւQ
           END-IF.
005830     MOVE {pZPv   TO ZP.
005840     MOVE {pZQv   TO ZQ.
005850     MOVE ڍ@v       TO {p.
006770     MOVE \҃Jiv     TO tKi.
005860     MOVE \Җv       TO .
006560     MOVE {pdbԍv TO dbԍ.
005861* evǉ 2006.10.27
005890     MOVE یXv     TO یX  .
005900     MOVE ۓXv     TO ۓX  .
005910     MOVE ۔pzXv   TO ۔pzX.
005910     MOVE ەSzXv   TO ەSzX.
005910     MOVE ېzXv   TO ېzX.
005920     MOVE یVv     TO یV  .
005930     MOVE ۓVv     TO ۓV  .
005940     MOVE ۔pzVv   TO ۔pzV.
005910     MOVE ەSzVv   TO ەSzV.
005910     MOVE ېzVv   TO ېzV.
005950     MOVE یv       TO ی  .
005960     MOVE ۓv       TO ۓ  .
005970     MOVE ۔pzv     TO ۔pz.
005910     MOVE ەSzv     TO ەSz.
005910     MOVE ېzv     TO ېz.
005980     MOVE یUv     TO یU  .
005990     MOVE ۓUv     TO ۓU  .
006000     MOVE ۔pzUv   TO ۔pzU.
005910     MOVE ەSzUv   TO ەSzU.
005910     MOVE ېzUv   TO ېzU.
006040     MOVE ޖ{v       TO ޖ{  .
006050     MOVE ޖ{v       TO ޖ{  .
006060     MOVE ޖ{pzv     TO ޖ{pz.
005910     MOVE ޖ{Szv     TO ޖ{Sz.
005910     MOVE ޖ{zv     TO ޖ{z.
006130     MOVE މƌv       TO މƌ  .
006140     MOVE މƓv       TO މƓ  .
006150     MOVE މƔpzv     TO މƔpz.
005910     MOVE މƕSzv     TO މƕSz.
005910     MOVE މƐzv     TO މƐz.
006160     MOVE ސEUv     TO ސEU  .
006170     MOVE ސEUv     TO ސEU  .
006180     MOVE ސEpzUv   TO ސEpzU.
005910     MOVE ސESzUv   TO ސESzU.
005910     MOVE ސEzUv   TO ސEzU.
005890     MOVE ㍂Xv     TO ㍂X  .
005900     MOVE ㍂Xv     TO ㍂X  .
005910     MOVE ㍂pzXv   TO ㍂pzX.
005910     MOVE ㍂SzXv   TO ㍂SzX.
005910     MOVE ㍂zXv   TO ㍂zX.
005920     MOVE ㍂Vv     TO ㍂V  .
005930     MOVE ㍂Vv     TO ㍂V  .
005940     MOVE ㍂pzVv   TO ㍂pzV.
005910     MOVE ㍂SzVv   TO ㍂SzV.
005910     MOVE ㍂zVv   TO ㍂zV.
006211*
006222*================================================================*
006230 擾 SECTION.
006240*
006250*********************************************************
006260* Af[^ی҃}X^萿擾B      *
006270*  ...... 於̂vɊi[                    *
006280*********************************************************
006290     MOVE P|ی   TO ہ|ی.
           IF P|ی NOT = 01 AND 08
               MOVE 01           TO ہ|ی
           END-IF.
006300     MOVE یҔԍv     TO ہ|یҔԍ.
006310     READ ی҃}X^
006320     INVALID KEY
006330         MOVE SPACE           TO 於̂v
006340     NOT INVALID KEY
006350         STRING ہ|یҖ  DELIMITED BY SPACE
                      ""            DELIMITED BY SIZE
                 INTO 於̂v
               END-STRING
006360     END-READ.
006222*================================================================*
006230 s擾 SECTION.
006240*
006250*********************************************************
006260* Af[^s}X^萿擾B      *
006270*  ...... 於̂vɊi[                    *
006280*********************************************************
006290     MOVE P|ی   TO s|.
006300     MOVE یҔԍv     TO s|sԍ.
006310     READ s}X^
006320     INVALID KEY
006330         MOVE SPACE           TO 於̂v
006340     NOT INVALID KEY
006350         STRING s|s  DELIMITED BY SPACE
                      ""            DELIMITED BY SIZE
                 INTO 於̂v
               END-STRING
006360     END-READ.
006370*================================================================*
006380 ׈ SECTION.
006390*
006050     IF ( I[vtO NOT = "YES" )
006060        MOVE "YES" TO I[vtO
006070        OPEN I-O  t@C
006080        PERFORM G[o
006090     END-IF.
006400     MOVE "YGN586P"  TO  `̖o.
006410     MOVE "SCREEN"   TO  ڌQo.
006420     WRITE YGN586P.
006430     PERFORM G[o.
006510*================================================================*
006520 G[o SECTION.
006530*
006540     IF ʒmo NOT = "00"
006550         DISPLAY NC"[G["              UPON CONS
006560         DISPLAY NC"ڌQoF" ڌQo UPON CONS
006570         DISPLAY NC"ʒmoF" ʒmo UPON CONS
006580         DISPLAY NC"goF" go UPON CONS
006590         DISPLAY NC"P͂dmsdqL[Ă"
006600                                             UPON CONS
004380*-----------------------------------------*
004390         CALL "actcshm"  WITH C LINKAGE
004400*-----------------------------------------*
006610         ACCEPT  L[ FROM CONS
006620         PERFORM t@C
006630         MOVE 99 TO PROGRAM-STATUS
006640         EXIT PROGRAM
006650     END-IF.
006660*================================================================*
006670 G[\q SECTION.
006680*
006690     DISPLAY NC"t@CǍG[" t@Cv UPON CONS.
006700     DISPLAY NC"P͂dmsdqL[Ă" UPON CONS.
004380*-----------------------------------------*
004390     CALL "actcshm"  WITH C LINKAGE.
004400*-----------------------------------------*
006710     ACCEPT  L[ FROM CONS.
006720     PERFORM t@C.
006730     EXIT PROGRAM.
007360*================================================================*
007370 eXg SECTION.
007380*
           MOVE 9999999 TO ۔pzX ۔pzV ۔pz ۔pzU
                           ޖ{pz މƔpz ސEpzU ㍂pzX ㍂pzV
                           ەSzX ەSzV ەSz ەSzU
                           ޖ{Sz މƕSz ސESzU ㍂SzX ㍂SzV
                           ېzX ېzV ېz ېzU
                           ޖ{z މƐz ސEzU ㍂zX ㍂zV.
           MOVE 999     TO یX ۓX یV ۓV ی ۓ
                           یU ۓU ޖ{ ޖ{ މƌ މƓ
                           ސEU ސEU ㍂X ㍂X ㍂V ㍂V.
006830*================================================================*
006840******************************************************************
006850 END PROGRAM YGN586.
006860******************************************************************
