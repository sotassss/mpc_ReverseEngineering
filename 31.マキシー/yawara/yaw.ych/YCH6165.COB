000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YCH6165.
000060 AUTHOR.                 rc@Kq
000070*
000080*----------------------------------------------------------------*
000090*          ЕۃZvgi_+޳ޔŁj
000100*         MED = YAW610 YCH6125P
000110*----------------------------------------------------------------*
000120 DATE-WRITTEN.           2011-03-08
000130 DATE-COMPILED.          2011-03-08
      */̓Z|ʎ]L/160816
      */qE^Â̕ύXEǉ/1805
      */쌧̂ǂ̏Ŏ󋋎ҕSL/2106
000140*----------------------------------------------------------------*
000150******************************************************************
000160*            ENVIRONMENT         DIVISION                        *
000170******************************************************************
000180 ENVIRONMENT             DIVISION.
000190 CONFIGURATION           SECTION.
000200 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000210 OBJECT-COMPUTER.        FMV-DESKPOWER.
000220 SPECIAL-NAMES.          CONSOLE  IS  CONS
000230                         SYSERR   IS  MSGBOX.
000240 INPUT-OUTPUT            SECTION.
000250 FILE-CONTROL.
000260     SELECT  ی҃}X^    ASSIGN      TO        HOKENSL
000270                             ORGANIZATION             IS  INDEXED
000280                             ACCESS MODE              IS  DYNAMIC
000290                             RECORD KEY               IS  ہ|ی
000300                                                          ہ|یҔԍ
000310* ́AL[ڂ̕یҖ̂ی҃Jiɂ
000320                             ALTERNATE RECORD KEY     IS  ہ|ی
000330                                                          ہ|یҖ
000340                                                          ہ|یҔԍ
000350                             FILE STATUS              IS  ԃL[
000360                             LOCK        MODE         IS  AUTOMATIC.
000370     SELECT  }X^      ASSIGN      TO        GENGOUL
000380                             ORGANIZATION             IS  INDEXED
000390                             ACCESS MODE              IS  DYNAMIC
000400                             RECORD KEY               IS  |敪
000410                             FILE STATUS              IS  ԃL[
000420                             LOCK        MODE         IS  AUTOMATIC.
000430     SELECT  ̃}X^      ASSIGN      TO        MEISYOL
000440                             ORGANIZATION             IS  INDEXED
000450                             ACCESS MODE              IS  DYNAMIC
000460                             RECORD KEY               IS  |敪R[h
000470                                                          |̃R[h
000480                             FILE STATUS              IS  ԃL[
000490                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  Zvge      ASSIGN      TO        RECEPTL
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  Z|{paN
000170                                                          Z|҃R[h
000180                                                          Z|Z
000190                             ALTERNATE RECORD KEY     IS  Z|҃R[h
000200                                                          Z|{paN
000210                                                          Z|Z
000220                             ALTERNATE RECORD KEY     IS  Z|aN
000230                                                          Z|{paN
000240                                                          Z|҃R[h
000250                                                          Z|Z
000260                             ALTERNATE RECORD KEY     IS  Z|aN
000270                                                          Z|Z
000280                                                          Z|یҔԍ
000290                                                          Z|҃R[h
000300                                                          Z|{paN
000310                             ALTERNATE RECORD KEY     IS  Z|aN
000320                                                          Z|یҔԍ
000330                                                          Z|҃R[h
000340                                                          Z|Z
000350                                                          Z|{paN
000360                             FILE STATUS              IS  ԃL[
000370                             LOCK        MODE         IS  AUTOMATIC.
000560     SELECT  }X^  ASSIGN      TO        SEIGYOL
000570                             ORGANIZATION             IS  INDEXED
000580                             ACCESS MODE              IS  DYNAMIC
000590                             RECORD KEY               IS  |敪
000600                             FILE STATUS              IS  ԃL[
000610                             LOCK        MODE         IS  AUTOMATIC.
000620     SELECT  {p}X^ ASSIGN      TO        SEJOHOL
000630                             ORGANIZATION             IS  INDEXED
000640                             ACCESS MODE              IS  DYNAMIC
000650                             RECORD KEY               IS  {|{pԍ
000660                             FILE STATUS              IS  ԃL[
000670                             LOCK        MODE         IS  AUTOMATIC.
000680     SELECT  }X^    ASSIGN      TO        SEIKYUSL
000690                             ORGANIZATION             IS  INDEXED
000700                             ACCESS MODE              IS  DYNAMIC
000710                             RECORD KEY               IS  |ی
000720                                                          |یҔԍ
000730                             FILE STATUS              IS  ԃL[
000740                             LOCK    MODE             IS  AUTOMATIC.
000750     SELECT  o߃}X^      ASSIGN      TO        KEIKAL
000760                             ORGANIZATION             IS  INDEXED
000770                             ACCESS MODE              IS  DYNAMIC
000780                             RECORD KEY               IS  o|敪R[h
000790                                                          o|o߃R[h
000800                             FILE STATUS              IS  ԃL[
000810                             LOCK        MODE         IS  AUTOMATIC.
000820     SELECT  fҏe    ASSIGN      TO        JUSINJL
000830                             ORGANIZATION             IS  INDEXED
000840                             ACCESS MODE              IS  DYNAMIC
000850                             RECORD KEY               IS  |{paN
000860                                                          |҃R[h
000870                             ALTERNATE RECORD KEY     IS  |{paN
000880                                                          |҃Ji
000890                                                          |҃R[h
000900                             ALTERNATE RECORD KEY     IS  |҃R[h
000910                                                          |{paN
000920                             ALTERNATE RECORD KEY     IS  |{paN
000930                                                          |ی
000940                                                          |یҔԍ
000950                                                          |҃R[h
000960                             ALTERNATE RECORD KEY     IS  |{paN
000970                                                          |
000980                                                          |pSҔԍ
000990                                                          |҃R[h
001000                             ALTERNATE RECORD KEY     IS  |{paN
001010                                                          |
001020                                                          |pSҔԍ
001030                                                          |҃R[h
001040                             ALTERNATE RECORD KEY     IS  |aN
001050                                                          |{paN
001060                                                          |҃R[h
001070                             FILE STATUS              IS  ԃL[
001080                             LOCK        MODE         IS  AUTOMATIC.
001090     SELECT  {pL^e      ASSIGN      TO        SEKIROKL
001100                             ORGANIZATION             IS  INDEXED
001110                             ACCESS MODE              IS  DYNAMIC
001120                             RECORD KEY               IS  {L|{paN
001130                                                          {L|҃R[h
001140                             ALTERNATE RECORD KEY     IS  {L|҃R[h
001150                                                          {L|{paN
001160                             FILE STATUS              IS  ԃL[
001170                             LOCK        MODE         IS  AUTOMATIC.
001180     SELECT  f[^e    ASSIGN      TO        HUSYOUL
001190                             ORGANIZATION             IS  INDEXED
001200                             ACCESS MODE              IS  DYNAMIC
001210                             RECORD KEY               IS  |{paN
001220                                                          |҃R[h
001230                             ALTERNATE RECORD KEY     IS  |҃R[h
001240                                                          |{paN
001250                             FILE STATUS              IS  ԃL[
001260                             LOCK        MODE         IS  AUTOMATIC.
001270*
001280     SELECT  e      ASSIGN      TO        HUGEINL
001290                             ORGANIZATION             IS  INDEXED
001300                             ACCESS MODE              IS  DYNAMIC
001310                             RECORD KEY               IS  |敪R[h
001320                                                          |R[h
001330                             FILE STATUS              IS  ԃL[
001340                             LOCK        MODE         IS  AUTOMATIC.
001350     SELECT  t@C    ASSIGN      TO        MEMOL
001360                             ORGANIZATION             IS  INDEXED
001370                             ACCESS MODE              IS  DYNAMIC
001380                             RECORD KEY               IS  |敪
001390                                                          |҃R[h
001400                                                          |{paN
001410                             ALTERNATE RECORD KEY     IS  |敪
001420                                                          |{paN
001430                                                          |҃R[h
001440                             ALTERNATE RECORD KEY     IS  |҃R[h
001450                                                          |{paN
001460                                                          |敪
001470                             FILE STATUS              IS  ԃL[
001480                             LOCK        MODE         IS  AUTOMATIC.
001490* я󎚗p
001500     SELECT  ƃt@CS  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W5912L.DAT"
001510                             ORGANIZATION             IS  INDEXED
001520                             ACCESS                   IS  DYNAMIC
001530                             RECORD      KEY          IS  S|{paN
001540                                                          S|҃R[h
001550                                                          S|ی
001560                             FILE        STATUS       IS  ԃL[
001570                             LOCK        MODE         IS  AUTOMATIC.
001580     SELECT  t@C    ASSIGN      TO     GS-PRTF002
001590                             SYMBOLIC    DESTINATION  IS "PRT"
001600                             FORMAT                   IS  `̖o
001610                             GROUP                    IS  ڌQo
001620                             PROCESSING  MODE         IS  ʂo
001630                             UNIT        CONTROL      IS  go
001640                             FILE        STATUS       IS  ʒmo.
001650******************************************************************
001660*                      DATA DIVISION                             *
001670******************************************************************
001680 DATA                    DIVISION.
001690 FILE                    SECTION.
001700*                           mqk  RQOn
001710 FD  ی҃}X^        BLOCK   CONTAINS   1   RECORDS.
001720     COPY HOKENS          OF  XFDLIB  JOINING      AS  PREFIX.
001730*                           mqk  PQWn
001740 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001750     COPY GENGOU          OF  XFDLIB  JOINING      AS  PREFIX.
001760*                           mqk  PQWn
001770 FD  ̃}X^          BLOCK   CONTAINS   1   RECORDS.
001780     COPY MEISYO          OF  XFDLIB  JOINING      AS  PREFIX.
      *                          mqk  PTRUn
       FD  Zvge          BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   Z  AS  PREFIX.
001820*                           mqk  QTUn
001830 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001840     COPY SEIGYO          OF  XFDLIB  JOINING      AS  PREFIX.
001850*                           mqk  PQWn
001860 FD  {p}X^          BLOCK   CONTAINS   1   RECORDS.
001870     COPY SEJOHO         OF  XFDLIB  JOINING   {   AS  PREFIX.
001880*                           mqk  PQWn
001890 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
001900     COPY SEIKYUS         OF  XFDLIB  JOINING      AS  PREFIX.
001910*                           mqk  PQWn
001920 FD  o߃}X^          BLOCK   CONTAINS   1   RECORDS.
001930     COPY KEIKA          OF  XFDLIB  JOINING   o   AS  PREFIX.
001940*                           mqk  RQOn
001950 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
001960     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
001970*                           mqk  QTUn
001980 FD  {pL^e          BLOCK   CONTAINS   1   RECORDS.
001990     COPY SEKIROK         OF  XFDLIB  JOINING   {L AS  PREFIX.
002000*                           mqk  PQWn
002010 FD  f[^e        BLOCK   CONTAINS   1   RECORDS.
002020     COPY HUSYOU          OF  XFDLIB  JOINING      AS  PREFIX.
002030*                           mqk  PQWn
002040 FD  e         BLOCK   CONTAINS   1   RECORDS.
002050     COPY HUGEIN          OF  XFDLIB  JOINING      AS  PREFIX.
002060*                           mqk  WRQn
002070 FD  t@C        BLOCK CONTAINS 1     RECORDS.
002080     COPY MEMO           OF    XFDLIB JOINING  AS PREFIX.
002090**
002100 FD  ƃt@CS RECORD  CONTAINS 32 CHARACTERS.
002110 01  S|R[h.
002120     03  S|R[hL[.
002130         05  S|{paN.
002140             07  S|{pa            PIC 9.
002150             07  S|{pN              PIC 9(2).
002160             07  S|{p              PIC 9(2).
002170         05  S|҃R[h.
002180             07 S|Ҕԍ             PIC 9(6).
002190             07 S|}                 PIC X(1).
002200         05  S|ی                PIC 9(2).
002210     03  S|R[hf[^.
002220         05  S|                    PIC 9(4).
002230         05  FILLER                        PIC X(14).
002240*
002250 FD  t@C.
002260     COPY YCH6125P       OF  XMDLIB.
002270*----------------------------------------------------------------*
002280******************************************************************
002290*                WORKING-STORAGE SECTION                         *
002300******************************************************************
002310 WORKING-STORAGE         SECTION.
002320 01 L[                           PIC X     VALUE SPACE.
002330 01 ԃL[                           PIC X(2)  VALUE SPACE.
002340 01 ItO                         PIC X(3)  VALUE SPACE.
002350 01 ItOQ                       PIC X(3)  VALUE SPACE.
002820 01 ItOR                       PIC X(3)  VALUE SPACE.
002360 01 tO                         PIC X(3)  VALUE SPACE.
002370 01 t@C                         PIC N(6)  VALUE SPACE.
002380 01 Zvgofv                     PIC X(8)  VALUE SPACE.
002390 01 Oav                           PIC 9     VALUE ZERO.
002400 01 Jgv                     PIC 9(1)  VALUE ZERO.
002410 01 ʂbms                         PIC 9     VALUE ZERO.
002420 01 Ҕԍv                         PIC 9(6)  VALUE ZERO.
002430 01 ̂v                         PIC N(6)  VALUE SPACE.
002440 01 ʖ̂v                         PIC N(12) VALUE SPACE.
002450 01 ʒv                           PIC 9(2) VALUE 1.
001363 01 Sp                           PIC X(2)  VALUE X"8140".
001364 01 p                           PIC X(2)  VALUE X"2020".
002870 01 pʂv                         PIC 9(1)  VALUE ZERO.
002460** {ϊ
002470 01 v                             PIC 9(2).
002480 01 q REDEFINES v.
002490    03 vP                        PIC X(1).
002500    03 vQ                        PIC X(1).
002510 01 ԍv                         PIC 9.
002520 01 ԍq REDEFINES ԍv.
002530    03 ԍvP                    PIC X.
002540*
002550 01 Spԍv                     PIC N     VALUE SPACE.
002560 01 Spԍq REDEFINES Spԍv.
002570    03 SpԍvP                PIC X(2).
002580*
002590 01 JE^                           PIC 9(2)  VALUE ZERO.
002600 01 JE^Q                         PIC 9(2)  VALUE ZERO.
002610*
002620* ޔp
002630 01 INvs.
002640    03 INvs                      PIC 9(2)  VALUE ZERO.
002650    03 Ivs                      PIC 9(2)  VALUE ZERO.
002660    03 Ivs                      PIC 9(2)  VALUE ZERO.
002670* ޔp
002680 01 Nvs.
002690    03 avs                    PIC 9     VALUE ZERO.
002700    03 Nvs                      PIC 9(2)  VALUE ZERO.
002710    03 vs                      PIC 9(2)  VALUE ZERO.
002720    03 vs                      PIC 9(2)  VALUE ZERO.
002730*
002740* Zp
002750 01 Zvs.
002760    03 ZJEg                PIC 9    VALUE ZERO.
002770    03 ԍJE^                    PIC 9    VALUE ZERO.
002780    03 ZWcvs  OCCURS 3.
002790       05 Z敪vs             PIC 9    VALUE ZERO.
002800       05 Zvs               PIC 9(2) VALUE ZERO.
002810       05 Zvs               PIC 9(2) VALUE ZERO.
002820    03 ZWcmv  OCCURS 3.
002830       05 Z؂v                   PIC N(1) VALUE SPACE.
002840       05 Zev                   PIC N(3) VALUE SPACE.
002850       05 ZmvP             PIC N(1) VALUE SPACE.
002860       05 ZmvQ             PIC N(1) VALUE SPACE.
002870       05 Œv                     PIC N(1) VALUE SPACE.
002880       05 ZmvP             PIC N(1) VALUE SPACE.
002890       05 ZmvQ             PIC N(1) VALUE SPACE.
002900       05 Œv                     PIC N(1) VALUE SPACE.
002910    03 ZPv                PIC N(10) VALUE SPACE.
002920    03 ZQv                PIC N(10) VALUE SPACE.
002930    03 ZRv                PIC N(10) VALUE SPACE.
003070    03 Z؂v                  PIC X     VALUE SPACE.
003080    03 Zv                    PIC 9(2)  VALUE ZERO.
003090    03 Zv                    PIC 9(2)  VALUE ZERO.
002940* p
002950 01 vs.
002960    03 Pvs                  PIC X(60) VALUE SPACE.
002970    03 Qvs                  PIC X(60) VALUE SPACE.
002980    03 Rvs                  PIC X(60) VALUE SPACE.
002990    03 Svs                  PIC X(60) VALUE SPACE.
003000    03 Tvs                  PIC X(60) VALUE SPACE.
003010    03 io[vs.
003020       05 io[vP         PIC X(2) OCCURS 9 VALUE SPACE.
003030    03 io[mv  REDEFINES io[vs PIC X(18).
003040 01 Ҕԍbv                   PIC 9(6)  VALUE ZERO.
003050 01 AԂbv                       PIC 9(4)  VALUE ZERO.
003060 01 sak.
003070    03 R[hsak            OCCURS 9.
003080       05 Ҕԍv               PIC 9(6)  VALUE ZERO.
003090       05 AԂv                   PIC 9(4)  VALUE ZERO.
003100       05 ʂv               PIC 9  OCCURS 9 VALUE ZERO.
003110 01 ev.
003120    03 ev              PIC X(318) OCCURS 9 VALUE SPACE.
003130    03 ewv.
003140       05 ePwv           PIC X(80)  VALUE SPACE.
003150       05 eQwv           PIC X(80)  VALUE SPACE.
003160       05 eRwv           PIC X(80)  VALUE SPACE.
003700       05 eSwv           PIC X(78)  VALUE SPACE.
003170*
003180*
003190** Ôݗp
003200 01 ČtO                     PIC X(3)  VALUE SPACE.
003210 01 OtO                         PIC X(3)  VALUE SPACE.
003220*
003230 01 vZNv.
003240    03 vZav                      PIC 9(1)  VALUE ZERO.
003250    03 vZNv                        PIC S9(2)  VALUE ZERO.
003260    03 vZv                        PIC S9(2)  VALUE ZERO.
003270    03 vZv                        PIC S9(2)  VALUE ZERO.
003280 01 JnNQv.
003290    03 JnaQv                    PIC 9(1)  VALUE ZERO.
003300    03 JnNQv                      PIC 9(2)  VALUE ZERO.
003310    03 JnQv                      PIC 9(2)  VALUE ZERO.
003320    03 JnQv                      PIC 9(2)  VALUE ZERO.
003330    03 JnNv                    PIC S9(4) VALUE ZERO.
003340 01 INQv.
003350    03 IaQv                    PIC 9(1)  VALUE ZERO.
003360    03 INQv                      PIC 9(2)  VALUE ZERO.
003370    03 IQv                      PIC 9(2)  VALUE ZERO.
003380    03 IQv                      PIC 9(2)  VALUE ZERO.
003390    03 INv                    PIC S9(4) VALUE ZERO.
003400***
003410** ER敪p
003420 01 敪v                 PIC 9 VALUE ZERO.
003430 01 R敪v                 PIC 9 VALUE ZERO.
003440*
003450** Zi̓t敪p (0:ŏIʉ@A1:A9:󎚂Ȃ)
003460 01 Zvgt敪v                 PIC 9 VALUE ZERO.
003470 01 Zvgғt敪v             PIC 9 VALUE ZERO.
003480*
003490*
003500** p
003510 01 {pNv                       PIC 9(4)  VALUE ZERO.
003520 01 v                               PIC 9(3)  VALUE ZERO.
003530 01 ]v                               PIC 9(3)  VALUE ZERO.
003540*
003550** }Ԕp
003560 01 JnfÓ蓮敪v               PIC 9    VALUE ZERO.
003570*
003580*
003590** ZEvp( N(38)Œj /
003600 01 ̌o߂v.
003610    03 ̌oߍsv                  PIC X(76) OCCURS 2 VALUE SPACE.
003620 01 ̌o߂mv REDEFINES ̌o߂v.
003630    03 ̌oߍsmv                PIC N(38) OCCURS 2.
003640*
003650* 敪
003660 01 Z敪v             PIC 9    VALUE ZERO.
003670*
003460 01 R敪e                 PIC 9 VALUE ZERO.
003671*
003672* ̌oߌŒ󎚗pɎgp
003673 01 S_eoc敪v                   PIC 9     VALUE ZERO.
003674 01 oߕʐv                     PIC N(1)  VALUE SPACE.
      *
004490* 쌧p
004500 01 󋋎ҔԍҏWv.
004510    03 󋋎ҔԍҏWvP              PIC X(3)  VALUE SPACE.
004520    03 󋋎ҋ؂P                    PIC X     VALUE SPACE.
004530    03 󋋎ҔԍҏWvQ              PIC X(2)  VALUE SPACE.
004540    03 󋋎ҋ؂Q                    PIC X     VALUE SPACE.
004550    03 󋋎ҔԍҏWvR              PIC X(10) VALUE SPACE.
      *
      */qE^Â̕ύXEǉ/1805
       01 qblP                     PIC X(130) VALUE SPACE.
       01 qblQ                     PIC X(170) VALUE SPACE.
       01 ^Âbl                       PIC X(68)  VALUE SPACE.
003675*
004770******************************
004780* T  Ev  ҏWp *
004790******************************
004800 01 ʂTv.
004840   03 JnTv.
004850      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
004870      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
         03 ʂPv                         PIC X(1).
004890   03 ÂTv.
            05 ʂQv                      PIC X(1).
004900      05 ÒPTv                  PIC ZZZZ.
            05 ZLPv                  PIC X(1).
004920      05 É񐔂Tv                  PIC ZZ.
            05 CR[Pv                  PIC X(1).
004940      05 ×Tv                    PIC ZZ,ZZZ.
         03 ʂRv                         PIC X(1).
         03 ZLPv                     PIC X(1).
         03 ʂSv                         PIC X(1).
004960   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLQv                  PIC X(1).
004970      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Qv                  PIC X(1).
004990      05 㪖@Tv                  PIC ZZZZ.
         03 ʂTv                         PIC X(1).
         03 ZLQv                     PIC X(1).
         03 ʂUv                         PIC X(1).
005010   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLRv                  PIC X(1).
005020      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Rv                  PIC X(1).
005040      05 㪖@Tv                  PIC ZZZZ.
         03 ʂVv                         PIC X(1).
         03 ZLRv                     PIC X(1).
         03 ʂWv                         PIC X(1).
005060   03 dÂTv.
            05 dÒPTv                  PIC Z(2).
            05 ZLSv                  PIC X(1).
005070      05 dÉ񐔂Tv                  PIC ZZ.
            05 CR[Sv                  PIC X(1).
005090      05 d×Tv                    PIC ZZZZ.
            05 ʂXv                      PIC X(1).
         03 ʂPOv                       PIC X(1).
         03 ZLTv                     PIC X(1).
005130   03 ʗTv                     PIC X(3).
         03 ZLUv                     PIC X(1).
005170   03 Tv                   PIC 9.9.
         03 CR[Tv                     PIC X(1).
005190   03 vTv                   PIC ZZ,ZZZ.
003676*
003680*
003690****************
003700* AڑҔ *
003710****************
003720*    ************
003730*    * L[ *
003740*    ************
003750 01 Ώۃf[^vq.
003760    03 {paNvq.
003770       05 {pavq                  PIC 9(1)  VALUE ZERO.
003780       05 {pNvq                    PIC 9(2)  VALUE ZERO.
003790       05 {pvq                    PIC 9(2)  VALUE ZERO.
003800    03 یʂvq                     PIC 9(2)  VALUE ZERO.
003810    03 یҔԍvq                   PIC X(10) VALUE SPACE.
003820    03 ʂvq                     PIC 9(2)  VALUE ZERO.
003830    03 pSҔԍvq               PIC X(10) VALUE SPACE.
003840    03 ʂvq                     PIC 9(2)  VALUE ZERO.
003850    03 pSҔԍvq           PIC X(10) VALUE SPACE.
003860    03 {lƑ敪vq                 PIC 9(1)  VALUE ZERO.
003870    03 ҃Jivq                     PIC X(20) VALUE SPACE.
003880    03 ҃R[hvq.
003890       05 Ҕԍvq                  PIC 9(6)  VALUE ZERO.
003900       05 }Ԃvq                      PIC X(1)  VALUE SPACE.
003910*    ************
003920*    *  *
003930*    ************
003940*    ̗
003950***********************
003960 01 Pvq.
003970   03 vq.
003980      05 Svq               PIC 9(3)    VALUE ZERO.
003990      05 vq                 PIC 9(5)    VALUE ZERO.
004000      05 Zvq             PIC 9(5)    VALUE ZERO.
         03 kvq              PIC 9(4)    VALUE ZERO.
004010   03 Čvq                    PIC 9(5)    VALUE ZERO.
004020   03 Âvq.
004030      05 Ëvq               PIC 9(2)V9  VALUE ZERO.
004040      05 É񐔂vq               PIC 9(2)    VALUE ZERO.
004050      05 ×vq                 PIC 9(6)    VALUE ZERO.
004060      05 ÉZvq             PIC 9(5)    VALUE ZERO.
004070   03 qZvq            PIC 9(5)    VALUE ZERO.
004080   03 {p񋟗vq            PIC 9(5)    VALUE ZERO.
004090   03 vvq                      PIC 9(6)    VALUE ZERO.
004100   03 ꕔSvq                PIC 9(6)    VALUE ZERO.
004110   03 zvq                  PIC 9(6)    VALUE ZERO.
004120   03 tvq                  PIC 9(1)    VALUE ZERO.
004130   03 󋋎ҕSzvq              PIC 9(6)    VALUE ZERO.
004140   03 zvq              PIC 9(6)    VALUE ZERO.
004150*
004160* ʖ̗
004170***********************
004180 01 Qvq.
004190   03 񏈒uvq    OCCURS   9.
004200      05 񏈒uvq             PIC 9(5)    VALUE ZERO.
004210*
004220* ̗
004230***********************
004240 01 Rvq.
004250**********
004260* P *
004270**********
004280   03 ʂPvq.
004290      05 ÂPvq.
004300         07 ÒPPvq              PIC 9(4)    VALUE ZERO.
004310         07 É񐔂Pvq              PIC 9(2)    VALUE ZERO.
004320         07 ×Pvq                PIC 9(5)    VALUE ZERO.
004330      05 㪖@Pvq.
004340         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004350         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
004360      05 㪖@Pvq.
004370         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004380         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
004390      05 dÂPvq.
004400         07 dÉ񐔂Pvq              PIC 9(2)    VALUE ZERO.
004410         07 d×Pvq                PIC 9(4)    VALUE ZERO.
004420      05 vPvq                     PIC 9(6)    VALUE ZERO.
004430      05 Pvq               PIC 9(3)    VALUE ZERO.
004440      05 vPvq               PIC 9(6)    VALUE ZERO.
004450**********
004460* Q *
004470**********
004480   03 ʂQvq.
004490      05 ÂQvq.
004500         07 ÒPQvq              PIC 9(4)    VALUE ZERO.
004510         07 É񐔂Qvq              PIC 9(2)    VALUE ZERO.
004520         07 ×Qvq                PIC 9(5)    VALUE ZERO.
004530      05 㪖@Qvq.
004540         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
004550         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
004560      05 㪖@Qvq.
004570         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
004580         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
004590      05 dÂQvq.
004600         07 dÉ񐔂Qvq              PIC 9(2)    VALUE ZERO.
004610         07 d×Qvq                PIC 9(4)    VALUE ZERO.
004620      05 vQvq                     PIC 9(6)    VALUE ZERO.
004630      05 Qvq               PIC 9(3)    VALUE ZERO.
004640      05 vQvq               PIC 9(6)    VALUE ZERO.
004650******************
004660* Rʁ^W *
004670******************
004680   03 ʂRWvq.
004690      05 ÂRWvq.
004700         07 ÒPRWvq              PIC 9(4)  VALUE ZERO.
004710         07 É񐔂RWvq              PIC 9(2)  VALUE ZERO.
004720         07 ×RWvq                PIC 9(5)  VALUE ZERO.
004730      05 㪖@RWvq.
004740         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
004750         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
004760      05 㪖@RWvq.
004770         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
004780         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
004790      05 dÂRWvq.
004800         07 dÉ񐔂RWvq              PIC 9(2)  VALUE ZERO.
004810         07 d×RWvq                PIC 9(4)  VALUE ZERO.
004820      05 vRWvq                     PIC 9(6)  VALUE ZERO.
004830      05 ʍvRWvq             PIC 9(6)  VALUE ZERO.
004840      05 RWvq               PIC 9(3)  VALUE ZERO.
004850      05 vRWvq               PIC 9(6)  VALUE ZERO.
004860******************
004870* Rʁ^PO *
004880******************
004890   03 ʂROvq.
004900      05 JnROvq.
004910         07 JnROvq            PIC 9(2)  VALUE ZERO.
004920         07 JnROvq            PIC 9(2)  VALUE ZERO.
004930      05 ÂROvq.
004940         07 ÒPROvq              PIC 9(4)  VALUE ZERO.
004950         07 É񐔂ROvq              PIC 9(2)  VALUE ZERO.
004960         07 ×ROvq                PIC 9(5)  VALUE ZERO.
004970      05 㪖@ROvq.
004980         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
004990         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005000      05 㪖@ROvq.
005010         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
005020         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005030      05 dÂROvq.
005040         07 dÉ񐔂ROvq              PIC 9(2)  VALUE ZERO.
005050         07 d×ROvq                PIC 9(4)  VALUE ZERO.
005060      05 vROvq                     PIC 9(6)  VALUE ZERO.
005070      05 ROvq               PIC 9(3)  VALUE ZERO.
005080      05 vROvq               PIC 9(6)  VALUE ZERO.
005090****************
005100* Sʁ^T *
005110****************
005120   03 ʂSTvq.
005130      05 ÂSTvq.
005140         07 ÒPSTvq              PIC 9(4)  VALUE ZERO.
005150         07 É񐔂STvq              PIC 9(2)  VALUE ZERO.
005160         07 ×STvq                PIC 9(5)  VALUE ZERO.
005170      05 㪖@STvq.
005180         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005190         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005200      05 㪖@STvq.
005210         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005220         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005230      05 dÂSTvq.
005240         07 dÉ񐔂STvq              PIC 9(2)  VALUE ZERO.
005250         07 d×STvq                PIC 9(4)  VALUE ZERO.
005260      05 vSTvq                     PIC 9(6)  VALUE ZERO.
005270      05 ʍvSTvq             PIC 9(6)  VALUE ZERO.
005280      05 STvq               PIC 9(3)  VALUE ZERO.
005290      05 vSTvq               PIC 9(6)  VALUE ZERO.
005300****************
005310* Sʁ^W *
005320****************
005330   03 ʂSWvq.
005340      05 JnSWvq.
005350         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005360         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005370      05 ÂSWvq.
005380         07 ÒPSWvq              PIC 9(4)  VALUE ZERO.
005390         07 É񐔂SWvq              PIC 9(2)  VALUE ZERO.
005400         07 ×SWvq                PIC 9(5)  VALUE ZERO.
005410      05 㪖@SWvq.
005420         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
005430         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
005440      05 㪖@SWvq.
005450         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
005460         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
005470      05 dÂSWvq.
005480         07 dÉ񐔂SWvq              PIC 9(2)  VALUE ZERO.
005490         07 d×SWvq                PIC 9(4)  VALUE ZERO.
005500      05 vSWvq                     PIC 9(6)  VALUE ZERO.
005510      05 ʍvSWvq             PIC 9(6)  VALUE ZERO.
005520      05 SWvq               PIC 9(3)  VALUE ZERO.
005530      05 vSWvq               PIC 9(6)  VALUE ZERO.
005540******************
005550* Sʁ^PO *
005560******************
005570   03 ʂSOvq.
005580      05 JnSOvq.
005590         07 JnSOvq            PIC 9(2)  VALUE ZERO.
005600         07 JnSOvq            PIC 9(2)  VALUE ZERO.
005610      05 ÂSOvq.
005620         07 ÒPSOvq              PIC 9(4)  VALUE ZERO.
005630         07 É񐔂SOvq              PIC 9(2)  VALUE ZERO.
005640         07 ×SOvq                PIC 9(5)  VALUE ZERO.
005650      05 㪖@SOvq.
005660         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
005670         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
005680      05 㪖@SOvq.
005690         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
005700         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
005710      05 dÂSOvq.
005720         07 dÉ񐔂SOvq              PIC 9(2)  VALUE ZERO.
005730         07 d×SOvq                PIC 9(4)  VALUE ZERO.
005740      05 vSOvq                     PIC 9(6)  VALUE ZERO.
005750      05 SOvq               PIC 9(3)  VALUE ZERO.
005760      05 vSOvq               PIC 9(6)  VALUE ZERO.
005770********************
005780* Tʁ^QDT *
005790********************
005800   03 ʂTQvq.
005810      05 ÂTQvq.
005820         07 ÒPTQvq              PIC 9(4)  VALUE ZERO.
005830         07 É񐔂TQvq              PIC 9(2)  VALUE ZERO.
005840         07 ×TQvq                PIC 9(5)  VALUE ZERO.
005850      05 㪖@TQvq.
005860         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
005870         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
005880      05 㪖@TQvq.
005890         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
005900         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
005910      05 dÂTQvq.
005920         07 dÉ񐔂TQvq              PIC 9(2)  VALUE ZERO.
005930         07 d×TQvq                PIC 9(4)  VALUE ZERO.
005940      05 vTQvq                     PIC 9(6)  VALUE ZERO.
005950      05 ʍvTQvq             PIC 9(6)  VALUE ZERO.
005960      05 TQvq               PIC 9(3)  VALUE ZERO.
005970      05 vTQvq               PIC 9(6)  VALUE ZERO.
005980****************
005990* Tʁ^T *
006000****************
006010   03 ʂTTvq.
006020      05 JnTTvq.
006030         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006040         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006050      05 ÂTTvq.
006060         07 ÒPTTvq              PIC 9(4)  VALUE ZERO.
006070         07 É񐔂TTvq              PIC 9(2)  VALUE ZERO.
006080         07 ×TTvq                PIC 9(5)  VALUE ZERO.
006090      05 㪖@TTvq.
006100         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006110         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006120      05 㪖@TTvq.
006130         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006140         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006150      05 dÂTTvq.
006160         07 dÉ񐔂TTvq              PIC 9(2)  VALUE ZERO.
006170         07 d×TTvq                PIC 9(4)  VALUE ZERO.
006180      05 vTTvq                     PIC 9(6)  VALUE ZERO.
006190      05 ʍvTTvq             PIC 9(6)  VALUE ZERO.
006200      05 TTvq               PIC 9(3)  VALUE ZERO.
006210      05 vTTvq               PIC 9(6)  VALUE ZERO.
006220****************
006230* Tʁ^W *
006240****************
006250   03 ʂTWvq.
006260      05 JnTWvq.
006270         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006280         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006290      05 ÂTWvq.
006300         07 ÒPTWvq              PIC 9(4)  VALUE ZERO.
006310         07 É񐔂TWvq              PIC 9(2)  VALUE ZERO.
006320         07 ×TWvq                PIC 9(5)  VALUE ZERO.
006330      05 㪖@TWvq.
006340         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006350         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
006360      05 㪖@TWvq.
006370         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006380         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
006390      05 dÂTWvq.
006400         07 dÉ񐔂TWvq              PIC 9(2)  VALUE ZERO.
006410         07 d×TWvq                PIC 9(4)  VALUE ZERO.
006420      05 vTWvq                     PIC 9(6)  VALUE ZERO.
006430      05 ʍvTWvq             PIC 9(6)  VALUE ZERO.
006440      05 TWvq               PIC 9(3)  VALUE ZERO.
006450      05 vTWvq               PIC 9(6)  VALUE ZERO.
006460******************
006470* Tʁ^PO *
006480******************
006490   03 ʂTOvq.
006500      05 JnTOvq.
006510         07 JnTOvq            PIC 9(2)  VALUE ZERO.
006520         07 JnTOvq            PIC 9(2)  VALUE ZERO.
006530      05 ÂTOvq.
006540         07 ÒPTOvq              PIC 9(4)  VALUE ZERO.
006550         07 É񐔂TOvq              PIC 9(2)  VALUE ZERO.
006560         07 ×TOvq                PIC 9(5)  VALUE ZERO.
006570      05 㪖@TOvq.
006580         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
006590         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
006600      05 㪖@TOvq.
006610         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
006620         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
006630      05 dÂTOvq.
006640         07 dÉ񐔂TOvq              PIC 9(2)  VALUE ZERO.
006650         07 d×TOvq                PIC 9(4)  VALUE ZERO.
006660      05 vTOvq                     PIC 9(6)  VALUE ZERO.
006670      05 TOvq               PIC 9(3)  VALUE ZERO.
006680      05 vTOvq               PIC 9(6)  VALUE ZERO.
006690*
006700**************
006710* {p *
006720**************
006730 01 {pv.
006740    03 _tԍv                    PIC X(16)  VALUE SPACE.
006750    03 ڍtԍv              PIC X(16)  VALUE SPACE.
006760    03 \҃Jiv                    PIC X(50)  VALUE SPACE.
006770    03 \Җv                      PIC X(50)  VALUE SPACE.
006780    03 ڍ@v                      PIC X(50)  VALUE SPACE.
          03 s{ihrv                PIC X(2)   VALUE SPACE.
006790    03 {pZv.
006800       05 {pZPv               PIC X(50)  VALUE SPACE.
006810       05 {pZQv               PIC X(50)  VALUE SPACE.
006820    03 {pX֔ԍv.
006830       05 {pX֔ԍPv           PIC X(3)   VALUE SPACE.
006840       05 {pX֔ԍQv           PIC X(4)   VALUE SPACE.
006850    03 {pdbԍv                PIC X(20)  VALUE SPACE.
006860    03 z󗝔ԍv                PIC X(15)  VALUE SPACE.
006870    03 󗝔Nv.
006880       05 󗝔Nv                     PIC 9(2)   VALUE ZERO.
006890       05 󗝌v                     PIC 9(2)   VALUE ZERO.
006900       05 󗝓v                     PIC 9(2)   VALUE ZERO.
006910    03 ŏIʉ@Nv.
006920       05 ŏIʉ@Nv                 PIC 9(2)   VALUE ZERO.
006930       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
006940       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
006950    03 _tNv.
006960       05 _tNv                   PIC 9(2)   VALUE ZERO.
006970       05 _tv                   PIC 9(2)   VALUE ZERO.
006980       05 _tv                   PIC 9(2)   VALUE ZERO.
006990    03 ҈ϔCNv.
007000       05 ҈ϔCNv                 PIC 9(2)   VALUE ZERO.
007010       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007020       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007030    03 v.
007040        05 sv              PIC X(40)  VALUE SPACE.
007050        05 sxXv          PIC X(40)  VALUE SPACE.
007060        05 aʂv                  PIC 9(1)   VALUE ZERO.
007070        05 ԍv                  PIC X(10)  VALUE SPACE.
007080        05 `lv                PIC X(40)  VALUE SPACE.
007090        05 `lJiv            PIC X(40)  VALUE SPACE.
007100        05 `lƃJiv          PIC X(60)  VALUE SPACE.
007110        05 sxXv              PIC X(60)  VALUE SPACE.
007120        05 aʃRgv          PIC N(3)   VALUE SPACE.
007130    03 Rgv.
007140        05 RgPv                PIC X(30)  VALUE SPACE.
007150        05 RgQv                PIC X(30)  VALUE SPACE.
007160        05 RgRv                PIC X(30)  VALUE SPACE.
007170**************
007180* fҏ *
007190**************
007200 01 fҏv.
      */C/20190408
          03 {pav                      PIC 9(1)   VALUE ZERO.
007210    03 {pNv.
007220       05 {pNv                     PIC 9(2)   VALUE ZERO.
007230       05 {pv                     PIC 9(2)   VALUE ZERO.
007240*    03 Lv                          PIC N(12)  VALUE SPACE.
007570    03 Lv.
007580       05 Lv                   PIC N(12)  VALUE SPACE.
          03 Lԍv.
             05 Lԍwv                 PIC X(40) VALUE SPACE.
007250    03 ԍv.
007260       05 ԍv                   PIC X(15)  VALUE SPACE.
007270       05 FILLER                       PIC X(15)  VALUE SPACE.
007280*    03 ʃ`FbNv.
007290*       05 `FbNv                 PIC N(1)   VALUE SPACE.
007300*       05 `FbNv                 PIC N(1)   VALUE SPACE.
007310*       05 D`FbNv                 PIC N(1)   VALUE SPACE.
007320*       05 g`FbNv                 PIC N(1)   VALUE SPACE.
007330    03 یҔԍv.
007340       05 یҔԍv             PIC X(8)   VALUE SPACE.
007350       05 FILLER                       PIC X(2)   VALUE SPACE.
007360    03 sԍv.
007370       05 sԍv             PIC X(8)   VALUE SPACE.
007380       05 FILLER                       PIC X(2)   VALUE SPACE.
007390*
007400    03 於̂v.
007410       05 於̂Pv           PIC X(38)  VALUE SPACE.
007420       05 於̂Qv           PIC X(38)  VALUE SPACE.
          03 xv.
             05 xPv                   PIC X(10)  VALUE SPACE.
             05 xQv                   PIC X(10)  VALUE SPACE.
007430*
007440    03 یʂv                      PIC 9(2)   VALUE ZERO.
007450    03 یҏv.
007460       05 ی҃Jiv               PIC X(50)  VALUE SPACE.
007470       05 یҎv               PIC X(50)  VALUE SPACE.
007480       05 X֔ԍv.
007490          07 X֔ԍPv              PIC X(3)   VALUE SPACE.
007500          07 X֔ԍQv              PIC X(4)   VALUE SPACE.
007510       05 یҏZPv             PIC X(50)  VALUE SPACE.
007520       05 یҏZQv             PIC X(50)  VALUE SPACE.
008990       05 dbԍv                   PIC X(35)  VALUE SPACE.
007530    03 ҏv.
007540       05 ҃Jiv                   PIC X(50)  VALUE SPACE.
007550       05 Ҏv                   PIC X(50)  VALUE SPACE.
007560       05 ʃ`FbNv.
007570          07 j`FbNv              PIC N(1)  VALUE SPACE.
007580          07 `FbNv              PIC N(1)  VALUE SPACE.
007590       05 Ґʂv.
007600          07 ʂv                    PIC N(1)  VALUE SPACE.
007610       05 a`FbNv.
007620          07 `FbNv            PIC N(1)  VALUE SPACE.
007630          07 吳`FbNv            PIC N(1)  VALUE SPACE.
007640          07 a`FbNv            PIC N(1)  VALUE SPACE.
007650          07 `FbNv            PIC N(1)  VALUE SPACE.
007660          07 v                    PIC N(2)  VALUE SPACE.
      */C/20190408
008210          07 ߘa`FbNv            PIC N(1)  VALUE SPACE.
                07 ߘablv                PIC X(4)  VALUE SPACE.
009110*          07 v                    PIC N(2)  VALUE SPACE.
      */C/20190408
007670       05 ҔNv                     PIC 9(2)  VALUE ZERO.
007680       05 Ҍv                     PIC 9(2)  VALUE ZERO.
007690       05 ғv                     PIC 9(2)  VALUE ZERO.
007700       05 v.
007710          07 v                PIC N(4)  VALUE SPACE.
007720          07 FILLER                    PIC X(4)  VALUE SPACE.
007730*
007740       05 Pv                 PIC N(37) VALUE SPACE.
007750       05 Qv                 PIC N(37) VALUE SPACE.
007760       05 Rv                 PIC N(37) VALUE SPACE.
007770       05 Sv                 PIC N(37) VALUE SPACE.
007780       05 Tv                 PIC N(37) VALUE SPACE.
007790*
008370*       05 v                   PIC N(40) OCCURS 29 VALUE SPACE.
      */pΉ/110421
             05 v OCCURS 29.
                07 wv              PIC X(80)  VALUE SPACE.
007810    03 v                        PIC N(1)  VALUE SPACE.
007820    03 ʃRgv                  PIC X(16) VALUE SPACE.
007390    03 یʃ`FbNv.
007400       05 Еۃ`FbNv               PIC N(1)  VALUE SPACE.
007410       05 D`FbNv               PIC N(1)  VALUE SPACE.
007420       05 g`FbNv               PIC N(1)  VALUE SPACE.
007430       05 ۃ`FbNv               PIC N(1)  VALUE SPACE.
             05 σ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv                 PIC N(1)  VALUE SPACE.
             05 ސE`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
          03 {l`FbNv                  PIC N(1)  VALUE SPACE.
          03 Ƒ`FbNv                  PIC N(1)  VALUE SPACE.
          03 Pƃ`FbNv                  PIC N(1)  VALUE SPACE.
          03 Q`FbNv                  PIC N(1)  VALUE SPACE.
          03 `FbNv                  PIC N(1)  VALUE SPACE.
          03 V`FbNv                  PIC N(1)  VALUE SPACE.
          03 U΃`FbNv                  PIC N(1)  VALUE SPACE.
          03 t`FbNv.
             05 V`FbNv               PIC N(1)  VALUE SPACE.
             05 W`FbNv               PIC N(1)  VALUE SPACE.
             05 X`FbNv               PIC N(1)  VALUE SPACE.
             05 PO`FbNv             PIC N(1)  VALUE SPACE.
007830*
007840****************
007850* f[^e *
007860****************
007870 01 v.
007880    03 ʐv                        PIC 9(1)  VALUE ZERO.
007890    03 ʏv  OCCURS   9.
007900       05 ʂbmsv                 PIC 9(1)  VALUE ZERO.
007910       05 ʃR[hv.
007920          07 ʂv                PIC 9(2)  VALUE ZERO.
007930          07 ʂv                    PIC 9(2)  VALUE ZERO.
007940          07 E敪v                PIC 9(1)  VALUE ZERO.
007950          07 ʒuԍv            PIC 9(2)  VALUE ZERO.
007960       05 v                     PIC N(18) VALUE SPACE.
007970       05 Nv.
007980          07 Nv                  PIC 9(2)  VALUE ZERO.
007990          07 v                  PIC 9(2)  VALUE ZERO.
008000          07 v                  PIC 9(2)  VALUE ZERO.
008010       05 Nv.
008020          07 Nv                  PIC 9(2)  VALUE ZERO.
008030          07 v                  PIC 9(2)  VALUE ZERO.
008040          07 v                  PIC 9(2)  VALUE ZERO.
008050       05 JnNv.
008060          07 JnNv                  PIC 9(2)  VALUE ZERO.
008070          07 Jnv                  PIC 9(2)  VALUE ZERO.
008080          07 Jnv                  PIC 9(2)  VALUE ZERO.
008090       05 INv.
008100          07 INv                  PIC 9(2)  VALUE ZERO.
008110          07 Iv                  PIC 9(2)  VALUE ZERO.
008120          07 Iv                  PIC 9(2)  VALUE ZERO.
008130       05 v                     PIC 9(2)  VALUE ZERO.
008140       05 ]A敪v                   PIC 9(1)  VALUE ZERO.
008150       05 ]A敪`FbNv.
008160          07 `FbNv            PIC N(1)  VALUE SPACE.
008170          07 ~`FbNv            PIC N(1)  VALUE SPACE.
008180          07 ]`FbNv            PIC N(1)  VALUE SPACE.
008190       05 JnN擾tO         PIC X(3)  VALUE SPACE.
008200       05 ʋ؂v                   PIC X(1)  VALUE SPACE.
008210       05 oߗ̂v.
008220          07 oߗ̂v            PIC N(6)  VALUE SPACE.
008240    03 oߕʂv                      PIC N(1)  VALUE SPACE.
008250    03 VK`FbNv                  PIC N(1)  VALUE SPACE.
008260    03 p`FbNv                  PIC N(1)  VALUE SPACE.
          03 {pv.
             05 {p`FbNv   OCCURS 31 PIC N(1)  VALUE SPACE.
008270****************
008280* nbqR[h *
008290****************
008300* 01 nbqR[hv.
008310*    03 nbqԍv                PIC X(6)    VALUE ZERO.
008320*    03 nbq{pNv                PIC 9(4)    VALUE ZERO.
008330*    03 nbqیʂv                PIC 9(2)    VALUE ZERO.
008340*    03 nbqeЂhcv                PIC 9(2)    VALUE ZERO.
008350*    03 nbqecAԂv.
008360*       05 ecAԊҔԍv           PIC 9(6)    VALUE ZERO.
008370*       05 ecAԌۂhcv           PIC 9(1)    VALUE ZERO.
008380*    03 nbqzv                PIC 9(6)    VALUE ZERO.
008390*    03 nbqSv                PIC 9(1)    VALUE ZERO.
008400*    03 nbqڍtԍv        PIC 9(10)   VALUE ZERO.
008410*
008420************
008430*  *
008440************
008450 01 v.
008460    03 Zv.
008470       05 ԊO`FbNv                PIC N(1) VALUE SPACE.
008480       05 x`FbNv                  PIC N(1) VALUE SPACE.
008490       05 [`FbNv                  PIC N(1) VALUE SPACE.
008500    03 ÉZv.
008510       05 ԃ`FbNv                  PIC N(1) VALUE SPACE.
008520       05 \J`FbNv              PIC N(1) VALUE SPACE.
008530    03 q`FbNv.
008540       05 `FbNv                    PIC N(1) VALUE SPACE.
008550       05 `FbNv                    PIC N(1) VALUE SPACE.
008560       05 `FbNv                    PIC N(1) VALUE SPACE.
008570    03 vv                             PIC 9(7) VALUE ZERO.
008580    03 񏈒uvv                   PIC 9(6) VALUE ZERO.
008590    03 񏈒u`FbNv.
008600       05 `FbNv                PIC N(1) VALUE SPACE.
008610       05 Œ藿`FbNv                PIC N(1) VALUE SPACE.
008620       05 {×`FbNv                PIC N(1) VALUE SPACE.
      */qE^Â̕ύXEǉ/1805
          03 񐔂v                         PIC 9(2)  VALUE ZERO.
          03 ^v                           PIC 9(4)  VALUE ZERO.
008630************
008640* l *
008650************
008660 01 lv.
008670    03 KpPv                        PIC N(38) VALUE SPACE.
008680    03 KpQv                        PIC N(38) VALUE SPACE.
008690*    03 KpRv                        PIC N(38) VALUE SPACE.
008700*    03 KpSv                        PIC N(38) VALUE SPACE.
008710    03 o߃Rgv                  PIC N(60) VALUE SPACE.
008720*
008730*****************
008740* Zvgя *
008750*****************
008760 01 ԌŒv                         PIC N(1) VALUE SPACE.
008770 01 Ԃv                             PIC 9(4) VALUE ZERO.
008780*
       01 Ev{pv                       PIC X(100) VALUE SPACE.
       01 {pv.
          03 {pQv                      PIC X(1)  VALUE SPACE.
          03 {pPv                      PIC X(1)  VALUE SPACE.
002790** Sp
002800 01 Sv                         PIC 9(2)  VALUE ZERO.
002810 01 tv                         PIC 9(2)  VALUE ZERO.
008790********************
008800 01 .
008810     03 `̖o                     PIC X(8) VALUE SPACE.
008820     03 ڌQo                     PIC X(8) VALUE SPACE.
008830     03 ʂo                     PIC X(2) VALUE SPACE.
008840     03 go.
008850         05 [o.
008860             07 ړo             PIC X(1) VALUE SPACE.
008870             07 ړso             PIC 9(3) VALUE ZERO.
008880         05 ڍאo                 PIC X(2) VALUE SPACE.
008890     03 ʒmo                     PIC X(2) VALUE SPACE.
008900     03 jbgo                   PIC X(8) VALUE SPACE.
008910*
008920 01 vZ@Nv                     PIC 9(2) VALUE ZERO.
008930* tvnqj
008940 01 aINv                       PIC 9(4) VALUE ZERO.
008950 01 vZ@.
008960    03 vZ@N                    PIC 9(4) VALUE ZERO.
008970    03 vZ@                  PIC 9(4) VALUE ZERO.
008980 01 vZ@q REDEFINES vZ@.
008990    03 vZ@I                      PIC 9(2).
009000    03 vZ@t                      PIC 9(6).
009010    03 vZ@tq REDEFINES vZ@t.
009020       05 vZ@N                   PIC 9(4).
009030       05 vZ@Nq REDEFINES vZ@N.
009040         07 vZ@N                   PIC 9(2).
009050         07 vZ@                   PIC 9(2).
009060       05 vZ@                     PIC 9(2).
009070*
       01 vOv     PIC X(8) VALUE "MOJI2".
      *
009080******************************************************************
009090*                          A                              *
009100******************************************************************
009110**  ʓ̓f[^
009120 01 A|̓f[^ϔC IS EXTERNAL.
009130    03 A|ϔC                     PIC 9.
014620*
       01 A|̓f[^db IS EXTERNAL.
          03 A|db                     PIC 9.
009190*
       01 A|vr[ IS EXTERNAL.
          03 A|vr[敪          PIC 9.
009140*
009150** RJ
009160 01 Aԁ|L[ IS EXTERNAL.
009170    03 Aԁ|{pN.
009180       05 Aԁ|{pa               PIC 9.
009190 05 Aԁ|{pN                 PIC 9(2).
009200 05 Aԁ|{p                 PIC 9(2).
009210    03  Aԁ|҃R[h.
009220       05 Aԁ|Ҕԍ               PIC 9(6).
009230       05 Aԁ|}                   PIC X.
009240    03 Aԁ|ΏۃtO                PIC X(3).
009250    03 Aԁ|Ԍv.
009260       05 Aԁ|Ԃv                 PIC 9(2) OCCURS 9.
009270************
009280* L[ *
009290************
009300*
009310*
009320 01 A|Ώۃf[^ IS EXTERNAL.
009330    03 A|{pN.
009340       05 A|{pa                  PIC 9(1).
009350       05 A|{pN                    PIC 9(2).
009360       05 A|{p                    PIC 9(2).
009370    03 A|҃R[h.
009380       05 A|Ҕԍ                  PIC 9(6).
009390       05 A|}                      PIC X(1).
009400    03 A|ی                     PIC 9(2).
009410    03 A|یҔԍ                   PIC X(10).
009420    03 A|                     PIC 9(2).
009430    03 A|pSҔԍ               PIC X(10).
009440    03 A|                     PIC 9(2).
009450    03 A|pSҔԍ           PIC X(10).
009460    03 A|҃Ji                     PIC X(20).
009470    03 A|{lƑ敪                 PIC 9(1).
009480*
012910 01 A|L[ IS EXTERNAL.
012920    03 A|ی                  PIC 9(2).
      *
       01 A|L[ IS EXTERNAL GLOBAL.
          03 A|쏕                  PIC 9(2).
012930*
012940************************
012950* RZbg     *
012960************************
012970 01 A|L[ IS EXTERNAL.
012980    03 A|{pN.
012990       05 A|{pa               PIC 9.
013000       05 A|{pN                 PIC 9(2).
013010       05 A|{p                 PIC 9(2).
013020    03  A|҃R[h.
013030       05 A|Ҕԍ               PIC 9(6).
013040       05 A|}                   PIC X.
013050    03 A|                    PIC 9(2).
013060    03 A|R                    PIC N(63) OCCURS 15.
013070*
014230************************
014240* EvZbg     *
014250************************
014260 01 AE|L[ IS EXTERNAL.
014270    03 AE|{pN.
014280       05 AE|{pa               PIC 9.
014290       05 AE|{pN                 PIC 9(2).
014300       05 AE|{p                 PIC 9(2).
014310    03  AE|҃R[h.
014320       05 AE|Ҕԍ               PIC 9(6).
014330       05 AE|}                   PIC X.
014340    03 AE|                    PIC 9(2).
014350    03 AE|Ev                    PIC X(126) OCCURS 30.
014340    03 AE|敪                  PIC 9(1).
013680*
013071*
013072*************
013073* 
013074*************
013075 01 Á|L[ IS EXTERNAL.
013076    03 Á|             PIC 9(2).
013077    03 Á|pSҔԍ   PIC X(10).
013078*   / OUT /
013079    03 Á|̏Wc.
013080       05 Á|P            PIC N.
013081       05 Á|              PIC N(4).
013082       05 Á|          PIC N(10).
013083*
014761*
014762************************
014763* Z
014764************************
014765 01 AZ|L[ IS EXTERNAL.
014766    03 AZ|{pN.
014767       05 AZ|{pa               PIC 9.
014768       05 AZ|{pN                 PIC 9(2).
014769       05 AZ|{p                 PIC 9(2).
014770    03  AZ|҃R[h.
014771       05 AZ|Ҕԍ               PIC 9(6).
014772       05 AZ|}                   PIC X.
014773    03 AZ|ΏۃtO                PIC X(3).
014774*
013084*
      * Np
       01 ANQ|L[ IS EXTERNAL.
          03 ANQ|{paN.
             05 ANQ|{pa      PIC 9.
             05 ANQ|{pN.
               07 ANQ|{pN      PIC 9(2).
               07 ANQ|{p      PIC 9(2).
          03 ANQ|aN.
             05 ANQ|a          PIC 9.
             05 ANQ|N            PIC 9(2).
             05 ANQ|            PIC 9(2).
             05 ANQ|            PIC 9(2).
          03 ANQ|یN         PIC 9(3).
          03 ANQ|c       PIC 9.
          03 ANQ|Vl         PIC 9.
006510*
000540************************************
000550* v^t@C쐬p           *
000560************************************
000570 01 gAoqse|쐬f[^ IS EXTERNAL.
000580     03 gAoqse|t@C           PIC X(8).
000590     03 gAoqse|vr[敪       PIC 9.
000600     03 gAoqse|[vO     PIC X(8).
000610     03 gAoqse|I[oC         PIC X(8).
000993************************************
000994* v^t@C쐬p       *
000995************************************
000996 01 gAoqse|쐬f[^ IS EXTERNAL.
000997     03 gAoqse|p         PIC X(8).
006490*
      * C Agp
       01  Pv        PIC X(4096).
       01  Qv        PIC X(512).
       01  vOv  PIC X(8)  VALUE "strmoji2".
      *
      * Íp
       01 AÍ|Í IS EXTERNAL.
          03 AÍ|͏.
             05 AÍ|L               PIC X(24).
             05 AÍ|ԍ               PIC X(30).
             05 AÍ|Í.
               07 AÍ|ÍҔԍ     PIC X(6).
               07 AÍ|ÍL     PIC X.
               07 AÍ|Íԍ     PIC X.
               07 AÍ|ÍL         PIC X(24).
               07 AÍ|Íԍ         PIC X(30).
          03 AÍ|o͏.
             05 AÍ|L       PIC X(24).
             05 AÍ|ԍ       PIC X(30).
      * 
      */qE^Â̕ύXEǉ/1805
       01 A^|L[ IS EXTERNAL.
          03 A^|{paN.
             05 A^|{pa                  PIC 9(1).
             05 A^|{pN.
                07 A^|{pN                 PIC 9(2).
                07 A^|{p                 PIC 9(2).
          03 A^|҃R[h.
             05 A^|Ҕԍ                  PIC 9(6).
             05 A^|}                      PIC X(1).
          03 A^|ی                     PIC 9(2).
          03 A^|R[h                     PIC 9(2).
          03 A^|p                     PIC 9(1).
          03 A^|q.
             05 A^|qbl              PIC X(200).
             05 A^|q              OCCURS 5.
                07 A^|qaN     OCCURS 3.
                   09 A^|qaN.
                      11 A^|qa     PIC 9(1).
                      11 A^|qN.
                         13 A^|qN    PIC 9(2).
                         13 A^|q    PIC 9(2).
                   09 A^|q          PIC 9(2).
          03 A^|^.
             05 A^|^Âbl              PIC X(100).
             05 A^|^                    PIC 9(2)    OCCURS 5.
      *
       01 A^Q|L[ IS EXTERNAL.
           03 A^Q|qbl.
               05 A^Q|qblP        PIC X(130).
               05 A^Q|qblQ        PIC X(170).
      *
013085******************************************************************
013090*                      PROCEDURE  DIVISION                       *
013100******************************************************************
013110 PROCEDURE               DIVISION.
013120************
013130*           *
013140*    *
013150*           *
013160************
002570     PERFORM v^t@C쐬.
013170     PERFORM .
013180************
013190*           *
013200* 又     *
013210*           *
013220************
013230* 
013240     PERFORM AڑҔ.
013250     PERFORM Zbg.
013260     PERFORM .
013270************
013280*           *
013290* I   *
013300*           *
013310************
013320     PERFORM f҈敪XV.
013330     PERFORM I.
013340     MOVE ZERO  TO PROGRAM-STATUS.
013350     EXIT PROGRAM.
013360*
013370*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
002860*================================================================*
002870 v^t@C쐬 SECTION.
002880*================================================================*
002890*   /  /
002900     MOVE SPACE TO gAoqse|쐬f[^.
002910     INITIALIZE gAoqse|쐬f[^.
002225     MOVE SPACE TO gAoqse|쐬f[^.
002226     INITIALIZE gAoqse|쐬f[^.
002920*
002930*
002940*-- ύXӏ --------------------------------------*
002230*   gppʃZbg
           MOVE "RECE"                TO gAoqse|p.
002970*   gpv^t@CZbg
002971     MOVE "PRTF002"             TO gAoqse|t@C.
002972*
002973*   gp钠[vOZbg
002974     MOVE "YCH6165"             TO gAoqse|[vO.
002975*
002976*-------------------------------------------------------*
002980*
002990*   / vr[敪Zbg /
003000     MOVE A|vr[敪  TO gAoqse|vr[敪.
003010*
003020     CALL   "CRTPRTF".
003030     CANCEL "CRTPRTF".
003040*
013380*================================================================*
013390  SECTION.
013400*
013410     PERFORM t@CI[v.
013420*    /* ݓt擾 */
013430     ACCEPT vZ@t FROM DATE.
013440*    /* 1980`2079N̊ԂŐݒ */
013450     IF ( vZ@N > 80 )
013460         MOVE 19 TO vZ@I
013470     ELSE
013480         MOVE 20 TO vZ@I
013490     END-IF.
013500     PERFORM Jg擾.
013510     PERFORM aIN擾.
013520     COMPUTE vZ@Nv = vZ@N - aINv.
013530*================================================================*
013540 Jg擾 SECTION.
013550*
013560     MOVE ZEROS TO |敪.
013570     READ }X^
013580     NOT INVALID KEY
013590         MOVE |Jg         TO Jgv
013600         MOVE |Z敪 TO 敪v
013610         MOVE |ZR敪 TO R敪v
013620         MOVE |Zvgt敪     TO Zvgt敪v
013630         MOVE |Zvgғt敪 TO Zvgғt敪v
013631         MOVE |S_eoc敪       TO S_eoc敪v
015320         MOVE |Еۖ{lZ         TO pʂv
013640     END-READ.
013650*
013660*================================================================*
013670 aIN擾 SECTION.
013680*
013690*     DISPLAY NC"Jgv"  Jgv UPON MSGBOX.
013700     MOVE Jgv TO |敪.
013710     READ }X^
013720     INVALID KEY
013730         DISPLAY NC"wao^Ă܂" UPON CONS
013740         DISPLAY NC"P͂dmsdqL[Ă"
013750                                                  UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
013760         ACCEPT  L[ FROM CONS
013770         PERFORM I
013780         EXIT PROGRAM
013790     NOT INVALID KEY
013800         COMPUTE Oav = Jgv - 1
013810         MOVE Oav TO |敪
013820         READ }X^
013830         INVALID KEY
013840             DISPLAY NC"wao^Ă܂" UPON CONS
013850             DISPLAY NC"P͂dmsdqL[Ă"
013860                                                      UPON CONS
000080*-----------------------------------------*
000090             CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
013870             ACCEPT  L[ FROM CONS
013880             PERFORM I
013890             EXIT PROGRAM
013900         NOT INVALID KEY
013910             MOVE |IN TO aINv
013920         END-READ
013930     END-READ.
013940*
013950*================================================================*
013960 t@CI[v SECTION.
013970*
013980     OPEN INPUT   ی҃}X^
013990         MOVE NC"ی" TO t@C.
014000         PERFORM I[v`FbN.
014010     OPEN INPUT   }X^
014020         MOVE NC"" TO t@C.
014030         PERFORM I[v`FbN.
014040     OPEN INPUT   ̃}X^
014050         MOVE NC"" TO t@C.
014060         PERFORM I[v`FbN.
007560     OPEN INPUT   Zvge
007570         MOVE NC"Z" TO t@C.
007580         PERFORM I[v`FbN.
014100     OPEN INPUT   }X^
014110         MOVE NC"" TO t@C.
014120         PERFORM I[v`FbN.
014130     OPEN INPUT   {p}X^
014140         MOVE NC"{" TO t@C.
014150         PERFORM I[v`FbN.
014160     OPEN INPUT   }X^
014170         MOVE NC"" TO t@C.
014180         PERFORM I[v`FbN.
014190     OPEN INPUT   o߃}X^
014200         MOVE NC"o" TO t@C.
014210         PERFORM I[v`FbN.
014220     OPEN INPUT   {pL^e.
014230         MOVE NC"{Le" TO t@C.
014240         PERFORM I[v`FbN.
014250     OPEN INPUT   f[^e.
014260         MOVE NC"" TO t@C.
014270         PERFORM I[v`FbN.
014280     OPEN INPUT   e.
014290         MOVE NC"" TO t@C.
014300         PERFORM I[v`FbN.
014310     OPEN INPUT t@C.
014320         MOVE NC"" TO t@C.
014330         PERFORM I[v`FbN.
014340     OPEN INPUT   ƃt@CS.
015170         IF ( ԃL[  NOT =  "00" )
015060            OPEN OUTPUT  ƃt@CS
                  CLOSE ƃt@CS
015060            OPEN INPUT  ƃt@CS
               END-IF.
014370     OPEN I-O   fҏe.
014380         MOVE NC"" TO t@C.
014390         PERFORM I[v`FbN.
014400     OPEN I-O   t@C
014410         PERFORM G[o.
014420*================================================================*
014430 I[v`FbN SECTION.
014440*
014450     IF ( ԃL[  NOT =  "00" )
014460         DISPLAY t@C NC"eI[vG[" UPON CONS
014470         DISPLAY NC"ԃL[F" ԃL[         UPON CONS
014480         DISPLAY NC"P͂dmsdqL[Ă"
014490                                                 UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
014500         ACCEPT  L[ FROM CONS
014510         PERFORM t@C
014520         EXIT PROGRAM.
014530*================================================================*
014540 AڑҔ SECTION.
014550*
014560     MOVE A|{pa           TO {pavq.
014570     MOVE A|{pN             TO {pNvq.
014580     MOVE A|{p             TO {pvq.
014590     MOVE A|ی           TO یʂvq.
014600     MOVE A|یҔԍ         TO یҔԍvq.
014610     MOVE A|           TO ʂvq.
014620     MOVE A|pSҔԍ     TO pSҔԍvq.
014630     MOVE A|           TO ʂvq.
014640     MOVE A|pSҔԍ TO pSҔԍvq.
014650     MOVE A|{lƑ敪       TO {lƑ敪vq.
014660     MOVE A|҃Ji           TO ҃Jivq.
014670     MOVE A|Ҕԍ           TO Ҕԍvq.
014680     MOVE A|}               TO }Ԃvq.
014690*================================================================*
014700 Zbg SECTION.
014710*
014720     PERFORM ڏ.
014800     PERFORM Ǎ.
014770     PERFORM 擾.
014730     PERFORM {p擾.
014740     PERFORM 擾.
014750     PERFORM fҏ擾.
014760     PERFORM f[^擾.
014780     PERFORM {pL^擾.
014790     PERFORM Zvgя擾.
014800**     PERFORM nbq擾.
014810**     PERFORM 擾.
014820**     PERFORM ȑÕf[^.
014830     PERFORM Z擾.
014840     PERFORM 擾.
014850     PERFORM ϔCN擾.
           PERFORM {p擾.
014860*
016791*-----------------------------------------------*
016800     IF ( 敪v  NOT = 1 ) AND ( Z敪v NOT = 1 )
016813        IF ( 敪v = 3 OR 4 )
016815           PERFORM Ώ۔菈
016817        ELSE
016820           PERFORM 擾
016821        END-IF
016830     END-IF.
014990*
015000**********************
015010* nbqR[hZbg *
015020**********************
015030*
015040*     MOVE nbqڍtԍv     TO nbqԍ.
015050*     MOVE nbq{pNv     TO nbq{pN.
015060*     MOVE nbqیʂv     TO nbqی.
015070*     MOVE nbqeЂhcv     TO nbqeЂhc.
015080*     MOVE nbqecAԂv     TO nbqecA.
015090*     MOVE nbqzv     TO nbqz.
015100*     MOVE nbqSv     TO nbqS.
015110*
015120********************
015130* fҏZbg *
015140********************
015150     MOVE {pNv            TO {pN.
015160     MOVE {pv            TO {p.
015170*
015180*     IF ( Lv(1:1) = NC"" )
015190*        MOVE  SPACE    TO  L
015200*     ELSE
015210*        MOVE Lv    TO  L
015220*     END-IF.
015230*     IF ( ԍv(1:1) = "*"  ) OR
015240*        ( ԍv(1:2) = "" )
015250*        MOVE  SPACE      TO  ԍ
015260*     ELSE
015270*        MOVE ԍv  TO  ԍ
015280*     END-IF.
015290*
           IF ( Lv(1:1) = NC"" )
              MOVE  SPACE          TO  Lv
           END-IF.
           IF ( ԍv(1:1) = "*"  ) OR
              ( ԍv(1:2) = "" )
              MOVE  SPACE          TO  ԍv
           END-IF.
      *
           INSPECT Lv  REPLACING ALL "@" BY "  ".
           EVALUATE TRUE
           WHEN (Lv NOT = SPACE) AND (ԍv NOT = SPACE)
               MOVE SPACE TO ItOQ
               PERFORM VARYING JE^ FROM 24 BY -1
                 UNTIL (JE^ <= ZERO) OR (ItOQ NOT = SPACE)
                   IF Lv(JE^:1) NOT = SPACE
                       MOVE Lv TO Lԍv
                       MOVE "E"   TO Lԍv(JE^ + 1:2)
                       MOVE ԍv TO Lԍv(JE^ + 3:40 - JE^ - 2)
                       MOVE "YES"  TO ItOQ
                   END-IF
               END-PERFORM
               MOVE Lԍv TO Lԍ
           WHEN Lv NOT = SPACE
               MOVE Lv TO Lԍ
           WHEN ԍv NOT = SPACE
               MOVE ԍv TO Lԍ
           END-EVALUATE.
015300*
015310     MOVE یҔԍv    TO یҔԍ.
015320*     MOVE 於̂v        TO 於.
015330*
015340*     MOVE 於̂Pv  TO یҖ.
015350*     MOVE 於̂Qv  TO یҖ̂Q.
015360*
015190     MOVE Еۃ`FbNv     TO Еۃ`FbN.
015210     MOVE g`FbNv     TO g`FbN.
015220     MOVE ۃ`FbNv     TO ۃ`FbN.
           MOVE σ`FbNv     TO σ`FbN.
           MOVE `FbNv       TO `FbN.
           MOVE ސE`FbNv     TO ސE`FbN.
           MOVE `FbNv     TO `FbN.
015230     MOVE V`FbNv     TO V`FbN.
015240     MOVE W`FbNv     TO W`FbN.
015250     MOVE X`FbNv     TO X`FbN.
015260     MOVE PO`FbNv   TO PO`FbN.
      *
           MOVE {l`FbNv     TO {l`FbN.
           MOVE Ƒ`FbNv     TO Ƒ`FbN.
           MOVE Pƃ`FbNv     TO Pƃ`FbN.
           MOVE Q`FbNv     TO Q`FbN.
           MOVE `FbNv     TO `FbN.
           MOVE V`FbNv     TO V`FbN.
           MOVE U΃`FbNv     TO U΃`FbN.
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
              MOVE {pav         TO |敪
037380        READ }X^
037390        NOT INVALID KEY
037400            MOVE |   TO {pa
037410        END-READ
      *        MOVE "===="             TO {pa
           END-IF.
      */C/20190408
015400*     MOVE ی҃Jiv      TO ی҃Ji.
015410     MOVE یҎv      TO یҎ.
      */ X֔ԍEdbԍǉ /42505
           IF ({paNvq >= 42505) AND (A|db = 1)
              IF (|_X֓dbԍ = 0 OR 2) AND
                 ((X֔ԍPv NOT = SPACE) OR (X֔ԍQv NOT = SPACE))
017280           MOVE ""          TO X
017260           MOVE X֔ԍPv  TO X֔ԍP
017270           MOVE X֔ԍQv  TO X֔ԍQ
017280           MOVE "-"           TO X֋
              END-IF
              IF |_X֓dbԍ = 0 OR 3
017260           MOVE dbԍv    TO dbԍ
              END-IF
           END-IF.
015450     MOVE یҏZPv    TO ZP.
015460     MOVE یҏZQv    TO ZQ.
015470*     MOVE ҃Jiv          TO ҃Ji.
015480     MOVE Ҏv          TO Ҏ.
015490     MOVE j`FbNv        TO j`FbN.
015500     MOVE `FbNv        TO `FbN.
015510*     MOVE ʂv              TO .
015520*     MOVE `FbNv      TO `FbN.
015530*     MOVE 吳`FbNv      TO 吳`FbN.
015540     MOVE a`FbNv      TO a`FbN.
015550     MOVE `FbNv      TO `FbN.
015560*     MOVE v              TO .
      */C/20190408
           MOVE ߘablv         TO ߘabl.
023070     MOVE ߘa`FbNv     TO ߘa`FbN.
017390*     MOVE v              TO Ҙa.
      */C/20190408
015570     MOVE ҔNv            TO ҔN.
015580     MOVE Ҍv            TO Ҍ.
015590     MOVE ғv            TO ғ.
015600*     MOVE v          TO .
015610     MOVE v(1)       TO P.
015620     MOVE v(2)       TO Q.
015630     MOVE v(3)       TO R.
015640     MOVE v(4)       TO S.
015650     MOVE v(5)       TO T.
016480     MOVE v(6)       TO U.
015660*
015670     MOVE v            TO .
015680********************
015690* RZbg *
015700********************
015710*     MOVE A|R(1)    TO RP.
015720*     MOVE A|R(2)    TO RQ.
015730*     MOVE A|R(3)    TO RR.
015740*     MOVE A|R(4)    TO RS.
015750*     MOVE A|R(5)    TO RT.
015760*     MOVE A|R(6)    TO RU.
015770*     MOVE A|R(7)    TO RV.
015780*     IF ( A|R(1)  NOT = SPACE )
015790*        MOVE NC"iRj"  TO RŒ
015800*     END-IF.
015810********************
015820* f[^Zbg *
015830********************
015840* P *
015850**********
015860     MOVE v(1)       TO P.
015870     MOVE Nv(1)       TO NP.
015880     MOVE v(1)       TO P.
015890     MOVE v(1)       TO P.
015900     MOVE Nv(1)       TO NP.
015910     MOVE v(1)       TO P.
015920     MOVE v(1)       TO P.
015930     MOVE JnNv(1)       TO JnNP.
015940     MOVE Jnv(1)       TO JnP.
015950     MOVE Jnv(1)       TO JnP.
015960     MOVE INv(1)       TO INP.
015970     MOVE Iv(1)       TO IP.
015980     MOVE Iv(1)       TO IP.
015990     MOVE v(1)       TO P.
016000     MOVE `FbNv(1) TO `FbNP.
016010     MOVE ~`FbNv(1) TO ~`FbNP.
016020     MOVE ]`FbNv(1) TO ]`FbNP.
016030**********
016040* Q *
016050**********
016060     MOVE v(2)       TO Q.
016070     MOVE Nv(2)       TO NQ.
016080     MOVE v(2)       TO Q.
016090     MOVE v(2)       TO Q.
016100     MOVE Nv(2)       TO NQ.
016110     MOVE v(2)       TO Q.
016120     MOVE v(2)       TO Q.
016130     MOVE JnNv(2)       TO JnNQ.
016140     MOVE Jnv(2)       TO JnQ.
016150     MOVE Jnv(2)       TO JnQ.
016160     MOVE INv(2)       TO INQ.
016170     MOVE Iv(2)       TO IQ.
016180     MOVE Iv(2)       TO IQ.
016190     MOVE v(2)       TO Q.
016200     MOVE `FbNv(2) TO `FbNQ.
016210     MOVE ~`FbNv(2) TO ~`FbNQ.
016220     MOVE ]`FbNv(2) TO ]`FbNQ.
016230**********
016240* R *
016250**********
016260     MOVE v(3)       TO R.
016270     MOVE Nv(3)       TO NR.
016280     MOVE v(3)       TO R.
016290     MOVE v(3)       TO R.
016300     MOVE Nv(3)       TO NR.
016310     MOVE v(3)       TO R.
016320     MOVE v(3)       TO R.
016330     MOVE JnNv(3)       TO JnNR.
016340     MOVE Jnv(3)       TO JnR.
016350     MOVE Jnv(3)       TO JnR.
016360     MOVE INv(3)       TO INR.
016370     MOVE Iv(3)       TO IR.
016380     MOVE Iv(3)       TO IR.
016390     MOVE v(3)       TO R.
016400     MOVE `FbNv(3) TO `FbNR.
016410     MOVE ~`FbNv(3) TO ~`FbNR.
016420     MOVE ]`FbNv(3) TO ]`FbNR.
016430**********
016440* S *
016450**********
016460     MOVE v(4)       TO S.
016470     MOVE Nv(4)       TO NS.
016480     MOVE v(4)       TO S.
016490     MOVE v(4)       TO S.
016500     MOVE Nv(4)       TO NS.
016510     MOVE v(4)       TO S.
016520     MOVE v(4)       TO S.
016530     MOVE JnNv(4)       TO JnNS.
016540     MOVE Jnv(4)       TO JnS.
016550     MOVE Jnv(4)       TO JnS.
016560     MOVE INv(4)       TO INS.
016570     MOVE Iv(4)       TO IS.
016580     MOVE Iv(4)       TO IS.
016590     MOVE v(4)       TO S.
016600     MOVE `FbNv(4) TO `FbNS.
016610     MOVE ~`FbNv(4) TO ~`FbNS.
016620     MOVE ]`FbNv(4) TO ]`FbNS.
016630**********
016640* T *
016650**********
016660     MOVE v(5)       TO T.
016670     MOVE Nv(5)       TO NT.
016680     MOVE v(5)       TO T.
016690     MOVE v(5)       TO T.
016700     MOVE Nv(5)       TO NT.
016710     MOVE v(5)       TO T.
016720     MOVE v(5)       TO T.
016730     MOVE JnNv(5)       TO JnNT.
016740     MOVE Jnv(5)       TO JnT.
016750     MOVE Jnv(5)       TO JnT.
016760     MOVE INv(5)       TO INT.
016770     MOVE Iv(5)       TO IT.
016780     MOVE Iv(5)       TO IT.
016790     MOVE v(5)       TO T.
016800     MOVE `FbNv(5) TO `FbNT.
016810     MOVE ~`FbNv(5) TO ~`FbNT.
016820     MOVE ]`FbNv(5) TO ]`FbNT.
016830**************
016840* o߃Zbg *
016850**************
016860     PERFORM VARYING ʂbms FROM 1 BY 1
016870             UNTIL ( ʂbms > ʐv ) OR
016880                   ( ʂbms > 5 )
016890*         MOVE ʂbmsv(ʂbms)   TO oߕʂbms(ʂbms)
016900*         MOVE ʋ؂v(ʂbms)     TO ʋ(ʂbms)
016910         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
016920     END-PERFORM.
016930*****************************************
016940*     VKEp`FbNɂ        *
016950*   VK...L p...Ȃ *
016960*****************************************
016970     MOVE VK`FbNv    TO VK`FbN.
016980     MOVE p`FbNv    TO p`FbN.
016990********************
017000* f[^Zbg *
017010********************
017020*    ****************************************************************
017030*    * ijijijɂĂ͘AڂZbg *
017040*    ****************************************************************
017050     MOVE vq                   TO  .
017060     MOVE ԊO`FbNv             TO  ԊO`FbN.
017070     MOVE x`FbNv               TO  x`FbN.
017080     MOVE [`FbNv               TO  [`FbN.
017090     MOVE Zvq               TO  Z.
      *
           IF ((ԊO`FbNv NOT = SPACE) OR ([`FbNv NOT = SPACE) OR
              (x`FbNv NOT = SPACE)) AND
              ((Zv NOT = ZERO) OR (Zv NOT = ZERO))
              MOVE Zv                 TO  Z
              MOVE Z؂v               TO  Z
              MOVE Zv                 TO  Z
           END-IF.
      *
           MOVE kvq             TO  k.
017100     MOVE Čvq                   TO  Č.
017110     MOVE Ëvq                 TO  Ë.
017120     MOVE É񐔂vq                 TO  É.
017130     MOVE ×vq                   TO  ×.
017140     MOVE ԃ`FbNv               TO  ԃ`FbN.
017150     MOVE \J`FbNv           TO  \J`FbN.
017160     MOVE ÉZvq               TO  ÉZ.
      */qE^Â̕ύXEǉ/1805
           IF pʂv < 2
              IF ( {paNvq < 43006 )
017170           MOVE `FbNv              TO  `FbN
017180           MOVE `FbNv              TO  `FbN
017190           MOVE `FbNv              TO  `FbN
              ELSE
                 MOVE ALL NC""                TO  
              END-IF
           END-IF.
           IF ( {paNvq >= 43006 ) AND ( qZvq NOT = ZERO )
              MOVE 񐔂v                TO  
              MOVE NC""                    TO  
           END-IF.
017200     MOVE qZvq           TO  qZ.
017210     MOVE {p񋟗vq           TO  {p񋟗.
017220     MOVE vv                       TO v.
017230********************
017240* 񏈒uZbg *
017250********************
017260     PERFORM VARYING ʂbms FROM 1 BY 1
016870             UNTIL ( ʂbms > ʐv ) OR
016880                   ( ʂbms > 5 )
017290         MOVE 񏈒uvq(ʂbms) TO 񏈒u(ʂbms)
017300     END-PERFORM.
017310     MOVE 񏈒uvv            TO 񏈒uv
017320*
017330     MOVE {×`FbNv            TO {×`FbN.
017340     MOVE `FbNv            TO `FbN.
017350     MOVE Œ藿`FbNv            TO Œ藿`FbN.
017360********************
017370* Zbg *
017380********************
017390*    **********
017400*    * P *
017410*    **********
017420     MOVE ÒPPvq             TO ÒPP.
017430     MOVE É񐔂Pvq             TO É񐔂P.
017440     MOVE ×Pvq               TO ×P.
017450     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
017460     MOVE 㪖@Pvq             TO 㪖@P.
017470     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
017480     MOVE 㪖@Pvq             TO 㪖@P.
017490     MOVE dÉ񐔂Pvq             TO dÉ񐔂P.
017500     MOVE d×Pvq               TO d×P.
017510     MOVE vPvq                 TO vP.
017520     IF ( Pvq NOT = ZERO )
017530        COMPUTE P = Pvq / 100
017540     END-IF.
017550     MOVE vPvq           TO vP.
017560*    **********
017570*    * Q *
017580*    **********
017590     MOVE ÒPQvq             TO ÒPQ.
017600     MOVE É񐔂Qvq             TO É񐔂Q.
017610     MOVE ×Qvq               TO ×Q.
017620     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
017630     MOVE 㪖@Qvq             TO 㪖@Q.
017640     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
017650     MOVE 㪖@Qvq             TO 㪖@Q.
017660     MOVE dÉ񐔂Qvq             TO dÉ񐔂Q.
017670     MOVE d×Qvq               TO d×Q.
017680     MOVE vQvq                 TO vQ.
017690     IF ( Qvq NOT = ZERO )
017700        COMPUTE Q = Qvq / 100
017710     END-IF.
017720     MOVE vQvq           TO vQ.
017730*    ****************
017740*    * Rʁ^W *
017750*    ****************
017760     MOVE ÒPRWvq             TO ÒPRW.
017770     MOVE É񐔂RWvq             TO É񐔂RW.
017780     MOVE ×RWvq               TO ×RW.
017790     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
017800     MOVE 㪖@RWvq             TO 㪖@RW.
017810     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
017820     MOVE 㪖@RWvq             TO 㪖@RW.
017830     MOVE dÉ񐔂RWvq             TO dÉ񐔂RW.
017840     MOVE d×RWvq               TO d×RW.
017850     MOVE vRWvq                 TO vRW.
017860     MOVE ʍvRWvq         TO ʍvRW.
017870     IF ( RWvq NOT = ZERO )
017880        COMPUTE RW = RWvq / 100
017890     END-IF.
017900     MOVE vRWvq           TO vRW.
      */  0.70.6 /42505
           IF ({paNvq >= 42505)
              MOVE "60"                      TO RW
              MOVE "0.6"                     TO ʂRW
           END-IF.
017910*    ****************
017920*    * Rʁ^10 *
017930*    ****************
017940     MOVE JnROvq           TO JnRO.
017950     MOVE JnROvq           TO JnRO.
017960     MOVE ÒPROvq             TO ÒPRO.
017970     MOVE É񐔂ROvq             TO É񐔂RO.
017980     MOVE ×ROvq               TO ×RO.
017990     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
018000     MOVE 㪖@ROvq             TO 㪖@RO.
018010     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
018020     MOVE 㪖@ROvq             TO 㪖@RO.
018030     MOVE dÉ񐔂ROvq             TO dÉ񐔂RO.
018040     MOVE d×ROvq               TO d×RO.
018050     MOVE vROvq                 TO vRO.
018060     IF ( ROvq NOT = ZERO )
018070        COMPUTE RO = ROvq / 100
018080     END-IF.
018090     MOVE vROvq           TO vRO.
018100*    ****************
018110*    * Sʁ^T *
018120*    ****************
018130*     MOVE ÒPSTvq             TO ÒPST.
018140*     MOVE É񐔂STvq             TO É񐔂ST.
018150*     MOVE ×STvq               TO ×ST.
018160*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
018170*     MOVE 㪖@STvq             TO 㪖@ST.
018180*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
018190*     MOVE 㪖@STvq             TO 㪖@ST.
018200*     MOVE dÉ񐔂STvq             TO dÉ񐔂ST.
018210*     MOVE d×STvq               TO d×ST.
018220*     MOVE vSTvq                 TO vST.
018230*     MOVE ʍvSTvq         TO ʍvST.
018240*     IF ( STvq NOT = ZERO )
018250*        COMPUTE ST = STvq / 100
018260*     END-IF.
018270*     MOVE vSTvq           TO vST.
018280*    ****************
018290*    * Sʁ^W *
018300*    ****************
018310     MOVE JnSWvq           TO JnSW.
018320     MOVE JnSWvq           TO JnSW.
018330     MOVE ÒPSWvq             TO ÒPSW.
018340     MOVE É񐔂SWvq             TO É񐔂SW.
018350     MOVE ×SWvq               TO ×SW.
018360     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
018370     MOVE 㪖@SWvq             TO 㪖@SW.
018380     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
018390     MOVE 㪖@SWvq             TO 㪖@SW.
018400     MOVE dÉ񐔂SWvq             TO dÉ񐔂SW.
018410     MOVE d×SWvq               TO d×SW.
018420     MOVE vSWvq                 TO vSW.
018430     MOVE ʍvSWvq         TO ʍvSW.
018440     IF ( SWvq NOT = ZERO )
018450        COMPUTE SW = SWvq / 100
018460     END-IF.
018470     MOVE vSWvq           TO vSW.
      */  0.70.6 /42505
           IF ({paNvq >= 42505)
              MOVE "60"                      TO SW
              MOVE "0.6"                     TO ʂSW
           END-IF.
018480*    ****************
018490*    * Sʁ^10 *
018500*    ****************
018510     MOVE JnSOvq           TO JnSO.
018520     MOVE JnSOvq           TO JnSO.
018530     MOVE ÒPSOvq             TO ÒPSO.
018540     MOVE É񐔂SOvq             TO É񐔂SO.
018550     MOVE ×SOvq               TO ×SO.
018560     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
018570     MOVE 㪖@SOvq             TO 㪖@SO.
018580     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
018590     MOVE 㪖@SOvq             TO 㪖@SO.
018600     MOVE dÉ񐔂SOvq             TO dÉ񐔂SO.
018610     MOVE d×SOvq               TO d×SO.
018620     MOVE vSOvq                 TO vSO.
018630     IF ( SOvq NOT = ZERO )
018640        COMPUTE SO = SOvq / 100
018650     END-IF.
018660     MOVE vSOvq           TO vSO.
018670*
018680************************************************************************
018690* Tʁ^2.5̈󎚂͕KvȂB
018700*------------------------------------------------------------------------*
018710*    *****************
018720*    * Tʁ^2.5 *
018730*    *****************
018740*     MOVE ÒPTQvq             TO ÒPTQ.
018750*     MOVE É񐔂TQvq             TO É񐔂TQ.
018760*     MOVE ×TQvq               TO ×TQ.
018770*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
018780*     MOVE 㪖@TQvq             TO 㪖@TQ.
018790*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
018800*     MOVE 㪖@TQvq             TO 㪖@TQ.
018810*     MOVE dÉ񐔂TQvq             TO dÉ񐔂TQ.
018820*     MOVE d×TQvq               TO d×TQ.
018830*     MOVE vTQvq                 TO vTQ.
018840*     MOVE ʍvTQvq         TO ʍvTQ.
018850*     IF ( TQvq NOT = ZERO )
018860*        COMPUTE TQ = TQvq / 100
018870*     END-IF.
018880*     MOVE vTQvq           TO vTQ.
018890************************************************************************
018900*
018910*    ****************
018920*    * Tʁ^T *
018930*    ****************
018940*     MOVE JnTTvq           TO JnTT.
018950*     MOVE JnTTvq           TO JnTT.
018960*     MOVE ÒPTTvq             TO ÒPTT.
018970*     MOVE É񐔂TTvq             TO É񐔂TT.
018980*     MOVE ×TTvq               TO ×TT.
018990*     MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT.
019000*     MOVE 㪖@TTvq             TO 㪖@TT.
019010*     MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT.
019020*     MOVE 㪖@TTvq             TO 㪖@TT.
019030*     MOVE dÉ񐔂TTvq             TO dÉ񐔂TT.
019040*     MOVE d×TTvq               TO d×TT.
019050*     MOVE vTTvq                 TO vTT.
019060*     MOVE ʍvTTvq         TO ʍvTT.
019070*     IF ( TTvq NOT = ZERO )
019080*        COMPUTE TT = TTvq / 100
019090*     END-IF.
019100*     MOVE vTTvq           TO vTT.
019110*    ****************
019120*    * Tʁ^W *
019130*    ****************
021220     MOVE SPACE TO ʂTv.
021230     IF vTWvq NOT = ZERO
      */t
021560        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TWvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTWvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TWvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TWvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TWvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TWvq / dÉ񐔂TWvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TWvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TWvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
              MOVE "x"                          TO ZLTv
      */  0.70.6 /42505
              IF ({paNvq >= 42505)
021290           MOVE "0.6 "                    TO ʗTv
              ELSE
021290           MOVE "0.7 "                    TO ʗTv
              END-IF
      */
021680        IF TWvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TWvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTWvq           TO vTv
021720        MOVE ʂTv                     TO ʂTW
021490     END-IF.
019310*    ****************
019320*    * Tʁ^10 *
019330*    ****************
021530     MOVE SPACE TO ʂTv.
021540     IF vTOvq NOT = ZERO
      */t
021560        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TOvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTOvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TOvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TOvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TOvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TOvq / dÉ񐔂TOvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TOvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TOvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
      *        ZLTv ʗTv
      */
021680        IF TOvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TOvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTOvq           TO vTv
021720        MOVE ʂTv                     TO ʂTO
021730     END-IF.
019510*
019520     MOVE KpPv                       TO KpP.
019530     MOVE KpQv                       TO KpQ.
019540*     MOVE KpRv                       TO KpR.
019550*     MOVE KpSv                       TO KpS.
      *
      */qE^Â̕ύXEǉ/1805
           IF ( {paNvq >= 43006 )
              INITIALIZE A^|L[
019550        MOVE {pavq TO A^|{pa
019560        MOVE {pNvq   TO A^|{pN
019570        MOVE {pvq   TO A^|{p
019580        MOVE Ҕԍvq TO A^|Ҕԍ
019590        MOVE }Ԃvq     TO A^|}
              MOVE یʂvq TO A^|ی
              MOVE 13           TO A^|R[h
              MOVE ZERO         TO A^|p
              CALL "KINUNRYO"
              CANCEL "KINUNRYO"
              MOVE A^Q|qblP       TO qblP
              MOVE A^Q|qblQ       TO qblQ
              MOVE A^|^Âbl           TO ^Âbl
              IF ( qZvq NOT = ZERO )
                 MOVE qblP              TO qP
                 MOVE qblQ              TO qQ
              END-IF
              IF ( ^v NOT = ZERO )
                 MOVE ^Âbl                TO ^
              END-IF
           END-IF.
      *
020440     MOVE Z|v                     TO v.
020450     MOVE Z|ꕔS               TO ꕔS.
020460     MOVE Z|z                 TO z.
      *
      */쌧̎Еۏŏʂ"60"ŌŗLꂽꍇA󋋎ҕSzƁiʁjo/2106
           IF (یʂvq NOT = 01 AND 08) AND (|pSҔԍ(3:2) =  "20") AND
              (A|쏕 = 60)
021370         MOVE Z|Z󋋎ҕSz       TO z
               MOVE "󋋎ҕS"                   TO zbl
               MOVE "~" TO z~bl
022720         MOVE NC""                           TO ʋL
022730         MOVE NC""                           TO ʃ}
               IF ( |vҔԍ(1:1) = "*"  ) OR
                  ( |vҔԍ(1:2) = "" )
                   MOVE  SPACE           TO 󋋎Ҕԍ
               ELSE
                   MOVE |vҔԍ     TO 󋋎Ҕԍ
               END-IF
               MOVE SPACE                TO 󋋎ҔԍP
               MOVE SPACE                TO 󋋎ҔԍR
           END-IF.
019592*------------------------------------------------------------------------*
019617**********************
019618* {pf[^Zbg *
019620**********************
           MOVE s{ihrv       TO s{ԍ.
019630     MOVE _tԍv           TO _tԍ.
019640*     MOVE z󗝔ԍv       TO z󗝔ԍ.
019650     MOVE {pX֔ԍPv     TO {pX֔ԍP.
019660     MOVE {pX֔ԍQv     TO {pX֔ԍQ.
           MOVE {pZPv         TO {pZP
           MOVE {pZQv         TO {pZQ
019680*     MOVE {pZPv         TO {pZP.
019690*     MOVE {pZQv         TO {pZQ.
019700     MOVE ڍtԍv     TO ڍtԍ.
019710     MOVE \҃Jiv           TO \҃Ji.
019720     MOVE \Җv             TO \Җ.
019730     MOVE ڍtԍv     TO ڍtԍ.
019740     MOVE {pdbԍv       TO {pdbԍ.
019750*
019760     MOVE ڍ@v             TO ڍ@.
019770*
019780* / _tE҈ϔC /
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
               MOVE {pav         TO |敪
037380         READ }X^
037390         NOT INVALID KEY
037400             MOVE |   TO 󗝘a
037410         END-READ
      *         MOVE "===="             TO 󗝘a
           END-IF.
      */C/20190408
019790     MOVE _tNv             TO 󗝔N.
019800     MOVE _tv             TO 󗝌.
019810     MOVE _tv             TO 󗝓.
019820* ( ϔCN 邩 )
019830     IF ( A|ϔC  = ZERO )
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
                   MOVE {pav         TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE |   TO ϔCa
037410             END-READ
      *             MOVE "===="             TO ϔCa
               END-IF
      */C/20190408
019840         MOVE ҈ϔCNv       TO ϔCN
019850         MOVE ҈ϔCv       TO ϔC
019860         MOVE ҈ϔCv       TO ϔC
019870     END-IF.
019880*
019890*
019900*     MOVE sxXv         TO sxX.
019910*     MOVE aʃRgv     TO a.
019920*     MOVE ԍv             TO ԍ.
019930*     MOVE `lJiv       TO `lJi.
019940*     MOVE `lƃJiv     TO `l.
019950*     MOVE RgPv           TO RgP.
019960*     MOVE RgQv           TO RgQ.
019970*     MOVE RgRv           TO RgR.
019980*
019990************************
020000* ZvgяZbg *
020010************************
020020     MOVE ԌŒv          TO ԌŒ.
020030     MOVE Ԃv              TO .
020040     MOVE Ҕԍvq        TO Ҕԍ.
020050     MOVE }Ԃvq            TO }.
020060*
020070*
020080* ʃRg
020090*     MOVE ʃRgv      TO ʃRg.
020100*
020110*-------------------------------------------------------------------------*
020120*---  ZEvăZbǵÄZbgSECTION ̍Ōɂ邱ƁI -----*
020130     PERFORM ZEvăZbg.
020140*-------------------------------------------------------------------------*
020141*
020142*-------------------------------------------------------------------------*
020143*---  nĹÄZbgSECTION ̍Ōɂ邱ƁI   @-----*
020144     PERFORM nL.
020145*-------------------------------------------------------------------------*
020146*
020150*
020160**********     PERFORM eXg󎚏.
020170*
020180*================================================================*
020190 ڏ SECTION.
020200*
020210     INITIALIZE {pv.
020220     INITIALIZE fҏv.
020230     INITIALIZE v.
020240     INITIALIZE lv.
020250*     INITIALIZE nbqR[hv.
020260     INITIALIZE Pvq.
020270     INITIALIZE Qvq.
020280     INITIALIZE Rvq.
020300     INITIALIZE YCH6125P.
020290     MOVE SPACE TO YCH6125P.
020310*================================================================*
020320 擾 SECTION.
020330*
           MOVE 1            TO Z|Z.
019550     MOVE {pavq TO Z|{pa.
019560     MOVE {pNvq   TO Z|{pN.
019570     MOVE {pvq   TO Z|{p.
019580     MOVE Ҕԍvq TO Z|Ҕԍ.
019590     MOVE }Ԃvq     TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
020340********************
020350* f[^Zbg *
020360********************
020370*    ****************************************************************
020380*    * ijijijɂĂ͘AڂZbg *
020390*    ****************************************************************
020400     MOVE Z|                 TO vq.
020410     IF ( Z|ԊO = 1 )
020420         MOVE NC""                   TO ԊO`FbNv
020430     END-IF.
020440     IF ( Z|x = 1 )
020450         MOVE NC""                   TO x`FbNv
020460     END-IF.
020470     IF ( Z|[ = 1 )
020480         MOVE NC""                   TO [`FbNv
020490     END-IF.
020500*
020510     MOVE Z|Z             TO  Zvq.
020520     MOVE Z|Č                 TO  Čvq.
           MOVE Z|k           TO  kvq.
020530     MOVE Z|Ë               TO  Ëvq.
020540     MOVE Z|É               TO  É񐔂vq.
020550     MOVE Z|×                 TO  ×vq.
020560     MOVE Z|ÉZ             TO  ÉZvq.
020570*
020580     IF ( Z| = 1 )
020590         MOVE NC""                   TO ԃ`FbNv
020600     END-IF.
020610     IF ( Z|\J = 1 )
020620         MOVE NC""                   TO \J`FbNv
020630     END-IF.
020640*
020650     MOVE Z|qZ         TO  qZvq.
020660*
      */qE^Â̕ύXEǉ/1805
021850     IF ( Z| >= 1 )
021860         MOVE NC""                   TO `FbNv
021870     END-IF.
021880     IF ( Z| >= 1 )
021890         MOVE NC""                   TO `FbNv
021900     END-IF.
021910     IF ( Z| >= 1 )
021920         MOVE NC""                   TO `FbNv
021930     END-IF.
           IF ( {paNvq >= 43006 )
              MOVE Z|q        TO 񐔂v
           END-IF.
           MOVE Z|^×              TO ^v.
      *
020770     MOVE Z|{p񋟗         TO  {p񋟗vq.
020780* v
020790     MOVE Z|v                   TO vv.
020800********************
020810* 񏈒uZbg *
020820********************
020830     PERFORM VARYING ʂbms FROM 1 BY 1
020840             UNTIL ( ʂbms > ʐv )
020850         MOVE Z|񏈒u(ʂbms) TO 񏈒uvq(ʂbms)
020860         IF ( Z|񏈒u(ʂbms) NOT = ZERO )
020870            EVALUATE |(ʂbms)
020880* PEŖoE
020890            WHEN 1
020900            WHEN 2
020910            WHEN 3
020920                MOVE NC""       TO {×`FbNv
020930* EPE܁E܍Sk
020940            WHEN 4
020950            WHEN 5
020960            WHEN 7
020970                MOVE NC""       TO `FbNv
020980* sS܁EsS܍Sk
020990            WHEN 6
021000            WHEN 8
021010                MOVE NC""       TO Œ藿`FbNv
021020            END-EVALUATE
021030         END-IF
021040     END-PERFORM.
021050     MOVE Z|񏈒uv         TO 񏈒uvv.
021060********************
021070* Zbg *
021080********************
021090*    **********
021100*    * P *
021110*    **********
021120     MOVE Z|ÒPP             TO ÒPPvq.
021130     MOVE Z|É񐔂P             TO É񐔂Pvq.
021140     MOVE Z|×P               TO ×Pvq.
021150     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
021160     MOVE Z|㪖@P             TO 㪖@Pvq.
021170     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
021180     MOVE Z|㪖@P             TO 㪖@Pvq.
021190     MOVE Z|dÉ񐔂P             TO dÉ񐔂Pvq.
021200     MOVE Z|d×P               TO d×Pvq.
021210     MOVE Z|vP                 TO vPvq.
021220     MOVE Z|P           TO Pvq.
021230     MOVE Z|vP           TO vPvq.
021240*    **********
021250*    * Q *
021260*    **********
021270     MOVE Z|ÒPQ             TO ÒPQvq.
021280     MOVE Z|É񐔂Q             TO É񐔂Qvq.
021290     MOVE Z|×Q               TO ×Qvq.
021300     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
021310     MOVE Z|㪖@Q             TO 㪖@Qvq.
021320     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
021330     MOVE Z|㪖@Q             TO 㪖@Qvq.
021340     MOVE Z|dÉ񐔂Q             TO dÉ񐔂Qvq.
021350     MOVE Z|d×Q               TO d×Qvq.
021360     MOVE Z|vQ                 TO vQvq.
021370     MOVE Z|Q           TO Qvq.
021380     MOVE Z|vQ           TO vQvq.
021390*    ****************
021400*    * Rʁ^W *
021410*    ****************
021420     MOVE Z|ÒPRW             TO ÒPRWvq.
021430     MOVE Z|É񐔂RW             TO É񐔂RWvq.
021440     MOVE Z|×RW               TO ×RWvq.
021450     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
021460     MOVE Z|㪖@RW             TO 㪖@RWvq.
021470     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
021480     MOVE Z|㪖@RW             TO 㪖@RWvq.
021490     MOVE Z|dÉ񐔂RW             TO dÉ񐔂RWvq.
021500     MOVE Z|d×RW               TO d×RWvq.
021510     MOVE Z|vRW                 TO vRWvq.
021520     MOVE Z|ʍvRW         TO ʍvRWvq.
021530     MOVE Z|RW           TO RWvq.
021540     MOVE Z|vRW           TO vRWvq.
021550*    ****************
021560*    * Rʁ^10 *
021570*    ****************
021580     MOVE Z|JnRO           TO JnROvq.
021590     MOVE Z|JnRO           TO JnROvq.
021600     MOVE Z|ÒPRO             TO ÒPROvq.
021610     MOVE Z|É񐔂RO             TO É񐔂ROvq.
021620     MOVE Z|×RO               TO ×ROvq.
021630     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
021640     MOVE Z|㪖@RO             TO 㪖@ROvq.
021650     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
021660     MOVE Z|㪖@RO             TO 㪖@ROvq.
021670     MOVE Z|dÉ񐔂RO             TO dÉ񐔂ROvq.
021680     MOVE Z|d×RO               TO d×ROvq.
021690     MOVE Z|vRO                 TO vROvq.
021700     MOVE Z|RO           TO ROvq.
021710     MOVE Z|vRO           TO vROvq.
021720*    ****************
021730*    * Sʁ^T *
021740*    ****************
021750     MOVE Z|ÒPST             TO ÒPSTvq.
021760     MOVE Z|É񐔂ST             TO É񐔂STvq.
021770     MOVE Z|×ST               TO ×STvq.
021780     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
021790     MOVE Z|㪖@ST             TO 㪖@STvq.
021800     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
021810     MOVE Z|㪖@ST             TO 㪖@STvq.
021820     MOVE Z|dÉ񐔂ST             TO dÉ񐔂STvq.
021830     MOVE Z|d×ST               TO d×STvq.
021840     MOVE Z|vST                 TO vSTvq.
021850     MOVE Z|ʍvST         TO ʍvSTvq.
021860     MOVE Z|ST           TO STvq.
021870     MOVE Z|vST           TO vSTvq.
021880*    ****************
021890*    * Sʁ^W *
021900*    ****************
021910     MOVE Z|JnSW           TO JnSWvq.
021920     MOVE Z|JnSW           TO JnSWvq.
021930     MOVE Z|ÒPSW             TO ÒPSWvq.
021940     MOVE Z|É񐔂SW             TO É񐔂SWvq.
021950     MOVE Z|×SW               TO ×SWvq.
021960     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
021970     MOVE Z|㪖@SW             TO 㪖@SWvq.
021980     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
021990     MOVE Z|㪖@SW             TO 㪖@SWvq.
022000     MOVE Z|dÉ񐔂SW             TO dÉ񐔂SWvq.
022010     MOVE Z|d×SW               TO d×SWvq.
022020     MOVE Z|vSW                 TO vSWvq.
022030     MOVE Z|ʍvSW         TO ʍvSWvq.
022040     MOVE Z|SW           TO SWvq.
022050     MOVE Z|vSW           TO vSWvq.
022060*    ****************
022070*    * Sʁ^10 *
022080*    ****************
022090     MOVE Z|JnSO           TO JnSOvq.
022100     MOVE Z|JnSO           TO JnSOvq.
022110     MOVE Z|ÒPSO             TO ÒPSOvq.
022120     MOVE Z|É񐔂SO             TO É񐔂SOvq.
022130     MOVE Z|×SO               TO ×SOvq.
022140     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
022150     MOVE Z|㪖@SO             TO 㪖@SOvq.
022160     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
022170     MOVE Z|㪖@SO             TO 㪖@SOvq.
022180     MOVE Z|dÉ񐔂SO             TO dÉ񐔂SOvq.
022190     MOVE Z|d×SO               TO d×SOvq.
022200     MOVE Z|vSO                 TO vSOvq.
022210     MOVE Z|SO           TO SOvq.
022220     MOVE Z|vSO           TO vSOvq.
022230*    *****************
022240*    * Tʁ^2.5 *
022250*    *****************
022260     MOVE Z|ÒPTQ             TO ÒPTQvq.
022270     MOVE Z|É񐔂TQ             TO É񐔂TQvq.
022280     MOVE Z|×TQ               TO ×TQvq.
022290     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
022300     MOVE Z|㪖@TQ             TO 㪖@TQvq.
022310     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
022320     MOVE Z|㪖@TQ             TO 㪖@TQvq.
022330     MOVE Z|dÉ񐔂TQ             TO dÉ񐔂TQvq.
022340     MOVE Z|d×TQ               TO d×TQvq.
022350     MOVE Z|vTQ                 TO vTQvq.
022360     MOVE Z|ʍvTQ         TO ʍvTQvq.
022370     MOVE Z|TQ           TO TQvq.
022380     MOVE Z|vTQ           TO vTQvq.
022390*    ****************
022400*    * Tʁ^T *
022410*    ****************
022420     MOVE Z|JnTT           TO JnTTvq.
022430     MOVE Z|JnTT           TO JnTTvq.
022440     MOVE Z|ÒPTT             TO ÒPTTvq.
022450     MOVE Z|É񐔂TT             TO É񐔂TTvq.
022460     MOVE Z|×TT               TO ×TTvq.
022470     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
022480     MOVE Z|㪖@TT             TO 㪖@TTvq.
022490     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
022500     MOVE Z|㪖@TT             TO 㪖@TTvq.
022510     MOVE Z|dÉ񐔂TT             TO dÉ񐔂TTvq.
022520     MOVE Z|d×TT               TO d×TTvq.
022530     MOVE Z|vTT                 TO vTTvq.
022540     MOVE Z|ʍvTT         TO ʍvTTvq.
022550     MOVE Z|TT           TO TTvq.
022560     MOVE Z|vTT           TO vTTvq.
022570*    ****************
022580*    * Tʁ^W *
022590*    ****************
022600     MOVE Z|JnTW           TO JnTWvq.
022610     MOVE Z|JnTW           TO JnTWvq.
022620     MOVE Z|ÒPTW             TO ÒPTWvq.
022630     MOVE Z|É񐔂TW             TO É񐔂TWvq.
022640     MOVE Z|×TW               TO ×TWvq.
022650     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
022660     MOVE Z|㪖@TW             TO 㪖@TWvq.
022670     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
022680     MOVE Z|㪖@TW             TO 㪖@TWvq.
022690     MOVE Z|dÉ񐔂TW             TO dÉ񐔂TWvq.
022700     MOVE Z|d×TW               TO d×TWvq.
022710     MOVE Z|vTW                 TO vTWvq.
022720     MOVE Z|ʍvTW         TO ʍvTWvq.
022730     MOVE Z|TW           TO TWvq.
022740     MOVE Z|vTW           TO vTWvq.
022750*    ****************
022760*    * Tʁ^10 *
022770*    ****************
022780     MOVE Z|JnTO           TO JnTOvq.
022790     MOVE Z|JnTO           TO JnTOvq.
022800     MOVE Z|ÒPTO             TO ÒPTOvq.
022810     MOVE Z|É񐔂TO             TO É񐔂TOvq.
022820     MOVE Z|×TO               TO ×TOvq.
022830     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
022840     MOVE Z|㪖@TO             TO 㪖@TOvq.
022850     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
022860     MOVE Z|㪖@TO             TO 㪖@TOvq.
022870     MOVE Z|dÉ񐔂TO             TO dÉ񐔂TOvq.
022880     MOVE Z|d×TO               TO d×TOvq.
022890     MOVE Z|vTO                 TO vTOvq.
022900     MOVE Z|TO           TO TOvq.
022910     MOVE Z|vTO           TO vTOvq.
022920*
022930*================================================================*
022940 {p擾 SECTION.
022950*
022960**************************************************
022970* {@f[^gpAȉ̏擾           *
022980*  _tԍ.. _tԍvɊi[             *
022990*  ԍ ... ڍtԍvɊi[       *
023000*  \Җ ... \ҖvɊi[               *
023010*  Z1,2   ...{pZ1,2vɊi[          *
023020*  dbԍ ... {pdbԍvɊi[         *
023030**************************************************
023040     MOVE ZERO  TO {|{pԍ.
023050     READ {p}X^
023060     INVALID KEY
023070         CONTINUE
023080     NOT INVALID KEY
023090*
               MOVE {|s{ihr     TO s{ihrv
023130         MOVE {|V_tԍ       TO _tԍv
023150*
023160*         MOVE {|ڍtԍ  TO nbqڍtԍv
023170*
023180         STRING "-"                DELIMITED BY SIZE
023190                {|ڍtԍ DELIMITED BY SPACE
023200           INTO ڍtԍv
023210         END-STRING
023220*
023230         MOVE {|X֔ԍP        TO {pX֔ԍPv
023240         MOVE {|X֔ԍQ        TO {pX֔ԍQv
023250         MOVE {|\҃Ji        TO \҃Jiv
023260         MOVE {|\Җ          TO \Җv
023270*
023280         MOVE {|ڍ@          TO ڍ@v
023290         MOVE {|ZP            TO {pZPv
023300         MOVE {|ZQ            TO {pZQv
023310*         STRING {|ZP  DELIMITED BY SPACE
023320*                {|ZQ  DELIMITED BY SPACE
023330*           INTO {pZv
023340*         END-STRING
023350*
023360         MOVE {|dbԍ          TO {pdbԍv
023370*
023380     END-READ.
023390*================================================================*
023400 fҏ擾 SECTION.
023410*
023420**************************************************
023430* Af[^fҏeȉ̏擾 *
023440*  {pN ..... {pNvɊi[                 *
023450*  {p ..... {pvɊi[                 *
023460*  Ҕԍ.... ҔԍvɊi[ecAԗp   *
023470*  L ....... LvɊi[                   *
023480*  ԍ ....... ԍvɊi[                   *
023490*  یҔԍ . یҔԍvɊi[             *
023500*  ی ... یʂvɊi[               *
023510*  ی҃Ji.ی҃JivɊi[           *
023520*  یҎ.یҎvɊi[           *
023530*  ZP ......یҏZPvɊi[         *
023540*  ZQ ......یҏZQvɊi[         *
023550*  ҃Ji ....҃JivɊi[               *
023560*  Ҏ ....ҎvɊi[               *
023570*  Ґ ....敪ɂ`FbN""i[ *
023580*  Ҙa ....aɂ`FbN""i[ *
023590*  ҔN ......ҔNvɊi[                 *
023600*  Ҍ ......ҌvɊi[                 *
023610*  ғ ......ғvɊi[                 *
023620*   ........̃}X^葱vɎ擾     *
023630**************************************************
023640     MOVE {pavq       TO |{pa.
023650     MOVE {pNvq         TO |{pN.
023660     MOVE {pvq         TO |{p.
023670     MOVE ҃R[hvq     TO |҃R[h.
023680     READ fҏe
023690     INVALID KEY
023700         CONTINUE
023710*            /* 肦Ȃ */
023720     NOT INVALID KEY
022660         EVALUATE |ی
022670         WHEN 01
022690            MOVE NC""        TO ۃ`FbNv
022700         WHEN 02
022710         WHEN 06
022750         WHEN 07
022720            MOVE NC""        TO Еۃ`FbNv
022730         WHEN 03
022740            MOVE NC""        TO g`FbNv
022750*         WHEN 07
022760*            MOVE NC""        TO D`FbNv
               WHEN 04
                  MOVE NC""        TO σ`FbNv
               WHEN 09
                  MOVE NC""        TO `FbNv
               WHEN 08
                  MOVE NC""        TO ސE`FbNv
               WHEN 05
                  MOVE NC""        TO `FbNv
022770         END-EVALUATE
      */{Ƌ敪͂ǂꂩPɁB
               IF | = ZERO
                   MOVE NC"" TO Pƃ`FbNv
               ELSE
                   MOVE NC"" TO Q`FbNv
               END-IF
               IF |ی = 05
                   EVALUATE |ʋ敪
                   WHEN 1
                   WHEN 2
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
                   END-EVALUATE
               ELSE
028984             EVALUATE |ʋ敪
                   WHEN 1
                   WHEN 2
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
028991             WHEN 6
                       MOVE NC"" TO U΃`FbNv
                   WHEN OTHER
                       IF |{lƑ敪 = 1
                           MOVE NC"" TO {l`FbNv
                       ELSE
                           MOVE NC"" TO Ƒ`FbNv
                       END-IF
028999             END-EVALUATE
               END-IF
      */SĂ̕یʂŋtɁt/130719
      *         IF |ی = 01 OR 08
                   EVALUATE Z|t
                   WHEN 10
                       MOVE NC"" TO PO`FbNv
                   WHEN 9
                       MOVE NC"" TO X`FbNv
      */̑OP͂WtɁ/110721
                       IF (|ی NOT = 05 ) AND (|ʋ敪 = 1)
                           MOVE SPACE  TO X`FbNv
                           MOVE NC"" TO W`FbNv
                       END-IF
                   WHEN 8
                       MOVE NC"" TO W`FbNv
                   WHEN 7
                       MOVE NC"" TO V`FbNv
                   END-EVALUATE
      *         END-IF
      */C/20190408
               MOVE |{pa     TO {pav
023730         MOVE |{pN       TO {pNv
023740         MOVE |{p       TO {pv
023750         MOVE |Ҕԍ     TO Ҕԍv
023760*         MOVE |L         TO Lv
023770*         MOVE |ԍ         TO ԍv
      *-----------------------------------------------------------------*
               MOVE SPACE TO AÍ|Í
      *
      *        / AÍ|͏Zbg /
               MOVE |L       TO AÍ|L
               MOVE |ԍ       TO AÍ|ԍ
               MOVE |Í TO AÍ|Í
      *
               CALL   vOv
               CANCEL vOv
      *
               MOVE AÍ|L TO Lv
               MOVE AÍ|ԍ TO ԍv
      *
      *-----------------------------------------------------------------*
023860         MOVE |یҔԍ   TO یҔԍv
023870         MOVE |ی     TO یʂv
023880         MOVE |ی҃Ji TO ی҃Jiv
023890         MOVE |یҎ TO یҎv
023900         MOVE |X֔ԍP   TO X֔ԍPv
023910         MOVE |X֔ԍQ   TO X֔ԍQv
023920         MOVE |ZP       TO یҏZPv
023930         MOVE |ZQ       TO یҏZQv
      */ dbԍǉ /42505
               IF |dbԍ NOT = SPACE
                  STRING "db:"        DELIMITED BY SIZE
                         |dbԍ   DELIMITED BY SPACE
                    INTO dbԍv
                  END-STRING
               ELSE
                  IF |ғdbԍ NOT = SPACE
                     STRING "db:"            DELIMITED BY SIZE
                            |ғdbԍ   DELIMITED BY SPACE
                       INTO dbԍv
                     END-STRING
                  END-IF
               END-IF
023940         MOVE |҃Ji     TO ҃Jiv
023950         MOVE |Ҏ     TO Ҏv
023960         MOVE |pSҔԍ TO sԍv
023970*
023980         EVALUATE |Ґ
023990         WHEN 1
024000             MOVE NC"j"  TO ʂv
024010             MOVE NC""  TO j`FbNv
024020         WHEN 2
024030             MOVE NC""  TO ʂv
024040             MOVE NC""  TO `FbNv
024050         END-EVALUATE
024060         EVALUATE |Ҙa
024070         WHEN 1
024080             MOVE NC""  TO v
024090             MOVE NC""    TO `FbNv
024100         WHEN 2
024110             MOVE NC"吳"  TO v
024120             MOVE NC""    TO 吳`FbNv
024130         WHEN 3
024140             MOVE NC"a"  TO v
024150             MOVE NC""    TO a`FbNv
024160         WHEN 4
024170             MOVE NC""  TO v
024180             MOVE NC""    TO `FbNv
      */C/20190408
023060         WHEN 5
                   MOVE "5"   TO ߘablv
023070             MOVE NC""  TO ߘa`FbNv
024190         END-EVALUATE
024200*
      */C/20190408
029310         IF |Ҙa > 4
037370             MOVE |Ҙa     TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE | TO v
037410             END-READ
029330         END-IF
      */C/20190408
024210         MOVE |ҔN  TO ҔNv
024220         MOVE |Ҍ  TO Ҍv
024230         MOVE |ғ  TO ғv
      */픚{19`̏ꍇ{̂ɌSҔԍA󋋎ҔԍLڂB
               IF (| = 54) AND (|pSҔԍ(1:2) = "19")
                   MOVE |pSҔԍ TO SҔԍ 
                   MOVE |vҔԍ     TO 󋋎Ҕԍ
               END-IF
031450* 15/7`@@
031460         IF |{paN >= 41507
031470            IF ( | = 52 OR 53 OR 55 OR 60 ) AND
031480               ( |{ = 20 ) AND
031490               ( |iؖ敪 NOT = 1 ) AND
031500               ( Z|ꕔS NOT = ZERO )
031510*
031520*               MOVE |vҔԍ(1:3)   TO 󋋎ҔԍҏWvP
031530*               MOVE |vҔԍ(4:2)   TO 󋋎ҔԍҏWvQ
031540*               MOVE |vҔԍ(6:10)  TO 󋋎ҔԍҏWvR
031550*               MOVE "-"  TO 󋋎ҋ؂P 󋋎ҋ؂Q
016580               IF ( |pSҔԍ(1:2) NOT = "99" )
042910                  MOVE |pSҔԍ    TO SҔԍ 
016620               END-IF
                     IF |vҔԍ(9:7) NOT = SPACE
                        MOVE |vҔԍ(1:8)  TO 󋋎ҔԍP
                        MOVE |vҔԍ(9:7)  TO 󋋎ҔԍR
                     ELSE
                        MOVE |vҔԍ(1:7)  TO 󋋎Ҕԍ
                     END-IF
031560            END-IF
031570         END-IF
024240*
024250*         IF ( {lƑ敪vq = 1 )
024260*             MOVE NC"{l"    TO v
024270*         ELSE
024280*             MOVE 05          TO |敪R[h
024290*             MOVE |    TO |̃R[h
024300*             READ ̃}X^
024310*             INVALID KEY
024320*                 MOVE SPACE    TO v
024330*             NOT INVALID KEY
024340*                 MOVE | TO v
024350*             END-READ
024360*         END-IF
024370*
024380** 14/10`@ʋ敪Rg
024390*         IF ( |{paN >= 41410 )
024400*             IF ( | = ZERO )
024401*                EVALUATE |ʋ敪
024402*                WHEN 1
024403*                   MOVE "70ˈȏ 1"  TO ʃRgv
024404*                WHEN 2
024405*                   MOVE "70ˈȏ 2"  TO ʃRgv
024406*                WHEN 3
024407*                   MOVE "70ˈȏ 3"  TO ʃRgv
024408*                WHEN 6
024409*                   IF |{paN < 42004
024410*                      MOVE "3˖"        TO ʃRgv
024411*                   ELSE
024412*                      MOVE "`AwO" TO ʃRgv
024413*                   END-IF
024414*                END-EVALUATE
      **/VOΖ̑O҂͓ʃRgNA/100929
      *                IF |ʋ敪 = 1 OR 2 OR 3
      *                     MOVE SPACE TO ANQ|L[
      *                     INITIALIZE    ANQ|L[
      *                     MOVE |{pa TO ANQ|{pa
      *                     MOVE |{pN   TO ANQ|{pN  
      *                     MOVE |{p   TO ANQ|{p  
      *                     MOVE |Ҙa TO ANQ|a
      *                     MOVE |ҔN   TO ANQ|N
      *                     MOVE |Ҍ   TO ANQ|
      *                     MOVE |ғ   TO ANQ|
      *                     CALL   "NENREI2"
      *                     CANCEL "NENREI2"
      *                     IF ANQ|Vl = ZERO
      *                         MOVE SPACE TO ʃRgv
      *                     END-IF
      *                END-IF
024490*             END-IF
024500*         END-IF
024510*
024520     END-READ.
024530*================================================================*
024540 擾 SECTION.
024550*
024560****************************************************
024570* Af[^ی҃}X^萿擾B *
024580* ہ|敪=1̏ꍇ}X^gp   *
024590*  ...... 於̂vɊi[               *
024600****************************************************
024610     MOVE یʂvq   TO ہ|ی.
024620     MOVE یҔԍvq TO ہ|یҔԍ.
024630     READ ی҃}X^
024640     INVALID KEY
024650         MOVE SPACE              TO 於̂v
024660     NOT INVALID KEY
024670* ЕہAق́uЉیv
024680                 EVALUATE یʂvq 
024690                 WHEN  02
024700                 WHEN  06
                           IF ہ|یҖ(1:16) = "SNی"
                              UNSTRING ہ|یҖ DELIMITED BY "SNی" OR "x"
                                       INTO xPv xQv
                              END-UNSTRING
                              STRING "SNی" DELIMITED BY SIZE
                                     "@"               DELIMITED BY SIZE
                                     xQv         DELIMITED BY SPACE
                                     "@"               DELIMITED BY SIZE
                                     "x"             DELIMITED BY SIZE
                                   INTO 於̂v
                              END-STRING
                           ELSE
024710                        IF ( ہ|ڔ敪 = 1 )
024720                           MOVE ہ|یҖ    TO 於̂v
024730                        ELSE
024740                           STRING ہ|یҖ    DELIMITED BY SPACE
024750                                  "Љی"  DELIMITED BY SIZE
024760                                  INTO 於̂v
024770                           END-STRING
024780                        END-IF
                           END-IF
024790** g͎x܂ň
024800                 WHEN  03
024810                     STRING ہ|یҖ  DELIMITED BY SPACE
024820                            "  "            DELIMITED BY SIZE
024830                            ہ|x  DELIMITED BY SPACE
024840                           INTO 於̂v
024850                     END-STRING
024860                 WHEN OTHER
024870                     MOVE ہ|یҖ   TO 於̂v
024880                 END-EVALUATE
024890     END-READ.
024900*
027590*================================================================*
027600 Ǎ SECTION.
027610*
027790     MOVE {pavq       TO |{pa.
027800     MOVE {pNvq         TO |{pN.
027810     MOVE {pvq         TO |{p.
027820     MOVE ҃R[hvq     TO |҃R[h.
027830     READ f[^e
027870     NOT INVALID KEY
027900         MOVE |ʐ                   TO ʐv
           END-READ.
024910*================================================================*
024920 f[^擾 SECTION.
024930*
024940**************************************************
024950* Af[^畉f[^eȉ̏擾 *
024960*  ...ʁ{ʂɂĉHĊi[     *
024970*  N.......Nv                       *
024980*  .......v                       *
024990*  .......v                       *
025000*  JnN.......Nv                       *
025010*  Jn.......v                       *
025020*  Jn.......v                       *
025030*  IN.......INv                       *
025040*  I.......Iv                       *
025050*  I.......Iv                       *
025060*  .......v                       *
025070*  ]A敪 ....敪ɂ`FbN""i[ *
025080*  q ....敪ɂ`FbN""i[ *
025090*  o߃R[h...o߃}X^擾             *
025100**************************************************
025110*     MOVE {pavq       TO |{pa.
025120*     MOVE {pNvq         TO |{pN.
025130*     MOVE {pvq         TO |{p.
025140*     MOVE ҃R[hvq     TO |҃R[h.
025150*     READ f[^e
025160*     INVALID KEY
025170*         CONTINUE
025180**            /* 肦Ȃ */
025190*     NOT INVALID KEY
025200*         MOVE |ʐ                   TO ʐv
025210         PERFORM VARYING ʂbms FROM 1 BY 1
025220                 UNTIL ( ʂbms > ʐv )
025230             MOVE |(ʂbms) TO ʂv(ʂbms)
025240             MOVE |(ʂbms)     TO ʂv(ʂbms)
025250             MOVE |E敪(ʂbms) TO E敪v(ʂbms)
025260             MOVE |ʒuԍ(ʂbms)
025270                                           TO ʒuԍv(ʂbms)
025280*********************************************
025290* jS_...ʁ{ʂɂĉHĊi[ *
025300*********************************************
025310* 
025320             MOVE SPACE                     TO ̂v
025330             MOVE 03                        TO |敪R[h
025340             MOVE |(ʂbms)  TO |̃R[h
025350             READ ̃}X^
025360             INVALID KEY
025370                 MOVE SPACE        TO ̂v
025380             NOT INVALID KEY
025390                 MOVE | TO ̂v
025400             END-READ
025410* 
020710             MOVE SPACE                    TO v(ʂbms)
028160*
028170             PERFORM ʖ̖
025600*
025610             MOVE |N(ʂbms)   TO Nv(ʂbms)
025620             MOVE |(ʂbms)   TO v(ʂbms)
025630             MOVE |(ʂbms)   TO v(ʂbms)
025640             MOVE |JnN(ʂbms)   TO Nv(ʂbms)
025650             MOVE |Jn(ʂbms)   TO v(ʂbms)
025660             MOVE |Jn(ʂbms)   TO v(ʂbms)
025670             IF ( |]A敪(ʂbms) = 9 )
025680                 MOVE 99                   TO INv(ʂbms)
025690                 MOVE 99                   TO Iv(ʂbms)
025700                 MOVE 99                   TO Iv(ʂbms)
025710             ELSE
025720                 MOVE |IN(ʂbms)   TO INv(ʂbms)
025730                 MOVE |I(ʂbms)   TO Iv(ʂbms)
025740                 MOVE |I(ʂbms)   TO Iv(ʂbms)
025750             END-IF
025760* oߗ̎擾
025770             MOVE 01                         TO o|敪R[h
025780             MOVE |o߃R[h(ʂbms) TO o|o߃R[h
025790             READ o߃}X^
025800             INVALID KEY
025810                 MOVE ZERO            TO ʂbmsv(ʂbms)
025820                 MOVE SPACE           TO ʋ؂v(ʂbms)
025830                 MOVE SPACE           TO oߗ̂v(ʂbms)
025840             NOT INVALID KEY
025850*
025860                 EVALUATE ʂbms
025870                 WHEN 1
025880                     MOVE NC"@" TO oߕʂv
025890                 WHEN 2
025900                     MOVE NC"A" TO oߕʂv
025910                 WHEN 3
025920                     MOVE NC"B" TO oߕʂv
025930                 WHEN 4
025940                     MOVE NC"C" TO oߕʂv
025950                 WHEN 5
025960                     MOVE NC"D" TO oߕʂv
025970                 END-EVALUATE
025980                 STRING  oߕʂv     DELIMITED BY SPACE
025990                         o|oߗ   DELIMITED BY SPACE
026000                        INTO oߗ̂v(ʂbms)
026010                 END-STRING
026020*
026030             END-READ
026040*
026050             MOVE |]A敪(ʂbms) TO ]A敪v(ʂbms)
026060             EVALUATE |]A敪(ʂbms)
026070             WHEN 1
026080             WHEN 2
026090                 MOVE NC""               TO `FbNv(ʂbms)
026100             WHEN 3
026110                 MOVE NC""               TO ~`FbNv(ʂbms)
026120             WHEN 4
026130                 MOVE NC""               TO ]`FbNv(ʂbms)
026140             END-EVALUATE
028260*
      */̓Z|ʎ]L/160816
031230             MOVE Z|ʎ(ʂbms) TO v(ʂbms)
026150         END-PERFORM.
026160* VK/p `FbN
033380         EVALUATE Z|Z敪
               WHEN 1
033390             MOVE NC""                   TO VK`FbNv
               WHEN 2
033410             MOVE NC""                   TO p`FbNv
033400         WHEN 3
033390             MOVE NC""                   TO VK`FbNv
033410             MOVE NC""                   TO p`FbNv
               WHEN OTHER
033410             MOVE NC""                   TO p`FbNv
033420         END-EVALUATE.
026220* }Ԕp
026230         MOVE |JnfÓ蓮敪 TO  JnfÓ蓮敪v.
026240* 敪
026250         MOVE |Z敪 TO Z敪v.
028370* R敪
027880         MOVE |ZR敪 TO R敪e.
026260*
026270*     END-READ.
026280*================================================================*
026290*================================================================*
026300 {pL^擾 SECTION.
026310*
026320************************************************************
026330* Pf[^畉f[^eȉ̏擾           *
026340*  Z .....敪ɂ`FbN""i[... *
026350*  ÉZ .....敪ɂ`FbN""i[... *
026360************************************************************
026370     MOVE  SPACE  TO  ČtO.
026380     PERFORM VARYING ʂbms FROM 1 BY 1 UNTIL ʂbms > ʐv
026390         IF ( {pNv = Nv(ʂbms) ) AND
026400            ( {pv = v(ʂbms) )
026410             MOVE Ҕԍvq          TO {L|Ҕԍ
026420             MOVE }Ԃvq              TO {L|}
026430             MOVE {pavq          TO {L|{pa
026440             MOVE Nv(ʂbms)  TO JnNv(ʂbms) {L|{pN
026450             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
026460             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
026470         ELSE
026480             MOVE Ҕԍvq          TO {L|Ҕԍ
026490             MOVE }Ԃvq              TO {L|}
026500             MOVE {pavq          TO {L|{pa
026510             MOVE {pNvq            TO {L|{pN
026520             MOVE {pvq            TO {L|{p
026530             MOVE ZERO                  TO {L|{p
026540         END-IF
026550         START {pL^e   KEY IS >= {L|҃R[h
026560                                      {L|{paN
026570         END-START
026580         IF ( ԃL[ = "00" )
      */̓Z|ʎ]L/160816
026590*             MOVE ZERO  TO v(ʂbms)
026600             MOVE ZERO  TO INvs
026610             MOVE ZERO  TO Ivs
026620             MOVE ZERO  TO Ivs
026630             MOVE SPACE TO ItOQ
026640             PERFORM {pL^eǍ
026650             IF  ( ItOQ      = SPACE   ) AND
026660                 ( {L|҃R[h  = ҃R[hvq ) AND
026670                 ( {L|{pa    = {pavq   ) AND
026680                 ( {L|{pN      = {pNvq     ) AND
026690                 ( {L|{p      = {pvq     ) 
026700*
026710*        *****************************************************************
026720*        * JnN ( ̕ʂłȂA
026730*                       ł}Ԃ鎞́Aŏ̎{pJn)*
026740*        *****************************************************************
026750                 IF ( {pNv NOT = Nv(ʂbms) ) OR
026760                    ( {pv NOT = v(ʂbms) ) OR
026770                    ( JnfÓ蓮敪v = 1 )
026780                     MOVE {L|{pN   TO JnNv(ʂbms)
026790                     MOVE {L|{p   TO Jnv(ʂbms)
026800                     MOVE {L|{p   TO Jnv(ʂbms)
026810                 END-IF
026820             END-IF
026830             PERFORM UNTIL ( ItOQ         = "YES"            ) OR
026840                           ( {L|҃R[h NOT = ҃R[hvq   ) OR
026850                           ( {L|{pa   NOT = {pavq     ) OR
026860                           ( {L|{pN     NOT = {pNvq       ) OR
026870                           ( {L|{p     NOT = {pvq       ) OR
026880                           ( {L|{p         > Iv(ʂbms))
026890*               **********
026900*               *  *
026910*               **********
      */̓Z|ʎ]L/160816
026920*                COMPUTE v(ʂbms) = v(ʂbms) + 1
026930                MOVE {L|{pN               TO INvs
026940                MOVE {L|{p               TO Ivs
026950                MOVE {L|{p               TO Ivs
026960*
026970                PERFORM {pL^eǍ
026980            END-PERFORM
026990        END-IF
027000*       **************************
027010*       * pFINZbg *
027020*       **************************
027030        IF ( ]A敪v(ʂbms) = 9 )
027040            MOVE INvs    TO INv(ʂbms)
027050            MOVE Ivs    TO Iv(ʂbms)
027060            MOVE Ivs    TO Iv(ʂbms)
027070        END-IF
027080        IF ( INv(ʂbms) > 󗝔Nv )
027090            MOVE INv(ʂbms) TO 󗝔Nv
027100            MOVE Iv(ʂbms) TO 󗝌v
027110            MOVE Iv(ʂbms) TO 󗝓v
027120        END-IF
027130     END-PERFORM.
027140*
027150** ----- Ô݂𔻒 -----------*
027160*
027170*     MOVE Ҕԍvq          TO {L|Ҕԍ.
027180*     MOVE }Ԃvq              TO {L|}.
027190*     MOVE {pavq          TO {L|{pa.
027200*     MOVE {pNvq            TO {L|{pN.
027210*     MOVE {pvq            TO {L|{p.
027220*     MOVE ZERO                  TO {L|{p.
027230*     START {pL^e   KEY IS >= {L|҃R[h
027240*                                  {L|{paN
027250*     END-START.
027260*     IF ( ԃL[ = "00" )
027270*             MOVE SPACE TO ItOQ
027280*             PERFORM {pL^eǍ
027290*             IF  ( ItOQ      = SPACE   ) AND
027300*                 ( {L|҃R[h  = ҃R[hvq ) AND
027310*                 ( {L|{pa    = {pavq   ) AND
027320*                 ( {L|{pN      = {pNvq     ) AND
027330*                 ( {L|{p      = {pvq     ) 
027340** {pJnČǂ
027350*                 IF ( {L|Č = 1 )
027360*                      MOVE "YES"  TO  ČtO
027370*                 END-IF
027380**
027390*             END-IF
027400*     END-IF.
027410*     IF ( ČtO = "YES" )
027420*        PERFORM Ôݔ
027430*     END-IF.
027440*
027450*================================================================*
027460*================================================================*
027470 Zvgя擾 SECTION.
027480*================================================================*
027490     MOVE {pavq       TO S|{pa.
027500     MOVE {pNvq         TO S|{pN.
027510     MOVE {pvq         TO S|{p.
027520     MOVE ҃R[hvq     TO S|҃R[h.
027530     MOVE یʂvq       TO S|ی.
027540     READ ƃt@CS
027550     NOT INVALID KEY
027560          MOVE NC""        TO ԌŒv
027570          MOVE S|    TO Ԃv
027580     END-READ.
027590*
027600*================================================================*
027610*================================================================*
027620* nbq擾 SECTION.
027630*
027640****************************************************************
027650*      ڍtԍ .....{p}X^Ɏ擾    *
027660*      {pN         .....fҏeɎ擾        *
027670*  @@ی         .....S_pۃR[h42Zbg    @*
027680*                              VK}X^ɂΉ̉\L*
027690*      weЂhc     .....Ђhc"21"Zbg            *
027700*      ecA         .....Q                        *
027710*  @@z         .....Z|zZbg        *
027720* @@ S         .....S = Z|S / 10@*
027730****************************************************************
027740* ڍtԍ
027750*     MOVE nbqڍtԍv TO nbqԍv.
027760* {pN
027770*     MOVE {pNv         TO nbq{pNv.
027780* ی = S_R[h = 42
027790*     MOVE 42                 TO nbqیʂv.
027800* weЂhc = Ђhc = 21
027810*     MOVE "21"               TO nbqeЂhcv.
027820* ecA = ecAԊҔԍv + ecAԌۂhcv
027830*     MOVE Ҕԍv         TO ecAԊҔԍv.
027840*     MOVE 1                  TO ecAԌۂhcv.
027850* z
027860*     MOVE Z|z       TO nbqzv.
027870* S
027880*     MOVE Z|S     TO Svq.
027890*     COMPUTE nbqSv = Svq / 10.
027900*================================================================*
027910 {pL^eǍ SECTION.
027920*
027930     READ {pL^e NEXT
027940     AT END
027950         MOVE "YES" TO ItOQ
027960     END-READ.
027970*================================================================*
027980  SECTION.
027990*
028000     MOVE "YCH6125P" TO  `̖o.
028010     MOVE "SCREEN"   TO  ڌQo.
028020     WRITE YCH6125P.
028030***     WRITE R[h.
028040     PERFORM G[o.
028050*================================================================*
028060 G[o SECTION.
028070*
028080     IF ( ʒmo NOT = "00" )
028090         DISPLAY NC"[G["              UPON CONS
028100         DISPLAY NC"ڌQoF" ڌQo UPON CONS
028110         DISPLAY NC"ʒmoF" ʒmo UPON CONS
028120         DISPLAY NC"goF" go UPON CONS
028130         DISPLAY NC"P͂dmsdqL[Ă"
028140                                             UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
028150         ACCEPT  L[ FROM CONS
028160         PERFORM t@C
028170         MOVE 99 TO PROGRAM-STATUS
028180         EXIT PROGRAM
028190     END-IF.
028200*================================================================*
028210 ʖ̖ SECTION.
028220*
006490     STRING Z|ʖ̂P(ʂbms)  DELIMITED BY SPACE
009980            ̂v                    DELIMITED BY SPACE
006500            Z|ʖ̂Q(ʂbms)  DELIMITED BY SPACE
006520       INTO v(ʂbms)
006570     END-STRING.
028420*
028430*================================================================*
028440 ȑÕf[^ SECTION.
028450*
028460*********************************************************************************
028470*  ŏ̏ȑO̓Ɏ{pL^R[h(A~)́A敪
028480*  pɂ`FbNB(VKƌp̗)
028490*********************************************************************************
028500** ŏ̏擾
028510     MOVE SPACE                 TO tO.
028520     MOVE Ҕԍvq          TO {L|Ҕԍ.
028530     MOVE }Ԃvq              TO {L|}.
028540     MOVE {pavq          TO {L|{pa.
028550     MOVE {pNvq            TO {L|{pN.
028560     MOVE {pvq            TO {L|{p.
028570     MOVE ZERO                  TO {L|{p.
028580     START {pL^e   KEY IS >= {L|҃R[h
028590                                  {L|{paN
028600     END-START.
028610     IF ( ԃL[ = "00" )
028620         MOVE ZERO  TO avs
028630         MOVE ZERO  TO Nvs
028640         MOVE ZERO  TO vs
028650         MOVE ZERO  TO vs
028660         MOVE SPACE TO ItOQ
028670         PERFORM {pL^eǍ
028680         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
028690                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
028700                       ( {L|{pa   NOT = {pavq    ) OR
028710                       ( {L|{pN     NOT = {pNvq      ) OR
028720                       ( {L|{p     NOT = {pvq      ) OR
028730                       ( tO           = "YES"           ) 
028740           IF ( {L|fË敪 = 2 )
028750               MOVE {L|{pa           TO avs
028760               MOVE {L|{pN             TO Nvs
028770               MOVE {L|{p             TO vs
028780               MOVE {L|{p             TO vs
028790               MOVE "YES"                    TO tO
028800           END-IF
028810           PERFORM {pL^eǍ
028820         END-PERFORM
028830     END-IF.
028840*
028850* ȑÕf[^
028860     IF ( tO = "YES" )
028870        MOVE Ҕԍvq          TO {L|Ҕԍ
028880        MOVE }Ԃvq              TO {L|}
028890        MOVE avs          TO {L|{pa
028900        MOVE Nvs            TO {L|{pN
028910        MOVE vs            TO {L|{p
028920        MOVE vs            TO {L|{p
028930        START {pL^e   KEY IS <  {L|҃R[h
028940                                     {L|{paN
028950                                     REVERSED
028960        END-START
028970        IF ( ԃL[ = "00" )
028980           MOVE SPACE  TO ItOQ
028990           PERFORM {pL^eǍ
029000           IF ( ItOQ    = SPACE        ) AND
029010              ( {L|Ҕԍ  = Ҕԍvq ) AND
029020              ( {L|}      = }Ԃvq     ) AND
029030              ( {L|{pa  = avs ) AND
029040              ( {L|{pN    = Nvs   ) AND
029050              ( {L|{p    = vs   )
029060*  ȑO̓Ɏ{pL^R[h
029070                IF ( p`FbNv = SPACE )
029080                   MOVE NC""    TO p`FbNv
029090                END-IF
029100           END-IF
029110         END-IF
029120     END-IF.
029130*
029140*================================================================*
029150 擾 SECTION.
029160*
029170* RJȏ̒ "CHOUKI" Ă. 
029180     MOVE  SPACE TO  Aԁ|L[.
029190     INITIALIZE      Aԁ|L[.
029200     MOVE {pavq  TO  Aԁ|{pa.
029210     MOVE {pNvq    TO  Aԁ|{pN.
029220     MOVE {pvq    TO  Aԁ|{p.
029230     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
029240     MOVE }Ԃvq      TO  Aԁ|}.
029250*
029260     CALL   "CHOUKI".
029270     CANCEL "CHOUKI".
029280*
029290**** KpPgp (uÔ݁v鎞́A)
029300     IF ( Aԁ|ΏۃtO  = "YES" )
029310        IF ( KpPv  = SPACE )
029320           MOVE NC"{ppRʂɋL"  TO KpPv
029330        ELSE
029340           STRING KpPv           DELIMITED BY SPACE
029350                  NC"C"             DELIMITED BY SIZE
029360                  NC"{ppRʂɋL"   DELIMITED BY SIZE
029370                  INTO KpPv
029380           END-STRING
029390        END-IF
029400     END-IF.
029410*
029420*================================================================*
029430 Z擾 SECTION.
029440*****************************************************************
029450** ZԊOƐ[̎AKpɁutԁv󎚂B
029460**   ̈󎚂͌3܂ŉ\
029470*****************************************************************
029480     IF ( Z|ԊO = 1 ) OR ( Z|[ = 1 ) OR ( Z|x = 1 )
029490*
029500         MOVE Ҕԍvq          TO {L|Ҕԍ
029510         MOVE }Ԃvq              TO {L|}
029520         MOVE {pavq          TO {L|{pa
029530         MOVE {pNvq            TO {L|{pN
029540         MOVE {pvq            TO {L|{p
029550         MOVE ZERO                  TO {L|{p
029560         START {pL^e   KEY IS >= {L|҃R[h
029570                                      {L|{paN
029580         END-START
029590         IF ( ԃL[ = "00" )
029600             MOVE ZERO  TO ZJEg
029610             MOVE SPACE TO ItOQ
029620             PERFORM {pL^eǍ
029630             PERFORM UNTIL ( ItOQ         = "YES"           ) OR
029640                           ( {L|҃R[h NOT = ҃R[hvq  ) OR
029650                           ( {L|{pa   NOT = {pavq    ) OR
029660                           ( {L|{pN     NOT = {pNvq      ) OR
029670                           ( {L|{p     NOT = {pvq      ) 
029680               IF ( {L|Z = 1 OR 2 OR 3 ) AND ( {L|fË敪 = 2 )
029690                   COMPUTE ZJEg = ZJEg  + 1
029700                   IF ( ZJEg <= 3 )
029710                       MOVE {L|Z TO Z敪vs(ZJEg)
029720                       MOVE {L|t   TO Zvs(ZJEg)
029730                       MOVE {L|t   TO Zvs(ZJEg)
029740                   END-IF
029750               END-IF
029760               PERFORM {pL^eǍ
029770             END-PERFORM
029780** Z̎KpɃZbg
033380            IF ( Zvs(1) NOT = ZERO ) OR ( Zvs(1) NOT = ZERO ) 
                      MOVE Zvs(1) TO Zv
                      MOVE ":"               TO Z؂v
                      MOVE Zvs(1) TO Zv
                  END-IF
033380            IF ( Zvs(2) NOT = ZERO ) OR ( Zvs(2) NOT = ZERO ) 
031910                PERFORM ZKpZbg
                  END-IF
029800         END-IF
029810*
029820     END-IF.
029830*
029840*================================================================*
029850 ZKpZbg SECTION.
029860*
029870     PERFORM VARYING ԍJE^ FROM 1 BY 1
029880              UNTIL  ԍJE^ > 3
029890         IF ( Zvs(ԍJE^)  = ZERO )  AND 
029900            ( Zvs(ԍJE^)  = ZERO ) 
029910             CONTINUE
029920         ELSE
029930* Œ荀
029940             EVALUATE Z敪vs(ԍJE^) 
029950             WHEN 1
029960                MOVE NC"ԊO"   TO Zev(ԍJE^)
033320             WHEN 2
033330                MOVE NC"x@"   TO Zev(ԍJE^)
029970             WHEN 3
029980                MOVE NC"[@"   TO Zev(ԍJE^)
029990             END-EVALUATE
030000*
030010             MOVE NC"F"          TO Z؂v(ԍJE^)
030020             MOVE NC""          TO Œv(ԍJE^)
030030             MOVE NC""          TO Œv(ԍJE^)
030040*
030050**** {ϊ
030060* 
030070             MOVE Zvs(ԍJE^)  TO  v
030080             IF ( v >= 10 )
030090                MOVE vP    TO ԍvP
030100                PERFORM {ϊ
030110                MOVE Spԍv  TO ZmvP(ԍJE^)
030120                MOVE vQ    TO ԍvP
030130                PERFORM {ϊ
030140                MOVE Spԍv  TO ZmvQ(ԍJE^)
030150             ELSE
030160                MOVE vQ    TO ԍvP
030170                PERFORM {ϊ
030180                MOVE Spԍv  TO ZmvQ(ԍJE^)
030190             END-IF
030200* 
030210             MOVE Zvs(ԍJE^)  TO  v
030220             MOVE vP    TO ԍvP
030230             PERFORM {ϊ
030240             MOVE Spԍv  TO ZmvP(ԍJE^)
030250             MOVE vQ    TO ԍvP
030260             PERFORM {ϊ
030270             MOVE Spԍv  TO ZmvQ(ԍJE^)
030280** 
030290        END-IF
030300     END-PERFORM.
030310*
030320     MOVE  ZWcmv(1)   TO ZPv. 
030330     MOVE  ZWcmv(2)   TO ZQv. 
030340     MOVE  ZWcmv(3)   TO ZRv. 
030350*
030360**** KpPQgpiRLڂœKpPgĂ鎞́AKpQj
030370     IF ( Zvs(2)  = ZERO ) AND ( Zvs(2)  = ZERO ) 
030380     CONTINUE
030390     ELSE
030400         IF ( KpPv  = SPACE )
030410               STRING NC"Z"       DELIMITED BY SIZE
030420                      ZPv   DELIMITED BY SIZE
030430                      ZQv   DELIMITED BY SIZE
030440                      ZRv   DELIMITED BY SIZE
030450                INTO KpPv
030460         END-STRING
030470         ELSE
030480               STRING NC"Z"       DELIMITED BY SIZE
030490                      ZPv   DELIMITED BY SIZE
030500                      ZQv   DELIMITED BY SIZE
030510                      ZRv   DELIMITED BY SIZE
030520                      INTO KpQv
030530         END-STRING
030540         END-IF
030550     END-IF.
030560*
030570*================================================================*
030580 {ϊ SECTION.
030590*
030600     MOVE NC"O"     TO Spԍv.
030610     CALL "htoz" WITH C LINKAGE
030620                        USING ԍvP SpԍvP.
030630*
030640*================================================================*
030650*================================================================*
030660 擾 SECTION.
030670*
030680********************************************************************
030690*  R[ĥ́A1sɂ܂Ƃ߂Ĉ󎚂B
030700*  : @A Ƃœ].
030710*     R[ĥ܂Ƃ߁Ae[uɃZbg
030720*     (Aʂœ̂́A2sɂȂ)
030730********************************************************************
030740     MOVE  ZERO   TO  JE^ JE^Q.
030750     PERFORM VARYING ʂbms FROM 1 BY 1
030760             UNTIL ( ʂbms > ʐv )
030770*
030780****        IF ( |Ҕԍ(ʂbms)  NOT = ZERO )  AND
030790        IF ( |A(ʂbms)      NOT = ZERO )
030800*
030810           IF ( JE^ = ZERO )
030820               MOVE 1   TO  JE^ JE^Q
030830               MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
030840               MOVE |A(ʂbms)     TO AԂv(JE^)   AԂbv
030850               MOVE ʂbms                   TO ʂv(JE^ JE^Q)
030860           ELSE
030870              IF ( |Ҕԍ(ʂbms)  = Ҕԍbv )  AND
030880                 ( |A(ʂbms)      = AԂbv     )
030890                 COMPUTE JE^Q = JE^Q  +  1
030900                 MOVE ʂbms                  TO ʂv(JE^ JE^Q)
030910              ELSE
030920                 COMPUTE JE^ = JE^  +  1
030930                 MOVE 1   TO  JE^Q
030940                 MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
030950                 MOVE |A(ʂbms)     TO AԂv(JE^)  AԂbv
030960                 MOVE ʂbms                   TO ʂv(JE^ JE^Q)
030970              END-IF
030980           END-IF
030990        END-IF
031000     END-PERFORM.
031010**************************************************************************
031020*  }X^蕶͎擾
031030**************************************************************************
031040     MOVE  ZERO   TO  JE^ JE^Q.
031050     PERFORM VARYING JE^ FROM 1 BY 1
031060             UNTIL ( JE^ > 9 )  OR ( AԂv(JE^) = ZERO )
031070** ۂ 敪 01
031080         MOVE 01                        TO |敪R[h
031090         MOVE Ҕԍv(JE^)  TO |Ҕԍ
031100         MOVE AԂv(JE^)      TO |A
031110         READ e
031120         NOT INVALID KEY
031130             INITIALIZE vs
031140             MOVE |bl(1) TO  Pvs
031150             MOVE |bl(2) TO  Qvs
031160             MOVE |bl(3) TO  Rvs
031170             MOVE |bl(4) TO  Svs
031180             MOVE |bl(5) TO  Tvs
031190             PERFORM VARYING JE^Q FROM 1 BY 1
031200                     UNTIL ( JE^Q > 9 )  OR 
031210                           ( ʂv(JE^ JE^Q) = ZERO )
031220                EVALUATE ʂv(JE^ JE^Q)
031230                WHEN 1
031240                   MOVE "@"  TO  io[vP(JE^Q)
031250                WHEN 2
031260                   MOVE "A"  TO  io[vP(JE^Q)
031270                WHEN 3
031280                   MOVE "B"  TO  io[vP(JE^Q)
031290                WHEN 4
031300                   MOVE "C"  TO  io[vP(JE^Q)
031310                WHEN 5
031320                   MOVE "D"  TO  io[vP(JE^Q)
031290                WHEN 6
031300                   MOVE "E"  TO  io[vP(JE^Q)
031310                WHEN 7
031320                   MOVE "F"  TO  io[vP(JE^Q)
031330                WHEN OTHER
031340                   CONTINUE
031350                END-EVALUATE
031360             END-PERFORM
031370*
031452             IF |͋敪 = 1
031453                 STRING io[mv  DELIMITED BY SPACE
031454                        Pvs  DELIMITED BY SIZE
031455                        Qvs  DELIMITED BY SIZE
031456                        Rvs  DELIMITED BY SIZE
031457                        Svs  DELIMITED BY SIZE
031458                        Tvs  DELIMITED BY SIZE
031459                        INTO ev(JE^)
031460                 END-STRING
031461             ELSE
005946                 INSPECT vs REPLACING ALL Sp BY p
                       MOVE SPACE TO Pv Qv
                       MOVE io[mv TO Pv
                       MOVE Pvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Qvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Rvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Svs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Tvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                        MOVE Pv TO ev(JE^)
031470             END-IF
031471*
031472         END-READ
031473     END-PERFORM.
031480*
031490     PERFORM Zbg.
031500*
031510*================================================================*
031520 Zbg SECTION.
031530*
031540**************************************************************************
031550*  ͂1s𒴂鎞́AsɕB
031560**************************************************************************
031570     MOVE  ZERO   TO  JE^ JE^Q.
031580     PERFORM VARYING JE^ FROM 1 BY 1
031590             UNTIL ( JE^ > 9 )  OR ( ev(JE^) = SPACE )
031600*
031610          INITIALIZE ewv
031620          MOVE ev(JE^)   TO ewv
031630          IF ( ePwv  NOT = SPACE )
031640              COMPUTE JE^Q = JE^Q  +  1
031650              MOVE ePwv  TO v(JE^Q)
031660          END-IF
031670          IF ( eQwv  NOT = SPACE )
031680              COMPUTE JE^Q = JE^Q  +  1
031690              MOVE eQwv  TO v(JE^Q)
031700          END-IF
031710          IF ( eRwv  NOT = SPACE )
031720              COMPUTE JE^Q = JE^Q  +  1
031730              MOVE eRwv  TO v(JE^Q)
031740          END-IF
033830          IF ( eSwv  NOT = SPACE )
033840              COMPUTE JE^Q = JE^Q  +  1
033850              MOVE eSwv  TO v(JE^Q)
033860          END-IF
031750*
031760     END-PERFORM.
031770*================================================================*
031780 擾 SECTION.
031790*
031800* 2006/04 ύX
031810*  "JOSEIMEI" Ă. 
031820     MOVE SPACE TO  Á|L[.
031830     INITIALIZE     Á|L[.
031840     MOVE ʂvq           TO Á|.
031850     MOVE pSҔԍvq TO Á|pSҔԍ.
031860*
031870     CALL   "JOSEIMEI".
031880     CANCEL "JOSEIMEI".
031890*
031900     MOVE Á|P TO v.
031910*
031920***
032170*
032180*================================================================*
032190 Ôݔ SECTION.
032200*
032210*** O̒ʉ@ 
032220     MOVE  SPACE            TO OtO.
032230     MOVE |҃R[h    TO {L|҃R[h.
032240     MOVE |{pa      TO {L|{pa.
032250     MOVE |{pN        TO {L|{pN.
032260     MOVE |{p        TO {L|{p.
032270     MOVE 1                 TO {L|{p.
032280     START {pL^e   KEY IS <  {L|҃R[h
032290                                  {L|{paN
032300                                  REVERSED
032310     END-START.
032320     IF ( ԃL[ = "00" )
032330         MOVE SPACE  TO ItOQ
032340         PERFORM {pL^eǍ
032350         IF ( ItOQ      = SPACE  ) AND
032360            ( {L|҃R[h  = |҃R[h ) AND
032370            ( {L|fË敪    = 2 ) 
032380*
032390            PERFORM O
032400**** KpPgp
032410            IF ( OtO = "YES" )
032420               MOVE NC"Ô"    TO  KpPv
032430            END-IF
032440**
032450         END-IF
032460     END-IF.
032470*
032480*================================================================*
032490 O  SECTION.
032500* 
032510*** ǂݍ񂾎{pL^̔NAOǂ (N̍ 1 ?)
032520      MOVE  SPACE  TO  OtO.
032530      INITIALIZE  vZNv JnNQv INQv.
032540**
032550      MOVE |{pa    TO IaQv.
032560      MOVE |{pN      TO INQv.
032570      MOVE |{p      TO IQv.
032580      MOVE {L|{pa  TO JnaQv.
032590      MOVE {L|{pN    TO JnNQv.
032600      MOVE {L|{p    TO JnQv.
032610*
032620      EVALUATE TRUE
032630       WHEN (JnaQv = IaQv) AND (JnNQv = INQv)
032640            PERFORM  Or
032650       WHEN (JnaQv = IaQv) AND (JnNQv NOT = INQv)
032660            PERFORM  OrN
032670       WHEN  JnaQv NOT = IaQv 
032680            PERFORM  Or
032690      END-EVALUATE.
032700*
032710      IF ( vZv = 1 )
032720         MOVE  "YES"  TO  OtO
032730      END-IF.
032740*
032750*================================================================*
032760 Or  SECTION.
032770*
032780     IF ( IQv >  JnQv )
032790         COMPUTE vZv = IQv - JnQv
032800     ELSE
032810        MOVE ZERO TO vZv
032820     END-IF.
032830*
032840*================================================================*
032850 OrN  SECTION.
032860*
032870     IF ( INQv >  JnNQv )
032880         COMPUTE vZNv = INQv - JnNQv
032890         COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
032900     ELSE
032910        MOVE ZERO TO vZv
032920     END-IF.
032930*
032940*================================================================*
032950 Or  SECTION.
032960*
032970     MOVE JnaQv TO |敪.
032980     READ }X^
032990     NOT INVALID KEY
033000         MOVE |JnN TO JnNv
033010     END-READ.
033020     MOVE IaQv TO |敪.
033030     READ }X^
033040     NOT INVALID KEY
033050         MOVE |JnN TO INv
033060     END-READ.
033070**
033080     IF ( JnNv NOT = ZERO ) AND ( INv NOT = ZERO )
033090        COMPUTE JnNv = JnNv + JnNQv - 1
033100        COMPUTE INv = INv + INQv - 1
033110*
033120        IF ( INv =  JnNv )
033130           PERFORM  Or
033140        ELSE
033150           IF ( INv >  JnNv )
033160               COMPUTE vZNv = INv - JnNv
033170               COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
033180           ELSE
033190               MOVE ZERO TO vZv
033200           END-IF
033210        END-IF
033220     ELSE
033230        MOVE ZERO TO vZv
033240     END-IF.
033250*
033430*================================================================*
033440 f҈敪XV SECTION.
033450*
033460** //  fҏë敪ɂPZbgAXVB//  
033470*
033480     MOVE {pavq       TO |{pa.
033490     MOVE {pNvq         TO |{pN.
033500     MOVE {pvq         TO |{p.
033510     MOVE ҃R[hvq     TO |҃R[h.
033520     READ fҏe
033530     NOT INVALID KEY
033540         MOVE  1  TO  |Z敪
033550         REWRITE  |R[h
033560         END-REWRITE
033570         IF ( ԃL[ NOT = "00" )
033580            MOVE NC"f" TO t@C
033590            PERFORM G[\
033600         END-IF
033610     END-READ.
033620*
033630*================================================================*
033640 擾 SECTION.
033650*
033660     MOVE {pNvq   TO 󗝔Nv.
033670     MOVE {pvq   TO 󗝌v.
033680     MOVE {pavq TO |敪.
033690     READ }X^
033700     NOT INVALID KEY
033710         MOVE |JnN TO {pNv
033720     END-READ.
033730     IF ( {pNv NOT = ZERO )
033740        COMPUTE {pNv = {pNv + {pNvq - 1
033750     END-IF.
033760*
033770     EVALUATE {pvq
033780     WHEN 4
033790     WHEN 6
033800     WHEN 9
033810     WHEN 11
033820         MOVE 30 TO 󗝓v
033830     WHEN 2
033840         DIVIDE 4 INTO {pNv GIVING    v
033850                                    REMAINDER ]v
033860         END-DIVIDE
033870         IF ( ]v = ZERO )
033880             MOVE 29 TO 󗝓v
033890         ELSE
033900             MOVE 28 TO 󗝓v
033910         END-IF
033920     WHEN 1
033930     WHEN 3
033940     WHEN 5
033950     WHEN 7
033960     WHEN 8
033970     WHEN 10
033980     WHEN 12
033990         MOVE 31 TO 󗝓v
034000     WHEN OTHER
034010          CONTINUE
034020     END-EVALUATE.
034030*
034040*================================================================*
034050 ϔCN擾 SECTION.
034060*
034070** ---// ̎󗝔Nɂ́AŏIʉ@ĂׁAޔ //----
034080     MOVE 󗝔Nv   TO ŏIʉ@Nv.
034090     MOVE 󗝌v   TO ŏIʉ@v.
034100     MOVE 󗝓v   TO ŏIʉ@v.
034110***
034120* (_t)
034130     EVALUATE Zvgt敪v 
034140*    /  ŏIʉ@ /
034150     WHEN ZERO
034160         MOVE ŏIʉ@Nv TO _tNv
034170         MOVE ŏIʉ@v TO _tv
034180         MOVE ŏIʉ@v TO _tv
034190*    /   /
034200     WHEN 1 
034210         PERFORM 擾
034220         MOVE 󗝔Nv     TO _tNv
034230         MOVE 󗝌v     TO _tv
034240         MOVE 󗝓v     TO _tv
034250*    /  󎚂Ȃ /
034260     WHEN 9
034270         MOVE ZERO         TO _tNv
034280         MOVE ZERO         TO _tv
034290         MOVE ZERO         TO _tv
034300*    /  ̑́AŏIʉ@ /
034310     WHEN OTHER
034320         MOVE ŏIʉ@Nv TO _tNv
034330         MOVE ŏIʉ@v TO _tv
034340         MOVE ŏIʉ@v TO _tv
034350     END-EVALUATE.
034360**
034370* (ґ)
034380     EVALUATE Zvgғt敪v 
034390*    /  ŏIʉ@ /
034400     WHEN ZERO
034410         MOVE ŏIʉ@Nv TO ҈ϔCNv
034420         MOVE ŏIʉ@v TO ҈ϔCv
034430         MOVE ŏIʉ@v TO ҈ϔCv
034440*    /   /
034450     WHEN 1 
034460         PERFORM 擾
034470         MOVE 󗝔Nv     TO ҈ϔCNv
034480         MOVE 󗝌v     TO ҈ϔCv
034490         MOVE 󗝓v     TO ҈ϔCv
034500*    /  󎚂Ȃ /
034510     WHEN 9
034520         MOVE ZERO         TO ҈ϔCNv
034530         MOVE ZERO         TO ҈ϔCv
034540         MOVE ZERO         TO ҈ϔCv
034550*    /  ̑́AŏIʉ@ /
034560     WHEN OTHER
034570         MOVE ŏIʉ@Nv TO ҈ϔCNv
034580         MOVE ŏIʉ@v TO ҈ϔCv
034590         MOVE ŏIʉ@v TO ҈ϔCv
034600     END-EVALUATE.
034610*
034620*================================================================*
034630 ZEvăZbg SECTION.
043230*---------------------------------------------------------------*
043240* Evt@CΒȒOɍăZbgB
043250* iΉȂA܂蒷R͂̂܂܁j
043260*---------------------------------------------------------------*
           PERFORM Ev擾.
           MOVE AE|Ev(1)    TO RP.
           MOVE AE|Ev(2)    TO RQ.
           MOVE AE|Ev(3)    TO RR.
           MOVE AE|Ev(4)    TO RS.
           MOVE AE|Ev(5)    TO RT.
           MOVE AE|Ev(6)    TO RU.
           MOVE AE|Ev(7)    TO RV.
           MOVE AE|Ev(8)    TO RW.
034810*
040580*================================================================*
040590 Ev擾 SECTION.
040600*
040610* Ev擾 "TEKIYBUN" Ă. 
040620     MOVE  SPACE TO  AE|L[.
040630     INITIALIZE      AE|L[.
040640     MOVE {pavq  TO  AE|{pa.
040650     MOVE {pNvq    TO  AE|{pN.
040660     MOVE {pvq    TO  AE|{p.
040670     MOVE Ҕԍvq  TO  AE|Ҕԍ.
040680     MOVE }Ԃvq      TO  AE|}.
040700*     MOVE 63            TO  AE|.
039370     MOVE 56            TO  AE|.
015000     IF (R敪e NOT = 1 )
               MOVE R敪v TO AE|敪
           ELSE
               MOVE 1                  TO AE|敪
015050     END-IF.
040710*
040720     CALL   "TEKIYBUN".
040730     CANCEL "TEKIYBUN".
040740*
044960*================================================================*
044961 Ώ۔菈 SECTION.
044963*------------------------------------------------------------------------------------*
044964* }X^́u敪v 3 iRʈȏj̎ARʈȏォ肵āA
044965* ̎̂݁AB
044966*------------------------------------------------------------------------------------*
044967*
044979     MOVE  SPACE TO  AZ|L[.
044980     INITIALIZE      AZ|L[.
044981     MOVE {pavq  TO  AZ|{pa.
044982     MOVE {pNvq    TO  AZ|{pN.
044983     MOVE {pvq    TO  AZ|{p.
044984     MOVE Ҕԍvq  TO  AZ|Ҕԍ.
044985     MOVE }Ԃvq      TO  AZ|}.
044986     CALL   "RECEHUGE".
044987     CANCEL "RECEHUGE".
044989*
044990     IF AZ|ΏۃtO = "YES"
044991        PERFORM 擾
044992     END-IF.
044993*
034820*================================================================*
034821*================================================================*
034822 nL SECTION.
034823*
034824*--------------------------------------------------------*
034825*  Foߗ̌Œ (S_eoc敪v 1 gp)
034826*  ȊO̕ʂ́Auv
034827*  ̕ʂ́Auɖv
034828*--------------------------------------------------------*
034829*
034830     IF S_eoc敪v = 1
034831*      ܂uvZbg
034832        PERFORM VARYING ʂbms FROM 1 BY 1
016870                UNTIL ( ʂbms > ʐv ) OR
016880                      ( ʂbms > 5 )
034834*
034835                 EVALUATE ʂbms
034836                 WHEN 1
034837                     MOVE NC"@" TO oߕʐv
034838                 WHEN 2
034839                     MOVE NC"A" TO oߕʐv
034840                 WHEN 3
034841                     MOVE NC"B" TO oߕʐv
034842                 WHEN 4
034843                     MOVE NC"C" TO oߕʐv
034844                 WHEN 5
034845                     MOVE NC"D" TO oߕʐv
034846                 END-EVALUATE
034847                 MOVE SPACE TO oߗ(ʂbms)
034848                 STRING  oߕʐv   DELIMITED BY SPACE
034849                         NC""         DELIMITED BY SPACE
034850                        INTO oߗ(ʂbms)
034851                 END-STRING
034852        END-PERFORM
034853*
034854*      ɁARJȏ̒
034855        MOVE  SPACE TO  Aԁ|L[
034856        INITIALIZE      Aԁ|L[
034857        MOVE {pavq  TO  Aԁ|{pa
034858        MOVE {pNvq    TO  Aԁ|{pN
034859        MOVE {pvq    TO  Aԁ|{p
034860        MOVE Ҕԍvq  TO  Aԁ|Ҕԍ
034861        MOVE }Ԃvq      TO  Aԁ|}
034862        CALL   "CHOUKI"
034863        CANCEL "CHOUKI"
034864*
034865        IF Aԁ|ΏۃtO  = "YES"
034866           PERFORM VARYING ʂbms FROM 1 BY 1
016870                   UNTIL ( ʂbms > ʐv ) OR
016880                         ( ʂbms > 5 )
034868*
034869               IF Aԁ|Ԃv(ʂbms)  >  ZERO
034870
034871                   EVALUATE ʂbms
034872                   WHEN 1
034873                       MOVE NC"@" TO oߕʐv
034874                   WHEN 2
034875                       MOVE NC"A" TO oߕʐv
034876                   WHEN 3
034877                       MOVE NC"B" TO oߕʐv
034878                   WHEN 4
034879                       MOVE NC"C" TO oߕʐv
034880                   WHEN 5
034881                       MOVE NC"D" TO oߕʐv
034882                   END-EVALUATE
034883                   MOVE SPACE TO oߗ(ʂbms)
034884                   STRING  oߕʐv   DELIMITED BY SPACE
034885                           NC"ɖ"         DELIMITED BY SPACE
034886                          INTO oߗ(ʂbms)
034887                   END-STRING
034888               END-IF
034889           END-PERFORM
034890        END-IF
034891*
034892     END-IF.
034893*
034894*
034895*================================================================*
034896*================================================================*
034897 G[\ SECTION.
034898*
034899     DISPLAY NC"t@CG[F" t@C   UPON CONS.
034900     DISPLAY NC"ԃL[" ԃL[                 UPON CONS.
034901     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
034902     DISPLAY NC"P͂dmsdqL[Ă"
034903                                                   UPON CONS.
003321*-----------------------------------------*
003322     CALL "actcshm"  WITH C LINKAGE.
003323*-----------------------------------------*
034910     ACCEPT  L[ FROM CONS
034920     PERFORM t@C.
034930     EXIT PROGRAM.
034940*================================================================*
034950*================================================================*
034960 t@C SECTION.
034970*
034980     CLOSE t@C.
034990     CLOSE ی҃}X^     }X^          ̃}X^
035000           Zvge       }X^      {p}X^
035010           }X^     o߃}X^          fҏe
035020           {pL^e       f[^e        e
035030           ƃt@CS   t@C.
035040*================================================================*
035050 I SECTION.
035060*
035070     PERFORM t@C.
035080*================================================================*
035090*================================================================*
035100 eXg󎚏 SECTION.
035110*
           MOVE ALL "9" TO
           {p {pN s{ԍ JnNP JnP JnP INP IP IP
           NP P P NP P P P JnNQ JnQ
           JnQ INQ IQ IQ NQ Q Q NQ Q
           Q Q JnNR JnR JnR INR IR IR NR
           R R NR R R R JnNS JnS JnS 
           INS IS IS NS S S NS S S 
           S JnNT JnT JnT INT IT IT NT T 
           T NT T T T  k Ë Č 
           qZ É × v Z {p񋟗 ÉZ Z 
           Z 񏈒u(1) 񏈒u(2) 񏈒u(3) 񏈒u(4) 񏈒u(5) 
           񏈒uv 㪖@P 㪖@P dÒP ÒPP 
           É񐔂P ×P 㪖@񐔂P 㪖@P 㪖@񐔂P 㪖@P dÉ񐔂P 
           d×P vP P vP ÒPQ É񐔂Q ×Q 㪖@񐔂Q 
           㪖@Q 㪖@񐔂Q 㪖@Q dÉ񐔂Q d×Q vQ Q vQ
           ÒPRW É񐔂RW ×RW 㪖@񐔂RW 㪖@RW 㪖@񐔂RW 
           㪖@RW dÉ񐔂RW d×RW vRW ʍvRW RW 
           vRW JnRO JnRO ÒPRO É񐔂RO ×RO 
           㪖@񐔂RO 㪖@RO 㪖@񐔂RO 㪖@RO dÉ񐔂RO d×RO 
           vRO RO vRO JnSW JnSW ÒPSW 
           É񐔂SW ×SW 㪖@񐔂SW 㪖@SW 㪖@񐔂SW 㪖@SW 
           dÉ񐔂SW d×SW vSW ʍvSW SW vSW 
           JnSO JnSO ÒPSO É񐔂SO ×SO 㪖@񐔂SO 
           㪖@SO 㪖@񐔂SO 㪖@SO dÉ񐔂SO d×SO vSO 
           SO vSO v ꕔS S z 󗝔N 󗝌 󗝓 
           ϔCN ϔC ϔC
           .
      *
           MOVE ALL "X" TO 
           SҔԍ 󋋎Ҕԍ {phc Lԍ ZP ZQ X֔ԍP X֔ԍQ 
           X֋ `lJi `l _tԍ ԍ یҖ 
           ϔCRgP ϔCRgQ ϔCRgR {pX֔ԍP  
           {pX֔ԍQ {pZP {pZQ {pdbԍ \҃Ji ڍtԍ
           .
      *
           MOVE ALL NC"m" TO
           P Q R S T oߗ(1) 
           oߗ(2) oߗ(3) oߗ(4) oߗ(5) KpP KpQ ʂTKp 
           .
      *
           MOVE ALL "m" TO
           یҎ Ҏ \Җ ڍ@
           RP RQ RR RS RT RU
           .
      *
           MOVE NC"" TO
           ʃ`FbN U`FbN `FbN {X`FbN xX`FbN {x`FbN 
           s`FbN Ƀ`FbN _`FbN {p`FbNP {p`FbNQ 
           {p`FbNR {p`FbNS {p`FbNT {p`FbNU {p`FbNV 
           {p`FbNW {p`FbNX {p`FbNPO {p`FbNPP {p`FbNPQ 
           {p`FbNPR {p`FbNPS {p`FbNPT {p`FbNPU 
           {p`FbNPV {p`FbNPW {p`FbNPX {p`FbNQO 
           {p`FbNQP {p`FbNQQ {p`FbNQR {p`FbNQS 
           {p`FbNQT {p`FbNQU {p`FbNQV {p`FbNQW 
           {p`FbNQX {p`FbNRO {p`FbNRP [`FbN ԊO`FbN 
           x`FbN Œ藿`FbN `FbN {×`FbN ԃ`FbN \J`FbN 
           H`FbN `FbN `FbN `FbN `FbNP ~`FbNP ]`FbNP 
           `FbNQ ~`FbNQ ]`FbNQ `FbNR ~`FbNR ]`FbNR 
           `FbNS ~`FbNS ]`FbNS `FbNT ~`FbNT ]`FbNT 
           VK`FbN p`FbN j`FbN `FbN 吳`FbN `FbN a`FbN 
           `FbN Pƃ`FbN {l`FbN `FbN σ`FbN `FbN Еۃ`FbN 
           g`FbN PO`FbN X`FbN Q`FbN U΃`FbN W`FbN V`FbN 
           `FbN ސE`FbN ۃ`FbN Ƒ`FbN V`FbN
           .
036380*
036390*================================================================*
       {p擾 SECTION.
      *
      *     MOVE SPACE TO {pv.
028350     MOVE Ҕԍvq          TO {L|Ҕԍ
028360     MOVE }Ԃvq              TO {L|}
028370     MOVE {pavq          TO {L|{pa
028380     MOVE {pNvq            TO {L|{pN
028390     MOVE {pvq            TO {L|{p
028400     MOVE ZERO                  TO {L|{p
028420     START {pL^e   KEY IS >= {L|҃R[h
028430                                  {L|{paN
028440     END-START
028450     IF ԃL[ = "00"
030910         MOVE SPACE TO ItOQ
030920         PERFORM {pL^eǍ
030930         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030940                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030950                       ( {L|{pa   NOT = {pavq    ) OR
030960                       ( {L|{pN     NOT = {pNvq      ) OR
030970                       ( {L|{p     NOT = {pvq      )
                   MOVE NC"" TO {p`FbNv({L|{p)
                   PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
           MOVE {p`FbNv(1)  TO {p`FbNP.
           MOVE {p`FbNv(2)  TO {p`FbNQ.
           MOVE {p`FbNv(3)  TO {p`FbNR.
           MOVE {p`FbNv(4)  TO {p`FbNS.
           MOVE {p`FbNv(5)  TO {p`FbNT.
           MOVE {p`FbNv(6)  TO {p`FbNU.
           MOVE {p`FbNv(7)  TO {p`FbNV.
           MOVE {p`FbNv(8)  TO {p`FbNW.
           MOVE {p`FbNv(9)  TO {p`FbNX.
           MOVE {p`FbNv(10) TO {p`FbNPO.
           MOVE {p`FbNv(11) TO {p`FbNPP.
           MOVE {p`FbNv(12) TO {p`FbNPQ.
           MOVE {p`FbNv(13) TO {p`FbNPR.
           MOVE {p`FbNv(14) TO {p`FbNPS.
           MOVE {p`FbNv(15) TO {p`FbNPT.
           MOVE {p`FbNv(16) TO {p`FbNPU.
           MOVE {p`FbNv(17) TO {p`FbNPV.
           MOVE {p`FbNv(18) TO {p`FbNPW.
           MOVE {p`FbNv(19) TO {p`FbNPX.
           MOVE {p`FbNv(20) TO {p`FbNQO.
           MOVE {p`FbNv(21) TO {p`FbNQP.
           MOVE {p`FbNv(22) TO {p`FbNQQ.
           MOVE {p`FbNv(23) TO {p`FbNQR.
           MOVE {p`FbNv(24) TO {p`FbNQS.
           MOVE {p`FbNv(25) TO {p`FbNQT.
           MOVE {p`FbNv(26) TO {p`FbNQU.
           MOVE {p`FbNv(27) TO {p`FbNQV.
           MOVE {p`FbNv(28) TO {p`FbNQW.
           MOVE {p`FbNv(29) TO {p`FbNQX.
           MOVE {p`FbNv(30) TO {p`FbNRO.
           MOVE {p`FbNv(31) TO {p`FbNRP.
      *================================================================*
036400******************************************************************
036410 END PROGRAM YCH6165.
036420******************************************************************
