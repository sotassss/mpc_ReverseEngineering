000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YCH6475.
000060 AUTHOR.                 rc Kq
000070*
000080*----------------------------------------------------------------*
000090*          ㍂Zvgi_+޳ޔŁj
000100*         MED = YAW610 YCH6125P
000110*----------------------------------------------------------------*
000120 DATE-WRITTEN.           2011-09-13
000130 DATE-COMPILED.          2011-09-13
      */̓Z|ʎ]L/160816
      */qE^Â̕ύXEǉ/1805
      */׏sZKpɒǉ/2022
000140*----------------------------------------------------------------*
000150******************************************************************
000160*            ENVIRONMENT         DIVISION                        *
000170******************************************************************
000180 ENVIRONMENT             DIVISION.
000190 CONFIGURATION           SECTION.
000200 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000210 OBJECT-COMPUTER.        FMV-DESKPOWER.
000220 SPECIAL-NAMES.          CONSOLE  IS  CONS
000230                         SYSERR   IS  MSGBOX.
000240 INPUT-OUTPUT            SECTION.
000250 FILE-CONTROL.
000260     SELECT  ی҃}X^    ASSIGN      TO        HOKENSL
000270                             ORGANIZATION             IS  INDEXED
000280                             ACCESS MODE              IS  DYNAMIC
000290                             RECORD KEY               IS  ہ|ی
000300                                                          ہ|یҔԍ
000310* ́AL[ڂ̕یҖ̂ی҃Jiɂ
000320                             ALTERNATE RECORD KEY     IS  ہ|ی
000330                                                          ہ|یҖ
000340                                                          ہ|یҔԍ
000350                             FILE STATUS              IS  ԃL[
000360                             LOCK        MODE         IS  AUTOMATIC.
000370     SELECT  s}X^    ASSIGN      TO        SITYOSNL
000380                             ORGANIZATION             IS  INDEXED
000390                             ACCESS MODE              IS  DYNAMIC
000400                             RECORD KEY               IS  s|
000410                                                          s|sԍ
000420                             ALTERNATE RECORD KEY     IS  s|
000430                                                          s|s
000440                                                          s|sԍ
000450                             FILE STATUS              IS  ԃL[
000460                             LOCK        MODE         IS  AUTOMATIC.
000470     SELECT  }X^      ASSIGN      TO        GENGOUL
000480                             ORGANIZATION             IS  INDEXED
000490                             ACCESS MODE              IS  DYNAMIC
000500                             RECORD KEY               IS  |敪
000510                             FILE STATUS              IS  ԃL[
000520                             LOCK        MODE         IS  AUTOMATIC.
000530     SELECT  ̃}X^      ASSIGN      TO        MEISYOL
000540                             ORGANIZATION             IS  INDEXED
000550                             ACCESS MODE              IS  DYNAMIC
000560                             RECORD KEY               IS  |敪R[h
000570                                                          |̃R[h
000580                             FILE STATUS              IS  ԃL[
000590                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  Zvge      ASSIGN      TO        RECEPTL
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  Z|{paN
000170                                                          Z|҃R[h
000180                                                          Z|Z
000190                             ALTERNATE RECORD KEY     IS  Z|҃R[h
000200                                                          Z|{paN
000210                                                          Z|Z
000220                             ALTERNATE RECORD KEY     IS  Z|aN
000230                                                          Z|{paN
000240                                                          Z|҃R[h
000250                                                          Z|Z
000260                             ALTERNATE RECORD KEY     IS  Z|aN
000270                                                          Z|Z
000280                                                          Z|یҔԍ
000290                                                          Z|҃R[h
000300                                                          Z|{paN
000310                             ALTERNATE RECORD KEY     IS  Z|aN
000320                                                          Z|یҔԍ
000330                                                          Z|҃R[h
000340                                                          Z|Z
000350                                                          Z|{paN
000360                             FILE STATUS              IS  ԃL[
000370                             LOCK        MODE         IS  AUTOMATIC.
000660     SELECT  }X^  ASSIGN      TO        SEIGYOL
000670                             ORGANIZATION             IS  INDEXED
000680                             ACCESS MODE              IS  DYNAMIC
000690                             RECORD KEY               IS  |敪
000700                             FILE STATUS              IS  ԃL[
000710                             LOCK        MODE         IS  AUTOMATIC.
000720     SELECT  {p}X^ ASSIGN      TO        SEJOHOL
000730                             ORGANIZATION             IS  INDEXED
000740                             ACCESS MODE              IS  DYNAMIC
000750                             RECORD KEY               IS  {|{pԍ
000760                             FILE STATUS              IS  ԃL[
000770                             LOCK        MODE         IS  AUTOMATIC.
000780     SELECT  }X^    ASSIGN      TO        SEIKYUSL
000790                             ORGANIZATION             IS  INDEXED
000800                             ACCESS MODE              IS  DYNAMIC
000810                             RECORD KEY               IS  |ی
000820                                                          |یҔԍ
000830                             FILE STATUS              IS  ԃL[
000840                             LOCK    MODE             IS  AUTOMATIC.
000850     SELECT  o߃}X^      ASSIGN      TO        KEIKAL
000860                             ORGANIZATION             IS  INDEXED
000870                             ACCESS MODE              IS  DYNAMIC
000880                             RECORD KEY               IS  o|敪R[h
000890                                                          o|o߃R[h
000900                             FILE STATUS              IS  ԃL[
000910                             LOCK        MODE         IS  AUTOMATIC.
000920     SELECT  fҏe    ASSIGN      TO        JUSINJL
000930                             ORGANIZATION             IS  INDEXED
000940                             ACCESS MODE              IS  DYNAMIC
000950                             RECORD KEY               IS  |{paN
000960                                                          |҃R[h
000970                             ALTERNATE RECORD KEY     IS  |{paN
000980                                                          |҃Ji
000990                                                          |҃R[h
001000                             ALTERNATE RECORD KEY     IS  |҃R[h
001010                                                          |{paN
001020                             ALTERNATE RECORD KEY     IS  |{paN
001030                                                          |ی
001040                                                          |یҔԍ
001050                                                          |҃R[h
001060                             ALTERNATE RECORD KEY     IS  |{paN
001070                                                          |
001080                                                          |pSҔԍ
001090                                                          |҃R[h
001100                             ALTERNATE RECORD KEY     IS  |{paN
001110                                                          |
001120                                                          |pSҔԍ
001130                                                          |҃R[h
001140                             ALTERNATE RECORD KEY     IS  |aN
001150                                                          |{paN
001160                                                          |҃R[h
001170                             FILE STATUS              IS  ԃL[
001180                             LOCK        MODE         IS  AUTOMATIC.
001190     SELECT  {pL^e      ASSIGN      TO        SEKIROKL
001200                             ORGANIZATION             IS  INDEXED
001210                             ACCESS MODE              IS  DYNAMIC
001220                             RECORD KEY               IS  {L|{paN
001230                                                          {L|҃R[h
001240                             ALTERNATE RECORD KEY     IS  {L|҃R[h
001250                                                          {L|{paN
001260                             FILE STATUS              IS  ԃL[
001270                             LOCK        MODE         IS  AUTOMATIC.
001280     SELECT  f[^e    ASSIGN      TO        HUSYOUL
001290                             ORGANIZATION             IS  INDEXED
001300                             ACCESS MODE              IS  DYNAMIC
001310                             RECORD KEY               IS  |{paN
001320                                                          |҃R[h
001330                             ALTERNATE RECORD KEY     IS  |҃R[h
001340                                                          |{paN
001350                             FILE STATUS              IS  ԃL[
001360                             LOCK        MODE         IS  AUTOMATIC.
001370     SELECT  e      ASSIGN      TO        HUGEINL
001380                             ORGANIZATION             IS  INDEXED
001390                             ACCESS MODE              IS  DYNAMIC
001400                             RECORD KEY               IS  |敪R[h
001410                                                          |R[h
001420                             FILE STATUS              IS  ԃL[
001430                             LOCK        MODE         IS  AUTOMATIC.
001340     SELECT  }X^    ASSIGN      TO        KAIJOHOL
001350                             ORGANIZATION             IS  INDEXED
001360                             ACCESS MODE              IS  DYNAMIC
001370                             RECORD KEY               IS  |_I敪
                                                                |R[h
001380                                                          |ی
001390                                                          |ύXaN
001400                             ALTERNATE RECORD KEY     IS  |_I敪
                                                                |ڍtJi
001410                                                          |R[h
001420                                                          |ی
001430                                                          |ύXaN
001440                             FILE STATUS              IS  ԃL[
001450                             LOCK        MODE         IS  AUTOMATIC.
001560     SELECT  hcǗ}X^    ASSIGN      TO        IDKANRL
001570                             ORGANIZATION             IS  INDEXED
001580                             ACCESS MODE              IS  DYNAMIC
001590                             RECORD KEY               IS  hcǁ|hc敪
001600                                                          hcǁ|{pԍ
001610                                                          hcǁ|ی
001620                                                          hcǁ|یҔԍ
001630                             ALTERNATE RECORD KEY     IS  hcǁ|{phcԍ
001640                                                          hcǁ|hc敪
001650                                                          hcǁ|{pԍ
001660                                                          hcǁ|ی
001670                                                          hcǁ|یҔԍ
001680                             FILE STATUS              IS  ԃL[
001690                             LOCK        MODE         IS  AUTOMATIC.
001700     SELECT  t@C    ASSIGN      TO        MEMOL
001710                             ORGANIZATION             IS  INDEXED
001720                             ACCESS MODE              IS  DYNAMIC
001730                             RECORD KEY               IS  |敪
001740                                                          |҃R[h
001750                                                          |{paN
001760                             ALTERNATE RECORD KEY     IS  |敪
001770                                                          |{paN
001780                                                          |҃R[h
001790                             ALTERNATE RECORD KEY     IS  |҃R[h
001800                                                          |{paN
001810                                                          |敪
001820                             FILE STATUS              IS  ԃL[
001830                             LOCK        MODE         IS  AUTOMATIC.
001840* я󎚗p
001850     SELECT  ƃt@CS  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W5912L.DAT"
001860                             ORGANIZATION             IS  INDEXED
001870                             ACCESS                   IS  DYNAMIC
001880                             RECORD      KEY          IS  S|{paN
001890                                                          S|҃R[h
001900                                                          S|ی
001910                             FILE        STATUS       IS  ԃL[
001920                             LOCK        MODE         IS  AUTOMATIC.
001930*
001940     SELECT  t@C    ASSIGN      TO     GS-PRTF002
001950                             SYMBOLIC    DESTINATION  IS "PRT"
001960                             FORMAT                   IS  `̖o
001970                             GROUP                    IS  ڌQo
001980                             PROCESSING  MODE         IS  ʂo
001990                             UNIT        CONTROL      IS  go
002000                             FILE        STATUS       IS  ʒmo.
002010******************************************************************
002020*                      DATA DIVISION                             *
002030******************************************************************
002040 DATA                    DIVISION.
002050 FILE                    SECTION.
002060*                           mqk  RQOn
002070 FD  ی҃}X^        BLOCK   CONTAINS   1   RECORDS.
002080     COPY HOKENS          OF  XFDLIB  JOINING      AS  PREFIX.
002090*                           mqk  QTUn
002100 FD  s}X^          BLOCK   CONTAINS   1   RECORDS.
002110     COPY SITYOSN        OF  XFDLIB  JOINING   s   AS  PREFIX.
002120*                           mqk  PQWn
002130 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002140     COPY GENGOU          OF  XFDLIB  JOINING      AS  PREFIX.
002150*                           mqk  PQWn
002160 FD  ̃}X^          BLOCK   CONTAINS   1   RECORDS.
002170     COPY MEISYO          OF  XFDLIB  JOINING      AS  PREFIX.
      *                          mqk  PTRUn
       FD  Zvge          BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   Z  AS  PREFIX.
002210*                           mqk  QTUn
002220 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002230     COPY SEIGYO          OF  XFDLIB  JOINING      AS  PREFIX.
002240*                           mqk  PQWn
002250 FD  {p}X^          BLOCK   CONTAINS   1   RECORDS.
002260     COPY SEJOHO         OF  XFDLIB  JOINING   {   AS  PREFIX.
002270*                           mqk  PQWn
002280 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002290     COPY SEIKYUS         OF  XFDLIB  JOINING      AS  PREFIX.
002300*                           mqk  PQWn
002310 FD  o߃}X^          BLOCK   CONTAINS   1   RECORDS.
002320     COPY KEIKA          OF  XFDLIB  JOINING   o   AS  PREFIX.
002330*                           mqk  RQOn
002340 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
002350     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
002360*                           mqk  QTUn
002370 FD  {pL^e          BLOCK   CONTAINS   1   RECORDS.
002380     COPY SEKIROK         OF  XFDLIB  JOINING   {L AS  PREFIX.
002390*                           mqk  PQWn
002400 FD  f[^e        BLOCK   CONTAINS   1   RECORDS.
002410     COPY HUSYOU          OF  XFDLIB  JOINING      AS  PREFIX.
002420*                           mqk  PQWn
002430 FD  e         BLOCK   CONTAINS   1   RECORDS.
002440     COPY HUGEIN          OF  XFDLIB  JOINING      AS  PREFIX.
002450*                           mqk  USOn
002460 FD  }X^        BLOCK   CONTAINS   1   RECORDS.
002470     COPY KAIJOHO         OF  XFDLIB  JOINING      AS  PREFIX.
002480*                           mqk  PQWn
002490 FD  hcǗ}X^          BLOCK   CONTAINS   1   RECORDS.
002500     COPY IDKANR    OF  XFDLIB  JOINING   hc   AS  PREFIX.
002510*                           mqk  WRQn
002520 FD  t@C        BLOCK CONTAINS 1     RECORDS.
002530     COPY MEMO           OF    XFDLIB JOINING  AS PREFIX.
002540**
002550 FD  ƃt@CS RECORD  CONTAINS 32 CHARACTERS.
002560 01  S|R[h.
002570     03  S|R[hL[.
002580         05  S|{paN.
002590             07  S|{pa            PIC 9.
002600             07  S|{pN              PIC 9(2).
002610             07  S|{p              PIC 9(2).
002620         05  S|҃R[h.
002630             07 S|Ҕԍ             PIC 9(6).
002640             07 S|}                 PIC X(1).
002650         05  S|ی                PIC 9(2).
002660     03  S|R[hf[^.
002670         05  S|                    PIC 9(4).
002680         05  FILLER                        PIC X(14).
002690*
002700 FD  t@C.
002710     COPY YCH6125P       OF  XMDLIB.
002720*----------------------------------------------------------------*
002730******************************************************************
002740*                WORKING-STORAGE SECTION                         *
002750******************************************************************
002760 WORKING-STORAGE         SECTION.
002770 01 L[                           PIC X     VALUE SPACE.
002780 01 ԃL[                           PIC X(2)  VALUE SPACE.
002790 01 ItO                         PIC X(3)  VALUE SPACE.
002800 01 ItOQ                       PIC X(3)  VALUE SPACE.
002820 01 ItOR                       PIC X(3)  VALUE SPACE.
002810 01 tO                         PIC X(3)  VALUE SPACE.
002820 01 t@C                         PIC N(6)  VALUE SPACE.
002830 01 Zvgofv                     PIC X(8)  VALUE SPACE.
002840 01 Oav                           PIC 9     VALUE ZERO.
002850 01 Jgv                     PIC 9(1)  VALUE ZERO.
002860 01 ʂbms                         PIC 9     VALUE ZERO.
002870 01 Ҕԍv                         PIC 9(6)  VALUE ZERO.
002880 01 ̂v                         PIC N(6)  VALUE SPACE.
002890 01 ʖ̂v                         PIC N(12) VALUE SPACE.
002900 01 ʒv                           PIC 9(2) VALUE 1.
001363 01 Sp                           PIC X(2)  VALUE X"8140".
001364 01 p                           PIC X(2)  VALUE X"2020".
002870 01 pʂv                         PIC 9(1)  VALUE ZERO.
002910** {ϊ
002920 01 v                             PIC 9(2).
002930 01 q REDEFINES v.
002940    03 vP                        PIC X(1).
002950    03 vQ                        PIC X(1).
002960*
002970 01 ԍv                         PIC 9.
002980 01 ԍq REDEFINES ԍv.
002990    03 ԍvP                    PIC X.
003000*
003010 01 Spԍv                     PIC N.
003020 01 Spԍq REDEFINES Spԍv.
003030    03 SpԍvP                PIC X(2).
003040*
003050 01 JE^                           PIC 9(2)  VALUE ZERO.
003060 01 JE^Q                         PIC 9(2)  VALUE ZERO.
003070*
003080* ޔp
003090 01 INvs.
003100    03 INvs                      PIC 9(2)  VALUE ZERO.
003110    03 Ivs                      PIC 9(2)  VALUE ZERO.
003120    03 Ivs                      PIC 9(2)  VALUE ZERO.
003130* ޔp
003140 01 Nvs.
003150    03 avs                    PIC 9     VALUE ZERO.
003160    03 Nvs                      PIC 9(2)  VALUE ZERO.
003170    03 vs                      PIC 9(2)  VALUE ZERO.
003180    03 vs                      PIC 9(2)  VALUE ZERO.
003190* Zp
003200 01 Zvs.
003210    03 ZJEg                PIC 9    VALUE ZERO.
003220    03 ԍJE^                    PIC 9    VALUE ZERO.
003230    03 ZWcvs  OCCURS 3.
003240       05 Z敪vs             PIC 9    VALUE ZERO.
003250       05 Zvs               PIC 9(2) VALUE ZERO.
003260       05 Zvs               PIC 9(2) VALUE ZERO.
003270    03 ZWcmv  OCCURS 3.
003280       05 Z؂v                   PIC N(1) VALUE SPACE.
003290       05 Zev                   PIC N(3) VALUE SPACE.
003300       05 ZmvP             PIC N(1) VALUE SPACE.
003310       05 ZmvQ             PIC N(1) VALUE SPACE.
003320       05 Œv                     PIC N(1) VALUE SPACE.
003330       05 ZmvP             PIC N(1) VALUE SPACE.
003340       05 ZmvQ             PIC N(1) VALUE SPACE.
003350       05 Œv                     PIC N(1) VALUE SPACE.
003360    03 ZPv                PIC N(10) VALUE SPACE.
003370    03 ZQv                PIC N(10) VALUE SPACE.
003380    03 ZRv                PIC N(10) VALUE SPACE.
003070    03 Z؂v                  PIC X     VALUE SPACE.
003080    03 Zv                    PIC 9(2)  VALUE ZERO.
003090    03 Zv                    PIC 9(2)  VALUE ZERO.
003390* p
003400 01 vs.
003410    03 Pvs                  PIC X(60) VALUE SPACE.
003420    03 Qvs                  PIC X(60) VALUE SPACE.
003430    03 Rvs                  PIC X(60) VALUE SPACE.
003440    03 Svs                  PIC X(60) VALUE SPACE.
003450    03 Tvs                  PIC X(60) VALUE SPACE.
003460    03 io[vs.
003470       05 io[vP         PIC X(2)  OCCURS 9 VALUE SPACE.
003480    03 io[mv  REDEFINES io[vs PIC X(18).
003490 01 Ҕԍbv                   PIC 9(6)  VALUE ZERO.
003500 01 AԂbv                       PIC 9(4)  VALUE ZERO.
003510 01 sak.
003520    03 R[hsak            OCCURS 9.
003530       05 Ҕԍv               PIC 9(6)  VALUE ZERO.
003540       05 AԂv                   PIC 9(4)  VALUE ZERO.
003550       05 ʂv               PIC 9  OCCURS 9 VALUE ZERO.
003560 01 ev.
003570    03 ev              PIC X(318) OCCURS 9 VALUE SPACE.
003580    03 ewv.
003590       05 ePwv           PIC X(80)  VALUE SPACE.
003600       05 eQwv           PIC X(80)  VALUE SPACE.
003610       05 eRwv           PIC X(80)  VALUE SPACE.
003700       05 eSwv           PIC X(78)  VALUE SPACE.
003620*
003630* U p(Tj
003640 01 v                           PIC N(5)   VALUE SPACE.
003650*
003660** Ôݗp
003670 01 ČtO                     PIC X(3)  VALUE SPACE.
003680 01 OtO                         PIC X(3)  VALUE SPACE.
003690*
003700 01 vZNv.
003710    03 vZav                      PIC 9(1)  VALUE ZERO.
003720    03 vZNv                        PIC S9(2)  VALUE ZERO.
003730    03 vZv                        PIC S9(2)  VALUE ZERO.
003740    03 vZv                        PIC S9(2)  VALUE ZERO.
003750 01 JnNQv.
003760    03 JnaQv                    PIC 9(1)  VALUE ZERO.
003770    03 JnNQv                      PIC 9(2)  VALUE ZERO.
003780    03 JnQv                      PIC 9(2)  VALUE ZERO.
003790    03 JnQv                      PIC 9(2)  VALUE ZERO.
003800    03 JnNv                    PIC S9(4) VALUE ZERO.
003810 01 INQv.
003820    03 IaQv                    PIC 9(1)  VALUE ZERO.
003830    03 INQv                      PIC 9(2)  VALUE ZERO.
003840    03 IQv                      PIC 9(2)  VALUE ZERO.
003850    03 IQv                      PIC 9(2)  VALUE ZERO.
003860    03 INv                    PIC S9(4) VALUE ZERO.
003870***
003880** ER敪p
003890 01 敪v                 PIC 9 VALUE ZERO.
003900 01 R敪v                 PIC 9 VALUE ZERO.
003910*
003920** Zi̓t敪p (0:ŏIʉ@A1:A9:󎚂Ȃ)
003930 01 Zvgt敪v                 PIC 9 VALUE ZERO.
003940 01 Zvgғt敪v             PIC 9 VALUE ZERO.
003950*
003960** p
003970 01 {pNv                       PIC 9(4)  VALUE ZERO.
003980 01 v                               PIC 9(3)  VALUE ZERO.
003990 01 ]v                               PIC 9(3)  VALUE ZERO.
004000*
004010** }Ԕp
004020 01 JnfÓ蓮敪v               PIC 9    VALUE ZERO.
004030*
004040*
004050** Z܂Ƃߗp
004060 01 Z܂Ƃ߃tO               PIC X(3)  VALUE SPACE.
004070 01 ʗ̂v                     PIC N(4)  VALUE SPACE.
004080 01 ʗ̂vQ                   PIC N(4)  VALUE SPACE.
004090*
004100*
004110** ZEvp( N(38)Œj /
004120 01 ̌o߂v.
004130    03 ̌oߍsv                  PIC X(76) OCCURS 2 VALUE SPACE.
004140 01 ̌o߂mv REDEFINES ̌o߂v.
004150    03 ̌oߍsmv                PIC N(38) OCCURS 2.
004160*
003460 01 R敪e                 PIC 9 VALUE ZERO.
004170*
004180* 敪
004190 01 Z敪v             PIC 9    VALUE ZERO.
      *
004490* 쌧p
004500 01 󋋎ҔԍҏWv.
004510    03 󋋎ҔԍҏWvP              PIC X(3)  VALUE SPACE.
004520    03 󋋎ҋ؂P                    PIC X     VALUE SPACE.
004530    03 󋋎ҔԍҏWvQ              PIC X(2)  VALUE SPACE.
004540    03 󋋎ҋ؂Q                    PIC X     VALUE SPACE.
004550    03 󋋎ҔԍҏWvR              PIC X(10) VALUE SPACE.
      *
      */qE^Â̕ύXEǉ/1805
       01 qblP                     PIC X(130) VALUE SPACE.
       01 qblQ                     PIC X(170) VALUE SPACE.
       01 ^Âbl                       PIC X(68)  VALUE SPACE.
004200*
004770******************************
004780* T  Ev  ҏWp *
004790******************************
004800 01 ʂTv.
004840   03 JnTv.
004850      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
004870      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
         03 ʂPv                         PIC X(1).
004890   03 ÂTv.
            05 ʂQv                      PIC X(1).
004900      05 ÒPTv                  PIC ZZZZ.
            05 ZLPv                  PIC X(1).
004920      05 É񐔂Tv                  PIC ZZ.
            05 CR[Pv                  PIC X(1).
004940      05 ×Tv                    PIC ZZ,ZZZ.
         03 ʂRv                         PIC X(1).
         03 ZLPv                     PIC X(1).
         03 ʂSv                         PIC X(1).
004960   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLQv                  PIC X(1).
004970      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Qv                  PIC X(1).
004990      05 㪖@Tv                  PIC ZZZZ.
         03 ʂTv                         PIC X(1).
         03 ZLQv                     PIC X(1).
         03 ʂUv                         PIC X(1).
005010   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLRv                  PIC X(1).
005020      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Rv                  PIC X(1).
005040      05 㪖@Tv                  PIC ZZZZ.
         03 ʂVv                         PIC X(1).
         03 ZLRv                     PIC X(1).
         03 ʂWv                         PIC X(1).
005060   03 dÂTv.
            05 dÒPTv                  PIC Z(2).
            05 ZLSv                  PIC X(1).
005070      05 dÉ񐔂Tv                  PIC ZZ.
            05 CR[Sv                  PIC X(1).
005090      05 d×Tv                    PIC ZZZZ.
            05 ʂXv                      PIC X(1).
         03 ʂPOv                       PIC X(1).
         03 ZLTv                     PIC X(1).
005130   03 ʗTv                     PIC X(3).
         03 ZLUv                     PIC X(1).
005170   03 Tv                   PIC 9.9.
         03 CR[Tv                     PIC X(1).
005190   03 vTv                   PIC ZZ,ZZZ.
      *
004210****************
004220* AڑҔ *
004230****************
004240*    ************
004250*    * L[ *
004260*    ************
004270 01 Ώۃf[^vq.
004280    03 {paNvq.
004290       05 {pavq                  PIC 9(1)  VALUE ZERO.
004300       05 {pNvq                    PIC 9(2)  VALUE ZERO.
004310       05 {pvq                    PIC 9(2)  VALUE ZERO.
004320    03 یʂvq                     PIC 9(2)  VALUE ZERO.
004330    03 یҔԍvq                   PIC X(10) VALUE SPACE.
004340    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004350    03 pSҔԍvq               PIC X(10) VALUE SPACE.
004360    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004370    03 pSҔԍvq           PIC X(10) VALUE SPACE.
004380    03 {lƑ敪vq                 PIC 9(1)  VALUE ZERO.
004390    03 ҃Jivq                     PIC X(20) VALUE SPACE.
004400    03 ҃R[hvq.
004410       05 Ҕԍvq                  PIC 9(6)  VALUE ZERO.
004420       05 }Ԃvq                      PIC X(1)  VALUE SPACE.
004430*    ************
004440*    *  *
004450*    ************
004460*    ̗
004470***********************
004480 01 Pvq.
004490   03 vq.
004500      05 Svq               PIC 9(3)    VALUE ZERO.
004510      05 vq                 PIC 9(5)    VALUE ZERO.
004520      05 Zvq             PIC 9(5)    VALUE ZERO.
         03 kvq              PIC 9(4)    VALUE ZERO.
004530   03 Čvq                    PIC 9(5)    VALUE ZERO.
004540   03 Âvq.
004550      05 Ëvq               PIC 9(2)V9  VALUE ZERO.
004560      05 É񐔂vq               PIC 9(2)    VALUE ZERO.
004570      05 ×vq                 PIC 9(6)    VALUE ZERO.
004580      05 ÉZvq             PIC 9(5)    VALUE ZERO.
004590   03 qZvq            PIC 9(5)    VALUE ZERO.
004600   03 {p񋟗vq            PIC 9(5)    VALUE ZERO.
004610   03 vvq                      PIC 9(6)    VALUE ZERO.
004620   03 ꕔSvq                PIC 9(6)    VALUE ZERO.
004630   03 zvq                  PIC 9(6)    VALUE ZERO.
004640   03 tvq                  PIC 9(1)    VALUE ZERO.
004650   03 󋋎ҕSzvq              PIC 9(6)    VALUE ZERO.
004660   03 zvq              PIC 9(6)    VALUE ZERO.
004670*
004680* ʖ̗
004690***********************
004700 01 Qvq.
004710   03 񏈒uvq    OCCURS   9.
004720      05 񏈒uvq             PIC 9(5)    VALUE ZERO.
004730*
004740* ̗
004750***********************
004760 01 Rvq.
004770**********
004780* P *
004790**********
004800   03 ʂPvq.
004810      05 ÂPvq.
004820         07 ÒPPvq              PIC 9(4)    VALUE ZERO.
004830         07 É񐔂Pvq              PIC 9(2)    VALUE ZERO.
004840         07 ×Pvq                PIC 9(5)    VALUE ZERO.
004850      05 㪖@Pvq.
004860         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004870         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
004880      05 㪖@Pvq.
004890         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004900         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
004910      05 dÂPvq.
004920         07 dÉ񐔂Pvq              PIC 9(2)    VALUE ZERO.
004930         07 d×Pvq                PIC 9(4)    VALUE ZERO.
004940      05 vPvq                     PIC 9(6)    VALUE ZERO.
004950      05 Pvq               PIC 9(3)    VALUE ZERO.
004960      05 vPvq               PIC 9(6)    VALUE ZERO.
004970**********
004980* Q *
004990**********
005000   03 ʂQvq.
005010      05 ÂQvq.
005020         07 ÒPQvq              PIC 9(4)    VALUE ZERO.
005030         07 É񐔂Qvq              PIC 9(2)    VALUE ZERO.
005040         07 ×Qvq                PIC 9(5)    VALUE ZERO.
005050      05 㪖@Qvq.
005060         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
005070         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
005080      05 㪖@Qvq.
005090         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
005100         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
005110      05 dÂQvq.
005120         07 dÉ񐔂Qvq              PIC 9(2)    VALUE ZERO.
005130         07 d×Qvq                PIC 9(4)    VALUE ZERO.
005140      05 vQvq                     PIC 9(6)    VALUE ZERO.
005150      05 Qvq               PIC 9(3)    VALUE ZERO.
005160      05 vQvq               PIC 9(6)    VALUE ZERO.
005170******************
005180* Rʁ^W *
005190******************
005200   03 ʂRWvq.
005210      05 ÂRWvq.
005220         07 ÒPRWvq              PIC 9(4)  VALUE ZERO.
005230         07 É񐔂RWvq              PIC 9(2)  VALUE ZERO.
005240         07 ×RWvq                PIC 9(5)  VALUE ZERO.
005250      05 㪖@RWvq.
005260         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005270         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005280      05 㪖@RWvq.
005290         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005300         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005310      05 dÂRWvq.
005320         07 dÉ񐔂RWvq              PIC 9(2)  VALUE ZERO.
005330         07 d×RWvq                PIC 9(4)  VALUE ZERO.
005340      05 vRWvq                     PIC 9(6)  VALUE ZERO.
005350      05 ʍvRWvq             PIC 9(6)  VALUE ZERO.
005360      05 RWvq               PIC 9(3)  VALUE ZERO.
005370      05 vRWvq               PIC 9(6)  VALUE ZERO.
005380******************
005390* Rʁ^PO *
005400******************
005410   03 ʂROvq.
005420      05 JnROvq.
005430         07 JnROvq            PIC 9(2)  VALUE ZERO.
005440         07 JnROvq            PIC 9(2)  VALUE ZERO.
005450      05 ÂROvq.
005460         07 ÒPROvq              PIC 9(4)  VALUE ZERO.
005470         07 É񐔂ROvq              PIC 9(2)  VALUE ZERO.
005480         07 ×ROvq                PIC 9(5)  VALUE ZERO.
005490      05 㪖@ROvq.
005500         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
005510         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005520      05 㪖@ROvq.
005530         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
005540         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005550      05 dÂROvq.
005560         07 dÉ񐔂ROvq              PIC 9(2)  VALUE ZERO.
005570         07 d×ROvq                PIC 9(4)  VALUE ZERO.
005580      05 vROvq                     PIC 9(6)  VALUE ZERO.
005590      05 ROvq               PIC 9(3)  VALUE ZERO.
005600      05 vROvq               PIC 9(6)  VALUE ZERO.
005610****************
005620* Sʁ^T *
005630****************
005640   03 ʂSTvq.
005650      05 ÂSTvq.
005660         07 ÒPSTvq              PIC 9(4)  VALUE ZERO.
005670         07 É񐔂STvq              PIC 9(2)  VALUE ZERO.
005680         07 ×STvq                PIC 9(5)  VALUE ZERO.
005690      05 㪖@STvq.
005700         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005710         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005720      05 㪖@STvq.
005730         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005740         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005750      05 dÂSTvq.
005760         07 dÉ񐔂STvq              PIC 9(2)  VALUE ZERO.
005770         07 d×STvq                PIC 9(4)  VALUE ZERO.
005780      05 vSTvq                     PIC 9(6)  VALUE ZERO.
005790      05 ʍvSTvq             PIC 9(6)  VALUE ZERO.
005800      05 STvq               PIC 9(3)  VALUE ZERO.
005810      05 vSTvq               PIC 9(6)  VALUE ZERO.
005820****************
005830* Sʁ^W *
005840****************
005850   03 ʂSWvq.
005860      05 JnSWvq.
005870         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005880         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005890      05 ÂSWvq.
005900         07 ÒPSWvq              PIC 9(4)  VALUE ZERO.
005910         07 É񐔂SWvq              PIC 9(2)  VALUE ZERO.
005920         07 ×SWvq                PIC 9(5)  VALUE ZERO.
005930      05 㪖@SWvq.
005940         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
005950         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
005960      05 㪖@SWvq.
005970         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
005980         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
005990      05 dÂSWvq.
006000         07 dÉ񐔂SWvq              PIC 9(2)  VALUE ZERO.
006010         07 d×SWvq                PIC 9(4)  VALUE ZERO.
006020      05 vSWvq                     PIC 9(6)  VALUE ZERO.
006030      05 ʍvSWvq             PIC 9(6)  VALUE ZERO.
006040      05 SWvq               PIC 9(3)  VALUE ZERO.
006050      05 vSWvq               PIC 9(6)  VALUE ZERO.
006060******************
006070* Sʁ^PO *
006080******************
006090   03 ʂSOvq.
006100      05 JnSOvq.
006110         07 JnSOvq            PIC 9(2)  VALUE ZERO.
006120         07 JnSOvq            PIC 9(2)  VALUE ZERO.
006130      05 ÂSOvq.
006140         07 ÒPSOvq              PIC 9(4)  VALUE ZERO.
006150         07 É񐔂SOvq              PIC 9(2)  VALUE ZERO.
006160         07 ×SOvq                PIC 9(5)  VALUE ZERO.
006170      05 㪖@SOvq.
006180         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006190         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006200      05 㪖@SOvq.
006210         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006220         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006230      05 dÂSOvq.
006240         07 dÉ񐔂SOvq              PIC 9(2)  VALUE ZERO.
006250         07 d×SOvq                PIC 9(4)  VALUE ZERO.
006260      05 vSOvq                     PIC 9(6)  VALUE ZERO.
006270      05 SOvq               PIC 9(3)  VALUE ZERO.
006280      05 vSOvq               PIC 9(6)  VALUE ZERO.
006290********************
006300* Tʁ^QDT *
006310********************
006320   03 ʂTQvq.
006330      05 ÂTQvq.
006340         07 ÒPTQvq              PIC 9(4)  VALUE ZERO.
006350         07 É񐔂TQvq              PIC 9(2)  VALUE ZERO.
006360         07 ×TQvq                PIC 9(5)  VALUE ZERO.
006370      05 㪖@TQvq.
006380         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006390         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006400      05 㪖@TQvq.
006410         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006420         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006430      05 dÂTQvq.
006440         07 dÉ񐔂TQvq              PIC 9(2)  VALUE ZERO.
006450         07 d×TQvq                PIC 9(4)  VALUE ZERO.
006460      05 vTQvq                     PIC 9(6)  VALUE ZERO.
006470      05 ʍvTQvq             PIC 9(6)  VALUE ZERO.
006480      05 TQvq               PIC 9(3)  VALUE ZERO.
006490      05 vTQvq               PIC 9(6)  VALUE ZERO.
006500****************
006510* Tʁ^T *
006520****************
006530   03 ʂTTvq.
006540      05 JnTTvq.
006550         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006560         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006570      05 ÂTTvq.
006580         07 ÒPTTvq              PIC 9(4)  VALUE ZERO.
006590         07 É񐔂TTvq              PIC 9(2)  VALUE ZERO.
006600         07 ×TTvq                PIC 9(5)  VALUE ZERO.
006610      05 㪖@TTvq.
006620         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006630         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006640      05 㪖@TTvq.
006650         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006660         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006670      05 dÂTTvq.
006680         07 dÉ񐔂TTvq              PIC 9(2)  VALUE ZERO.
006690         07 d×TTvq                PIC 9(4)  VALUE ZERO.
006700      05 vTTvq                     PIC 9(6)  VALUE ZERO.
006710      05 ʍvTTvq             PIC 9(6)  VALUE ZERO.
006720      05 TTvq               PIC 9(3)  VALUE ZERO.
006730      05 vTTvq               PIC 9(6)  VALUE ZERO.
006740****************
006750* Tʁ^W *
006760****************
006770   03 ʂTWvq.
006780      05 JnTWvq.
006790         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006800         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006810      05 ÂTWvq.
006820         07 ÒPTWvq              PIC 9(4)  VALUE ZERO.
006830         07 É񐔂TWvq              PIC 9(2)  VALUE ZERO.
006840         07 ×TWvq                PIC 9(5)  VALUE ZERO.
006850      05 㪖@TWvq.
006860         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006870         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
006880      05 㪖@TWvq.
006890         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006900         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
006910      05 dÂTWvq.
006920         07 dÉ񐔂TWvq              PIC 9(2)  VALUE ZERO.
006930         07 d×TWvq                PIC 9(4)  VALUE ZERO.
006940      05 vTWvq                     PIC 9(6)  VALUE ZERO.
006950      05 ʍvTWvq             PIC 9(6)  VALUE ZERO.
006960      05 TWvq               PIC 9(3)  VALUE ZERO.
006970      05 vTWvq               PIC 9(6)  VALUE ZERO.
006980******************
006990* Tʁ^PO *
007000******************
007010   03 ʂTOvq.
007020      05 JnTOvq.
007030         07 JnTOvq            PIC 9(2)  VALUE ZERO.
007040         07 JnTOvq            PIC 9(2)  VALUE ZERO.
007050      05 ÂTOvq.
007060         07 ÒPTOvq              PIC 9(4)  VALUE ZERO.
007070         07 É񐔂TOvq              PIC 9(2)  VALUE ZERO.
007080         07 ×TOvq                PIC 9(5)  VALUE ZERO.
007090      05 㪖@TOvq.
007100         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
007110         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
007120      05 㪖@TOvq.
007130         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
007140         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
007150      05 dÂTOvq.
007160         07 dÉ񐔂TOvq              PIC 9(2)  VALUE ZERO.
007170         07 d×TOvq                PIC 9(4)  VALUE ZERO.
007180      05 vTOvq                     PIC 9(6)  VALUE ZERO.
007190      05 TOvq               PIC 9(3)  VALUE ZERO.
007200      05 vTOvq               PIC 9(6)  VALUE ZERO.
008000*******************
008010*  ׏sZ */202206
008020*******************
008030   03 ׏sZvq                PIC ZZZ   VALUE ZERO.
008030   03 ׏sZvq                PIC ZZ    VALUE ZERO.
007210*
007220**************
007230* {p *
007240**************
007250 01 {pv.
007260    03 _tԍv                    PIC X(16)  VALUE SPACE.
007270    03 ڍtԍv              PIC X(16)  VALUE SPACE.
007280    03 \҃Jiv                    PIC X(50)  VALUE SPACE.
007290    03 \Җv                      PIC X(50)  VALUE SPACE.
007300    03 ڍ@v                      PIC X(50)  VALUE SPACE.
          03 s{ihrv                PIC X(2)   VALUE SPACE.
007310    03 {pZv.
007320       05 {pZPv               PIC X(50)  VALUE SPACE.
007330       05 {pZQv               PIC X(50)  VALUE SPACE.
007340    03 {pX֔ԍv.
007350       05 {pX֔ԍPv           PIC X(3)   VALUE SPACE.
007360       05 {pX֔ԍQv           PIC X(4)   VALUE SPACE.
007370    03 {pdbԍv                PIC X(20)  VALUE SPACE.
007380    03 z󗝔ԍv                PIC X(15)  VALUE SPACE.
007390    03 󗝔Nv.
007400       05 󗝔Nv                     PIC 9(2)   VALUE ZERO.
007410       05 󗝌v                     PIC 9(2)   VALUE ZERO.
007420       05 󗝓v                     PIC 9(2)   VALUE ZERO.
007430    03 ŏIʉ@Nv.
007440       05 ŏIʉ@Nv                 PIC 9(2)   VALUE ZERO.
007450       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
007460       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
007470    03 _tNv.
007480       05 _tNv                   PIC 9(2)   VALUE ZERO.
007490       05 _tv                   PIC 9(2)   VALUE ZERO.
007500       05 _tv                   PIC 9(2)   VALUE ZERO.
007510    03 ҈ϔCNv.
007520       05 ҈ϔCNv                 PIC 9(2)   VALUE ZERO.
007530       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007540       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007550    03 v.
007560        05 sv              PIC X(40)  VALUE SPACE.
007570        05 sxXv          PIC X(40)  VALUE SPACE.
007580        05 aʂv                  PIC 9(1)   VALUE ZERO.
007590        05 ԍv                  PIC X(10)  VALUE SPACE.
007600        05 `lv                PIC X(40)  VALUE SPACE.
007610        05 `lJiv            PIC X(40)  VALUE SPACE.
007620        05 `lƃJiv          PIC X(60)  VALUE SPACE.
007630        05 sxXv              PIC X(60)  VALUE SPACE.
007640        05 aʃRgv          PIC N(3)   VALUE SPACE.
007650        05 aʃRgwv        PIC X(4)   VALUE SPACE.
          03 x@.
             05 Z@֖v.
                07 Z@֖Pv            PIC X(12)  VALUE SPACE.
                07 Z@֖Qv            PIC X(12)  VALUE SPACE.
      *          07 Z@֖Rv            PIC X(8)  VALUE SPACE.
      *          07 Z@֖Sv            PIC X(8)  VALUE SPACE.
      *          07 Z@֖Tv            PIC X(8)  VALUE SPACE.
             05 xXv.
                07 xXPv                PIC X(12) VALUE SPACE.
                07 xXQv                PIC X(12) VALUE SPACE.
      *          07 xXRv                PIC X(12) VALUE SPACE.
      *          07 xXSv                PIC X(12) VALUE SPACE.
             05 U`FbNv               PIC N(1)  VALUE SPACE.
             05 ʃ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
             05 s`FbNv               PIC N(1)  VALUE SPACE.
             05 Ƀ`FbNv               PIC N(1)  VALUE SPACE.
             05 _`FbNv               PIC N(1)  VALUE SPACE.
             05 {X`FbNv               PIC N(1)  VALUE SPACE.
             05 xX`FbNv               PIC N(1)  VALUE SPACE.
             05 {x`FbNv             PIC N(1)  VALUE SPACE.
007660*    03 Rgv.
007670*        05 RgPv                PIC X(40)  VALUE SPACE.
007680*        05 RgQv                PIC X(40)  VALUE SPACE.
007690*        05 RgRv                PIC X(40)  VALUE SPACE.
007700*        05 RgSv                PIC X(40)  VALUE SPACE.
007710*        05 RgTv                PIC N(20)  VALUE SPACE.
007750    03 Rgv.
007760        05 RgPv                PIC X(36)  VALUE SPACE.
007770        05 RgQv                PIC X(36)  VALUE SPACE.
007780        05 RgRv                PIC X(36)  VALUE SPACE.
007790        05 RgSv                PIC X(36)  VALUE SPACE.
007720    03 {phcv                    PIC X(15)  VALUE SPACE.
007730    03 s{phcv                PIC X(15)  VALUE SPACE.
007740**************
007750* fҏ *
007760**************
007770 01 fҏv.
      */C/20190408
          03 {pav                      PIC 9(1)   VALUE ZERO.
007780    03 {pNv.
007790       05 {pNv                     PIC 9(2)   VALUE ZERO.
007800       05 {pv                     PIC 9(2)   VALUE ZERO.
007810*    03 Lv                          PIC N(12)  VALUE SPACE.
007570    03 Lv.
007580       05 Lv                   PIC N(12)  VALUE SPACE.
          03 Lԍv.
             05 Lԍwv                 PIC X(40) VALUE SPACE.
007820    03 ԍv.
007830       05 ԍv                   PIC X(15)  VALUE SPACE.
007840       05 FILLER                       PIC X(15)  VALUE SPACE.
007850    03 یҔԍv.
007860       05 یҔԍv             PIC X(8)   VALUE SPACE.
007870       05 FILLER                       PIC X(2)   VALUE SPACE.
007880    03 sԍv.
007890       05 FILLER                       PIC X(2)   VALUE SPACE.
007900       05 sԍUv           PIC X(6)   VALUE SPACE.
007910       05 FILLER                       PIC X(2)   VALUE SPACE.
007920    03 󋋎Ҕԍv.
007930       05 󋋎Ҕԍv             PIC X(7)   VALUE SPACE.
007940       05 FILLER                       PIC X(13).
007950    03 sԍv                PIC X(8)   VALUE SPACE.
          03 󋋎Ҕԍv                PIC X(15) VALUE SPACE.
007960    03 於̂v.
007970       05 於̂v             PIC X(38)  VALUE SPACE.
007980       05 FILLER                       PIC X(38)  VALUE SPACE.
007990    03 یʂv                      PIC 9(2)   VALUE ZERO.
008000    03 یҏv.
008010       05 ی҃Jiv               PIC X(50)  VALUE SPACE.
008020       05 یҎv               PIC X(50)  VALUE SPACE.
008030       05 X֔ԍv.
008040          07 X֔ԍPv              PIC X(3)   VALUE SPACE.
008050          07 X֔ԍQv              PIC X(4)   VALUE SPACE.
008060       05 یҏZv               PIC X(80)  VALUE SPACE.
008070       05 یҏZPv             PIC X(50)  VALUE SPACE.
008080       05 یҏZQv             PIC X(50)  VALUE SPACE.
008990       05 dbԍv                   PIC X(35)  VALUE SPACE.
008090    03 ҏv.
008100       05 ҏZv                   PIC X(80)  VALUE SPACE.
008110       05 ҏZPv                 PIC X(50)  VALUE SPACE.
008120       05 ҏZQv                 PIC X(50)  VALUE SPACE.
008130       05 ҃Jiv                   PIC X(50)  VALUE SPACE.
008140       05 Ҏv                   PIC X(50)  VALUE SPACE.
008150       05 ʃ`FbNv.
008160          07 j`FbNv              PIC N(1)  VALUE SPACE.
008170          07 `FbNv              PIC N(1)  VALUE SPACE.
008180       05 Ґʂv.
008190          07 ʂv                    PIC N(1)  VALUE SPACE.
008200       05 a`FbNv.
008210          07 `FbNv            PIC N(1)  VALUE SPACE.
008220          07 吳`FbNv            PIC N(1)  VALUE SPACE.
008230          07 a`FbNv            PIC N(1)  VALUE SPACE.
008240          07 `FbNv            PIC N(1)  VALUE SPACE.
008250          07 v                    PIC N(2)  VALUE SPACE.
      */C/20190408
008210          07 ߘa`FbNv            PIC N(1)  VALUE SPACE.
                07 ߘablv                PIC X(4)  VALUE SPACE.
009110*          07 v                    PIC N(2)  VALUE SPACE.
      */C/20190408
008260       05 ҔNv                     PIC 9(2)  VALUE ZERO.
008270       05 Ҍv                     PIC 9(2)  VALUE ZERO.
008280       05 ғv                     PIC 9(2)  VALUE ZERO.
008290       05 v.
008300          07 v                PIC N(4)  VALUE SPACE.
008310          07 FILLER                    PIC X(4)  VALUE SPACE.
008320       05 Pv                 PIC N(37) VALUE SPACE.
008330       05 Qv                 PIC N(37) VALUE SPACE.
008340       05 Rv                 PIC N(37) VALUE SPACE.
008350       05 Sv                 PIC N(37) VALUE SPACE.
008360       05 Tv                 PIC N(37) VALUE SPACE.
008370*
008370*       05 v                   PIC N(40) OCCURS 29 VALUE SPACE.
      */pΉ/110421
             05 v OCCURS 29.
                07 wv              PIC X(80)  VALUE SPACE.
008390*
008400*       05 ۋ敪`FbNv.
008410*          07 ۃ`FbNv            PIC N(1)  VALUE SPACE.
008420*          07 ۑg`FbNv        PIC N(1)  VALUE SPACE.
008430    03 v                        PIC N(1)  VALUE SPACE.
008440    03 ʃRgv                  PIC X(16) VALUE SPACE.
007390    03 یʃ`FbNv.
007400       05 Еۃ`FbNv               PIC N(1)  VALUE SPACE.
007410       05 D`FbNv               PIC N(1)  VALUE SPACE.
007420       05 g`FbNv               PIC N(1)  VALUE SPACE.
007430       05 ۃ`FbNv               PIC N(1)  VALUE SPACE.
             05 σ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv                 PIC N(1)  VALUE SPACE.
             05 ސE`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
          03 {l`FbNv                  PIC N(1)  VALUE SPACE.
          03 Ƒ`FbNv                  PIC N(1)  VALUE SPACE.
          03 Pƃ`FbNv                  PIC N(1)  VALUE SPACE.
          03 Q`FbNv                  PIC N(1)  VALUE SPACE.
          03 `FbNv                  PIC N(1)  VALUE SPACE.
          03 V`FbNv                  PIC N(1)  VALUE SPACE.
          03 U΃`FbNv                  PIC N(1)  VALUE SPACE.
          03 t`FbNv.
             05 V`FbNv               PIC N(1)  VALUE SPACE.
             05 W`FbNv               PIC N(1)  VALUE SPACE.
             05 X`FbNv               PIC N(1)  VALUE SPACE.
             05 PO`FbNv             PIC N(1)  VALUE SPACE.
008450*
008460****************
008470* f[^e *
008480****************
008490 01 v.
008500    03 ʐv                        PIC 9(1)  VALUE ZERO.
008510    03 ʏv  OCCURS   9.
008520       05 ʂbmsv                 PIC 9(1)  VALUE ZERO.
008530       05 ʃR[hv.
008540          07 ʂv                PIC 9(2)  VALUE ZERO.
008550          07 ʂv                    PIC 9(2)  VALUE ZERO.
008560          07 E敪v                PIC 9(1)  VALUE ZERO.
008570          07 ʒuԍv            PIC 9(2)  VALUE ZERO.
008580       05 v                     PIC N(18) VALUE SPACE.
008590       05 Nv.
008600          07 Nv                  PIC 9(2)  VALUE ZERO.
008610          07 v                  PIC 9(2)  VALUE ZERO.
008620          07 v                  PIC 9(2)  VALUE ZERO.
008630       05 Nv.
008640          07 Nv                  PIC 9(2)  VALUE ZERO.
008650          07 v                  PIC 9(2)  VALUE ZERO.
008660          07 v                  PIC 9(2)  VALUE ZERO.
008670       05 JnNv.
008680          07 JnNv                  PIC 9(2)  VALUE ZERO.
008690          07 Jnv                  PIC 9(2)  VALUE ZERO.
008700          07 Jnv                  PIC 9(2)  VALUE ZERO.
008710       05 INv.
008720          07 INv                  PIC 9(2)  VALUE ZERO.
008730          07 Iv                  PIC 9(2)  VALUE ZERO.
008740          07 Iv                  PIC 9(2)  VALUE ZERO.
008750       05 v                     PIC 9(2)  VALUE ZERO.
008760       05 ]A敪v                   PIC 9(1)  VALUE ZERO.
008770       05 ]A敪`FbNv.
008780          07 `FbNv            PIC N(1)  VALUE SPACE.
008790          07 ~`FbNv            PIC N(1)  VALUE SPACE.
008800          07 ]`FbNv            PIC N(1)  VALUE SPACE.
008810       05 JnN擾tO         PIC X(3)  VALUE SPACE.
008820       05 ʋ؂v                   PIC X(1)  VALUE SPACE.
008830       05 oߗ̂v.
008840          07 oߗ̂v            PIC N(5)  VALUE SPACE.
008850          07 FILLER                    PIC X(2)  VALUE SPACE.
008860    03 oߕʂv                      PIC N(1)  VALUE SPACE.
009030    03 o߂bl                        PIC N(4)  VALUE SPACE.
008870    03 VK`FbNv                  PIC N(1)  VALUE SPACE.
008880    03 p`FbNv                  PIC N(1)  VALUE SPACE.
          03 {pv.
             05 {p`FbNv   OCCURS 31 PIC N(1)  VALUE SPACE.
008890****************
008900* nbqR[h *
008910****************
008920* 01 nbqR[hv.
008930*    03 nbqԍv                PIC X(6)    VALUE ZERO.
008940*    03 nbq{pNv                PIC 9(4)    VALUE ZERO.
008950*    03 nbqیʂv                PIC 9(2)    VALUE ZERO.
008960*    03 nbqeЂhcv                PIC 9(2)    VALUE ZERO.
008970*    03 nbqecAԂv.
008980*       05 ecAԊҔԍv           PIC 9(6)    VALUE ZERO.
008990*       05 ecAԌۂhcv           PIC 9(1)    VALUE ZERO.
009000*    03 nbqzv                PIC 9(6)    VALUE ZERO.
009010*    03 nbqSv                PIC 9(1)    VALUE ZERO.
009020*    03 nbqڍtԍv        PIC 9(10)   VALUE ZERO.
009030*
009040************
009050*  *
009060************
009070 01 v.
009080    03 Zv.
009090       05 ԊO`FbNv                PIC N(1) VALUE SPACE.
009100       05 x`FbNv                  PIC N(1) VALUE SPACE.
009110       05 [`FbNv                  PIC N(1) VALUE SPACE.
009120    03 ÉZv.
009130       05 ԃ`FbNv                  PIC N(1) VALUE SPACE.
009140       05 \J`FbNv              PIC N(1) VALUE SPACE.
009150    03 q`FbNv.
009160       05 `FbNv                    PIC N(1) VALUE SPACE.
009170       05 `FbNv                    PIC N(1) VALUE SPACE.
009180       05 `FbNv                    PIC N(1) VALUE SPACE.
009190    03 vv                             PIC 9(7) VALUE ZERO.
009200    03 񏈒uvv                   PIC 9(6) VALUE ZERO.
009210    03 񏈒u`FbNv.
009220       05 `FbNv                PIC N(1) VALUE SPACE.
009230       05 Œ藿`FbNv                PIC N(1) VALUE SPACE.
009240       05 {×`FbNv                PIC N(1) VALUE SPACE.
      */qE^Â̕ύXEǉ/1805
          03 񐔂v                         PIC 9(2)  VALUE ZERO.
          03 ^v                           PIC 9(4)  VALUE ZERO.
009250************
009260* l *
009270************
009280 01 lv.
009290    03 KpPv                        PIC N(38) VALUE SPACE.
009300    03 KpQv                        PIC N(38) VALUE SPACE.
009310    03 KpRv                        PIC X(40) VALUE SPACE.
009320*    03 KpSv                        PIC N(38) VALUE SPACE.
009330    03 o߃Rgv                  PIC N(60) VALUE SPACE.
      *
       01 {pv                       PIC X(150) VALUE SPACE.
       01 {pvq.
          03 {pvo                  PIC X(4)  VALUE SPACE OCCURS 31.
       01 vo                             PIC Z9    VALUE ZERO.
       01 {pv                     PIC 9(3)  VALUE ZERO.
009340*
009350*****************
009360* Zvgя *
009370*****************
009380 01 ԌŒv                         PIC N(1) VALUE SPACE.
009390 01 Ԃv                             PIC 9(4) VALUE ZERO.
009400*
       01 Ev{pv                       PIC X(100) VALUE SPACE.
       01 {pv.
          03 {pQv                      PIC X(1)  VALUE SPACE.
          03 {pPv                      PIC X(1)  VALUE SPACE.
002790** Sp
002800 01 Sv                         PIC 9(2)  VALUE ZERO.
002810 01 tv                         PIC 9(2)  VALUE ZERO.
009410*******************************************************************
009420 01 .
009430     03 `̖o                     PIC X(8) VALUE SPACE.
009440     03 ڌQo                     PIC X(8) VALUE SPACE.
009450     03 ʂo                     PIC X(2) VALUE SPACE.
009460     03 go.
009470         05 [o.
009480             07 ړo             PIC X(1) VALUE SPACE.
009490             07 ړso             PIC 9(3) VALUE ZERO.
009500         05 ڍאo                 PIC X(2) VALUE SPACE.
009510     03 ʒmo                     PIC X(2) VALUE SPACE.
009520     03 jbgo                   PIC X(8) VALUE SPACE.
009530*
009540 01 vZ@Nv                     PIC 9(2) VALUE ZERO.
009550* tvnqj
009560 01 aINv                       PIC 9(4) VALUE ZERO.
009570 01 vZ@.
009580    03 vZ@N                    PIC 9(4) VALUE ZERO.
009590    03 vZ@                  PIC 9(4) VALUE ZERO.
009600 01 vZ@q REDEFINES vZ@.
009610    03 vZ@I                      PIC 9(2).
009620    03 vZ@t                      PIC 9(6).
009630    03 vZ@tq REDEFINES vZ@t.
009640       05 vZ@N                   PIC 9(4).
009650       05 vZ@Nq REDEFINES vZ@N.
009660         07 vZ@N                   PIC 9(2).
009670         07 vZ@                   PIC 9(2).
009680       05 vZ@                     PIC 9(2).
009690*
       01 vOv     PIC X(8) VALUE "MOJI2".
      *
009700******************************************************************
009710*                          A                              *
009720******************************************************************
009730**  ʓ̓f[^
009740 01 A|̓f[^ϔC IS EXTERNAL.
009750    03 A|ϔC                     PIC 9.
014620*
       01 A|̓f[^db IS EXTERNAL.
          03 A|db                     PIC 9.
009190*
       01 A|vr[ IS EXTERNAL.
          03 A|vr[敪          PIC 9.
009760*
009770** RJ
009780 01 Aԁ|L[ IS EXTERNAL.
009790    03 Aԁ|{pN.
009800       05 Aԁ|{pa               PIC 9.
009810       05 Aԁ|{pN                 PIC 9(2).
009820       05 Aԁ|{p                 PIC 9(2).
009830    03  Aԁ|҃R[h.
009840       05 Aԁ|Ҕԍ               PIC 9(6).
009850       05 Aԁ|}                   PIC X.
009860    03 Aԁ|ΏۃtO                PIC X(3).
009870    03 Aԁ|Ԍv.
009880       05 Aԁ|Ԃv                 PIC 9(2) OCCURS 9.
014230************************
014240* EvZbg     *
014250************************
014260 01 AE|L[ IS EXTERNAL.
014270    03 AE|{pN.
014280       05 AE|{pa               PIC 9.
014290       05 AE|{pN                 PIC 9(2).
014300       05 AE|{p                 PIC 9(2).
014310    03  AE|҃R[h.
014320       05 AE|Ҕԍ               PIC 9(6).
014330       05 AE|}                   PIC X.
014340    03 AE|                    PIC 9(2).
014350    03 AE|Ev                    PIC X(126) OCCURS 30.
014340    03 AE|敪                  PIC 9(1).
009890************
009900* L[ *
009910************
009940 01 A|Ώۃf[^ IS EXTERNAL.
009950    03 A|{pN.
009960       05 A|{pa                  PIC 9(1).
009970       05 A|{pN                    PIC 9(2).
009980       05 A|{p                    PIC 9(2).
009990    03 A|҃R[h.
010000       05 A|Ҕԍ                  PIC 9(6).
010010       05 A|}                      PIC X(1).
010020    03 A|ی                     PIC 9(2).
010030    03 A|یҔԍ                   PIC X(10).
010040    03 A|                     PIC 9(2).
010050    03 A|pSҔԍ               PIC X(10).
010060    03 A|                     PIC 9(2).
010070    03 A|pSҔԍ           PIC X(10).
010080    03 A|҃Ji                     PIC X(20).
010090    03 A|{lƑ敪                 PIC 9(1).
013520*
013530 01 A|L[ IS EXTERNAL.
013540    03 A|ی                  PIC 9(2).
013550*
013560************************
013570* RZbg     *
013580************************
013590 01 A|L[ IS EXTERNAL.
013600    03 A|{pN.
013610       05 A|{pa               PIC 9.
013620       05 A|{pN                 PIC 9(2).
013630       05 A|{p                 PIC 9(2).
013640    03  A|҃R[h.
013650       05 A|Ҕԍ               PIC 9(6).
013660       05 A|}                   PIC X.
013670    03 A|                    PIC 9(2).
013680    03 A|R                    PIC N(63) OCCURS 15.
013690*
013691************************
013692* Z܂Ƃ
013693************************
013694 01 AZ܂Ƃ߁|L[ IS EXTERNAL.
013695    03 AZ܂Ƃ߁|{paN.
013696       05 AZ܂Ƃ߁|{pa               PIC 9.
013697       05 AZ܂Ƃ߁|{pN.
013698          07 AZ܂Ƃ߁|{pN              PIC 9(2).
013699          07 AZ܂Ƃ߁|{p              PIC 9(2).
013700    03 AZ܂Ƃ߁|҃R[h.
013701       05 AZ܂Ƃ߁|Ҕԍ               PIC 9(6).
013702       05 AZ܂Ƃ߁|}                   PIC X(1).
013703**-------------------------------------------------------**
013704*   1:ZvgȂ̖{̂܂Ƃ߂̔
013705*   2:lEp̎ЕۏZ̔
013706    03 AZ܂Ƃ߁|敪                  PIC 9.
013707**-------------------------------------------------------**
013708*  / OUT /@ 0:ΏۊOA1:Ώ
013709    03 AZ܂Ƃ߁|茋                  PIC 9.
013710**
013711*
013712*************
013713* 
013714*************
013715 01 Á|L[ IS EXTERNAL.
013716    03 Á|             PIC 9(2).
013717    03 Á|pSҔԍ   PIC X(10).
013718*   / OUT /
013719    03 Á|̏Wc.
013720       05 Á|P            PIC N.
013721       05 Á|              PIC N(4).
013722       05 Á|          PIC N(10).
013723*
014761*
014762************************
014763* Z
014764************************
014765 01 AZ|L[ IS EXTERNAL.
014766    03 AZ|{pN.
014767       05 AZ|{pa               PIC 9.
014768       05 AZ|{pN                 PIC 9(2).
014769       05 AZ|{p                 PIC 9(2).
014770    03  AZ|҃R[h.
014771       05 AZ|Ҕԍ               PIC 9(6).
014772       05 AZ|}                   PIC X.
014773    03 AZ|ΏۃtO                PIC X(3).
014774*
000540************************************
000550* v^t@C쐬p           *
000560************************************
000570 01 gAoqse|쐬f[^ IS EXTERNAL.
000580     03 gAoqse|t@C           PIC X(8).
000590     03 gAoqse|vr[敪       PIC 9.
000600     03 gAoqse|[vO     PIC X(8).
000610     03 gAoqse|I[oC         PIC X(8).
000993************************************
000994* v^t@C쐬p       *
000995************************************
000996 01 gAoqse|쐬f[^ IS EXTERNAL.
000997     03 gAoqse|p         PIC X(8).
006490*
      * C Agp
       01  Pv        PIC X(4096).
       01  Qv        PIC X(512).
       01  vOv  PIC X(8)  VALUE "strmoji2".
      *
      * Íp
       01 AÍ|Í IS EXTERNAL.
          03 AÍ|͏.
             05 AÍ|L               PIC X(24).
             05 AÍ|ԍ               PIC X(30).
             05 AÍ|Í.
               07 AÍ|ÍҔԍ     PIC X(6).
               07 AÍ|ÍL     PIC X.
               07 AÍ|Íԍ     PIC X.
               07 AÍ|ÍL         PIC X(24).
               07 AÍ|Íԍ         PIC X(30).
          03 AÍ|o͏.
             05 AÍ|L       PIC X(24).
             05 AÍ|ԍ       PIC X(30).
      * 
      */qE^Â̕ύXEǉ/1805
       01 A^|L[ IS EXTERNAL.
          03 A^|{paN.
             05 A^|{pa                  PIC 9(1).
             05 A^|{pN.
                07 A^|{pN                 PIC 9(2).
                07 A^|{p                 PIC 9(2).
          03 A^|҃R[h.
             05 A^|Ҕԍ                  PIC 9(6).
             05 A^|}                      PIC X(1).
          03 A^|ی                     PIC 9(2).
          03 A^|R[h                     PIC 9(2).
          03 A^|p                     PIC 9(1).
          03 A^|q.
             05 A^|qbl              PIC X(200).
             05 A^|q              OCCURS 5.
                07 A^|qaN     OCCURS 3.
                   09 A^|qaN.
                      11 A^|qa     PIC 9(1).
                      11 A^|qN.
                         13 A^|qN    PIC 9(2).
                         13 A^|q    PIC 9(2).
                   09 A^|q          PIC 9(2).
          03 A^|^.
             05 A^|^Âbl              PIC X(100).
             05 A^|^                    PIC 9(2)    OCCURS 5.
      *
       01 A^Q|L[ IS EXTERNAL.
           03 A^Q|qbl.
               05 A^Q|qblP        PIC X(130).
               05 A^Q|qblQ        PIC X(170).
      * 
013725******************************************************************
013726*                      PROCEDURE  DIVISION                       *
013727******************************************************************
013730 PROCEDURE               DIVISION.
013740************
013750*           *
013760*    *
013770*           *
013780************
002570     PERFORM v^t@C쐬.
013790     PERFORM .
013800************
013810*           *
013820* 又     *
013830*           *
013840************
013850* 
013860     PERFORM AڑҔ.
013870     PERFORM Zbg.
013880     PERFORM .
013890************
013900*           *
013910* I   *
013920*           *
013930************
013940     PERFORM f҈敪XV.
013950     PERFORM I.
013960     MOVE ZERO  TO PROGRAM-STATUS.
013970     EXIT PROGRAM.
013980*
013990*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
002860*================================================================*
002870 v^t@C쐬 SECTION.
002880*================================================================*
002890*   /  /
002900     MOVE SPACE TO gAoqse|쐬f[^.
002910     INITIALIZE gAoqse|쐬f[^.
002225     MOVE SPACE TO gAoqse|쐬f[^.
002226     INITIALIZE gAoqse|쐬f[^.
002920*
002930*
002940*-- ύXӏ --------------------------------------*
002230*   gppʃZbg
           MOVE "RECE"                TO gAoqse|p.
002970*   gpv^t@CZbg
002971     MOVE "PRTF002"             TO gAoqse|t@C.
002972*
002973*   gp钠[vOZbg
002974     MOVE "YCH6475"             TO gAoqse|[vO.
002975*
002976*-------------------------------------------------------*
002980*
002990*   / vr[敪Zbg /
003000     MOVE A|vr[敪  TO gAoqse|vr[敪.
003010*
003020     CALL   "CRTPRTF".
003030     CANCEL "CRTPRTF".
003040*
014000*================================================================*
014010  SECTION.
014020*
014030     PERFORM t@CI[v.
014040*    /* ݓt擾 */
014050     ACCEPT vZ@t FROM DATE.
014060*    /* 1980`2079N̊ԂŐݒ */
014070     IF ( vZ@N > 80 )
014080         MOVE 19 TO vZ@I
014090     ELSE
014100         MOVE 20 TO vZ@I
014110     END-IF.
014120     PERFORM Jg擾.
014130     PERFORM aIN擾.
014140     COMPUTE vZ@Nv = vZ@N - aINv.
014150*================================================================*
014160 Jg擾 SECTION.
014170*
014180     MOVE ZEROS TO |敪.
014190     READ }X^
014200     NOT INVALID KEY
014210         MOVE |Jg         TO Jgv
014220         MOVE |Z敪 TO 敪v
014230         MOVE |ZR敪 TO R敪v
014240         MOVE |Zvgt敪     TO Zvgt敪v
014250         MOVE |Zvgғt敪 TO Zvgғt敪v
015320         MOVE |VlZ             TO pʂv
014260     END-READ.
014270*
014280*================================================================*
014290 aIN擾 SECTION.
014300*
014310*     DISPLAY NC"Jgv"  Jgv UPON MSGBOX.
014320     MOVE Jgv TO |敪.
014330     READ }X^
014340     INVALID KEY
014350         DISPLAY NC"wao^Ă܂" UPON CONS
014360         DISPLAY NC"P͂dmsdqL[Ă"
014370                                                  UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
014380         ACCEPT  L[ FROM CONS
014390         PERFORM I
014400         EXIT PROGRAM
014410     NOT INVALID KEY
014420         COMPUTE Oav = Jgv - 1
014430         MOVE Oav TO |敪
014440         READ }X^
014450         INVALID KEY
014460             DISPLAY NC"wao^Ă܂" UPON CONS
014470             DISPLAY NC"P͂dmsdqL[Ă"
014480                                                      UPON CONS
000080*-----------------------------------------*
000090             CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
014490             ACCEPT  L[ FROM CONS
014500             PERFORM I
014510             EXIT PROGRAM
014520         NOT INVALID KEY
014530             MOVE |IN TO aINv
014540         END-READ
014550     END-READ.
014560*
014570*================================================================*
014580 t@CI[v SECTION.
014590*
014600     OPEN INPUT   ی҃}X^
014610         MOVE NC"ی" TO t@C.
014620         PERFORM I[v`FbN.
014630     OPEN INPUT   s}X^
014640         MOVE NC"s" TO t@C.
014650         PERFORM I[v`FbN.
014660     OPEN INPUT   }X^
014670         MOVE NC"" TO t@C.
014680         PERFORM I[v`FbN.
014690     OPEN INPUT   ̃}X^
014700         MOVE NC"" TO t@C.
014710         PERFORM I[v`FbN.
007560     OPEN INPUT   Zvge
007570         MOVE NC"Z" TO t@C.
007580         PERFORM I[v`FbN.
014750     OPEN INPUT   }X^
014760         MOVE NC"" TO t@C.
014770         PERFORM I[v`FbN.
014780     OPEN INPUT   {p}X^
014790         MOVE NC"{" TO t@C.
014800         PERFORM I[v`FbN.
014810     OPEN INPUT   }X^
014820         MOVE NC"" TO t@C.
014830         PERFORM I[v`FbN.
014840     OPEN INPUT   o߃}X^
014850         MOVE NC"o" TO t@C.
014860         PERFORM I[v`FbN.
014870     OPEN INPUT   {pL^e.
014880         MOVE NC"{Le" TO t@C.
014890         PERFORM I[v`FbN.
014900     OPEN INPUT   f[^e.
014910         MOVE NC"" TO t@C.
014920         PERFORM I[v`FbN.
014930     OPEN INPUT   e.
014940         MOVE NC"" TO t@C.
014950         PERFORM I[v`FbN.
014960     OPEN INPUT   }X^.
014970         MOVE NC"}X^" TO t@C.
014980         PERFORM I[v`FbN.
014990     OPEN INPUT   hcǗ}X^
015000         MOVE NC"hc" TO t@C.
015010         PERFORM I[v`FbN.
015020     OPEN INPUT t@C.
015030         MOVE NC"" TO t@C.
015040         PERFORM I[v`FbN.
015050     OPEN INPUT   ƃt@CS.
015170         IF ( ԃL[  NOT =  "00" )
015060            OPEN OUTPUT  ƃt@CS
                  CLOSE ƃt@CS
015060            OPEN INPUT  ƃt@CS
               END-IF.
015080     OPEN I-O   fҏe.
015090         MOVE NC"" TO t@C.
015100         PERFORM I[v`FbN.
015110     OPEN I-O   t@C
015120         PERFORM G[o.
015130*================================================================*
015140 I[v`FbN SECTION.
015150*
015160     IF ( ԃL[  NOT =  "00" )
015170         DISPLAY t@C NC"eI[vG[" UPON CONS
015180         DISPLAY NC"ԃL[F" ԃL[         UPON CONS
015190         DISPLAY NC"P͂dmsdqL[Ă"
015200                                                 UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015210         ACCEPT  L[ FROM CONS
015220         PERFORM t@C
015230         EXIT PROGRAM.
015240*================================================================*
015250 AڑҔ SECTION.
015260*
015270     MOVE A|{pa           TO {pavq.
015280     MOVE A|{pN             TO {pNvq.
015290     MOVE A|{p             TO {pvq.
015300     MOVE A|ی           TO یʂvq.
015310     MOVE A|یҔԍ         TO یҔԍvq.
015320     MOVE A|           TO ʂvq.
015330     MOVE A|pSҔԍ     TO pSҔԍvq.
015340     MOVE A|           TO ʂvq.
015350     MOVE A|pSҔԍ TO pSҔԍvq.
015360     MOVE A|{lƑ敪       TO {lƑ敪vq.
015370     MOVE A|҃Ji           TO ҃Jivq.
015380     MOVE A|Ҕԍ           TO Ҕԍvq.
015390     MOVE A|}               TO }Ԃvq.
015400*================================================================*
015410 Zbg SECTION.
015420*
015430     PERFORM ڏ.
014800     PERFORM Ǎ.
015480     PERFORM 擾.
015440     PERFORM {p擾.
015450     PERFORM 擾.
015460     PERFORM fҏ擾.
015470     PERFORM f[^擾.
015490     PERFORM {pL^擾.
015500     PERFORM Zvgя擾.
015510**     PERFORM nbq擾.
015520**     PERFORM 擾.
015530**     PERFORM ȑÕf[^.
015540     PERFORM Z擾.
015550     PERFORM 擾.
015560     PERFORM ϔCN擾.
           PERFORM {p擾.
015570*
016791*-----------------------------------------------*
016800     IF ( 敪v  NOT = 1 ) AND ( Z敪v NOT = 1 )
016813        IF ( 敪v = 3 OR 4 )
016815           PERFORM Ώ۔菈
016817        ELSE
016820           PERFORM 擾
016821        END-IF
016830     END-IF.
      *//160816
      **/tdxSgQÔ
      *     IF (| = "53" ) AND (|pSҔԍ(1:4) = "8112" )
      *         MOVE NC"dS"         TO dS
      *         MOVE NC""           TO dS
      *     END-IF.
015700*
015710**********************
015720* nbqR[hZbg *
015730**********************
015740*
015750*     MOVE nbqڍtԍv     TO nbqԍ.
015760*     MOVE nbq{pNv     TO nbq{pN.
015770*     MOVE nbqیʂv     TO nbqی.
015780*     MOVE nbqeЂhcv     TO nbqeЂhc.
015790*     MOVE nbqecAԂv     TO nbqecA.
015800*     MOVE nbqzv     TO nbqz.
015810*     MOVE nbqSv     TO nbqS.
015820*
015830********************
015840* fҏZbg *
015850********************
015860     MOVE {pNv            TO {pN.
015870     MOVE {pv            TO {p.
015880*
015890*
015900*     IF ( Lv(1:1) = NC"" )
015910*        MOVE  SPACE    TO  L
015920*     ELSE
015930*        MOVE Lv    TO  L
015940*     END-IF.
015950*     IF ( ԍv(1:1) = "*"  ) OR
015960*        ( ԍv(1:2) = "" )
015970*        MOVE  SPACE      TO  یҔԍ
015980*     ELSE
015990*        MOVE ԍv  TO  یҔԍ
016000*     END-IF.
016010*
           IF ( Lv(1:1) = NC"" )
              MOVE  SPACE          TO  Lv
           END-IF.
           IF ( ԍv(1:1) = "*"  ) OR
              ( ԍv(1:2) = "" )
              MOVE  SPACE          TO  ԍv
           END-IF.
      *
           INSPECT Lv  REPLACING ALL "@" BY "  ".
           EVALUATE TRUE
           WHEN (Lv NOT = SPACE) AND (ԍv NOT = SPACE)
               MOVE SPACE TO ItOQ
               PERFORM VARYING JE^ FROM 24 BY -1
                 UNTIL (JE^ <= ZERO) OR (ItOQ NOT = SPACE)
                   IF Lv(JE^:1) NOT = SPACE
                       MOVE Lv TO Lԍv
                       MOVE "E"   TO Lԍv(JE^ + 1:2)
                       MOVE ԍv TO Lԍv(JE^ + 3:40 - JE^ - 2)
                       MOVE "YES"  TO ItOQ
                   END-IF
               END-PERFORM
               MOVE Lԍv TO Lԍ
           WHEN Lv NOT = SPACE
               MOVE Lv TO Lԍ
           WHEN ԍv NOT = SPACE
               MOVE ԍv TO Lԍ
           END-EVALUATE.
016020**
016030     MOVE یҔԍv    TO یҔԍ.
016060**
016070*     MOVE 於̂v        TO 於.
016080*     MOVE 於̂v        TO یҖ.
016090*     MOVE ی҃Jiv      TO ی҃Ji.
016100     MOVE یҎv      TO یҎ.
016110*     MOVE X֔ԍPv        TO X֔ԍP.
016120*     MOVE X֔ԍQv        TO X֔ԍQ.
016130*     MOVE "-"                 TO X֋.
016140     MOVE یҏZPv    TO ZP.
016150     MOVE یҏZQv    TO ZQ.
016160**     MOVE یҏZv      TO Z.
016170*     MOVE ҏZv          TO Z.
      */ X֔ԍEdbԍǉ /42505
           IF ({paNvq >= 42505) AND (A|db = 1)
              IF (|_X֓dbԍ = 0 OR 2) AND
                 ((X֔ԍPv NOT = SPACE) OR (X֔ԍQv NOT = SPACE))
017280           MOVE ""          TO X
017260           MOVE X֔ԍPv  TO X֔ԍP
017270           MOVE X֔ԍQv  TO X֔ԍQ
017280           MOVE "-"           TO X֋
              END-IF
              IF |_X֓dbԍ = 0 OR 3
017260           MOVE dbԍv    TO dbԍ
              END-IF
           END-IF.
016170*     MOVE ҏZPv          TO ZP.
016170*     MOVE ҏZQv          TO ZQ.
016180*     MOVE ҃Jiv          TO ҃Ji.
016190     MOVE Ҏv          TO Ҏ.
016200     MOVE j`FbNv        TO j`FbN.
016210     MOVE `FbNv        TO `FbN.
016220*     MOVE ʂv               TO .
016230     MOVE `FbNv      TO `FbN.
016240     MOVE 吳`FbNv      TO 吳`FbN.
016250     MOVE a`FbNv      TO a`FbN.
016260*     MOVE `FbNv      TO `FbN.
016270*     MOVE v              TO .
      */C/20190408
           MOVE ߘablv         TO ߘabl.
023070     MOVE ߘa`FbNv     TO ߘa`FbN.
017390*     MOVE v              TO Ҙa.
      */C/20190408
016280     MOVE ҔNv            TO ҔN.
016290     MOVE Ҍv            TO Ҍ.
016300     MOVE ғv            TO ғ.
016310*     MOVE v          TO .
016320     MOVE v(1)       TO P.
016330     MOVE v(2)       TO Q.
016340     MOVE v(3)       TO R.
016350     MOVE v(4)       TO S.
016360     MOVE v(5)       TO T.
016480     MOVE v(6)       TO U.
016370*
016380     MOVE v            TO .
016390*
015190     MOVE Еۃ`FbNv     TO Еۃ`FbN.
015210     MOVE g`FbNv     TO g`FbN.
015220     MOVE ۃ`FbNv     TO ۃ`FbN.
           MOVE σ`FbNv     TO σ`FbN.
           MOVE `FbNv       TO `FbN.
           MOVE ސE`FbNv     TO ސE`FbN.
           MOVE `FbNv     TO `FbN.
015230     MOVE V`FbNv     TO V`FbN.
015240     MOVE W`FbNv     TO W`FbN.
015250     MOVE X`FbNv     TO X`FbN.
015260     MOVE PO`FbNv   TO PO`FbN.
      *
           MOVE {l`FbNv     TO {l`FbN.
           MOVE Ƒ`FbNv     TO Ƒ`FbN.
           MOVE Pƃ`FbNv     TO Pƃ`FbN.
           MOVE Q`FbNv     TO Q`FbN.
           MOVE `FbNv     TO `FbN.
           MOVE V`FbNv     TO V`FbN.
           MOVE U΃`FbNv     TO U΃`FbN.
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
              MOVE {pav         TO |敪
037380        READ }X^
037390        NOT INVALID KEY
037400            MOVE |   TO {pa
037410        END-READ
      *        MOVE "===="             TO {pa
           END-IF.
      */C/20190408
      */{̍ۑސE{̏ꍇ͕SҎ󋋎ҔԍLڂ
           IF (|ی = 01      ) AND (|یҔԍ(1:2) = "27") OR
              (|ی = 05 OR 08) AND (|یҔԍ(3:2) = "27")
               IF ( sԍv(1:2) NOT = "99" )
                   MOVE sԍv TO SҔԍ
               END-IF
               IF ( 󋋎Ҕԍv(1:1) = "*"  ) OR
                  ( 󋋎Ҕԍv(1:2) = "" )
                   MOVE SPACE            TO 󋋎Ҕԍ
               ELSE
                   MOVE 󋋎Ҕԍv TO 󋋎Ҕԍ
               END-IF
           END-IF.
016400********************
016410* RZbg *
016420********************
016430*     MOVE A|R(1)    TO RP.
016440*     MOVE A|R(2)    TO RQ.
016450*     MOVE A|R(3)    TO RR.
016460*     MOVE A|R(4)    TO RS.
016470*     MOVE A|R(5)    TO RT.
016480*     MOVE A|R(6)    TO RU.
016490*     MOVE A|R(7)    TO RV.
015780*     IF ( A|R(1)  NOT = SPACE )
015790*        MOVE NC"iRj"  TO RŒ
015800*     END-IF.
016530********************
016540* f[^Zbg *
016550********************
016560* P *
016570**********
016580     MOVE v(1)       TO P.
016590     MOVE Nv(1)       TO NP.
016600     MOVE v(1)       TO P.
016610     MOVE v(1)       TO P.
016620     MOVE Nv(1)       TO NP.
016630     MOVE v(1)       TO P.
016640     MOVE v(1)       TO P.
016650     MOVE JnNv(1)       TO JnNP.
016660     MOVE Jnv(1)       TO JnP.
016670     MOVE Jnv(1)       TO JnP.
016680     MOVE INv(1)       TO INP.
016690     MOVE Iv(1)       TO IP.
016700     MOVE Iv(1)       TO IP.
016710     MOVE v(1)       TO P.
016720     MOVE `FbNv(1) TO `FbNP.
016730     MOVE ~`FbNv(1) TO ~`FbNP.
016740     MOVE ]`FbNv(1) TO ]`FbNP.
016750**********
016760* Q *
016770**********
016780     MOVE v(2)       TO Q.
016790     MOVE Nv(2)       TO NQ.
016800     MOVE v(2)       TO Q.
016810     MOVE v(2)       TO Q.
016820     MOVE Nv(2)       TO NQ.
016830     MOVE v(2)       TO Q.
016840     MOVE v(2)       TO Q.
016850     MOVE JnNv(2)       TO JnNQ.
016860     MOVE Jnv(2)       TO JnQ.
016870     MOVE Jnv(2)       TO JnQ.
016880     MOVE INv(2)       TO INQ.
016890     MOVE Iv(2)       TO IQ.
016900     MOVE Iv(2)       TO IQ.
016910     MOVE v(2)       TO Q.
016920     MOVE `FbNv(2) TO `FbNQ.
016930     MOVE ~`FbNv(2) TO ~`FbNQ.
016940     MOVE ]`FbNv(2) TO ]`FbNQ.
016950**********
016960* R *
016970**********
016980     MOVE v(3)       TO R.
016990     MOVE Nv(3)       TO NR.
017000     MOVE v(3)       TO R.
017010     MOVE v(3)       TO R.
017020     MOVE Nv(3)       TO NR.
017030     MOVE v(3)       TO R.
017040     MOVE v(3)       TO R.
017050     MOVE JnNv(3)       TO JnNR.
017060     MOVE Jnv(3)       TO JnR.
017070     MOVE Jnv(3)       TO JnR.
017080     MOVE INv(3)       TO INR.
017090     MOVE Iv(3)       TO IR.
017100     MOVE Iv(3)       TO IR.
017110     MOVE v(3)       TO R.
017120     MOVE `FbNv(3) TO `FbNR.
017130     MOVE ~`FbNv(3) TO ~`FbNR.
017140     MOVE ]`FbNv(3) TO ]`FbNR.
017150**********
017160* S *
017170**********
017180     MOVE v(4)       TO S.
017190     MOVE Nv(4)       TO NS.
017200     MOVE v(4)       TO S.
017210     MOVE v(4)       TO S.
017220     MOVE Nv(4)       TO NS.
017230     MOVE v(4)       TO S.
017240     MOVE v(4)       TO S.
017250     MOVE JnNv(4)       TO JnNS.
017260     MOVE Jnv(4)       TO JnS.
017270     MOVE Jnv(4)       TO JnS.
017280     MOVE INv(4)       TO INS.
017290     MOVE Iv(4)       TO IS.
017300     MOVE Iv(4)       TO IS.
017310     MOVE v(4)       TO S.
017320     MOVE `FbNv(4) TO `FbNS.
017330     MOVE ~`FbNv(4) TO ~`FbNS.
017340     MOVE ]`FbNv(4) TO ]`FbNS.
017350**********
017360* T *
017370**********
017380     MOVE v(5)       TO T.
017390     MOVE Nv(5)       TO NT.
017400     MOVE v(5)       TO T.
017410     MOVE v(5)       TO T.
017420     MOVE Nv(5)       TO NT.
017430     MOVE v(5)       TO T.
017440     MOVE v(5)       TO T.
017450     MOVE JnNv(5)       TO JnNT.
017460     MOVE Jnv(5)       TO JnT.
017470     MOVE Jnv(5)       TO JnT.
017480     MOVE INv(5)       TO INT.
017490     MOVE Iv(5)       TO IT.
017500     MOVE Iv(5)       TO IT.
017510     MOVE v(5)       TO T.
017520     MOVE `FbNv(5) TO `FbNT.
017530     MOVE ~`FbNv(5) TO ~`FbNT.
017540     MOVE ]`FbNv(5) TO ]`FbNT.
017550**************
017560* o߃Zbg *
017570**************
017580     PERFORM VARYING ʂbms FROM 1 BY 1
017590***             UNTIL ( ʂbms > ʐv )
017600             UNTIL ( ʂbms > 5 )
017610*         MOVE ʂbmsv(ʂbms)   TO oߕʂbms(ʂbms)
017620*         MOVE ʋ؂v(ʂbms)     TO ʋ(ʂbms)
017630         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
017640     END-PERFORM.
017650*****************************************
017660*     VKEp`FbNɂ        *
017670*   VK...L p...Ȃ *
017680*****************************************
017690     MOVE VK`FbNv    TO VK`FbN.
017700     MOVE p`FbNv    TO p`FbN.
017710********************
017720* f[^Zbg *
017730********************
017740*    ****************************************************************
017750*    * ijijijɂĂ͘AڂZbg *
017760*    ****************************************************************
017770     MOVE vq                   TO  .
017780     MOVE ԊO`FbNv             TO  ԊO`FbN.
017790     MOVE x`FbNv               TO  x`FbN.
017800     MOVE [`FbNv               TO  [`FbN.
017810     MOVE Zvq               TO  Z.
      *
           IF ((ԊO`FbNv NOT = SPACE) OR ([`FbNv NOT = SPACE) OR
              (x`FbNv NOT = SPACE)) AND
              ((Zv NOT = ZERO) OR (Zv NOT = ZERO))
              MOVE Zv                 TO  Z
              MOVE Z؂v               TO  Z
              MOVE Zv                 TO  Z
           END-IF.
      *
           MOVE kvq             TO  k.
017820     MOVE Čvq                   TO  Č.
017830     MOVE Ëvq                 TO  Ë.
017840     MOVE É񐔂vq                 TO  É.
017850     MOVE ×vq                   TO  ×.
017860     MOVE ԃ`FbNv               TO  ԃ`FbN.
017870     MOVE \J`FbNv           TO  \J`FbN.
017880     MOVE ÉZvq               TO  ÉZ.
      */qE^Â̕ύXEǉ/1805
           IF pʂv < 2
              IF ( {paNvq < 43006 )
018050           MOVE `FbNv              TO  `FbN
018060           MOVE `FbNv              TO  `FbN
018070           MOVE `FbNv              TO  `FbN
              ELSE
                 MOVE ALL NC""                TO  
              END-IF
           END-IF.
           IF ( {paNvq >= 43006 ) AND ( qZvq NOT = ZERO )
              MOVE 񐔂v                TO  
              MOVE NC""                    TO  
           END-IF.
017920     MOVE qZvq           TO  qZ.
017930     MOVE {p񋟗vq           TO  {p񋟗.
017940     MOVE vv                       TO v.
017950********************
017960* 񏈒uZbg *
017970********************
017980     PERFORM VARYING ʂbms FROM 1 BY 1
017990***             UNTIL ( ʂbms > ʐv )
018000             UNTIL ( ʂbms > 5 )
018010         MOVE 񏈒uvq(ʂbms) TO 񏈒u(ʂbms)
018020     END-PERFORM.
018030     MOVE 񏈒uvv         TO 񏈒uv
018040*
018050     MOVE {×`FbNv            TO {×`FbN.
018060     MOVE `FbNv            TO `FbN.
018070     MOVE Œ藿`FbNv            TO Œ藿`FbN.
018080********************
018090* Zbg *
018100********************
018110*    **********
018120*    * P *
018130*    **********
018140     MOVE ÒPPvq             TO ÒPP.
018150     MOVE É񐔂Pvq             TO É񐔂P.
018160     MOVE ×Pvq               TO ×P.
018170     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
018180     MOVE 㪖@Pvq             TO 㪖@P.
018190     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
018200     MOVE 㪖@Pvq             TO 㪖@P.
018210     MOVE dÉ񐔂Pvq             TO dÉ񐔂P.
018220     MOVE d×Pvq               TO d×P.
018230     MOVE vPvq                 TO vP.
018240     IF ( Pvq NOT = ZERO )
018250         COMPUTE P = Pvq / 100
018260     END-IF.
018270     MOVE vPvq           TO vP.
018280*    **********
018290*    * Q *
018300*    **********
018310     MOVE ÒPQvq             TO ÒPQ.
018320     MOVE É񐔂Qvq             TO É񐔂Q.
018330     MOVE ×Qvq               TO ×Q.
018340     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
018350     MOVE 㪖@Qvq             TO 㪖@Q.
018360     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
018370     MOVE 㪖@Qvq             TO 㪖@Q.
018380     MOVE dÉ񐔂Qvq             TO dÉ񐔂Q.
018390     MOVE d×Qvq               TO d×Q.
018400     MOVE vQvq                 TO vQ.
018410     IF ( Qvq NOT = ZERO )
018420         COMPUTE Q = Qvq / 100
018430     END-IF.
018440     MOVE vQvq           TO vQ.
018450*    ****************
018460*    * Rʁ^W *
018470*    ****************
018480     MOVE ÒPRWvq             TO ÒPRW.
018490     MOVE É񐔂RWvq             TO É񐔂RW.
018500     MOVE ×RWvq               TO ×RW.
018510     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
018520     MOVE 㪖@RWvq             TO 㪖@RW.
018530     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
018540     MOVE 㪖@RWvq             TO 㪖@RW.
018550     MOVE dÉ񐔂RWvq             TO dÉ񐔂RW.
018560     MOVE d×RWvq               TO d×RW.
018570     MOVE vRWvq                 TO vRW.
018580     MOVE ʍvRWvq         TO ʍvRW.
018590     IF ( RWvq NOT = ZERO )
018600         COMPUTE RW = RWvq / 100
018610     END-IF.
018620     MOVE vRWvq           TO vRW.
      */  0.70.6 /42505
           IF ({paNvq >= 42505)
              MOVE "60"                      TO RW
              MOVE "0.6"                     TO ʂRW
           END-IF.
018630*    ****************
018640*    * Rʁ^10 *
018650*    ****************
018660     MOVE JnROvq           TO JnRO.
018670     MOVE JnROvq           TO JnRO.
018680     MOVE ÒPROvq             TO ÒPRO.
018690     MOVE É񐔂ROvq             TO É񐔂RO.
018700     MOVE ×ROvq               TO ×RO.
018710     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
018720     MOVE 㪖@ROvq             TO 㪖@RO.
018730     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
018740     MOVE 㪖@ROvq             TO 㪖@RO.
018750     MOVE dÉ񐔂ROvq             TO dÉ񐔂RO.
018760     MOVE d×ROvq               TO d×RO.
018770     MOVE vROvq                 TO vRO.
018780     IF ( ROvq NOT = ZERO )
018790         COMPUTE RO = ROvq / 100
018800     END-IF.
018810     MOVE vROvq           TO vRO.
018820*    ****************
018830*    * Sʁ^T *
018840*    ****************
018850*     MOVE ÒPSTvq             TO ÒPST.
018860*     MOVE É񐔂STvq             TO É񐔂ST.
018870*     MOVE ×STvq               TO ×ST.
018880*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
018890*     MOVE 㪖@STvq             TO 㪖@ST.
018900*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
018910*     MOVE 㪖@STvq             TO 㪖@ST.
018920*     MOVE dÉ񐔂STvq             TO dÉ񐔂ST.
018930*     MOVE d×STvq               TO d×ST.
018940*     MOVE vSTvq                 TO vST.
018950*     MOVE ʍvSTvq         TO ʍvST.
018960*     IF ( STvq NOT = ZERO )
018970*         COMPUTE ST = STvq / 100
018980*     END-IF.
018990*     MOVE vSTvq           TO vST.
019000*    ****************
019010*    * Sʁ^W *
019020*    ****************
019030     MOVE JnSWvq           TO JnSW.
019040     MOVE JnSWvq           TO JnSW.
019050     MOVE ÒPSWvq             TO ÒPSW.
019060     MOVE É񐔂SWvq             TO É񐔂SW.
019070     MOVE ×SWvq               TO ×SW.
019080     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
019090     MOVE 㪖@SWvq             TO 㪖@SW.
019100     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
019110     MOVE 㪖@SWvq             TO 㪖@SW.
019120     MOVE dÉ񐔂SWvq             TO dÉ񐔂SW.
019130     MOVE d×SWvq               TO d×SW.
019140     MOVE vSWvq                 TO vSW.
019150     MOVE ʍvSWvq         TO ʍvSW.
019160     IF ( SWvq NOT = ZERO )
019170         COMPUTE SW = SWvq / 100
019180     END-IF.
019190     MOVE vSWvq           TO vSW.
      */  0.70.6 /42505
           IF ({paNvq >= 42505)
              MOVE "60"                      TO SW
              MOVE "0.6"                     TO ʂSW
           END-IF.
019200*    ****************
019210*    * Sʁ^10 *
019220*    ****************
019230     MOVE JnSOvq           TO JnSO.
019240     MOVE JnSOvq           TO JnSO.
019250     MOVE ÒPSOvq             TO ÒPSO.
019260     MOVE É񐔂SOvq             TO É񐔂SO.
019270     MOVE ×SOvq               TO ×SO.
019280     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
019290     MOVE 㪖@SOvq             TO 㪖@SO.
019300     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
019310     MOVE 㪖@SOvq             TO 㪖@SO.
019320     MOVE dÉ񐔂SOvq             TO dÉ񐔂SO.
019330     MOVE d×SOvq               TO d×SO.
019340     MOVE vSOvq                 TO vSO.
019350     IF ( SOvq NOT = ZERO )
019360         COMPUTE SO = SOvq / 100
019370     END-IF.
019380     MOVE vSOvq           TO vSO.
019390*
019400************************************************************************
019410* Tʁ^2.5̈󎚂͕KvȂB
019420*------------------------------------------------------------------------*
019430*    *****************
019440*    * Tʁ^2.5 *
019450*    *****************
019460*     MOVE ÒPTQvq             TO ÒPTQ.
019470*     MOVE É񐔂TQvq             TO É񐔂TQ.
019480*     MOVE ×TQvq               TO ×TQ.
019490*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
019500*     MOVE 㪖@TQvq             TO 㪖@TQ.
019510*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
019520*     MOVE 㪖@TQvq             TO 㪖@TQ.
019530*     MOVE dÉ񐔂TQvq             TO dÉ񐔂TQ.
019540*     MOVE d×TQvq               TO d×TQ.
019550*     MOVE vTQvq                 TO vTQ.
019560*     MOVE ʍvTQvq         TO ʍvTQ.
019570*     IF ( TQvq NOT = ZERO )
019580*         COMPUTE TQ = TQvq / 100
019590*     END-IF.
019600*     MOVE vTQvq           TO vTQ.
019610************************************************************************
019620*
019630*    ****************
019640*    * Tʁ^T *
019650*    ****************
019660*     MOVE JnTTvq           TO JnTT.
019670*     MOVE JnTTvq           TO JnTT.
019680*     MOVE ÒPTTvq             TO ÒPTT.
019690*     MOVE É񐔂TTvq             TO É񐔂TT.
019700*     MOVE ×TTvq               TO ×TT.
019710*     MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT.
019720*     MOVE 㪖@TTvq             TO 㪖@TT.
019730*     MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT.
019740*     MOVE 㪖@TTvq             TO 㪖@TT.
019750*     MOVE dÉ񐔂TTvq             TO dÉ񐔂TT.
019760*     MOVE d×TTvq               TO d×TT.
019770*     MOVE vTTvq                 TO vTT.
019780*     MOVE ʍvTTvq         TO ʍvTT.
019790*     IF ( TTvq NOT = ZERO )
019800*         COMPUTE TT = TTvq / 100
019810*     END-IF.
019820*     MOVE vTTvq           TO vTT.
019830*    ****************
019840*    * Tʁ^W *
019850*    ****************
021220     MOVE SPACE TO ʂTv.
021230     IF vTWvq NOT = ZERO
      */t
021560        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TWvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTWvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TWvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TWvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TWvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TWvq / dÉ񐔂TWvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TWvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TWvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
              MOVE "x"                          TO ZLTv
      */  0.70.6 /42505
              IF ({paNvq >= 42505)
021290           MOVE "0.6 "                    TO ʗTv
              ELSE
021290           MOVE "0.7 "                    TO ʗTv
              END-IF
      */
021680        IF TWvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TWvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTWvq           TO vTv
021720        MOVE ʂTv                     TO ʂTW
021490     END-IF.
020030*    ****************
020040*    * Tʁ^10 *
020050*    ****************
021530     MOVE SPACE TO ʂTv.
021540     IF vTOvq NOT = ZERO
      */t
021560        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TOvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTOvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TOvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TOvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TOvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TOvq / dÉ񐔂TOvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TOvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TOvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
      *        ZLTv ʗTv
      */
021680        IF TOvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TOvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTOvq           TO vTv
021720        MOVE ʂTv                     TO ʂTO
021730     END-IF.
020230*
020240     MOVE KpPv                       TO KpP.
020250     MOVE KpQv                       TO KpQ.
020260     MOVE KpRv                       TO KpR.
020270*     MOVE KpSv                       TO KpS.
      *
      */qE^Â̕ύXEǉ/1805
           IF ( {paNvq >= 43006 )
              INITIALIZE A^|L[
019550        MOVE {pavq TO A^|{pa
019560        MOVE {pNvq   TO A^|{pN
019570        MOVE {pvq   TO A^|{p
019580        MOVE Ҕԍvq TO A^|Ҕԍ
019590        MOVE }Ԃvq     TO A^|}
              MOVE ʂvq TO A^|ی
              MOVE 13           TO A^|R[h
              MOVE ZERO         TO A^|p
              CALL "KINUNRYO"
              CANCEL "KINUNRYO"
              MOVE A^Q|qblP       TO qblP
              MOVE A^Q|qblQ       TO qblQ
              MOVE A^|^Âbl           TO ^Âbl
              IF ( qZvq NOT = ZERO )
                 MOVE qblP              TO qP
                 MOVE qblQ              TO qQ
              END-IF
              IF ( ^v NOT = ZERO )
                 MOVE ^Âbl                TO ^
              END-IF
           END-IF.
      *
020440     MOVE Z|v                     TO v.
      */͏܂Ƃ߂̋zLڂ/120209
020450*     MOVE Z|ZSz           TO ꕔS.
020460*     MOVE Z|Zz           TO z.
           MOVE Z|ꕔS               TO ꕔS.
           MOVE Z|z                 TO z.
020310*
      *//160816
      **/t̏dxSgQÔ/150703
      *     IF ((ʂvq = 53) AND (pSҔԍvq(1:4) =  "8112"))
021370*         MOVE Z|󋋎ҕSz        TO 󋋎ҕSz
021380*         MOVE Z|z        TO z
      *         MOVE "ȕSzF"          TO ꕔSbl
      *         MOVE "SzF"          TO zbl
      *         MOVE "~" TO ꕔS~bl z~bl
      *     END-IF.
020320*------------------------------------------------------------------------------------*
020330* ʁiZȂŁA{̃Zɂ܂Ƃ߂鎞Az͏݁EKpQɏʈ󎚁j
020340*     IF ( Z܂Ƃ߃tO = "YES" )
020350*         PERFORM vZ
020360*         MOVE Av|pzVl         TO v
020370*         MOVE Av|Sz         TO ꕔS
020380*     / Z/
020390*         COMPUTE z = Av|pzVl - Av|Sz
020400*
020410*/[Q̋󔒂ɃXgOĂ܂NOT SPACE͍̎Ōɓ]LB
020411*         IF ʗ̂v NOT = SPACE
020420*            IF ( KpQv NOT = SPACE )
020430*                MOVE SPACE TO ʗ̂vQ
020440*                STRING NC""             DELIMITED BY SIZE
020450*                       ʗ̂v     DELIMITED BY SPACE
020460*                       INTO ʗ̂vQ
020470*                END-STRING
020480*                MOVE ʗ̂vQ TO KpQ(35:4)
020490*            ELSE
020500*                STRING KpQv           DELIMITED BY SPACE
020510*                       NC""             DELIMITED BY SIZE
020520*                       ʗ̂v     DELIMITED BY SPACE
020530*                       INTO KpQ
020540*                END-STRING
020550*            END-IF
020551*         END-IF
020560*     END-IF.
020570*------------------------------------------------------------------------------------*
020571*
      */VpΉς/080407
020572**------------------------------------------------------------------------*
020573** 18N6牷㪖@75~ɕύX̂߁A󎚂
020574**
020575*     IF ( {paNvq >= 41806 )
020576**
020577*        IF ( qZvq NOT = ZERO )
020578*           MOVE NC"qZ"   TO q
020579*        END-IF
020580**
020581*        IF ( 㪖@Pvq   NOT = ZERO )  OR 
020582*           ( 㪖@Qvq   NOT = ZERO )  OR 
020583*           ( 㪖@RWvq NOT = ZERO )  OR 
020584*           ( 㪖@ROvq NOT = ZERO )  OR 
020585*           ( 㪖@STvq NOT = ZERO )  OR 
020586*           ( 㪖@SWvq NOT = ZERO )  OR 
020587*           ( 㪖@SOvq NOT = ZERO )  OR 
020588*           ( 㪖@TTvq NOT = ZERO )  OR 
020589*           ( 㪖@TWvq NOT = ZERO )  OR 
020590*           ( 㪖@TOvq NOT = ZERO ) 
020591*           MOVE "75~"   TO z
020592*        END-IF
020593*     END-IF.
020594*
020595*------------------------------------------------------------------------*
      */QۘA̍یn{iEEqj{̂܂Ƃ߂Ŏ󋋎ҕSzo/220601
           IF (((|ی     = 01) AND (|یҔԍ(1:2) = "38")) OR
               ((|ی     = 05 OR 08) AND (|یҔԍ(3:2) = "38"))) AND
              (| NOT = ZERO)
              IF | = 52 OR 53 OR 55
021370           MOVE Z|ZSz           TO ꕔS
021370           MOVE Z|Zz           TO z
021370           MOVE Z|Zz     TO 󋋎ҕSzQ
037781           MOVE |pSҔԍ         TO SҔԍ 
                 IF ( 󋋎Ҕԍv(1:1) = "*"  ) OR
                    ( 󋋎Ҕԍv(1:2) = "" )
                    MOVE  SPACE               TO 󋋎Ҕԍ
                 ELSE
                    MOVE 󋋎Ҕԍv     TO 󋋎Ҕԍ
                 END-IF
                 MOVE SPACE                TO 󋋎ҔԍP
                 MOVE SPACE                TO 󋋎ҔԍR
                 PERFORM {p擾
                 MOVE {pv       TO {p
              END-IF
           END-IF.
020596*
020597*
020598**********************
020600* {pf[^Zbg *
020610**********************
           MOVE s{ihrv       TO s{ԍ.
020620     MOVE _tԍv           TO _tԍ.
020630*     MOVE z󗝔ԍv       TO z󗝔ԍ.
020640     MOVE {pX֔ԍPv     TO {pX֔ԍP.
020650     MOVE {pX֔ԍQv     TO {pX֔ԍQ.
020670     MOVE {pZPv         TO {pZP.
020680     MOVE {pZQv         TO {pZQ.
020690     MOVE ڍtԍv     TO ڍtԍ.
020700     MOVE \҃Jiv           TO \҃Ji.
020710     MOVE \Җv             TO \Җ.
020720     MOVE ڍtԍv     TO ڍtԍ.
020730     MOVE {pdbԍv       TO {pdbԍ.
020740*
020750     MOVE ڍ@v             TO ڍ@.
020760*
020770*     MOVE sxXv         TO sxX.
020780*     MOVE aʃRgv     TO a.
020790     MOVE ԍv             TO ԍ.
020800     MOVE `lJiv       TO `lJi.
020810*     MOVE `lƃJiv     TO `l.
020810     MOVE `lv           TO `l.
020820     MOVE RgPv           TO RgP.
020830     MOVE RgQv           TO RgQ.
020840     MOVE RgRv           TO RgR.
020850     MOVE RgSv           TO RgS.
020860*     MOVE RgTv           TO RgT.
           MOVE Z@֖Pv         TO Z@֖P.
           MOVE Z@֖Qv         TO Z@֖Q.
      *     MOVE Z@֖Rv         TO Z@֖R.
      *     MOVE Z@֖Sv         TO Z@֖S.
           MOVE xXPv             TO xXP.
           MOVE xXQv             TO xXQ.
      *     MOVE xXRv             TO xXR.
      *     MOVE xXSv             TO xXS.
           MOVE U`FbNv         TO U`FbN.
           MOVE ʃ`FbNv         TO ʃ`FbN.
           MOVE `FbNv         TO `FbN.
           MOVE s`FbNv         TO s`FbN.
           MOVE Ƀ`FbNv         TO Ƀ`FbN.
           MOVE _`FbNv         TO _`FbN.
           MOVE {X`FbNv         TO {X`FbN.
           MOVE xX`FbNv         TO xX`FbN.
           MOVE {x`FbNv       TO {x`FbN.
020870*
020880* / _tE҈ϔC /
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
               MOVE {pav         TO |敪
037380         READ }X^
037390         NOT INVALID KEY
037400             MOVE |   TO 󗝘a
037410         END-READ
      *         MOVE "===="             TO 󗝘a
           END-IF.
      */C/20190408
020890     MOVE _tNv             TO 󗝔N.
020900     MOVE _tv             TO 󗝌.
020910     MOVE _tv             TO 󗝓.
020920* ( ϔCN 邩 )
020930     IF ( A|ϔC  = ZERO )
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
                   MOVE {pav         TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE |   TO ϔCa
037410             END-READ
      *             MOVE "===="             TO ϔCa
               END-IF
      */C/20190408
020940         MOVE ҈ϔCNv       TO ϔCN
020950         MOVE ҈ϔCv       TO ϔC
020960         MOVE ҈ϔCv       TO ϔC
020970     END-IF.
020980*
020990* {pID
021000     MOVE {phcv           TO {phc.
021010*
021020************************
021030* ZvgяZbg *
021040************************
021050     MOVE ԌŒv          TO ԌŒ.
021060     MOVE Ԃv              TO .
021070     MOVE Ҕԍvq        TO Ҕԍ.
021080     MOVE }Ԃvq            TO }.
021090*
021100*
021110* SRg
021120*     MOVE ʃRgv      TO ʃRg.
021130*
021140**********     PERFORM eXg󎚏.
021170*-------------------------------------------------------------------------*
021180*---  ZEvăZbǵÄZbgSECTION ̍Ōɂ邱ƁI -----*
021190     PERFORM ZEvăZbg.
021200*-------------------------------------------------------------------------*
037573*
      */̍ہEސEE㍂̎Ōo߂͂ĂȂ́Ao߂/160610
           IF ((ʂvq = 05) AND (pSҔԍvq(3:2) = "20"))
016020        PERFORM oߎ擾
           END-IF.
018770     PERFORM VARYING ʂbms FROM 1 BY 1
018790             UNTIL ( ʂbms > 5 )
018820         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
018830     END-PERFORM.
021210*
021220*================================================================*
021230 ڏ SECTION.
021240*
021250     INITIALIZE {pv.
021260     INITIALIZE fҏv.
021270     INITIALIZE v.
021280     INITIALIZE lv.
021290*     INITIALIZE nbqR[hv.
021300     INITIALIZE Pvq.
021310     INITIALIZE Qvq.
021320     INITIALIZE Rvq.
021340     INITIALIZE YCH6125P.
021330     MOVE SPACE TO YCH6125P.
021350*================================================================*
021360 擾 SECTION.
021370*
           MOVE 2            TO Z|Z.
019550     MOVE {pavq TO Z|{pa.
019560     MOVE {pNvq   TO Z|{pN.
019570     MOVE {pvq   TO Z|{p.
019580     MOVE Ҕԍvq TO Z|Ҕԍ.
019590     MOVE }Ԃvq     TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
021380********************
021390* f[^Zbg *
021400********************
021410*    ****************************************************************
021420*    * ijijijɂĂ͘AڂZbg *
021430*    ****************************************************************
021440     MOVE Z|                 TO vq.
021450     IF ( Z|ԊO = 1 )
021460         MOVE NC""                   TO ԊO`FbNv
021470     END-IF.
021480     IF ( Z|x = 1 )
021490         MOVE NC""                   TO x`FbNv
021500     END-IF.
021510     IF ( Z|[ = 1 )
021520         MOVE NC""                   TO [`FbNv
021530     END-IF.
021540*
021550     MOVE Z|Z             TO  Zvq.
           MOVE Z|k           TO  kvq.
021560     MOVE Z|Č                 TO  Čvq.
021570     MOVE Z|Ë               TO  Ëvq.
021580     MOVE Z|É               TO  É񐔂vq.
021590     MOVE Z|×                 TO  ×vq.
021600     MOVE Z|ÉZ             TO  ÉZvq.
021610*
021620     IF ( Z| = 1 )
021630         MOVE NC""                   TO ԃ`FbNv
021640     END-IF.
021650     IF ( Z|\J = 1 )
021660         MOVE NC""                   TO \J`FbNv
021670     END-IF.
021680*
021690     MOVE Z|qZ         TO  qZvq.
021700*
      */qE^Â̕ύXEǉ/1805
021850     IF ( Z| >= 1 )
021860         MOVE NC""                   TO `FbNv
021870     END-IF.
021880     IF ( Z| >= 1 )
021890         MOVE NC""                   TO `FbNv
021900     END-IF.
021910     IF ( Z| >= 1 )
021920         MOVE NC""                   TO `FbNv
021930     END-IF.
           IF ( {paNvq >= 43006 )
              MOVE Z|q        TO 񐔂v
           END-IF.
           MOVE Z|^×              TO ^v.
021800*
021810     MOVE Z|{p񋟗         TO  {p񋟗vq.
021820* v
021830     MOVE Z|v                   TO vv.
021840********************
021850* 񏈒uZbg *
021860********************
021870     PERFORM VARYING ʂbms FROM 1 BY 1
021880             UNTIL ( ʂbms > ʐv )
021890         MOVE Z|񏈒u(ʂbms) TO 񏈒uvq(ʂbms)
021900         IF ( Z|񏈒u(ʂbms) NOT = ZERO )
021910            EVALUATE |(ʂbms)
021920* PEŖoE
021930            WHEN 1
021940            WHEN 2
021950            WHEN 3
021960                MOVE NC""       TO {×`FbNv
021970* EPE܁E܍Sk
021980            WHEN 4
021990            WHEN 5
022000            WHEN 7
022010                MOVE NC""       TO `FbNv
022020* sS܁EsS܍Sk
022030            WHEN 6
022040            WHEN 8
022050                MOVE NC""       TO Œ藿`FbNv
022060            END-EVALUATE
022070         END-IF
022080     END-PERFORM.
022090     MOVE Z|񏈒uv         TO 񏈒uvv.
022100********************
022110* Zbg *
022120********************
022130*    **********
022140*    * P *
022150*    **********
022160     MOVE Z|ÒPP             TO ÒPPvq.
022170     MOVE Z|É񐔂P             TO É񐔂Pvq.
022180     MOVE Z|×P               TO ×Pvq.
022190     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
022200     MOVE Z|㪖@P             TO 㪖@Pvq.
022210     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
022220     MOVE Z|㪖@P             TO 㪖@Pvq.
022230     MOVE Z|dÉ񐔂P             TO dÉ񐔂Pvq.
022240     MOVE Z|d×P               TO d×Pvq.
022250     MOVE Z|vP                 TO vPvq.
022260     MOVE Z|P           TO Pvq.
022270     MOVE Z|vP           TO vPvq.
022280*    **********
022290*    * Q *
022300*    **********
022310     MOVE Z|ÒPQ             TO ÒPQvq.
022320     MOVE Z|É񐔂Q             TO É񐔂Qvq.
022330     MOVE Z|×Q               TO ×Qvq.
022340     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
022350     MOVE Z|㪖@Q             TO 㪖@Qvq.
022360     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
022370     MOVE Z|㪖@Q             TO 㪖@Qvq.
022380     MOVE Z|dÉ񐔂Q             TO dÉ񐔂Qvq.
022390     MOVE Z|d×Q               TO d×Qvq.
022400     MOVE Z|vQ                 TO vQvq.
022410     MOVE Z|Q           TO Qvq.
022420     MOVE Z|vQ           TO vQvq.
022430*    ****************
022440*    * Rʁ^W *
022450*    ****************
022460     MOVE Z|ÒPRW             TO ÒPRWvq.
022470     MOVE Z|É񐔂RW             TO É񐔂RWvq.
022480     MOVE Z|×RW               TO ×RWvq.
022490     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
022500     MOVE Z|㪖@RW             TO 㪖@RWvq.
022510     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
022520     MOVE Z|㪖@RW             TO 㪖@RWvq.
022530     MOVE Z|dÉ񐔂RW             TO dÉ񐔂RWvq.
022540     MOVE Z|d×RW               TO d×RWvq.
022550     MOVE Z|vRW                 TO vRWvq.
022560     MOVE Z|ʍvRW         TO ʍvRWvq.
022570     MOVE Z|RW           TO RWvq.
022580     MOVE Z|vRW           TO vRWvq.
022590*    ****************
022600*    * Rʁ^10 *
022610*    ****************
022620     MOVE Z|JnRO           TO JnROvq.
022630     MOVE Z|JnRO           TO JnROvq.
022640     MOVE Z|ÒPRO             TO ÒPROvq.
022650     MOVE Z|É񐔂RO             TO É񐔂ROvq.
022660     MOVE Z|×RO               TO ×ROvq.
022670     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
022680     MOVE Z|㪖@RO             TO 㪖@ROvq.
022690     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
022700     MOVE Z|㪖@RO             TO 㪖@ROvq.
022710     MOVE Z|dÉ񐔂RO             TO dÉ񐔂ROvq.
022720     MOVE Z|d×RO               TO d×ROvq.
022730     MOVE Z|vRO                 TO vROvq.
022740     MOVE Z|RO           TO ROvq.
022750     MOVE Z|vRO           TO vROvq.
022760*    ****************
022770*    * Sʁ^T *
022780*    ****************
022790     MOVE Z|ÒPST             TO ÒPSTvq.
022800     MOVE Z|É񐔂ST             TO É񐔂STvq.
022810     MOVE Z|×ST               TO ×STvq.
022820     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
022830     MOVE Z|㪖@ST             TO 㪖@STvq.
022840     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
022850     MOVE Z|㪖@ST             TO 㪖@STvq.
022860     MOVE Z|dÉ񐔂ST             TO dÉ񐔂STvq.
022870     MOVE Z|d×ST               TO d×STvq.
022880     MOVE Z|vST                 TO vSTvq.
022890     MOVE Z|ʍvST         TO ʍvSTvq.
022900     MOVE Z|ST           TO STvq.
022910     MOVE Z|vST           TO vSTvq.
022920*    ****************
022930*    * Sʁ^W *
022940*    ****************
022950     MOVE Z|JnSW           TO JnSWvq.
022960     MOVE Z|JnSW           TO JnSWvq.
022970     MOVE Z|ÒPSW             TO ÒPSWvq.
022980     MOVE Z|É񐔂SW             TO É񐔂SWvq.
022990     MOVE Z|×SW               TO ×SWvq.
023000     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
023010     MOVE Z|㪖@SW             TO 㪖@SWvq.
023020     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
023030     MOVE Z|㪖@SW             TO 㪖@SWvq.
023040     MOVE Z|dÉ񐔂SW             TO dÉ񐔂SWvq.
023050     MOVE Z|d×SW               TO d×SWvq.
023060     MOVE Z|vSW                 TO vSWvq.
023070     MOVE Z|ʍvSW         TO ʍvSWvq.
023080     MOVE Z|SW           TO SWvq.
023090     MOVE Z|vSW           TO vSWvq.
023100*    ****************
023110*    * Sʁ^10 *
023120*    ****************
023130     MOVE Z|JnSO           TO JnSOvq.
023140     MOVE Z|JnSO           TO JnSOvq.
023150     MOVE Z|ÒPSO             TO ÒPSOvq.
023160     MOVE Z|É񐔂SO             TO É񐔂SOvq.
023170     MOVE Z|×SO               TO ×SOvq.
023180     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
023190     MOVE Z|㪖@SO             TO 㪖@SOvq.
023200     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
023210     MOVE Z|㪖@SO             TO 㪖@SOvq.
023220     MOVE Z|dÉ񐔂SO             TO dÉ񐔂SOvq.
023230     MOVE Z|d×SO               TO d×SOvq.
023240     MOVE Z|vSO                 TO vSOvq.
023250     MOVE Z|SO           TO SOvq.
023260     MOVE Z|vSO           TO vSOvq.
023270*    *****************
023280*    * Tʁ^2.5 *
023290*    *****************
023300     MOVE Z|ÒPTQ             TO ÒPTQvq.
023310     MOVE Z|É񐔂TQ             TO É񐔂TQvq.
023320     MOVE Z|×TQ               TO ×TQvq.
023330     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
023340     MOVE Z|㪖@TQ             TO 㪖@TQvq.
023350     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
023360     MOVE Z|㪖@TQ             TO 㪖@TQvq.
023370     MOVE Z|dÉ񐔂TQ             TO dÉ񐔂TQvq.
023380     MOVE Z|d×TQ               TO d×TQvq.
023390     MOVE Z|vTQ                 TO vTQvq.
023400     MOVE Z|ʍvTQ         TO ʍvTQvq.
023410     MOVE Z|TQ           TO TQvq.
023420     MOVE Z|vTQ           TO vTQvq.
023430*    ****************
023440*    * Tʁ^T *
023450*    ****************
023460     MOVE Z|JnTT           TO JnTTvq.
023470     MOVE Z|JnTT           TO JnTTvq.
023480     MOVE Z|ÒPTT             TO ÒPTTvq.
023490     MOVE Z|É񐔂TT             TO É񐔂TTvq.
023500     MOVE Z|×TT               TO ×TTvq.
023510     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
023520     MOVE Z|㪖@TT             TO 㪖@TTvq.
023530     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
023540     MOVE Z|㪖@TT             TO 㪖@TTvq.
023550     MOVE Z|dÉ񐔂TT             TO dÉ񐔂TTvq.
023560     MOVE Z|d×TT               TO d×TTvq.
023570     MOVE Z|vTT                 TO vTTvq.
023580     MOVE Z|ʍvTT         TO ʍvTTvq.
023590     MOVE Z|TT           TO TTvq.
023600     MOVE Z|vTT           TO vTTvq.
023610*    ****************
023620*    * Tʁ^W *
023630*    ****************
023640     MOVE Z|JnTW           TO JnTWvq.
023650     MOVE Z|JnTW           TO JnTWvq.
023660     MOVE Z|ÒPTW             TO ÒPTWvq.
023670     MOVE Z|É񐔂TW             TO É񐔂TWvq.
023680     MOVE Z|×TW               TO ×TWvq.
023690     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
023700     MOVE Z|㪖@TW             TO 㪖@TWvq.
023710     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
023720     MOVE Z|㪖@TW             TO 㪖@TWvq.
023730     MOVE Z|dÉ񐔂TW             TO dÉ񐔂TWvq.
023740     MOVE Z|d×TW               TO d×TWvq.
023750     MOVE Z|vTW                 TO vTWvq.
023760     MOVE Z|ʍvTW         TO ʍvTWvq.
023770     MOVE Z|TW           TO TWvq.
023780     MOVE Z|vTW           TO vTWvq.
023790*    ****************
023800*    * Tʁ^10 *
023810*    ****************
023820     MOVE Z|JnTO           TO JnTOvq.
023830     MOVE Z|JnTO           TO JnTOvq.
023840     MOVE Z|ÒPTO             TO ÒPTOvq.
023850     MOVE Z|É񐔂TO             TO É񐔂TOvq.
023860     MOVE Z|×TO               TO ×TOvq.
023870     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
023880     MOVE Z|㪖@TO             TO 㪖@TOvq.
023890     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
023900     MOVE Z|㪖@TO             TO 㪖@TOvq.
023910     MOVE Z|dÉ񐔂TO             TO dÉ񐔂TOvq.
023920     MOVE Z|d×TO               TO d×TOvq.
023930     MOVE Z|vTO                 TO vTOvq.
023940     MOVE Z|TO           TO TOvq.
023950     MOVE Z|vTO           TO vTOvq.
      */2022
           MOVE Z|׏sZ         TO ׏sZvq.
           MOVE Z|׏sZ         TO ׏sZvq.
           IF Z|׏sZ NOT = ZERO
               STRING "׏s̐Z"     DELIMITED BY SIZE
                      ׏sZvq     DELIMITED BY SIZE
                      "~ Z"              DELIMITED BY SIZE
                      ׏sZvq     DELIMITED BY SIZE
                      ""                     DELIMITED BY SIZE
                 INTO KpRv
               END-STRING
           END-IF.
023960*
023970*================================================================*
023980 {p擾 SECTION.
023990*
024000**************************************************
024010* {@f[^gpAȉ̏擾           *
024020*  _tԍ.. _tԍvɊi[             *
024030*  ԍ ... ڍtԍvɊi[       *
024040*  \Җ ... \ҖvɊi[               *
024050*  Z1,2   ...{pZ1,2vɊi[          *
024060*  dbԍ ... {pdbԍvɊi[         *
024070**************************************************
024080     MOVE ZERO  TO {|{pԍ.
024090     READ {p}X^
024100     INVALID KEY
024110         CONTINUE
024120     NOT INVALID KEY
024130*
               MOVE {|s{ihr     TO s{ihrv
024170         MOVE {|V_tԍ       TO _tԍv
024190*
024200*         MOVE {|ڍtԍ  TO nbqڍtԍv
024210*
024220         STRING "-"                DELIMITED BY SIZE
024230                {|ڍtԍ DELIMITED BY SPACE
024240           INTO ڍtԍv
024250         END-STRING
024260*
024270         MOVE {|X֔ԍP        TO {pX֔ԍPv
024280         MOVE {|X֔ԍQ        TO {pX֔ԍQv
024290         MOVE {|\҃Ji        TO \҃Jiv
024300         MOVE {|\Җ          TO \Җv
024310*
024320         MOVE {|ڍ@          TO ڍ@v
024330*
024340*         STRING {|ZP  DELIMITED BY SPACE
024350*                {|ZQ  DELIMITED BY SPACE
024360*           INTO {pZv
024370*         END-STRING
024380         MOVE {|ZP            TO {pZPv
024390         MOVE {|ZQ            TO {pZQv
024410         MOVE {|dbԍ          TO {pdbԍv
024420**
024430** U
024440** Vl̎sԍ 2713XXXX() ̎A}X^
024450         IF ( pSҔԍvq(3:2) = "13" )
024700             MOVE ZERO             TO  |_I敪
024690             MOVE 13               TO  |R[h
024700             MOVE ZERO             TO  |ی
024710             MOVE {paNvq TO  |ύXaN
024720             START }X^ KEY IS <  |_I敪
034410                                          |R[h
                                                |ی
                                                |ύXaN
034420                                          REVERSED
034430             END-START
034440             IF ( ԃL[ = "00" )
034450                 MOVE SPACE  TO ItOR
034460                 READ }X^ NEXT
                       END-READ
024510                 MOVE |s      TO sv
024520                 MOVE |sxX  TO sxXv
024530                 MOVE |a          TO aʂv
024540                 MOVE |ԍ          TO ԍv
024550*                 MOVE |`l        TO `lƃJiv
024550                 MOVE |`l        TO `lv
024560                 MOVE |`lJi    TO `lJiv
024570                 EVALUATE aʂv
024580                 WHEN 1
024590                     MOVE "()"  TO aʃRgwv
024600                 WHEN 2
024610                     MOVE "()"  TO aʃRgwv
024620                 WHEN OTHER
024630                     MOVE SPACE   TO aʃRgwv
024640                 END-EVALUATE
024650*
024660                 STRING sv       DELIMITED BY SPACE
024670                        " "                  DELIMITED BY SIZE
024680                        sxXv   DELIMITED BY SPACE
024690                        "  "                 DELIMITED BY SIZE
024700                        aʃRgwv DELIMITED BY SPACE
024710                        " "                  DELIMITED BY SIZE
024720                        |ԍ       DELIMITED BY SPACE
024730                        INTO sxXv
024740                 END-STRING
024750             END-IF
024760* Œ
024917*             MOVE "܂A擾Lz̎̂A" TO  RgPv
024918*             MOVE "L()ڍtɈϔC"   TO  RgQv
024919*             MOVE "܂B"                             TO  RgRv
025080             MOVE "܂A擾Lz̎̂A" TO  RgPv
025090             MOVE "()ڍt  i"       TO  RgQv
025100             MOVE "(s搬2-9-5)ɈϔC"        TO  RgRv
025100             MOVE "܂B"                             TO  RgSv
024930** ȊO
024940         ELSE
024950             MOVE {|s      TO sv
024960             MOVE {|sxX  TO sxXv
024970             MOVE {|a          TO aʂv
024980             MOVE {|ԍ          TO ԍv
024990             MOVE {|`l        TO `lv
                   MOVE {|`lJi    TO `lJiv
025000             STRING sv     DELIMITED BY SPACE
025010                    " "                DELIMITED BY SIZE
025020                    sxXv DELIMITED BY SPACE
025030                    INTO sxXv
025040             END-STRING
025050*             STRING `lv           DELIMITED BY SPACE
025060*                    "  "                   DELIMITED BY SIZE
025070*                    {|`lJi   DELIMITED BY SIZE
025080*                    INTO `lƃJiv
025090*             END-STRING
025100             EVALUATE aʂv
025110             WHEN 1
025120                 MOVE NC"ij" TO aʃRgv
025130             WHEN 2
025140                 MOVE NC"ij" TO aʃRgv
025150             WHEN OTHER
025160                 MOVE SPACE      TO aʃRgv
025170             END-EVALUATE
025180         END-IF
025190*
      */͐ÛݑΉ
               MOVE NC"" TO U`FbNv
      *
               EVALUATE aʂv
               WHEN 1
                   MOVE NC"" TO ʃ`FbNv
               WHEN 2
                   MOVE NC"" TO `FbNv
               END-EVALUATE
      *
009745         IF sv NOT = SPACE
009746            PERFORM VARYING JE^ FROM 40 BY -1
009747                      UNTIL (sv(JE^:1) NOT = SPACE) OR
009748                            (JE^ <= ZERO)
009749                CONTINUE
009750            END-PERFORM
009751            IF JE^ > 4
009752               IF sv(JE^ - 3 : 4)  = "s"
009753                  MOVE  sv(1:JE^ - 4)   TO Z@֖v
009754                  MOVE NC"" TO s`FbNv
009755               ELSE
009756                  IF sv(JE^ - 3 : 4)  = ""
009757                     MOVE  sv(1:JE^ - 4)   TO Z@֖v
009758                     MOVE NC"" TO Ƀ`FbNv
009759                  ELSE
009760                     IF sv(JE^ - 3 : 4)  = "_"
009761                        MOVE  sv(1:JE^ - 4)   TO Z@֖v
009762                        MOVE NC"" TO _`FbNv
009763                     ELSE
009764                        MOVE  sv  TO Z@֖v
009765                     END-IF
009766                  END-IF
009767               END-IF
009768            ELSE
009769               MOVE  sv  TO Z@֖v
009770            END-IF
009771         END-IF
009779*
009780         IF sxXv NOT = SPACE
009781            PERFORM VARYING JE^ FROM 40 BY -1
009782                      UNTIL (sxXv(JE^:1) NOT = SPACE) OR
009783                            (JE^ <= ZERO)
009784                CONTINUE
009785            END-PERFORM
009786            IF JE^ >= 4
009787               IF sxXv(JE^ - 3 : 4)  = "{X"
009788                  MOVE  sxXv(1:JE^ - 4)   TO xXv
009789                  MOVE NC"" TO {X`FbNv
009790               ELSE
009791                  IF sxXv(JE^ - 3 : 4)  = "xX"
009792                     MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                     MOVE NC"" TO xX`FbNv
009794                  ELSE
009791                     IF sxXv(JE^ - 3 : 4)  = "x"
009792                        MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                        MOVE NC"" TO {x`FbNv
009794                     ELSE
009791                         IF sxXv(JE^ - 3 : 4)  = "{"
009792                            MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                            MOVE NC"" TO {x`FbNv
009794                         ELSE
009800                             MOVE  sxXv  TO xXv
009801                         END-IF
009804                     END-IF
009805                  END-IF
009806               END-IF
009807            ELSE
009808               MOVE  sxXv  TO xXv
009809            END-IF
009810         END-IF
      *
025200     END-READ.
025210*
025220*********************************************
025230** hcǗ}X^@{phc擾B
025240*********************************************
025250** {pID
025260     MOVE 01                   TO hcǁ|hc敪
025270     MOVE ZERO                 TO hcǁ|{pԍ
025280     MOVE pSҔԍvq(3:2)  TO hcǁ|ی
025290     MOVE SPACE                TO hcǁ|یҔԍ
025300     READ hcǗ}X^
025310     NOT INVALID KEY
025320          MOVE hcǁ|{phcԍ   TO {phcv
025330     END-READ.
025340*
025350*================================================================*
025360 fҏ擾 SECTION.
025370*
025380**************************************************
025390* Af[^fҏeȉ̏擾 *
025400*  {pN ..... {pNvɊi[                 *
025410*  {p ..... {pvɊi[                 *
025420*  Ҕԍ.... ҔԍvɊi[ecAԗp   *
025430*  L ....... LvɊi[                   *
025440*  ԍ ....... ԍvɊi[                   *
025450*  یҔԍ . یҔԍvɊi[             *
025460*  ی ... یʂvɊi[               *
025470*  ی҃Ji.ی҃JivɊi[           *
025480*  یҎ.یҎvɊi[           *
025490*  ZP ......یҏZPvɊi[         *
025500*  ZQ ......یҏZQvɊi[         *
025510*  ҃Ji ....҃JivɊi[               *
025520*  Ҏ ....ҎvɊi[               *
025530*  Ґ ....敪ɂ`FbN""i[ *
025540*  Ҙa ....aɂ`FbN""i[ *
025550*  ҔN ......ҔNvɊi[                 *
025560*  Ҍ ......ҌvɊi[                 *
025570*  ғ ......ғvɊi[                 *
025580*   ........̃}X^葱vɎ擾     *
025590**************************************************
025600     MOVE {pavq       TO |{pa.
025610     MOVE {pNvq         TO |{pN.
025620     MOVE {pvq         TO |{p.
025630     MOVE ҃R[hvq     TO |҃R[h.
025640     READ fҏe
025650     INVALID KEY
025660         CONTINUE
025670*            /* 肦Ȃ */
025680     NOT INVALID KEY
022660         EVALUATE |ی
022670         WHEN 01
022690            MOVE NC""        TO ۃ`FbNv
022700         WHEN 02
022710         WHEN 06
022750         WHEN 07
022720            MOVE NC""        TO Еۃ`FbNv
022730         WHEN 03
022740            MOVE NC""        TO g`FbNv
022750*         WHEN 07
022760*            MOVE NC""        TO D`FbNv
               WHEN 04
                  MOVE NC""        TO σ`FbNv
               WHEN 09
                  MOVE NC""        TO `FbNv
               WHEN 08
                  MOVE NC""        TO ސE`FbNv
               WHEN 05
                  MOVE NC""        TO `FbNv
022770         END-EVALUATE
      *
               IF | = ZERO
                   MOVE NC"" TO Pƃ`FbNv
               ELSE
                   MOVE NC"" TO Q`FbNv
               END-IF
      */QۘA̍یn{Ŗ{̃Z͒PƂɁ/20201029
               IF (((|ی     = 01) AND (|یҔԍ(1:2) = "38")) OR
                   ((|ی     = 05 OR 08) AND (|یҔԍ(3:2) = "38"))) AND
                  (| NOT = ZERO)
      */QۘA̍یn{iEEqj͖{̂܂Ƃ߂łQɁ/220601
                  IF | = 52 OR 53 OR 55
                     MOVE SPACE  TO Pƃ`FbNv
                     MOVE NC"" TO Q`FbNv
                  ELSE
                     MOVE NC"" TO Pƃ`FbNv
                     MOVE SPACE  TO Q`FbNv
                  END-IF
               END-IF
      */{Ƌ敪͂ǂꂩPɁB
               IF |ی = 05
                   EVALUATE |ʋ敪
                   WHEN 1
                   WHEN 2
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
                   END-EVALUATE
               ELSE
028984             EVALUATE |ʋ敪
                   WHEN 1
                   WHEN 2
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
028991             WHEN 6
                       MOVE NC"" TO U΃`FbNv
                   WHEN OTHER
                       IF |{lƑ敪 = 1
                           MOVE NC"" TO {l`FbNv
                       ELSE
                           MOVE NC"" TO Ƒ`FbNv
                       END-IF
028999             END-EVALUATE
               END-IF
      */tt/110721
      *         IF |ی = 01 OR 08
                   EVALUATE Z|t
                   WHEN 10
                       MOVE NC"" TO PO`FbNv
                   WHEN 9
                       MOVE NC"" TO X`FbNv
      */̑OP͂WtɁ/110721
                       IF (|ی NOT = 05 ) AND (|ʋ敪 = 1)
                           MOVE SPACE  TO X`FbNv
                           MOVE NC"" TO W`FbNv
                       END-IF
                   WHEN 8
                       MOVE NC"" TO W`FbNv
                   WHEN 7
                       MOVE NC"" TO V`FbNv
                   END-EVALUATE
      *         END-IF
      */C/20190408
               MOVE |{pa     TO {pav
025690         MOVE |{pN       TO {pNv
025700         MOVE |{p       TO {pv
025710         MOVE |Ҕԍ     TO Ҕԍv
025720*         MOVE |L         TO Lv
025730*         MOVE |ԍ         TO ԍv
      *-----------------------------------------------------------------*
               MOVE SPACE TO AÍ|Í
      *
      *        / AÍ|͏Zbg /
               MOVE |L       TO AÍ|L
               MOVE |ԍ       TO AÍ|ԍ
               MOVE |Í TO AÍ|Í
      *
               CALL   vOv
               CANCEL vOv
      *
               MOVE AÍ|L TO Lv
               MOVE AÍ|ԍ TO ԍv
      *
      *-----------------------------------------------------------------*
025740         MOVE |یҔԍ   TO یҔԍv
025750         MOVE |ی     TO یʂv
025760** Sy؂̎}ԍ폜
025770         IF ( |ی = 01 ) AND ( |یҔԍ(1:6) = "133033" )
025780            MOVE |یҔԍ(1:6)  TO یҔԍv
025790         END-IF
025800**
025810         MOVE |یҎ TO یҎv
025820         MOVE |X֔ԍP   TO X֔ԍPv
025830         MOVE |X֔ԍQ   TO X֔ԍQv
025840         MOVE |ZP       TO یҏZPv
025850         MOVE |ZQ       TO یҏZQv
      */ dbԍǉ /42505
               IF |dbԍ NOT = SPACE
                  STRING "db:"        DELIMITED BY SIZE
                         |dbԍ   DELIMITED BY SPACE
                    INTO dbԍv
                  END-STRING
               ELSE
                  IF |ғdbԍ NOT = SPACE
                     STRING "db:"            DELIMITED BY SIZE
                            |ғdbԍ   DELIMITED BY SPACE
                       INTO dbԍv
                     END-STRING
                  END-IF
               END-IF
025820         MOVE |җX֔ԍP     TO X֔ԍPv
025830         MOVE |җX֔ԍQ     TO X֔ԍQv
               MOVE |ҏZP         TO ҏZPv
               MOVE |ҏZQ         TO ҏZQv
025940         MOVE |҃Ji           TO ҃Jiv
025950         MOVE |Ҏ           TO Ҏv
025960         MOVE |pSҔԍ TO sԍv
037782         MOVE |vҔԍ     TO 󋋎Ҕԍv
025970         MOVE |pSҔԍ     TO sԍv
025980         MOVE |vҔԍVl     TO 󋋎Ҕԍv
025990*
026000         EVALUATE |Ґ
026010         WHEN 1
026020             MOVE NC"j"  TO ʂv
026030             MOVE NC""  TO j`FbNv
026040         WHEN 2
026050             MOVE NC""  TO ʂv
026060             MOVE NC""  TO `FbNv
026070         END-EVALUATE
026080         EVALUATE |Ҙa
026090         WHEN 1
026100             MOVE NC""  TO v
026110             MOVE NC""    TO `FbNv
026120         WHEN 2
026130             MOVE NC"吳"  TO v
026140             MOVE NC""    TO 吳`FbNv
026150         WHEN 3
026160             MOVE NC"a"  TO v
026170             MOVE NC""    TO a`FbNv
026180         WHEN 4
026190             MOVE NC""  TO v
026200             MOVE NC""    TO `FbNv
      */C/20190408
023060         WHEN 5
                   MOVE "5"   TO ߘablv
023070             MOVE NC""  TO ߘa`FbNv
026210         END-EVALUATE
026220*
      */C/20190408
029310         IF |Ҙa > 4
037370             MOVE |Ҙa     TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE | TO v
037410             END-READ
029330         END-IF
      */C/20190408
026230         MOVE |ҔN  TO ҔNv
026240         MOVE |Ҍ  TO Ҍv
026250         MOVE |ғ  TO ғv
026260* Ȃ
026270*         IF ( {lƑ敪vq = 1 )
026280*             MOVE SPACE       TO v
026290*         ELSE
026300*             MOVE 05          TO |敪R[h
026310*             MOVE |    TO |̃R[h
026320*             READ ̃}X^
026330*             INVALID KEY
026340*                 MOVE SPACE    TO v
026350*             NOT INVALID KEY
026360*                 MOVE | TO v
026370*             END-READ
026380*         END-IF
026390*
026400**
026410         IF ( | NOT = ZERO )
026420            PERFORM Z܂Ƃߔ
026430         ELSE
026440            MOVE SPACE TO Z܂Ƃ߃tO
026450         END-IF
               IF (| = 54) AND (|pSҔԍ(1:2) = "19")
                   MOVE |pSҔԍ TO SҔԍ 
                   MOVE |vҔԍ     TO 󋋎Ҕԍ
               END-IF
031450* 15/7`@@
031460         IF |{paN >= 41507
031470            IF ( | = 52 OR 53 OR 55 ) AND
031480               ( |{ = 20 ) AND
031490               ( |iؖ敪 NOT = 1 ) AND
031500               ( Z|ꕔS NOT = ZERO )
031510*
031520*               MOVE |vҔԍ(1:3)   TO 󋋎ҔԍҏWvP
031530*               MOVE |vҔԍ(4:2)   TO 󋋎ҔԍҏWvQ
031540*               MOVE |vҔԍ(6:10)  TO 󋋎ҔԍҏWvR
031550*               MOVE "-"  TO 󋋎ҋ؂P 󋋎ҋ؂Q
016580               IF ( |pSҔԍ(1:2) NOT = "99" )
042910                  MOVE |pSҔԍ    TO SҔԍ 
016620               END-IF
                     IF |vҔԍ(9:7) NOT = SPACE
                        MOVE |vҔԍ(1:8)  TO 󋋎ҔԍP
                        MOVE |vҔԍ(9:7)  TO 󋋎ҔԍR
                     ELSE
                        MOVE |vҔԍ(1:7)  TO 󋋎Ҕԍ
                     END-IF
031560            END-IF
031570         END-IF
026460**
026470* 14/10`@ʋ敪Rg
026541         EVALUATE |ʋ敪
026542         WHEN 2
026543             MOVE "Q"   TO ʃRgv
026544         WHEN 3
026545             MOVE "R"   TO ʃRgv
026546         WHEN OTHER
026547             MOVE "P"   TO ʃRgv
026548         END-EVALUATE
026570*
026580     END-READ.
026590*
026600*================================================================*
026610 擾 SECTION.
026620*
026630****************************************************
026640* Af[^ی҃}X^萿擾B *
026650* ہ|敪=1̏ꍇ}X^gp   *
026660*  ...... 於̂vɊi[               *
026670****************************************************
026680     MOVE یʂvq       TO s|.
026690     MOVE یҔԍvq     TO s|sԍ.
026700     READ s}X^
026710     INVALID KEY
026720         MOVE SPACE          TO 於̂v
026730     NOT INVALID KEY
026840         MOVE s|s  TO 於̂v
026860     END-READ.
026870* 
027590*================================================================*
027600 Ǎ SECTION.
027610*
027790     MOVE {pavq       TO |{pa.
027800     MOVE {pNvq         TO |{pN.
027810     MOVE {pvq         TO |{p.
027820     MOVE ҃R[hvq     TO |҃R[h.
027830     READ f[^e
027870     NOT INVALID KEY
027900         MOVE |ʐ                   TO ʐv
           END-READ.
026880*================================================================*
026890 f[^擾 SECTION.
026900*
026910**************************************************
026920* Af[^畉f[^eȉ̏擾 *
026930*  ...ʁ{ʂɂĉHĊi[     *
026940*  N.......Nv                       *
026950*  .......v                       *
026960*  .......v                       *
026970*  JnN.......Nv                       *
026980*  Jn.......v                       *
026990*  Jn.......v                       *
027000*  IN.......INv                       *
027010*  I.......Iv                       *
027020*  I.......Iv                       *
027030*  .......v                       *
027040*  ]A敪 ....敪ɂ`FbN""i[ *
027050*  q ....敪ɂ`FbN""i[ *
027060*  o߃R[h...o߃}X^擾             *
027070**************************************************
027080*     MOVE {pavq       TO |{pa.
027090*     MOVE {pNvq         TO |{pN.
027100*     MOVE {pvq         TO |{p.
027110*     MOVE ҃R[hvq     TO |҃R[h.
027120*     READ f[^e
027130*     INVALID KEY
027140*         CONTINUE
027150**            /* 肦Ȃ */
027160*     NOT INVALID KEY
027170*         MOVE |ʐ                   TO ʐv
027180         PERFORM VARYING ʂbms FROM 1 BY 1
027190                 UNTIL ( ʂbms > ʐv )
027200             MOVE |(ʂbms) TO ʂv(ʂbms)
027210             MOVE |(ʂbms)     TO ʂv(ʂbms)
027220             MOVE |E敪(ʂbms) TO E敪v(ʂbms)
027230             MOVE |ʒuԍ(ʂbms)
027240                                           TO ʒuԍv(ʂbms)
027250*********************************************
027260* jS_...ʁ{ʂɂĉHĊi[ *
027270*********************************************
027280* 
027290             MOVE SPACE                     TO ̂v
027300             MOVE 03                        TO |敪R[h
027310             MOVE |(ʂbms)  TO |̃R[h
027320             READ ̃}X^
027330             INVALID KEY
027340                 MOVE SPACE        TO ̂v
027350             NOT INVALID KEY
027360                 MOVE | TO ̂v
027370             END-READ
027380* 
020710             MOVE SPACE                    TO v(ʂbms)
028160*
028170             PERFORM ʖ̖
027570*
027580             MOVE |N(ʂbms)   TO Nv(ʂbms)
027590             MOVE |(ʂbms)   TO v(ʂbms)
027600             MOVE |(ʂbms)   TO v(ʂbms)
027610             MOVE |JnN(ʂbms)   TO Nv(ʂbms)
027620             MOVE |Jn(ʂbms)   TO v(ʂbms)
027630             MOVE |Jn(ʂbms)   TO v(ʂbms)
027640             IF ( |]A敪(ʂbms) = 9 )
027650                 MOVE 99                   TO INv(ʂbms)
027660                 MOVE 99                   TO Iv(ʂbms)
027670                 MOVE 99                   TO Iv(ʂbms)
027680             ELSE
027690                 MOVE |IN(ʂbms)   TO INv(ʂbms)
027700                 MOVE |I(ʂbms)   TO Iv(ʂbms)
027710                 MOVE |I(ʂbms)   TO Iv(ʂbms)
027720             END-IF
027730* oߗ̎擾
027740             MOVE 01                         TO o|敪R[h
027750             MOVE |o߃R[h(ʂbms) TO o|o߃R[h
027760             READ o߃}X^
027770             INVALID KEY
027780                 MOVE ZERO            TO ʂbmsv(ʂbms)
027790                 MOVE SPACE           TO ʋ؂v(ʂbms)
027800                 MOVE SPACE           TO oߗ̂v(ʂbms)
027810             NOT INVALID KEY
027820*
027830                 EVALUATE ʂbms
027840                 WHEN 1
027850                     MOVE NC"@" TO oߕʂv
027860                 WHEN 2
027870                     MOVE NC"A" TO oߕʂv
027880                 WHEN 3
027890                     MOVE NC"B" TO oߕʂv
027900                 WHEN 4
027910                     MOVE NC"C" TO oߕʂv
027920                 WHEN 5
027930                     MOVE NC"D" TO oߕʂv
027940                 END-EVALUATE
027950                 STRING  oߕʂv     DELIMITED BY SPACE
027960                         o|oߗ   DELIMITED BY SPACE
027970                        INTO oߗ̂v(ʂbms)
027980                 END-STRING
027990*
028000             END-READ
028010*
028020             MOVE |]A敪(ʂbms) TO ]A敪v(ʂbms)
028030             EVALUATE |]A敪(ʂbms)
028040             WHEN 1
028050             WHEN 2
028060                 MOVE NC""               TO `FbNv(ʂbms)
028070             WHEN 3
028080                 MOVE NC""               TO ~`FbNv(ʂbms)
028090             WHEN 4
028100                 MOVE NC""               TO ]`FbNv(ʂbms)
028110             END-EVALUATE
028120*
      */̓Z|ʎ]L/160816
031230             MOVE Z|ʎ(ʂbms) TO v(ʂbms)
028130         END-PERFORM.
028140* VK/p `FbN
033380         EVALUATE Z|Z敪
               WHEN 1
033390             MOVE NC""                   TO VK`FbNv
               WHEN 2
033410             MOVE NC""                   TO p`FbNv
033400         WHEN 3
033390             MOVE NC""                   TO VK`FbNv
033410             MOVE NC""                   TO p`FbNv
               WHEN OTHER
033410             MOVE NC""                   TO p`FbNv
033420         END-EVALUATE.
028200* }Ԕp
028210         MOVE |JnfÓ蓮敪 TO  JnfÓ蓮敪v.
028220*
028230* 敪
028240         MOVE |Z敪 TO Z敪v.
028370* R敪
027880         MOVE |ZR敪     TO R敪e.
028250*
028260*     END-READ.
028270*================================================================*
028280*================================================================*
028290 {pL^擾 SECTION.
028300*
028310************************************************************
028320* Pf[^畉f[^eȉ̏擾           *
028330*  Z .....敪ɂ`FbN""i[... *
028340*  ÉZ .....敪ɂ`FbN""i[... *
028350************************************************************
028360     MOVE  SPACE  TO  ČtO.
028370     PERFORM VARYING ʂbms FROM 1 BY 1 UNTIL ʂbms > ʐv
028380         IF ( {pNv = Nv(ʂbms) ) AND
028390            ( {pv = v(ʂbms) )
028400             MOVE Ҕԍvq          TO {L|Ҕԍ
028410             MOVE }Ԃvq              TO {L|}
028420             MOVE {pavq          TO {L|{pa
028430             MOVE Nv(ʂbms)  TO JnNv(ʂbms) {L|{pN
028440             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
028450             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
028460         ELSE
028470             MOVE Ҕԍvq          TO {L|Ҕԍ
028480             MOVE }Ԃvq              TO {L|}
028490             MOVE {pavq          TO {L|{pa
028500             MOVE {pNvq            TO {L|{pN
028510             MOVE {pvq            TO {L|{p
028520             MOVE ZERO                  TO {L|{p
028530         END-IF
028540         START {pL^e   KEY IS >= {L|҃R[h
028550                                      {L|{paN
028560         END-START
028570         IF ( ԃL[ = "00" )
      */̓Z|ʎ]L/160816
028580*             MOVE ZERO  TO v(ʂbms)
028590             MOVE ZERO  TO INvs
028600             MOVE ZERO  TO Ivs
028610             MOVE ZERO  TO Ivs
028620             MOVE SPACE TO ItOQ
028630             PERFORM {pL^eǍ
028640             IF ( ItOQ      = SPACE   ) AND
028650                ( {L|҃R[h  = ҃R[hvq ) AND
028660                ( {L|{pa    = {pavq   ) AND
028670                ( {L|{pN      = {pNvq     ) AND
028680                ( {L|{p      = {pvq     ) 
028690*
028700*        *****************************************************************
028710*        * JnN ( ̕ʂłȂA
028720*                       ł}Ԃ鎞́Aŏ̎{pJn)*
028730*        *****************************************************************
028740                 IF ( {pNv NOT = Nv(ʂbms) ) OR
028750                    ( {pv NOT = v(ʂbms) ) OR
028760                    ( JnfÓ蓮敪v = 1 )
028770                     MOVE {L|{pN   TO JnNv(ʂbms)
028780                     MOVE {L|{p   TO Jnv(ʂbms)
028790                     MOVE {L|{p   TO Jnv(ʂbms)
028800                 END-IF
028810             END-IF
028820             PERFORM UNTIL ( ItOQ         = "YES"            ) OR
028830                           ( {L|҃R[h NOT = ҃R[hvq   ) OR
028840                           ( {L|{pa   NOT = {pavq     ) OR
028850                           ( {L|{pN     NOT = {pNvq       ) OR
028860                           ( {L|{p     NOT = {pvq       ) OR
028870                           ( {L|{p         > Iv(ʂbms))
028880*               **********
028890*               *  *
028900*               **********
      */̓Z|ʎ]L/160816
028910*                COMPUTE v(ʂbms) = v(ʂbms) + 1
028920                MOVE {L|{pN               TO INvs
028930                MOVE {L|{p               TO Ivs
028940                MOVE {L|{p               TO Ivs
028950*
028960                PERFORM {pL^eǍ
028970            END-PERFORM
028980        END-IF
028990*       **************************
029000*       * pFINZbg *
029010*       **************************
029020        IF ( ]A敪v(ʂbms) = 9 )
029030            MOVE INvs    TO INv(ʂbms)
029040            MOVE Ivs    TO Iv(ʂbms)
029050            MOVE Ivs    TO Iv(ʂbms)
029060        END-IF
029070        IF ( INv(ʂbms) > 󗝔Nv )
029080            MOVE INv(ʂbms) TO 󗝔Nv
029090            MOVE Iv(ʂbms) TO 󗝌v
029100            MOVE Iv(ʂbms) TO 󗝓v
029110        END-IF
029120     END-PERFORM.
029130*
029140** ----- Ô݂𔻒 -----------*
029150*
029160*     MOVE Ҕԍvq          TO {L|Ҕԍ.
029170*     MOVE }Ԃvq              TO {L|}.
029180*     MOVE {pavq          TO {L|{pa.
029190*     MOVE {pNvq            TO {L|{pN.
029200*     MOVE {pvq            TO {L|{p.
029210*     MOVE ZERO                  TO {L|{p.
029220*     START {pL^e   KEY IS >= {L|҃R[h
029230*                                  {L|{paN
029240*     END-START.
029250*     IF ( ԃL[ = "00" )
029260*             MOVE SPACE TO ItOQ
029270*             PERFORM {pL^eǍ
029280*             IF ( ItOQ      = SPACE   ) AND
029290*                ( {L|҃R[h  = ҃R[hvq ) AND
029300*                ( {L|{pa    = {pavq   ) AND
029310*                ( {L|{pN      = {pNvq     ) AND
029320*                ( {L|{p      = {pvq     ) 
029330** {pJnČǂ
029340*                 IF ( {L|Č = 1 )
029350*                      MOVE "YES"  TO  ČtO
029360*                 END-IF
029370**
029380*             END-IF
029390*     END-IF.
029400*     IF ( ČtO = "YES" )
029410*        PERFORM Ôݔ
029420*     END-IF.
029430*
029440*================================================================*
029450*================================================================*
029460 Zvgя擾 SECTION.
029470*================================================================*
029480     MOVE {pavq       TO S|{pa.
029490     MOVE {pNvq         TO S|{pN.
029500     MOVE {pvq         TO S|{p.
029510     MOVE ҃R[hvq     TO S|҃R[h.
029520     MOVE ʂvq       TO S|ی.
029530     READ ƃt@CS
029540     NOT INVALID KEY
029550          MOVE NC""        TO ԌŒv
029560          MOVE S|    TO Ԃv
029570     END-READ.
029580*
029590*================================================================*
029600*================================================================*
029610* nbq擾 SECTION.
029620*
029630****************************************************************
029640*      ڍtԍ .....{p}X^Ɏ擾    *
029650*      {pN         .....fҏeɎ擾        *
029660*  @@ی         .....S_pۃR[h42Zbg    @*
029670*                              VK}X^ɂΉ̉\L*
029680*      weЂhc     .....Ђhc"21"Zbg            *
029690*      ecA         .....Q                        *
029700*  @@z         .....Z|zZbg        *
029710* @@ S         .....S = Z|S / 10@*
029720****************************************************************
029730* ڍtԍ
029740*     MOVE nbqڍtԍv TO nbqԍv.
029750* {pN
029760*     MOVE {pNv         TO nbq{pNv.
029770* ی = S_R[h = 42
029780*     MOVE 42                 TO nbqیʂv.
029790* weЂhc = Ђhc = 21
029800*     MOVE "21"               TO nbqeЂhcv.
029810* ecA = ecAԊҔԍv + ecAԌۂhcv
029820*     MOVE Ҕԍv         TO ecAԊҔԍv.
029830*     MOVE 1                  TO ecAԌۂhcv.
029840* z
029850*     MOVE Z|z       TO nbqzv.
029860* S
029870*     MOVE Z|S     TO Svq.
029880*     COMPUTE nbqSv = Svq / 10.
029890*================================================================*
029900 {pL^eǍ SECTION.
029910*
029920     READ {pL^e NEXT
029930     AT END
029940         MOVE "YES" TO ItOQ
029950     END-READ.
029960*================================================================*
029970  SECTION.
029980*
029990     MOVE "YCH6125P" TO  `̖o.
030000     MOVE "SCREEN"   TO  ڌQo.
030010     WRITE YCH6125P.
030020***     WRITE R[h.
030030     PERFORM G[o.
030040*================================================================*
030050 G[o SECTION.
030060*
030070     IF ( ʒmo NOT = "00" )
030080         DISPLAY NC"[G["              UPON CONS
030090         DISPLAY NC"ڌQoF" ڌQo UPON CONS
030100         DISPLAY NC"ʒmoF" ʒmo UPON CONS
030110         DISPLAY NC"goF" go UPON CONS
030120         DISPLAY NC"P͂dmsdqL[Ă"
030130                                             UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
030140         ACCEPT  L[ FROM CONS
030150         PERFORM t@C
030160         MOVE 99 TO PROGRAM-STATUS
030170         EXIT PROGRAM
030180     END-IF.
030190*================================================================*
030200 ʖ̖ SECTION.
030210*
006490     STRING Z|ʖ̂P(ʂbms)  DELIMITED BY SPACE
009980            ̂v                    DELIMITED BY SPACE
006500            Z|ʖ̂Q(ʂbms)  DELIMITED BY SPACE
006520       INTO v(ʂbms)
006570     END-STRING.
030410*
030420*================================================================*
030430 ȑÕf[^ SECTION.
030440*
030450*********************************************************************************
030460*  ŏ̏ȑO̓Ɏ{pL^R[h(A~)́A敪
030470*  pɂ`FbNB(VKƌp̗)
030480*********************************************************************************
030490** ŏ̏擾
030500     MOVE SPACE                 TO tO.
030510     MOVE Ҕԍvq          TO {L|Ҕԍ.
030520     MOVE }Ԃvq              TO {L|}.
030530     MOVE {pavq          TO {L|{pa.
030540     MOVE {pNvq            TO {L|{pN.
030550     MOVE {pvq            TO {L|{p.
030560     MOVE ZERO                  TO {L|{p.
030570     START {pL^e   KEY IS >= {L|҃R[h
030580                                  {L|{paN
030590     END-START.
030600     IF ( ԃL[ = "00" )
030610         MOVE ZERO  TO avs
030620         MOVE ZERO  TO Nvs
030630         MOVE ZERO  TO vs
030640         MOVE ZERO  TO vs
030650         MOVE SPACE TO ItOQ
030660         PERFORM {pL^eǍ
030670         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030680                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030690                       ( {L|{pa   NOT = {pavq    ) OR
030700                       ( {L|{pN     NOT = {pNvq      ) OR
030710                       ( {L|{p     NOT = {pvq      ) OR
030720                       ( tO           = "YES"           ) 
030730               IF ( {L|fË敪 = 2 )
030740                   MOVE {L|{pa           TO avs
030750                   MOVE {L|{pN             TO Nvs
030760                   MOVE {L|{p             TO vs
030770                   MOVE {L|{p             TO vs
030780                   MOVE "YES"                    TO tO
030790               END-IF
030800               PERFORM {pL^eǍ
030810         END-PERFORM
030820     END-IF.
030830*
030840* ȑÕf[^
030850     IF ( tO = "YES" )
030860        MOVE Ҕԍvq          TO {L|Ҕԍ
030870        MOVE }Ԃvq              TO {L|}
030880        MOVE avs          TO {L|{pa
030890        MOVE Nvs            TO {L|{pN
030900        MOVE vs            TO {L|{p
030910        MOVE vs            TO {L|{p
030920        START {pL^e   KEY IS <  {L|҃R[h
030930                                     {L|{paN
030940                                     REVERSED
030950        END-START
030960        IF ( ԃL[ = "00" )
030970           MOVE SPACE  TO ItOQ
030980           PERFORM {pL^eǍ
030990           IF ( ItOQ    = SPACE        ) AND
031000              ( {L|Ҕԍ  = Ҕԍvq ) AND
031010              ( {L|}      = }Ԃvq     ) AND
031020              ( {L|{pa  = avs ) AND
031030              ( {L|{pN    = Nvs   ) AND
031040              ( {L|{p    = vs   )
031050*  ȑO̓Ɏ{pL^R[h
031060                IF ( p`FbNv = SPACE )
031070                   MOVE NC""    TO p`FbNv
031080                END-IF
031090           END-IF
031100         END-IF
031110     END-IF.
031120*
031130*================================================================*
031140 擾 SECTION.
031150*
031160* RJȏ̒ "CHOUKI" Ă. 
031170     MOVE  SPACE TO  Aԁ|L[.
031180     INITIALIZE      Aԁ|L[.
031190     MOVE {pavq  TO  Aԁ|{pa.
031200     MOVE {pNvq    TO  Aԁ|{pN.
031210     MOVE {pvq    TO  Aԁ|{p.
031220     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
031230     MOVE }Ԃvq      TO  Aԁ|}.
031240*
031250     CALL   "CHOUKI".
031260     CANCEL "CHOUKI".
031270*
031280**** KpPgp (uÔ݁v鎞́A)
031290     IF ( Aԁ|ΏۃtO  = "YES" )
031300        IF ( KpPv  = SPACE )
031310           MOVE NC"{ppRʂɋL"  TO KpPv
031320        ELSE
031330           STRING KpPv           DELIMITED BY SPACE
031340                  NC"C"             DELIMITED BY SIZE
031350                  NC"{ppRʂɋL"   DELIMITED BY SIZE
031360                  INTO KpPv
031370           END-STRING
031380        END-IF
031390     END-IF.
031400*
031410*================================================================*
031420 Z擾 SECTION.
031430*****************************************************************
031440** ZԊOƐ[̎AKpɁutԁv󎚂B
031450**   ̈󎚂͌3܂ŉ\
031460*****************************************************************
031470     IF ( Z|ԊO = 1 ) OR ( Z|[ = 1 ) OR ( Z|x = 1 )
031480*
031490         MOVE Ҕԍvq          TO {L|Ҕԍ
031500         MOVE }Ԃvq              TO {L|}
031510         MOVE {pavq          TO {L|{pa
031520         MOVE {pNvq            TO {L|{pN
031530         MOVE {pvq            TO {L|{p
031540         MOVE ZERO                  TO {L|{p
031550         START {pL^e   KEY IS >= {L|҃R[h
031560                                      {L|{paN
031570         END-START
031580         IF ( ԃL[ = "00" )
031590             MOVE ZERO  TO ZJEg
031600             MOVE SPACE TO ItOQ
031610             PERFORM UNTIL ( ItOQ         = "YES"           ) OR
031620                           ( {L|҃R[h NOT = ҃R[hvq  ) OR
031630                           ( {L|{pa   NOT = {pavq    ) OR
031640                           ( {L|{pN     NOT = {pNvq      ) OR
031650                           ( {L|{p     NOT = {pvq      ) 
031660               IF ( {L|Z = 1 OR 2 OR 3 ) AND ( {L|fË敪 = 2 )
031670                  COMPUTE ZJEg = ZJEg  + 1
031680                  IF ( ZJEg <= 3 )
031690                     MOVE {L|Z TO Z敪vs(ZJEg)
031700                     MOVE {L|t   TO Zvs(ZJEg)
031710                     MOVE {L|t   TO Zvs(ZJEg)
031720                  END-IF
031730               END-IF
031740               PERFORM {pL^eǍ
031750            END-PERFORM
031760** Z̎KpɃZbg
033380            IF ( Zvs(1) NOT = ZERO ) OR ( Zvs(1) NOT = ZERO ) 
                      MOVE Zvs(1) TO Zv
                      MOVE ":"               TO Z؂v
                      MOVE Zvs(1) TO Zv
                  END-IF
033380            IF ( Zvs(2) NOT = ZERO ) OR ( Zvs(2) NOT = ZERO ) 
031910                PERFORM ZKpZbg
                  END-IF
031780         END-IF
031790*
031800     END-IF.
031810*
031820*================================================================*
031830 ZKpZbg SECTION.
031840*
031850     PERFORM VARYING ԍJE^ FROM 1 BY 1
031860              UNTIL  ԍJE^ > 3
031870         IF ( Zvs(ԍJE^)  = ZERO )  AND 
031880            ( Zvs(ԍJE^)  = ZERO ) 
031890             CONTINUE
031900         ELSE
031910* Œ荀
031920             EVALUATE Z敪vs(ԍJE^) 
031930             WHEN 1
031940                MOVE NC"ԊO"   TO Zev(ԍJE^)
033320             WHEN 2
033330                MOVE NC"x@"   TO Zev(ԍJE^)
031950             WHEN 3
031960                MOVE NC"[@"   TO Zev(ԍJE^)
031970             END-EVALUATE
031980*
031990             MOVE NC"F"          TO Z؂v(ԍJE^)
032000             MOVE NC""          TO Œv(ԍJE^)
032010             MOVE NC""          TO Œv(ԍJE^)
032020*
032030**** {ϊ
032040* 
032050             MOVE Zvs(ԍJE^)  TO  v
032060             IF ( v >= 10 )
032070                 MOVE vP    TO ԍvP
032080                 PERFORM {ϊ
032090                 MOVE Spԍv  TO ZmvP(ԍJE^)
032100                 MOVE vQ    TO ԍvP
032110                 PERFORM {ϊ
032120                 MOVE Spԍv  TO ZmvQ(ԍJE^)
032130             ELSE
032140                 MOVE vQ    TO ԍvP
032150                 PERFORM {ϊ
032160                 MOVE Spԍv  TO ZmvQ(ԍJE^)
032170             END-IF
032180* 
032190             MOVE Zvs(ԍJE^)  TO  v
032200             MOVE vP    TO ԍvP
032210             PERFORM {ϊ
032220             MOVE Spԍv  TO ZmvP(ԍJE^)
032230             MOVE vQ    TO ԍvP
032240             PERFORM {ϊ
032250             MOVE Spԍv  TO ZmvQ(ԍJE^)
032260** 
032270        END-IF
032280     END-PERFORM.
032290*
032300     MOVE  ZWcmv(1)   TO ZPv. 
032310     MOVE  ZWcmv(2)   TO ZQv. 
032320     MOVE  ZWcmv(3)   TO ZRv. 
032330*
032340**** KpPQgpiRLڂœKpPgĂ鎞́AKpQj
032350     IF ( Zvs(2)  = ZERO ) AND ( Zvs(2)  = ZERO ) 
032360         CONTINUE
032370     ELSE
032380         IF ( KpPv  = SPACE )
032390               STRING NC"Z"       DELIMITED BY SIZE
032400                      ZPv   DELIMITED BY SIZE
032410                      ZQv   DELIMITED BY SIZE
032420                      ZRv   DELIMITED BY SIZE
032430                      INTO KpPv
032440               END-STRING
032450         ELSE
032460               STRING NC"Z"       DELIMITED BY SIZE
032470                      ZPv   DELIMITED BY SIZE
032480                      ZQv   DELIMITED BY SIZE
032490                      ZRv   DELIMITED BY SIZE
032500                      INTO KpQv
032510               END-STRING
032520         END-IF
032530     END-IF.
032540*
032550*================================================================*
032560 {ϊ SECTION.
032570*
032580     MOVE NC"O"     TO Spԍv.
032590     CALL "htoz" WITH C LINKAGE
032600                        USING ԍvP SpԍvP.
032610*
032620*================================================================*
032630*================================================================*
032640 擾 SECTION.
032650*
032660********************************************************************
032670*  R[ĥ́A1sɂ܂Ƃ߂Ĉ󎚂B
032680*  : @A Ƃœ].
032690*     R[ĥ܂Ƃ߁Ae[uɃZbg
032700*     (Aʂœ̂́A2sɂȂ)
032710********************************************************************
032720     MOVE  ZERO   TO  JE^ JE^Q.
032730     PERFORM VARYING ʂbms FROM 1 BY 1
032740             UNTIL ( ʂbms > ʐv )
032750*
032760****        IF ( |Ҕԍ(ʂbms)  NOT = ZERO )  AND
032770        IF ( |A(ʂbms)      NOT = ZERO )
032780*
032790           IF ( JE^ = ZERO )
032800               MOVE 1   TO  JE^ JE^Q
032810               MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
032820               MOVE |A(ʂbms)     TO AԂv(JE^)   AԂbv
032830               MOVE ʂbms                   TO ʂv(JE^ JE^Q)
032840           ELSE
032850              IF ( |Ҕԍ(ʂbms)  = Ҕԍbv )  AND
032860                 ( |A(ʂbms)      = AԂbv     )
032870                 COMPUTE JE^Q = JE^Q  +  1
032880                 MOVE ʂbms                  TO ʂv(JE^ JE^Q)
032890              ELSE
032900                 COMPUTE JE^ = JE^  +  1
032910                 MOVE 1   TO  JE^Q
032920                 MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
032930                 MOVE |A(ʂbms)     TO AԂv(JE^)  AԂbv
032940                 MOVE ʂbms                   TO ʂv(JE^ JE^Q)
032950              END-IF
032960           END-IF
032970        END-IF
032980     END-PERFORM.
032990**************************************************************************
033000*  }X^蕶͎擾
033010**************************************************************************
033020     MOVE  ZERO   TO  JE^ JE^Q.
033030     PERFORM VARYING JE^ FROM 1 BY 1
033040             UNTIL ( JE^ > 9 )  OR ( AԂv(JE^) = ZERO )
033050** ۂ 敪 01
033060         MOVE 01                        TO |敪R[h
033070         MOVE Ҕԍv(JE^)  TO |Ҕԍ
033080         MOVE AԂv(JE^)      TO |A
033090         READ e
033100         NOT INVALID KEY
033110             INITIALIZE vs
033120             MOVE |bl(1) TO  Pvs
033130             MOVE |bl(2) TO  Qvs
033140             MOVE |bl(3) TO  Rvs
033150             MOVE |bl(4) TO  Svs
033160             MOVE |bl(5) TO  Tvs
033170             PERFORM VARYING JE^Q FROM 1 BY 1
033180                     UNTIL ( JE^Q > 9 )  OR 
033190                           ( ʂv(JE^ JE^Q) = ZERO )
033200                EVALUATE ʂv(JE^ JE^Q)
033210                WHEN 1
033220                   MOVE "@"  TO  io[vP(JE^Q)
033230                WHEN 2
033240                   MOVE "A"  TO  io[vP(JE^Q)
033250                WHEN 3
033260                   MOVE "B"  TO  io[vP(JE^Q)
033270                WHEN 4
033280                   MOVE "C"  TO  io[vP(JE^Q)
033290                WHEN 5
033300                   MOVE "D"  TO  io[vP(JE^Q)
033270                WHEN 6
033280                   MOVE "E"  TO  io[vP(JE^Q)
033290                WHEN 7
033300                   MOVE "F"  TO  io[vP(JE^Q)
033310                WHEN OTHER
033320                   CONTINUE
033330                END-EVALUATE
033340             END-PERFORM
033350*
033432             IF |͋敪 = 1
033433                 STRING io[mv  DELIMITED BY SPACE
033434                        Pvs  DELIMITED BY SIZE
033435                        Qvs  DELIMITED BY SIZE
033436                        Rvs  DELIMITED BY SIZE
033437                        Svs  DELIMITED BY SIZE
033438                        Tvs  DELIMITED BY SIZE
033439                        INTO ev(JE^)
033440                 END-STRING
033441             ELSE
005946                 INSPECT vs REPLACING ALL Sp BY p
                       MOVE SPACE TO Pv Qv
                       MOVE io[mv TO Pv
                       MOVE Pvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Qvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Rvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Svs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Tvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                        MOVE Pv TO ev(JE^)
033450             END-IF
033451*
033452         END-READ
033453     END-PERFORM.
033460*
033470     PERFORM Zbg.
033480*
033490*================================================================*
033500 Zbg SECTION.
033510*
033520**************************************************************************
033530*  ͂1s𒴂鎞́AsɕB
033540**************************************************************************
033550     MOVE  ZERO   TO  JE^ JE^Q.
033560     PERFORM VARYING JE^ FROM 1 BY 1
033570             UNTIL ( JE^ > 9 )  OR ( ev(JE^) = SPACE )
033580*
033590          INITIALIZE ewv
033600          MOVE ev(JE^)   TO ewv
033610          IF ( ePwv  NOT = SPACE )
033620              COMPUTE JE^Q = JE^Q  +  1
033630              MOVE ePwv  TO v(JE^Q)
033640          END-IF
033650          IF ( eQwv  NOT = SPACE )
033660              COMPUTE JE^Q = JE^Q  +  1
033670              MOVE eQwv  TO v(JE^Q)
033680          END-IF
033690          IF ( eRwv  NOT = SPACE )
033700              COMPUTE JE^Q = JE^Q  +  1
033710              MOVE eRwv  TO v(JE^Q)
033720          END-IF
033830          IF ( eSwv  NOT = SPACE )
033840              COMPUTE JE^Q = JE^Q  +  1
033850              MOVE eSwv  TO v(JE^Q)
033860          END-IF
033730*
033740     END-PERFORM.
033750*================================================================*
033760 擾 SECTION.
033770*
033780* 2006/04 ύX
033790*  "JOSEIMEI" Ă. 
033800     MOVE SPACE TO  Á|L[.
033810     INITIALIZE     Á|L[.
033820     MOVE ʂvq           TO Á|.
033830     MOVE pSҔԍvq TO Á|pSҔԍ.
033840*
033850     CALL   "JOSEIMEI".
033860     CANCEL "JOSEIMEI".
033870*
033880     MOVE Á|P TO v.
033890*
033900***
034070*
034080*================================================================*
034090 Ôݔ SECTION.
034100*
034110*** O̒ʉ@ 
034120     MOVE  SPACE            TO OtO.
034130     MOVE |҃R[h    TO {L|҃R[h.
034140     MOVE |{pa      TO {L|{pa.
034150     MOVE |{pN        TO {L|{pN.
034160     MOVE |{p        TO {L|{p.
034170     MOVE 1                 TO {L|{p.
034180     START {pL^e   KEY IS <  {L|҃R[h
034190                                  {L|{paN
034200                                  REVERSED
034210     END-START.
034220     IF ( ԃL[ = "00" )
034230         MOVE SPACE  TO ItOQ
034240         PERFORM {pL^eǍ
034250         IF ( ItOQ      = SPACE  ) AND
034260            ( {L|҃R[h  = |҃R[h ) AND
034270            ( {L|fË敪    = 2 ) 
034280*
034290            PERFORM O
034300**** KpPgp
034310            IF ( OtO = "YES" )
034320               MOVE NC"Ô"    TO  KpPv
034330            END-IF
034340**
034350         END-IF
034360     END-IF.
034370*
034380*================================================================*
034390 O  SECTION.
034400* 
034410*** ǂݍ񂾎{pL^̔NAOǂ (N̍ 1 ?)
034420      MOVE  SPACE  TO  OtO.
034430      INITIALIZE  vZNv JnNQv INQv.
034440**
034450      MOVE |{pa    TO IaQv.
034460      MOVE |{pN      TO INQv.
034470      MOVE |{p      TO IQv.
034480      MOVE {L|{pa  TO JnaQv.
034490      MOVE {L|{pN    TO JnNQv.
034500      MOVE {L|{p    TO JnQv.
034510*
034520      EVALUATE TRUE
034530       WHEN (JnaQv = IaQv) AND (JnNQv = INQv)
034540            PERFORM  Or
034550       WHEN (JnaQv = IaQv) AND (JnNQv NOT = INQv)
034560            PERFORM  OrN
034570       WHEN  JnaQv NOT = IaQv 
034580            PERFORM  Or
034590      END-EVALUATE.
034600*
034610      IF ( vZv = 1 )
034620         MOVE  "YES"  TO  OtO
034630      END-IF.
034640*
034650*================================================================*
034660 Or  SECTION.
034670*
034680     IF ( IQv >  JnQv )
034690         COMPUTE vZv = IQv - JnQv
034700     ELSE
034710        MOVE ZERO TO vZv
034720     END-IF.
034730*
034740*================================================================*
034750 OrN  SECTION.
034760*
034770     IF ( INQv >  JnNQv )
034780         COMPUTE vZNv = INQv - JnNQv
034790         COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
034800     ELSE
034810        MOVE ZERO TO vZv
034820     END-IF.
034830*
034840*================================================================*
034850 Or  SECTION.
034860*
034870     MOVE JnaQv TO |敪.
034880     READ }X^
034890     NOT INVALID KEY
034900         MOVE |JnN TO JnNv
034910     END-READ.
034920     MOVE IaQv TO |敪.
034930     READ }X^
034940     NOT INVALID KEY
034950         MOVE |JnN TO INv
034960     END-READ.
034970**
034980     IF ( JnNv NOT = ZERO ) AND ( INv NOT = ZERO )
034990        COMPUTE JnNv = JnNv + JnNQv - 1
035000        COMPUTE INv = INv + INQv - 1
035010*
035020        IF ( INv =  JnNv )
035030           PERFORM  Or
035040        ELSE
035050           IF ( INv >  JnNv )
035060               COMPUTE vZNv = INv - JnNv
035070               COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
035080           ELSE
035090               MOVE ZERO TO vZv
035100           END-IF
035110        END-IF
035120     ELSE
035130        MOVE ZERO TO vZv
035140     END-IF.
035150*
035330*================================================================*
035340 f҈敪XV SECTION.
035350*
035360** //  fҏë敪ɂPZbgAXVB//  
035370*
035380     MOVE {pavq       TO |{pa.
035390     MOVE {pNvq         TO |{pN.
035400     MOVE {pvq         TO |{p.
035410     MOVE ҃R[hvq     TO |҃R[h.
035420     READ fҏe
035430     NOT INVALID KEY
035440         MOVE  1  TO  |Z敪
035450         REWRITE  |R[h
035460         END-REWRITE
035470         IF ( ԃL[ NOT = "00" )
035480            MOVE NC"f" TO t@C
035490            PERFORM G[\
035500         END-IF
035510     END-READ.
035520*
035530*================================================================*
035540 擾 SECTION.
035550*
035560     MOVE {pNvq   TO 󗝔Nv.
035570     MOVE {pvq   TO 󗝌v.
035580     MOVE {pavq TO |敪.
035590     READ }X^
035600     NOT INVALID KEY
035610         MOVE |JnN TO {pNv
035620     END-READ.
035630     IF ( {pNv NOT = ZERO )
035640        COMPUTE {pNv = {pNv + {pNvq - 1
035650     END-IF.
035660*
035670     EVALUATE {pvq
035680     WHEN 4
035690     WHEN 6
035700     WHEN 9
035710     WHEN 11
035720         MOVE 30 TO 󗝓v
035730     WHEN 2
035740         DIVIDE 4 INTO {pNv GIVING    v
035750                                    REMAINDER ]v
035760         END-DIVIDE
035770         IF ( ]v = ZERO )
035780             MOVE 29 TO 󗝓v
035790         ELSE
035800             MOVE 28 TO 󗝓v
035810         END-IF
035820     WHEN 1
035830     WHEN 3
035840     WHEN 5
035850     WHEN 7
035860     WHEN 8
035870     WHEN 10
035880     WHEN 12
035890         MOVE 31 TO 󗝓v
035900     WHEN OTHER
035910          CONTINUE
035920     END-EVALUATE.
035930*
035940*================================================================*
035950 ϔCN擾 SECTION.
035960*
035970** ---// ̎󗝔Nɂ́AŏIʉ@ĂׁAޔ //----
035980     MOVE 󗝔Nv   TO ŏIʉ@Nv.
035990     MOVE 󗝌v   TO ŏIʉ@v.
036000     MOVE 󗝓v   TO ŏIʉ@v.
036010***
036020* (_t)
036030     EVALUATE Zvgt敪v 
036040*    /  ŏIʉ@ /
036050     WHEN ZERO
036060         MOVE ŏIʉ@Nv TO _tNv
036070         MOVE ŏIʉ@v TO _tv
036080         MOVE ŏIʉ@v TO _tv
036090*    /   /
036100     WHEN 1 
036110         PERFORM 擾
036120         MOVE 󗝔Nv     TO _tNv
036130         MOVE 󗝌v     TO _tv
036140         MOVE 󗝓v     TO _tv
036150*    /  󎚂Ȃ /
036160     WHEN 9
036170         MOVE ZERO         TO _tNv
036180         MOVE ZERO         TO _tv
036190         MOVE ZERO         TO _tv
036200*    /  ̑́AŏIʉ@ /
036210     WHEN OTHER
036220         MOVE ŏIʉ@Nv TO _tNv
036230         MOVE ŏIʉ@v TO _tv
036240         MOVE ŏIʉ@v TO _tv
036250     END-EVALUATE.
036260**
036270* (ґ)
036280     EVALUATE Zvgғt敪v 
036290*    /  ŏIʉ@ /
036300     WHEN ZERO
036310         MOVE ŏIʉ@Nv TO ҈ϔCNv
036320         MOVE ŏIʉ@v TO ҈ϔCv
036330         MOVE ŏIʉ@v TO ҈ϔCv
036340*    /   /
036350     WHEN 1 
036360         PERFORM 擾
036370         MOVE 󗝔Nv     TO ҈ϔCNv
036380         MOVE 󗝌v     TO ҈ϔCv
036390         MOVE 󗝓v     TO ҈ϔCv
036400*    /  󎚂Ȃ /
036410     WHEN 9
036420         MOVE ZERO         TO ҈ϔCNv
036430         MOVE ZERO         TO ҈ϔCv
036440         MOVE ZERO         TO ҈ϔCv
036450*    /  ̑́AŏIʉ@ /
036460     WHEN OTHER
036470         MOVE ŏIʉ@Nv TO ҈ϔCNv
036480         MOVE ŏIʉ@v TO ҈ϔCv
036490         MOVE ŏIʉ@v TO ҈ϔCv
036500     END-EVALUATE.
036510*
036520*================================================================*
036831*================================================================*
036832 Z܂Ƃߔ SECTION.
036833*---------------------------------------------------------------------------*
036834* s}X^ǂ݁AZ܂Ƃߋ敪PłA{̕یہEސE
036835* ̎́AtOYES (z݂ň󎚁j
036836*iFls̏Q́A{̕یiیnj̃ZvgPŐAZ͂Ȃj
036837*---------------------------------------------------------------------------*
036838*
036839     MOVE SPACE TO Z܂Ƃ߃tO.
036840*     MOVE SPACE TO ʗ̂v.
036841*
036842*     MOVE |           TO s|.
036843*     MOVE |pSҔԍ TO s|sԍ.
036844*     READ s}X^
036845*     NOT INVALID KEY
036846*         IF s|Z܂Ƃߋ敪 = 1 
036847*            IF (( |ی = 01 ) AND ( |یҔԍ(3:1) NOT = "3" )) OR
036848*               ( |ی = 08 ) 
      *                OR ( |ی = 05 )
036849*                MOVE "YES" TO Z܂Ƃ߃tO
036850*
036851*                MOVE 02            TO |敪R[h
036852*                MOVE |  TO |̃R[h
036853*                READ ̃}X^
036854*                NOT INVALID KEY
036855*                    MOVE |  TO ʗ̂v
036856*                END-READ
036857*            END-IF
036858*         END-IF
036859*     END-READ.
036860*
036861** / CALL JRECEOFF /
036862*     IF Z܂Ƃ߃tO = SPACE
036863*        INITIALIZE AZ܂Ƃ߁|L[
036864*        MOVE {pavq TO AZ܂Ƃ߁|{pa
036865*        MOVE {pNvq   TO AZ܂Ƃ߁|{pN
036866*        MOVE {pvq   TO AZ܂Ƃ߁|{p
036867*        MOVE Ҕԍvq TO AZ܂Ƃ߁|Ҕԍ
036868*        MOVE }Ԃvq     TO AZ܂Ƃ߁|}
036869*       1:ZvgȂ̖{̂܂Ƃ߂̔
036870*        MOVE 1            TO AZ܂Ƃ߁|敪
036871*        CALL   "JRECEOFF"
036872*        CANCEL "JRECEOFF"
036873*
036874*        IF AZ܂Ƃ߁|茋 = 1
           IF ( Z|{̂܂Ƃߋ敪 = 1 )
036875           MOVE "YES" TO Z܂Ƃ߃tO
036877     END-IF.
036878*
036879*----------------------------------------------------------------------*
036880** / _ސ쌧ŗLFEvɕSҔԍƎ󋋎Ҕԍ /
036881     IF ( Z܂Ƃ߃tO = "YES" ) AND
036882        ( |pSҔԍ(3:2) = "14" )
036883        IF |pSҔԍ(1:2) NOT = "99"
036884*            MOVE ALL NC"P"    TO P Q R
036885*            MOVE ALL NC"b"    TO cP cQ
036886*            MOVE NC"b"                    TO cR cS
036887*            MOVE NC"SҔԍ"        TO ŒP
036888*            MOVE NC"󋋎Ҕԍ"            TO ŒQ
036889*            MOVE NC"^"                    TO _ސŒR
036890            MOVE |pSҔԍ    TO SҔԍ 
036891            MOVE |vҔԍ        TO 󋋎Ҕԍ
036892        END-IF
036893     END-IF.
      */a̎RQcЂƂe/100518
037769     IF ( Z܂Ƃ߃tO = "YES" ) AND
037770        ( |pSҔԍ(3:2) = "30" )
037772        IF |pSҔԍ(1:2) NOT = "99"
036887*            MOVE NC"SҔԍ"        TO ŒP
036888*            MOVE NC"󋋎Ҕԍ"            TO ŒQ
036890            MOVE |pSҔԍ    TO SҔԍ 
036891            MOVE |vҔԍ        TO 󋋎Ҕԍ
           END-IF.
      */ꌧ/110806
037769     IF ( Z܂Ƃ߃tO = "YES" ) AND
037770        ( |pSҔԍ(3:2) = "25" )
037772        IF |pSҔԍ(1:2) NOT = "99"
037781            MOVE |pSҔԍ    TO SҔԍ 
037782            MOVE |vҔԍ        TO 󋋎Ҕԍ
036792        END-IF
           END-IF.
036894*
037100*================================================================*
037110 ZEvăZbg SECTION.
037120*---------------------------------------------------------------*
043230*---------------------------------------------------------------*
043240* Evt@CΒȒOɍăZbgB
043250* iΉȂA܂蒷R͂̂܂܁j
043260*---------------------------------------------------------------*
           PERFORM Ev擾.
           MOVE AE|Ev(1)    TO RP.
           MOVE AE|Ev(2)    TO RQ.
           MOVE AE|Ev(3)    TO RR.
           MOVE AE|Ev(4)    TO RS.
           MOVE AE|Ev(5)    TO RT.
           MOVE AE|Ev(6)    TO RU.
           MOVE AE|Ev(7)    TO RV.
           MOVE AE|Ev(8)    TO RW.
037290*
040580*================================================================*
040590 Ev擾 SECTION.
040600*
040610* Ev擾 "TEKIYBUN" Ă. 
040620     MOVE  SPACE TO  AE|L[.
040630     INITIALIZE      AE|L[.
040640     MOVE {pavq  TO  AE|{pa.
040650     MOVE {pNvq    TO  AE|{pN.
040660     MOVE {pvq    TO  AE|{p.
040670     MOVE Ҕԍvq  TO  AE|Ҕԍ.
040680     MOVE }Ԃvq      TO  AE|}.
040700*     MOVE 63            TO  AE|.
039370     MOVE 56            TO  AE|.
015000     IF (R敪e NOT = 1 )
               MOVE R敪v TO AE|敪
           ELSE
               MOVE 1                  TO AE|敪
015050     END-IF.
040710*
040720     CALL   "TEKIYBUN".
040730     CANCEL "TEKIYBUN".
040740*
044960*================================================================*
044961 Ώ۔菈 SECTION.
044963*------------------------------------------------------------------------------------*
044964* }X^́u敪v 3 iRʈȏj̎ARʈȏォ肵āA
044965* ̎̂݁AB
044966*------------------------------------------------------------------------------------*
044967*
044979     MOVE  SPACE TO  AZ|L[.
044980     INITIALIZE      AZ|L[.
044981     MOVE {pavq  TO  AZ|{pa.
044982     MOVE {pNvq    TO  AZ|{pN.
044983     MOVE {pvq    TO  AZ|{p.
044984     MOVE Ҕԍvq  TO  AZ|Ҕԍ.
044985     MOVE }Ԃvq      TO  AZ|}.
044986     CALL   "RECEHUGE".
044987     CANCEL "RECEHUGE".
044989*
044990     IF AZ|ΏۃtO = "YES"
044991        PERFORM 擾
044992     END-IF.
044993*
037320*================================================================*
037330 G[\ SECTION.
037340*
037350     DISPLAY NC"t@CG[F" t@C   UPON CONS.
037360     DISPLAY NC"ԃL[" ԃL[                 UPON CONS.
037370     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
037380     DISPLAY NC"P͂dmsdqL[Ă"
037390                                                   UPON CONS.
003321*-----------------------------------------*
003322     CALL "actcshm"  WITH C LINKAGE.
003323*-----------------------------------------*
037400     ACCEPT  L[ FROM CONS
037410     PERFORM t@C.
037420     EXIT PROGRAM.
037430*================================================================*
037440*================================================================*
037450 t@C SECTION.
037460*
037470     CLOSE t@C.
037480     CLOSE ی҃}X^     }X^          ̃}X^
037490           Zvge       }X^      {p}X^
037500           }X^     o߃}X^          fҏe
037510           {pL^e       f[^e        e
037520           s}X^     t@C
037530           }X^     hcǗ}X^      ƃt@CS.
037540*================================================================*
037550 I SECTION.
037560*
037570     PERFORM t@C.
037580*================================================================*
037590*================================================================*
037600 eXg󎚏 SECTION.
037610*
           CONTINUE.
038950*
038960*================================================================*
       {p擾 SECTION.
      *
      *     MOVE SPACE TO {pv.
028350     MOVE Ҕԍvq          TO {L|Ҕԍ
028360     MOVE }Ԃvq              TO {L|}
028370     MOVE {pavq          TO {L|{pa
028380     MOVE {pNvq            TO {L|{pN
028390     MOVE {pvq            TO {L|{p
028400     MOVE ZERO                  TO {L|{p
028420     START {pL^e   KEY IS >= {L|҃R[h
028430                                  {L|{paN
028440     END-START
028450     IF ԃL[ = "00"
030910         MOVE SPACE TO ItOQ
030920         PERFORM {pL^eǍ
030930         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030940                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030950                       ( {L|{pa   NOT = {pavq    ) OR
030960                       ( {L|{pN     NOT = {pNvq      ) OR
030970                       ( {L|{p     NOT = {pvq      )
                   MOVE NC"" TO {p`FbNv({L|{p)
                   PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
           MOVE {p`FbNv(1)  TO {p`FbNP.
           MOVE {p`FbNv(2)  TO {p`FbNQ.
           MOVE {p`FbNv(3)  TO {p`FbNR.
           MOVE {p`FbNv(4)  TO {p`FbNS.
           MOVE {p`FbNv(5)  TO {p`FbNT.
           MOVE {p`FbNv(6)  TO {p`FbNU.
           MOVE {p`FbNv(7)  TO {p`FbNV.
           MOVE {p`FbNv(8)  TO {p`FbNW.
           MOVE {p`FbNv(9)  TO {p`FbNX.
           MOVE {p`FbNv(10) TO {p`FbNPO.
           MOVE {p`FbNv(11) TO {p`FbNPP.
           MOVE {p`FbNv(12) TO {p`FbNPQ.
           MOVE {p`FbNv(13) TO {p`FbNPR.
           MOVE {p`FbNv(14) TO {p`FbNPS.
           MOVE {p`FbNv(15) TO {p`FbNPT.
           MOVE {p`FbNv(16) TO {p`FbNPU.
           MOVE {p`FbNv(17) TO {p`FbNPV.
           MOVE {p`FbNv(18) TO {p`FbNPW.
           MOVE {p`FbNv(19) TO {p`FbNPX.
           MOVE {p`FbNv(20) TO {p`FbNQO.
           MOVE {p`FbNv(21) TO {p`FbNQP.
           MOVE {p`FbNv(22) TO {p`FbNQQ.
           MOVE {p`FbNv(23) TO {p`FbNQR.
           MOVE {p`FbNv(24) TO {p`FbNQS.
           MOVE {p`FbNv(25) TO {p`FbNQT.
           MOVE {p`FbNv(26) TO {p`FbNQU.
           MOVE {p`FbNv(27) TO {p`FbNQV.
           MOVE {p`FbNv(28) TO {p`FbNQW.
           MOVE {p`FbNv(29) TO {p`FbNQX.
           MOVE {p`FbNv(30) TO {p`FbNRO.
           MOVE {p`FbNv(31) TO {p`FbNRP.
040820*================================================================*
040830 oߎ擾 SECTION.
040840*
036040     MOVE  SPACE TO  Aԁ|L[.
036050     INITIALIZE      Aԁ|L[.
036060     MOVE {pavq  TO  Aԁ|{pa.
036070     MOVE {pNvq    TO  Aԁ|{pN.
036080     MOVE {pvq    TO  Aԁ|{p.
036090     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
036100     MOVE }Ԃvq      TO  Aԁ|}.
036110*
036120     CALL   "CHOUKI".
036130     CANCEL "CHOUKI".
036140*
      */PEŖoE͓]Aɂ炸Rȏ́uǍDvA
      */ȊOׂ͂āuǍDvɂ@@@@@@@@@@@@@@@@/151217
031620     PERFORM VARYING ʂbms FROM 1 BY 1
031630             UNTIL ( ʂbms > ʐv )
               IF  (|o߃R[h(ʂbms) = ZERO)
028850             EVALUATE ʂbms
028860             WHEN 1
028870                 MOVE NC"@" TO oߕʂv
028880             WHEN 2
028890                 MOVE NC"A" TO oߕʂv
028900             WHEN 3
028910                 MOVE NC"B" TO oߕʂv
028920             WHEN 4
028930                 MOVE NC"C" TO oߕʂv
028940             WHEN 5
028950                 MOVE NC"D" TO oߕʂv
028960             END-EVALUATE
                   IF |(ʂbms) = 01 OR 02 OR 03
040850*              IF ( |]A敪(ʂbms) NOT = 1 AND 2)
040900                 IF ( Aԁ|Ԃv(ʂbms)  >= 3 )
040910                    MOVE NC"ǍD" TO  o߂bl
040920                 ELSE
040930                    MOVE NC"ǍD"     TO  o߂bl
040940                 END-IF
                   ELSE
040930                 MOVE NC"ǍD"     TO  o߂bl
040950*              END-IF
                   END-IF
                   MOVE SPACE      TO  oߗ̂v(ʂbms)
028970             STRING  oߕʂv     DELIMITED BY SPACE
028980                     o߂bl       DELIMITED BY SPACE
028990                INTO oߗ̂v(ʂbms)
029000             END-STRING
               END-IF
           END-PERFORM.
040960*
042680**================================================================*
       {p擾 SECTION.
      *
           MOVE 3              TO Z|Z.
019550     MOVE {pavq   TO Z|{pa.
019560     MOVE {pNvq     TO Z|{pN.
019570     MOVE {pvq     TO Z|{p.
019580     MOVE Ҕԍvq   TO Z|Ҕԍ.
019590     MOVE }Ԃvq       TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
028350     MOVE Ҕԍvq          TO {L|Ҕԍ.
028360     MOVE }Ԃvq              TO {L|}.
028370     MOVE {pavq          TO {L|{pa.
028380     MOVE {pNvq            TO {L|{pN.
028390     MOVE {pvq            TO {L|{p.
      *------------------------------------------------------------------------*
           IF ( Z|rΏ = 1 )
               MOVE |rJn  TO {L|{p
           ELSE
               MOVE ZERO                  TO {L|{p
           END-IF.
      *------------------------------------------------------------------------*
028420     START {pL^e   KEY IS >= {L|҃R[h
028430                                  {L|{paN
028440     END-START.
028450     IF ԃL[ = "00"
030910         MOVE SPACE TO ItOQ
               MOVE ZERO  TO JE^
030920         PERFORM {pL^eǍ
030930         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030940                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030950                       ( {L|{pa   NOT = {pavq    ) OR
030960                       ( {L|{pN     NOT = {pNvq      ) OR
030970                       ( {L|{p     NOT = {pvq      )
                   COMPUTE JE^ = JE^ + 1
                   MOVE {L|{p TO vo
                   STRING vo                DELIMITED BY SIZE
                          "E"                  DELIMITED BY SIZE
                     INTO {pvo(JE^)
                   END-STRING
                   PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
           MOVE JE^ TO vo
           COMPUTE {pv = JE^ * 4 - 2
           STRING "m{pn"                     DELIMITED BY SPACE
                  {pvq(1:{pv) DELIMITED BY SIZE
                  "mn"                     DELIMITED BY SIZE
                  vo                           DELIMITED BY SIZE
                  ""                             DELIMITED BY SIZE
             INTO {pv
           END-STRING.
      *================================================================*
038970******************************************************************
038980 END PROGRAM YCH6475.
038990******************************************************************
