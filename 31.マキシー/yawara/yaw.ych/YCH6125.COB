000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YCH6125.
000060 AUTHOR.                 rc Kq
000070*
000080*----------------------------------------------------------------*
000090*          Zvgi_+޳ޔŁj
000100*         MED = YAW610 YCH6125P
000110*----------------------------------------------------------------*
000120 DATE-WRITTEN.           2011-09-08
000130 DATE-COMPILED.          2011-09-08
      */̓Z|ʎ]L/160816
      */qE^Â̕ύXEǉ/1805
      */쌧̂ǂ̏Ŏ󋋎ҕSL/2106
000140*----------------------------------------------------------------*
000150******************************************************************
000160*            ENVIRONMENT         DIVISION                        *
000170******************************************************************
000180 ENVIRONMENT             DIVISION.
000190 CONFIGURATION           SECTION.
000200 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000210 OBJECT-COMPUTER.        FMV-DESKPOWER.
000220 SPECIAL-NAMES.          CONSOLE  IS  CONS
000230                         SYSERR   IS  MSGBOX.
000240 INPUT-OUTPUT            SECTION.
000250 FILE-CONTROL.
000260     SELECT  ی҃}X^    ASSIGN      TO        HOKENSL
000270                             ORGANIZATION             IS  INDEXED
000280                             ACCESS MODE              IS  DYNAMIC
000290                             RECORD KEY               IS  ہ|ی
000300                                                          ہ|یҔԍ
000310* ́AL[ڂ̕یҖ̂ی҃Jiɂ
000320                             ALTERNATE RECORD KEY     IS  ہ|ی
000330                                                          ہ|یҖ
000340                                                          ہ|یҔԍ
000350                             FILE STATUS              IS  ԃL[
000360                             LOCK        MODE         IS  AUTOMATIC.
000370     SELECT  }X^      ASSIGN      TO        GENGOUL
000380                             ORGANIZATION             IS  INDEXED
000390                             ACCESS MODE              IS  DYNAMIC
000400                             RECORD KEY               IS  |敪
000410                             FILE STATUS              IS  ԃL[
000420                             LOCK        MODE         IS  AUTOMATIC.
000430     SELECT  ̃}X^      ASSIGN      TO        MEISYOL
000440                             ORGANIZATION             IS  INDEXED
000450                             ACCESS MODE              IS  DYNAMIC
000460                             RECORD KEY               IS  |敪R[h
000470                                                          |̃R[h
000480                             FILE STATUS              IS  ԃL[
000490                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  Zvge      ASSIGN      TO        RECEPTL
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  Z|{paN
000170                                                          Z|҃R[h
000180                                                          Z|Z
000190                             ALTERNATE RECORD KEY     IS  Z|҃R[h
000200                                                          Z|{paN
000210                                                          Z|Z
000220                             ALTERNATE RECORD KEY     IS  Z|aN
000230                                                          Z|{paN
000240                                                          Z|҃R[h
000250                                                          Z|Z
000260                             ALTERNATE RECORD KEY     IS  Z|aN
000270                                                          Z|Z
000280                                                          Z|یҔԍ
000290                                                          Z|҃R[h
000300                                                          Z|{paN
000310                             ALTERNATE RECORD KEY     IS  Z|aN
000320                                                          Z|یҔԍ
000330                                                          Z|҃R[h
000340                                                          Z|Z
000350                                                          Z|{paN
000360                             FILE STATUS              IS  ԃL[
000370                             LOCK        MODE         IS  AUTOMATIC.
000560     SELECT  }X^  ASSIGN      TO        SEIGYOL
000570                             ORGANIZATION             IS  INDEXED
000580                             ACCESS MODE              IS  DYNAMIC
000590                             RECORD KEY               IS  |敪
000600                             FILE STATUS              IS  ԃL[
000610                             LOCK        MODE         IS  AUTOMATIC.
000620     SELECT  {p}X^ ASSIGN      TO        SEJOHOL
000630                             ORGANIZATION             IS  INDEXED
000640                             ACCESS MODE              IS  DYNAMIC
000650                             RECORD KEY               IS  {|{pԍ
000660                             FILE STATUS              IS  ԃL[
000670                             LOCK        MODE         IS  AUTOMATIC.
000680     SELECT  }X^    ASSIGN      TO        SEIKYUSL
000690                             ORGANIZATION             IS  INDEXED
000700                             ACCESS MODE              IS  DYNAMIC
000710                             RECORD KEY               IS  |ی
000720                                                          |یҔԍ
000730                             FILE STATUS              IS  ԃL[
000740                             LOCK    MODE             IS  AUTOMATIC.
000750     SELECT  o߃}X^      ASSIGN      TO        KEIKAL
000760                             ORGANIZATION             IS  INDEXED
000770                             ACCESS MODE              IS  DYNAMIC
000780                             RECORD KEY               IS  o|敪R[h
000790                                                          o|o߃R[h
000800                             FILE STATUS              IS  ԃL[
000810                             LOCK        MODE         IS  AUTOMATIC.
000820     SELECT  fҏe    ASSIGN      TO        JUSINJL
000830                             ORGANIZATION             IS  INDEXED
000840                             ACCESS MODE              IS  DYNAMIC
000850                             RECORD KEY               IS  |{paN
000860                                                          |҃R[h
000870                             ALTERNATE RECORD KEY     IS  |{paN
000880                                                          |҃Ji
000890                                                          |҃R[h
000900                             ALTERNATE RECORD KEY     IS  |҃R[h
000910                                                          |{paN
000920                             ALTERNATE RECORD KEY     IS  |{paN
000930                                                          |ی
000940                                                          |یҔԍ
000950                                                          |҃R[h
000960                             ALTERNATE RECORD KEY     IS  |{paN
000970                                                          |
000980                                                          |pSҔԍ
000990                                                          |҃R[h
001000                             ALTERNATE RECORD KEY     IS  |{paN
001010                                                          |
001020                                                          |pSҔԍ
001030                                                          |҃R[h
001040                             ALTERNATE RECORD KEY     IS  |aN
001050                                                          |{paN
001060                                                          |҃R[h
001070                             FILE STATUS              IS  ԃL[
001080                             LOCK        MODE         IS  AUTOMATIC.
001090     SELECT  {pL^e      ASSIGN      TO        SEKIROKL
001100                             ORGANIZATION             IS  INDEXED
001110                             ACCESS MODE              IS  DYNAMIC
001120                             RECORD KEY               IS  {L|{paN
001130                                                          {L|҃R[h
001140                             ALTERNATE RECORD KEY     IS  {L|҃R[h
001150                                                          {L|{paN
001160                             FILE STATUS              IS  ԃL[
001170                             LOCK        MODE         IS  AUTOMATIC.
001180     SELECT  f[^e    ASSIGN      TO        HUSYOUL
001190                             ORGANIZATION             IS  INDEXED
001200                             ACCESS MODE              IS  DYNAMIC
001210                             RECORD KEY               IS  |{paN
001220                                                          |҃R[h
001230                             ALTERNATE RECORD KEY     IS  |҃R[h
001240                                                          |{paN
001250                             FILE STATUS              IS  ԃL[
001260                             LOCK        MODE         IS  AUTOMATIC.
001270     SELECT  e      ASSIGN      TO        HUGEINL
001280                             ORGANIZATION             IS  INDEXED
001290                             ACCESS MODE              IS  DYNAMIC
001300                             RECORD KEY               IS  |敪R[h
001310                                                          |R[h
001320                             FILE STATUS              IS  ԃL[
001330                             LOCK        MODE         IS  AUTOMATIC.
001340     SELECT  }X^    ASSIGN      TO        KAIJOHOL
001350                             ORGANIZATION             IS  INDEXED
001360                             ACCESS MODE              IS  DYNAMIC
001370                             RECORD KEY               IS  |_I敪
                                                                |R[h
001380                                                          |ی
001390                                                          |ύXaN
001400                             ALTERNATE RECORD KEY     IS  |_I敪
                                                                |ڍtJi
001410                                                          |R[h
001420                                                          |ی
001430                                                          |ύXaN
001440                             FILE STATUS              IS  ԃL[
001450                             LOCK        MODE         IS  AUTOMATIC.
001460     SELECT  hcǗ}X^    ASSIGN      TO        IDKANRL
001470                             ORGANIZATION             IS  INDEXED
001480                             ACCESS MODE              IS  DYNAMIC
001490                             RECORD KEY               IS  hcǁ|hc敪
001500                                                          hcǁ|{pԍ
001510                                                          hcǁ|ی
001520                                                          hcǁ|یҔԍ
001530                             ALTERNATE RECORD KEY     IS  hcǁ|{phcԍ
001540                                                          hcǁ|hc敪
001550                                                          hcǁ|{pԍ
001560                                                          hcǁ|ی
001570                                                          hcǁ|یҔԍ
001580                             FILE STATUS              IS  ԃL[
001590                             LOCK        MODE         IS  AUTOMATIC.
001600     SELECT  s}X^    ASSIGN      TO        SITYOSNL
001610                             ORGANIZATION             IS  INDEXED
001620                             ACCESS MODE              IS  DYNAMIC
001630                             RECORD KEY               IS  s|
001640                                                          s|sԍ
001650                             ALTERNATE RECORD KEY     IS  s|
001660                                                          s|s
001670                                                          s|sԍ
001680                             FILE STATUS              IS  ԃL[
001690                             LOCK        MODE         IS  AUTOMATIC.
001700     SELECT  t@C    ASSIGN      TO        MEMOL
001710                             ORGANIZATION             IS  INDEXED
001720                             ACCESS MODE              IS  DYNAMIC
001730                             RECORD KEY               IS  |敪
001740                                                          |҃R[h
001750                                                          |{paN
001760                             ALTERNATE RECORD KEY     IS  |敪
001770                                                          |{paN
001780                                                          |҃R[h
001790                             ALTERNATE RECORD KEY     IS  |҃R[h
001800                                                          |{paN
001810                                                          |敪
001820                             FILE STATUS              IS  ԃL[
001830                             LOCK        MODE         IS  AUTOMATIC.
001840* я󎚗p
001850     SELECT  ƃt@CS  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W5912L.DAT"
001860                             ORGANIZATION             IS  INDEXED
001870                             ACCESS                   IS  DYNAMIC
001880                             RECORD      KEY          IS  S|{paN
001890                                                          S|҃R[h
001900                                                          S|ی
001910                             FILE        STATUS       IS  ԃL[
001920                             LOCK        MODE         IS  AUTOMATIC.
001930*
001940     SELECT  t@C    ASSIGN      TO     GS-PRTF002
001950                             SYMBOLIC    DESTINATION  IS "PRT"
001960                             FORMAT                   IS  `̖o
001970                             GROUP                    IS  ڌQo
001980                             PROCESSING  MODE         IS  ʂo
001990                             UNIT        CONTROL      IS  go
002000                             FILE        STATUS       IS  ʒmo.
002010******************************************************************
002020*                      DATA DIVISION                             *
002030******************************************************************
002040 DATA                    DIVISION.
002050 FILE                    SECTION.
002060*                           mqk  RQOn
002070 FD  ی҃}X^        BLOCK   CONTAINS   1   RECORDS.
002080     COPY HOKENS          OF  XFDLIB  JOINING      AS  PREFIX.
002090*                           mqk  PQWn
002100 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002110     COPY GENGOU          OF  XFDLIB  JOINING      AS  PREFIX.
002120*                           mqk  PQWn
002130 FD  ̃}X^          BLOCK   CONTAINS   1   RECORDS.
002140     COPY MEISYO          OF  XFDLIB  JOINING      AS  PREFIX.
      *                          mqk  PTRUn
       FD  Zvge          BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   Z  AS  PREFIX.
002180*                           mqk  QTUn
002190 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002200     COPY SEIGYO          OF  XFDLIB  JOINING      AS  PREFIX.
002210*                           mqk  PQWn
002220 FD  {p}X^          BLOCK   CONTAINS   1   RECORDS.
002230     COPY SEJOHO         OF  XFDLIB  JOINING   {   AS  PREFIX.
002240*                           mqk  PQWn
002250 FD  }X^          BLOCK   CONTAINS   1   RECORDS.
002260     COPY SEIKYUS         OF  XFDLIB  JOINING      AS  PREFIX.
002270*                           mqk  PQWn
002280 FD  o߃}X^          BLOCK   CONTAINS   1   RECORDS.
002290     COPY KEIKA          OF  XFDLIB  JOINING   o   AS  PREFIX.
002300*                           mqk  RQOn
002310 FD  fҏe        BLOCK   CONTAINS   1   RECORDS.
002320     COPY JUSINJ          OF  XFDLIB  JOINING      AS  PREFIX.
002330*                           mqk  QTUn
002340 FD  {pL^e          BLOCK   CONTAINS   1   RECORDS.
002350     COPY SEKIROK         OF  XFDLIB  JOINING   {L AS  PREFIX.
002360*                           mqk  PQWn
002370 FD  f[^e        BLOCK   CONTAINS   1   RECORDS.
002380     COPY HUSYOU          OF  XFDLIB  JOINING      AS  PREFIX.
002390*                           mqk  PQWn
002400 FD  e          BLOCK   CONTAINS   1   RECORDS.
002410     COPY HUGEIN          OF  XFDLIB  JOINING      AS  PREFIX.
002420*                           mqk  USOn
002430 FD  }X^        BLOCK   CONTAINS   1   RECORDS.
002440     COPY KAIJOHO         OF  XFDLIB  JOINING      AS  PREFIX.
002450*                           mqk  PQWn
002460 FD  hcǗ}X^          BLOCK   CONTAINS   1   RECORDS.
002470     COPY IDKANR    OF  XFDLIB  JOINING   hc   AS  PREFIX.
002480*                           mqk  QTUn
002490 FD  s}X^          BLOCK   CONTAINS   1   RECORDS.
002500     COPY SITYOSN        OF  XFDLIB  JOINING   s   AS  PREFIX.
002510*                           mqk  WRQn
002520 FD  t@C        BLOCK CONTAINS 1     RECORDS.
002530     COPY MEMO           OF    XFDLIB JOINING  AS PREFIX.
002540**
002550**
002560 FD  ƃt@CS RECORD  CONTAINS 32 CHARACTERS.
002570 01  S|R[h.
002580     03  S|R[hL[.
002590         05  S|{paN.
002600             07  S|{pa            PIC 9.
002610             07  S|{pN              PIC 9(2).
002620             07  S|{p              PIC 9(2).
002630         05  S|҃R[h.
002640             07 S|Ҕԍ             PIC 9(6).
002650             07 S|}                 PIC X(1).
002660         05  S|ی                PIC 9(2).
002670     03  S|R[hf[^.
002680         05  S|                    PIC 9(4).
002690         05  FILLER                        PIC X(14).
002700*
002710*
002720 FD  t@C.
002730     COPY YCH6125P       OF  XMDLIB.
002740*----------------------------------------------------------------*
002750******************************************************************
002760*                WORKING-STORAGE SECTION                         *
002770******************************************************************
002780 WORKING-STORAGE         SECTION.
002790 01 L[                           PIC X     VALUE SPACE.
002800 01 ԃL[                           PIC X(2)  VALUE SPACE.
002810 01 ItO                         PIC X(3)  VALUE SPACE.
002820 01 ItOQ                       PIC X(3)  VALUE SPACE.
002820 01 ItOR                       PIC X(3)  VALUE SPACE.
002830 01 tO                         PIC X(3)  VALUE SPACE.
002840 01 t@C                         PIC N(6)  VALUE SPACE.
002850 01 Zvgofv                     PIC X(8)  VALUE SPACE.
002860 01 Oav                           PIC 9     VALUE ZERO.
002870 01 Jgv                     PIC 9(1)  VALUE ZERO.
002880 01 ʂbms                         PIC 9     VALUE ZERO.
002890 01 Ҕԍv                         PIC 9(6)  VALUE ZERO.
002900 01 ̂v                         PIC N(6)  VALUE SPACE.
002910 01 ʖ̂v                         PIC N(12) VALUE SPACE.
002920 01 ʒv                           PIC 9(2) VALUE 1.
001363 01 Sp                           PIC X(2)  VALUE X"8140".
001364 01 p                           PIC X(2)  VALUE X"2020".
002870 01 pʂv                         PIC 9(1)  VALUE ZERO.
002930**
002940 01 xtO                         PIC X(3) VALUE SPACE.
002950 01 x񐔂v                         PIC 9(4) VALUE ZERO.
002960 01 xbms                         PIC 9(5) VALUE ZERO.
002970 01 őo^v                       PIC 9 VALUE ZERO.
002980 01 Ao^v                     PIC 9 VALUE ZERO.
002990**
003000** {ϊ
003010 01 v                             PIC 9(2).
003020 01 q REDEFINES v.
003030    03 vP                        PIC X(1).
003040    03 vQ                        PIC X(1).
003050*
003060 01 ԍv                         PIC 9.
003070 01 ԍq REDEFINES ԍv.
003080    03 ԍvP                    PIC X.
003090*
003100 01 Spԍv                     PIC N.
003110 01 Spԍq REDEFINES Spԍv.
003120    03 SpԍvP                PIC X(2).
003130*
003140 01 JE^                           PIC 9(2)  VALUE ZERO.
003150 01 JE^Q                         PIC 9(2)  VALUE ZERO.
003160*
003170* ޔp
003180 01 INvs.
003190    03 INvs                      PIC 9(2)  VALUE ZERO.
003200    03 Ivs                      PIC 9(2)  VALUE ZERO.
003210    03 Ivs                      PIC 9(2)  VALUE ZERO.
003220* ޔp
003230 01 Nvs.
003240    03 avs                    PIC 9     VALUE ZERO.
003250    03 Nvs                      PIC 9(2)  VALUE ZERO.
003260    03 vs                      PIC 9(2)  VALUE ZERO.
003270    03 vs                      PIC 9(2)  VALUE ZERO.
003280* Zp
003290 01 Zvs.
003300    03 ZJEg                PIC 9    VALUE ZERO.
003310    03 ԍJE^                    PIC 9    VALUE ZERO.
003320    03 ZWcvs  OCCURS 3.
003330       05 Z敪vs             PIC 9    VALUE ZERO.
003340       05 Zvs               PIC 9(2) VALUE ZERO.
003350       05 Zvs               PIC 9(2) VALUE ZERO.
003360    03 ZWcmv  OCCURS 3.
003370       05 Z؂v                   PIC N(1) VALUE SPACE.
003380       05 Zev                   PIC N(3) VALUE SPACE.
003390       05 ZmvP             PIC N(1) VALUE SPACE.
003400       05 ZmvQ             PIC N(1) VALUE SPACE.
003410       05 Œv                     PIC N(1) VALUE SPACE.
003420       05 ZmvP             PIC N(1) VALUE SPACE.
003430       05 ZmvQ             PIC N(1) VALUE SPACE.
003440       05 Œv                     PIC N(1) VALUE SPACE.
003450    03 ZPv                PIC N(10) VALUE SPACE.
003460    03 ZQv                PIC N(10) VALUE SPACE.
003470    03 ZRv                PIC N(10) VALUE SPACE.
003070    03 Z؂v                  PIC X     VALUE SPACE.
003080    03 Zv                    PIC 9(2)  VALUE ZERO.
003090    03 Zv                    PIC 9(2)  VALUE ZERO.
003480* p
003490 01 vs.
003500    03 Pvs                  PIC X(60) VALUE SPACE.
003510    03 Qvs                  PIC X(60) VALUE SPACE.
003520    03 Rvs                  PIC X(60) VALUE SPACE.
003530    03 Svs                  PIC X(60) VALUE SPACE.
003540    03 Tvs                  PIC X(60) VALUE SPACE.
003550    03 io[vs.
003560       05 io[vP         PIC X(2)  OCCURS 9 VALUE SPACE.
003570    03 io[mv  REDEFINES io[vs PIC X(18).
003580 01 Ҕԍbv                   PIC 9(6)  VALUE ZERO.
003590 01 AԂbv                       PIC 9(4)  VALUE ZERO.
003600 01 sak.
003610    03 R[hsak            OCCURS 9.
003620       05 Ҕԍv               PIC 9(6)  VALUE ZERO.
003630       05 AԂv                   PIC 9(4)  VALUE ZERO.
003640       05 ʂv               PIC 9  OCCURS 9 VALUE ZERO.
003650 01 ev.
003660    03 ev              PIC X(318) OCCURS 9 VALUE SPACE.
003670    03 ewv.
003680       05 ePwv           PIC X(80)  VALUE SPACE.
003690       05 eQwv           PIC X(80)  VALUE SPACE.
003690       05 eRwv           PIC X(80)  VALUE SPACE.
003700       05 eSwv           PIC X(78)  VALUE SPACE.
003710*
003720* یҔԍ
003730 01 یҔԍrv                   PIC X(6)   VALUE SPACE.
003740* U p(Tj
003750 01 v                           PIC N(5)   VALUE SPACE.
003760*
003770** Ôݗp
003780 01 ČtO                     PIC X(3)  VALUE SPACE.
003790 01 OtO                         PIC X(3)  VALUE SPACE.
003800*
003810 01 vZNv.
003820    03 vZav                      PIC 9(1)  VALUE ZERO.
003830    03 vZNv                        PIC S9(2)  VALUE ZERO.
003840    03 vZv                        PIC S9(2)  VALUE ZERO.
003850    03 vZv                        PIC S9(2)  VALUE ZERO.
003860 01 JnNQv.
003870    03 JnaQv                    PIC 9(1)  VALUE ZERO.
003880    03 JnNQv                      PIC 9(2)  VALUE ZERO.
003890    03 JnQv                      PIC 9(2)  VALUE ZERO.
003900    03 JnQv                      PIC 9(2)  VALUE ZERO.
003910    03 JnNv                    PIC S9(4) VALUE ZERO.
003920 01 INQv.
003930    03 IaQv                    PIC 9(1)  VALUE ZERO.
003940    03 INQv                      PIC 9(2)  VALUE ZERO.
003950    03 IQv                      PIC 9(2)  VALUE ZERO.
003960    03 IQv                      PIC 9(2)  VALUE ZERO.
003970    03 INv                    PIC S9(4) VALUE ZERO.
003980***
003990** ER敪p
004000 01 敪v                 PIC 9 VALUE ZERO.
004010 01 R敪v                 PIC 9 VALUE ZERO.
004020*
004030** Zi̓t敪p (0:ŏIʉ@A1:A9:󎚂Ȃ)
004040 01 Zvgt敪v                 PIC 9 VALUE ZERO.
004050 01 Zvgғt敪v             PIC 9 VALUE ZERO.
004060*
004070** p
004080 01 {pNv                       PIC 9(4)  VALUE ZERO.
004090 01 v                               PIC 9(3)  VALUE ZERO.
004100 01 ]v                               PIC 9(3)  VALUE ZERO.
004110*
004120** }Ԕp
004130 01 JnfÓ蓮敪v               PIC 9    VALUE ZERO.
004140*
004150*
004160** Z܂Ƃߗp
004170 01 Z܂Ƃ߃tO               PIC X(3)  VALUE SPACE.
004180 01 ʗ̂v                     PIC N(4)  VALUE SPACE.
004190 01 ʗ̂vQ                   PIC N(4)  VALUE SPACE.
004200*
004210** ZEvp( N(38)Œj /
004220 01 ̌o߂v.
004230    03 ̌oߍsv                  PIC X(76) OCCURS 2 VALUE SPACE.
004240 01 ̌o߂mv REDEFINES ̌o߂v.
004250    03 ̌oߍsmv                PIC N(38) OCCURS 2.
004260*
004270* 敪
004280 01 Z敪v             PIC 9    VALUE ZERO.
004290*
003460 01 R敪e                 PIC 9 VALUE ZERO.
004291*
004292* ̌oߌŒ󎚗pɎgp
004293 01 S_eoc敪v                   PIC 9     VALUE ZERO.
004294 01 oߕʐv                     PIC N(1)  VALUE SPACE.
      *
004490* 쌧p
004500 01 󋋎ҔԍҏWv.
004510    03 󋋎ҔԍҏWvP              PIC X(3)  VALUE SPACE.
004520    03 󋋎ҋ؂P                    PIC X     VALUE SPACE.
004530    03 󋋎ҔԍҏWvQ              PIC X(2)  VALUE SPACE.
004540    03 󋋎ҋ؂Q                    PIC X     VALUE SPACE.
004550    03 󋋎ҔԍҏWvR              PIC X(10) VALUE SPACE.
004560*
      */qE^Â̕ύXEǉ/1805
       01 qblP                     PIC X(130) VALUE SPACE.
       01 qblQ                     PIC X(170) VALUE SPACE.
       01 ^Âbl                       PIC X(68)  VALUE SPACE.
004295*
004770******************************
004780* T  Ev  ҏWp *
004790******************************
004800 01 ʂTv.
004840   03 JnTv.
004850      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
004870      05 JnTv                PIC ZZ.
            05 bl                        PIC X(2).
         03 ʂPv                         PIC X(1).
004890   03 ÂTv.
            05 ʂQv                      PIC X(1).
004900      05 ÒPTv                  PIC ZZZZ.
            05 ZLPv                  PIC X(1).
004920      05 É񐔂Tv                  PIC ZZ.
            05 CR[Pv                  PIC X(1).
004940      05 ×Tv                    PIC ZZ,ZZZ.
         03 ʂRv                         PIC X(1).
         03 ZLPv                     PIC X(1).
         03 ʂSv                         PIC X(1).
004960   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLQv                  PIC X(1).
004970      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Qv                  PIC X(1).
004990      05 㪖@Tv                  PIC ZZZZ.
         03 ʂTv                         PIC X(1).
         03 ZLQv                     PIC X(1).
         03 ʂUv                         PIC X(1).
005010   03 㪖@Tv.
            05 㪖@PTv                PIC Z(2).
            05 ZLRv                  PIC X(1).
005020      05 㪖@񐔂Tv                PIC ZZ.
            05 CR[Rv                  PIC X(1).
005040      05 㪖@Tv                  PIC ZZZZ.
         03 ʂVv                         PIC X(1).
         03 ZLRv                     PIC X(1).
         03 ʂWv                         PIC X(1).
005060   03 dÂTv.
            05 dÒPTv                  PIC Z(2).
            05 ZLSv                  PIC X(1).
005070      05 dÉ񐔂Tv                  PIC ZZ.
            05 CR[Sv                  PIC X(1).
005090      05 d×Tv                    PIC ZZZZ.
            05 ʂXv                      PIC X(1).
         03 ʂPOv                       PIC X(1).
         03 ZLTv                     PIC X(1).
005130   03 ʗTv                     PIC X(3).
         03 ZLUv                     PIC X(1).
005170   03 Tv                   PIC 9.9.
         03 CR[Tv                     PIC X(1).
005190   03 vTv                   PIC ZZ,ZZZ.
004296*
004300****************
004310* AڑҔ *
004320****************
004330*    ************
004340*    * L[ *
004350*    ************
004360 01 Ώۃf[^vq.
004370    03 {paNvq.
004380       05 {pavq                  PIC 9(1)  VALUE ZERO.
004390       05 {pNvq                    PIC 9(2)  VALUE ZERO.
004400       05 {pvq                    PIC 9(2)  VALUE ZERO.
004410    03 یʂvq                     PIC 9(2)  VALUE ZERO.
004420    03 یҔԍvq                   PIC X(10) VALUE SPACE.
004430    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004440    03 pSҔԍvq               PIC X(10) VALUE SPACE.
004450    03 ʂvq                     PIC 9(2)  VALUE ZERO.
004460    03 pSҔԍvq           PIC X(10) VALUE SPACE.
004470    03 {lƑ敪vq                 PIC 9(1)  VALUE ZERO.
004480    03 ҃Jivq                     PIC X(50) VALUE SPACE.
004490    03 ҃R[hvq.
004500       05 Ҕԍvq                  PIC 9(6)  VALUE ZERO.
004510       05 }Ԃvq                      PIC X(1)  VALUE SPACE.
004520*    ************
004530*    *  *
004540*    ************
004550*    ̗
004560***********************
004570 01 Pvq.
004580   03 vq.
004590      05 Svq               PIC 9(3)    VALUE ZERO.
004600      05 vq                 PIC 9(5)    VALUE ZERO.
004610      05 Zvq             PIC 9(5)    VALUE ZERO.
         03 kvq              PIC 9(4)    VALUE ZERO.
004620   03 Čvq                    PIC 9(5)    VALUE ZERO.
004630   03 Âvq.
004640      05 Ëvq               PIC 9(2)V9  VALUE ZERO.
004650      05 É񐔂vq               PIC 9(2)    VALUE ZERO.
004660      05 ×vq                 PIC 9(6)    VALUE ZERO.
004670      05 ÉZvq             PIC 9(5)    VALUE ZERO.
004680   03 qZvq            PIC 9(5)    VALUE ZERO.
004690   03 {p񋟗vq            PIC 9(5)    VALUE ZERO.
004700   03 vvq                      PIC 9(6)    VALUE ZERO.
004710   03 ꕔSvq                PIC 9(6)    VALUE ZERO.
004720   03 zvq                  PIC 9(6)    VALUE ZERO.
004730   03 tvq                  PIC 9(1)    VALUE ZERO.
004740   03 󋋎ҕSzvq              PIC 9(6)    VALUE ZERO.
004750   03 zvq              PIC 9(6)    VALUE ZERO.
004760*
004770* ʖ̗
004780***********************
004790 01 Qvq.
004800   03 񏈒uvq    OCCURS   9.
004810      05 񏈒uvq             PIC 9(5)    VALUE ZERO.
004820*
004830* ̗
004840***********************
004850 01 Rvq.
004860**********
004870* P *
004880**********
004890   03 ʂPvq.
004900      05 ÂPvq.
004910         07 ÒPPvq              PIC 9(4)    VALUE ZERO.
004920         07 É񐔂Pvq              PIC 9(2)    VALUE ZERO.
004930         07 ×Pvq                PIC 9(5)    VALUE ZERO.
004940      05 㪖@Pvq.
004950         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004960         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
004970      05 㪖@Pvq.
004980         07 㪖@񐔂Pvq            PIC 9(2)    VALUE ZERO.
004990         07 㪖@Pvq              PIC 9(4)    VALUE ZERO.
005000      05 dÂPvq.
005010         07 dÉ񐔂Pvq              PIC 9(2)    VALUE ZERO.
005020         07 d×Pvq                PIC 9(4)    VALUE ZERO.
005030      05 vPvq                     PIC 9(6)    VALUE ZERO.
005040      05 Pvq               PIC 9(3)    VALUE ZERO.
005050      05 vPvq               PIC 9(6)    VALUE ZERO.
005060**********
005070* Q *
005080**********
005090   03 ʂQvq.
005100      05 ÂQvq.
005110         07 ÒPQvq              PIC 9(4)    VALUE ZERO.
005120         07 É񐔂Qvq              PIC 9(2)    VALUE ZERO.
005130         07 ×Qvq                PIC 9(5)    VALUE ZERO.
005140      05 㪖@Qvq.
005150         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
005160         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
005170      05 㪖@Qvq.
005180         07 㪖@񐔂Qvq            PIC 9(2)    VALUE ZERO.
005190         07 㪖@Qvq              PIC 9(4)    VALUE ZERO.
005200      05 dÂQvq.
005210         07 dÉ񐔂Qvq              PIC 9(2)    VALUE ZERO.
005220         07 d×Qvq                PIC 9(4)    VALUE ZERO.
005230      05 vQvq                     PIC 9(6)    VALUE ZERO.
005240      05 Qvq               PIC 9(3)    VALUE ZERO.
005250      05 vQvq               PIC 9(6)    VALUE ZERO.
005260******************
005270* Rʁ^W *
005280******************
005290   03 ʂRWvq.
005300      05 ÂRWvq.
005310         07 ÒPRWvq              PIC 9(4)  VALUE ZERO.
005320         07 É񐔂RWvq              PIC 9(2)  VALUE ZERO.
005330         07 ×RWvq                PIC 9(5)  VALUE ZERO.
005340      05 㪖@RWvq.
005350         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005360         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005370      05 㪖@RWvq.
005380         07 㪖@񐔂RWvq            PIC 9(2)  VALUE ZERO.
005390         07 㪖@RWvq              PIC 9(4)  VALUE ZERO.
005400      05 dÂRWvq.
005410         07 dÉ񐔂RWvq              PIC 9(2)  VALUE ZERO.
005420         07 d×RWvq                PIC 9(4)  VALUE ZERO.
005430      05 vRWvq                     PIC 9(6)  VALUE ZERO.
005440      05 ʍvRWvq             PIC 9(6)  VALUE ZERO.
005450      05 RWvq               PIC 9(3)  VALUE ZERO.
005460      05 vRWvq               PIC 9(6)  VALUE ZERO.
005470******************
005480* Rʁ^PO *
005490******************
005500   03 ʂROvq.
005510      05 JnROvq.
005520         07 JnROvq            PIC 9(2)  VALUE ZERO.
005530         07 JnROvq            PIC 9(2)  VALUE ZERO.
005540      05 ÂROvq.
005550         07 ÒPROvq              PIC 9(4)  VALUE ZERO.
005560         07 É񐔂ROvq              PIC 9(2)  VALUE ZERO.
005570         07 ×ROvq                PIC 9(5)  VALUE ZERO.
005580      05 㪖@ROvq.
005590         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
005600         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005610      05 㪖@ROvq.
005620         07 㪖@񐔂ROvq            PIC 9(2)  VALUE ZERO.
005630         07 㪖@ROvq              PIC 9(4)  VALUE ZERO.
005640      05 dÂROvq.
005650         07 dÉ񐔂ROvq              PIC 9(2)  VALUE ZERO.
005660         07 d×ROvq                PIC 9(4)  VALUE ZERO.
005670      05 vROvq                     PIC 9(6)  VALUE ZERO.
005680      05 ROvq               PIC 9(3)  VALUE ZERO.
005690      05 vROvq               PIC 9(6)  VALUE ZERO.
005700****************
005710* Sʁ^T *
005720****************
005730   03 ʂSTvq.
005740      05 ÂSTvq.
005750         07 ÒPSTvq              PIC 9(4)  VALUE ZERO.
005760         07 É񐔂STvq              PIC 9(2)  VALUE ZERO.
005770         07 ×STvq                PIC 9(5)  VALUE ZERO.
005780      05 㪖@STvq.
005790         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005800         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005810      05 㪖@STvq.
005820         07 㪖@񐔂STvq            PIC 9(2)  VALUE ZERO.
005830         07 㪖@STvq              PIC 9(4)  VALUE ZERO.
005840      05 dÂSTvq.
005850         07 dÉ񐔂STvq              PIC 9(2)  VALUE ZERO.
005860         07 d×STvq                PIC 9(4)  VALUE ZERO.
005870      05 vSTvq                     PIC 9(6)  VALUE ZERO.
005880      05 ʍvSTvq             PIC 9(6)  VALUE ZERO.
005890      05 STvq               PIC 9(3)  VALUE ZERO.
005900      05 vSTvq               PIC 9(6)  VALUE ZERO.
005910****************
005920* Sʁ^W *
005930****************
005940   03 ʂSWvq.
005950      05 JnSWvq.
005960         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005970         07 JnSWvq            PIC 9(2)  VALUE ZERO.
005980      05 ÂSWvq.
005990         07 ÒPSWvq              PIC 9(4)  VALUE ZERO.
006000         07 É񐔂SWvq              PIC 9(2)  VALUE ZERO.
006010         07 ×SWvq                PIC 9(5)  VALUE ZERO.
006020      05 㪖@SWvq.
006030         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
006040         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
006050      05 㪖@SWvq.
006060         07 㪖@񐔂SWvq            PIC 9(2)  VALUE ZERO.
006070         07 㪖@SWvq              PIC 9(4)  VALUE ZERO.
006080      05 dÂSWvq.
006090         07 dÉ񐔂SWvq              PIC 9(2)  VALUE ZERO.
006100         07 d×SWvq                PIC 9(4)  VALUE ZERO.
006110      05 vSWvq                     PIC 9(6)  VALUE ZERO.
006120      05 ʍvSWvq             PIC 9(6)  VALUE ZERO.
006130      05 SWvq               PIC 9(3)  VALUE ZERO.
006140      05 vSWvq               PIC 9(6)  VALUE ZERO.
006150******************
006160* Sʁ^PO *
006170******************
006180   03 ʂSOvq.
006190      05 JnSOvq.
006200         07 JnSOvq            PIC 9(2)  VALUE ZERO.
006210         07 JnSOvq            PIC 9(2)  VALUE ZERO.
006220      05 ÂSOvq.
006230         07 ÒPSOvq              PIC 9(4)  VALUE ZERO.
006240         07 É񐔂SOvq              PIC 9(2)  VALUE ZERO.
006250         07 ×SOvq                PIC 9(5)  VALUE ZERO.
006260      05 㪖@SOvq.
006270         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006280         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006290      05 㪖@SOvq.
006300         07 㪖@񐔂SOvq            PIC 9(2)  VALUE ZERO.
006310         07 㪖@SOvq              PIC 9(4)  VALUE ZERO.
006320      05 dÂSOvq.
006330         07 dÉ񐔂SOvq              PIC 9(2)  VALUE ZERO.
006340         07 d×SOvq                PIC 9(4)  VALUE ZERO.
006350      05 vSOvq                     PIC 9(6)  VALUE ZERO.
006360      05 SOvq               PIC 9(3)  VALUE ZERO.
006370      05 vSOvq               PIC 9(6)  VALUE ZERO.
006380********************
006390* Tʁ^QDT *
006400********************
006410   03 ʂTQvq.
006420      05 ÂTQvq.
006430         07 ÒPTQvq              PIC 9(4)  VALUE ZERO.
006440         07 É񐔂TQvq              PIC 9(2)  VALUE ZERO.
006450         07 ×TQvq                PIC 9(5)  VALUE ZERO.
006460      05 㪖@TQvq.
006470         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006480         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006490      05 㪖@TQvq.
006500         07 㪖@񐔂TQvq            PIC 9(2)  VALUE ZERO.
006510         07 㪖@TQvq              PIC 9(4)  VALUE ZERO.
006520      05 dÂTQvq.
006530         07 dÉ񐔂TQvq              PIC 9(2)  VALUE ZERO.
006540         07 d×TQvq                PIC 9(4)  VALUE ZERO.
006550      05 vTQvq                     PIC 9(6)  VALUE ZERO.
006560      05 ʍvTQvq             PIC 9(6)  VALUE ZERO.
006570      05 TQvq               PIC 9(3)  VALUE ZERO.
006580      05 vTQvq               PIC 9(6)  VALUE ZERO.
006590****************
006600* Tʁ^T *
006610****************
006620   03 ʂTTvq.
006630      05 JnTTvq.
006640         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006650         07 JnTTvq            PIC 9(2)  VALUE ZERO.
006660      05 ÂTTvq.
006670         07 ÒPTTvq              PIC 9(4)  VALUE ZERO.
006680         07 É񐔂TTvq              PIC 9(2)  VALUE ZERO.
006690         07 ×TTvq                PIC 9(5)  VALUE ZERO.
006700      05 㪖@TTvq.
006710         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006720         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006730      05 㪖@TTvq.
006740         07 㪖@񐔂TTvq            PIC 9(2)  VALUE ZERO.
006750         07 㪖@TTvq              PIC 9(4)  VALUE ZERO.
006760      05 dÂTTvq.
006770         07 dÉ񐔂TTvq              PIC 9(2)  VALUE ZERO.
006780         07 d×TTvq                PIC 9(4)  VALUE ZERO.
006790      05 vTTvq                     PIC 9(6)  VALUE ZERO.
006800      05 ʍvTTvq             PIC 9(6)  VALUE ZERO.
006810      05 TTvq               PIC 9(3)  VALUE ZERO.
006820      05 vTTvq               PIC 9(6)  VALUE ZERO.
006830****************
006840* Tʁ^W *
006850****************
006860   03 ʂTWvq.
006870      05 JnTWvq.
006880         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006890         07 JnTWvq            PIC 9(2)  VALUE ZERO.
006900      05 ÂTWvq.
006910         07 ÒPTWvq              PIC 9(4)  VALUE ZERO.
006920         07 É񐔂TWvq              PIC 9(2)  VALUE ZERO.
006930         07 ×TWvq                PIC 9(5)  VALUE ZERO.
006940      05 㪖@TWvq.
006950         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006960         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
006970      05 㪖@TWvq.
006980         07 㪖@񐔂TWvq            PIC 9(2)  VALUE ZERO.
006990         07 㪖@TWvq              PIC 9(4)  VALUE ZERO.
007000      05 dÂTWvq.
007010         07 dÉ񐔂TWvq              PIC 9(2)  VALUE ZERO.
007020         07 d×TWvq                PIC 9(4)  VALUE ZERO.
007030      05 vTWvq                     PIC 9(6)  VALUE ZERO.
007040      05 ʍvTWvq             PIC 9(6)  VALUE ZERO.
007050      05 TWvq               PIC 9(3)  VALUE ZERO.
007060      05 vTWvq               PIC 9(6)  VALUE ZERO.
007070******************
007080* Tʁ^PO *
007090******************
007100   03 ʂTOvq.
007110      05 JnTOvq.
007120         07 JnTOvq            PIC 9(2)  VALUE ZERO.
007130         07 JnTOvq            PIC 9(2)  VALUE ZERO.
007140      05 ÂTOvq.
007150         07 ÒPTOvq              PIC 9(4)  VALUE ZERO.
007160         07 É񐔂TOvq              PIC 9(2)  VALUE ZERO.
007170         07 ×TOvq                PIC 9(5)  VALUE ZERO.
007180      05 㪖@TOvq.
007190         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
007200         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
007210      05 㪖@TOvq.
007220         07 㪖@񐔂TOvq            PIC 9(2)  VALUE ZERO.
007230         07 㪖@TOvq              PIC 9(4)  VALUE ZERO.
007240      05 dÂTOvq.
007250         07 dÉ񐔂TOvq              PIC 9(2)  VALUE ZERO.
007260         07 d×TOvq                PIC 9(4)  VALUE ZERO.
007270      05 vTOvq                     PIC 9(6)  VALUE ZERO.
007280      05 TOvq               PIC 9(3)  VALUE ZERO.
007290      05 vTOvq               PIC 9(6)  VALUE ZERO.
007300*
007310**************
007320* {p *
007330**************
007340 01 {pv.
007350    03 _tԍv                    PIC X(16)  VALUE SPACE.
007360    03 ڍtԍv              PIC X(16)  VALUE SPACE.
007370    03 \҃Jiv                    PIC X(50)  VALUE SPACE.
007380    03 \Җv                      PIC X(50)  VALUE SPACE.
007390    03 ڍ@v                      PIC X(50)  VALUE SPACE.
          03 s{ihrv                PIC X(2)   VALUE SPACE.
007400    03 {pZv.
007410       05 {pZPv               PIC X(50)  VALUE SPACE.
007420       05 {pZQv               PIC X(50)  VALUE SPACE.
007430    03 {pX֔ԍv.
007440       05 {pX֔ԍPv           PIC X(3)   VALUE SPACE.
007450       05 {pX֔ԍQv           PIC X(4)   VALUE SPACE.
007460    03 {pdbԍv                PIC X(20)  VALUE SPACE.
007470    03 z󗝔ԍv                PIC X(15)  VALUE SPACE.
007480    03 󗝔Nv.
007490       05 󗝔Nv                     PIC 9(2)   VALUE ZERO.
007500       05 󗝌v                     PIC 9(2)   VALUE ZERO.
007510       05 󗝓v                     PIC 9(2)   VALUE ZERO.
007520    03 ŏIʉ@Nv.
007530       05 ŏIʉ@Nv                 PIC 9(2)   VALUE ZERO.
007540       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
007550       05 ŏIʉ@v                 PIC 9(2)   VALUE ZERO.
007560    03 _tNv.
007570       05 _tNv                   PIC 9(2)   VALUE ZERO.
007580       05 _tv                   PIC 9(2)   VALUE ZERO.
007590       05 _tv                   PIC 9(2)   VALUE ZERO.
007600    03 ҈ϔCNv.
007610       05 ҈ϔCNv                 PIC 9(2)   VALUE ZERO.
007620       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007630       05 ҈ϔCv                 PIC 9(2)   VALUE ZERO.
007640    03 v.
007650        05 sv              PIC X(40)  VALUE SPACE.
007660        05 sxXv          PIC X(40)  VALUE SPACE.
007670        05 aʂv                  PIC 9(1)   VALUE ZERO.
007680        05 ԍv                  PIC X(10)  VALUE SPACE.
007690        05 `lv                PIC X(40)  VALUE SPACE.
007700        05 `lJiv            PIC X(40)  VALUE SPACE.
007710        05 `lƃJiv          PIC X(60)  VALUE SPACE.
007720        05 sxXv              PIC X(60)  VALUE SPACE.
007730        05 aʃRgv          PIC N(3)   VALUE SPACE.
007740        05 aʃRgwv        PIC X(4)   VALUE SPACE.
          03 x@.
             05 Z@֖v.
                07 Z@֖Pv            PIC X(12)  VALUE SPACE.
                07 Z@֖Qv            PIC X(12)  VALUE SPACE.
      *          07 Z@֖Rv            PIC X(8)  VALUE SPACE.
      *          07 Z@֖Sv            PIC X(8)  VALUE SPACE.
      *          07 Z@֖Tv            PIC X(8)  VALUE SPACE.
             05 xXv.
                07 xXPv                PIC X(12) VALUE SPACE.
                07 xXQv                PIC X(12) VALUE SPACE.
      *          07 xXRv                PIC X(12) VALUE SPACE.
      *          07 xXSv                PIC X(12) VALUE SPACE.
             05 U`FbNv               PIC N(1)  VALUE SPACE.
             05 ʃ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
             05 s`FbNv               PIC N(1)  VALUE SPACE.
             05 Ƀ`FbNv               PIC N(1)  VALUE SPACE.
             05 _`FbNv               PIC N(1)  VALUE SPACE.
             05 {X`FbNv               PIC N(1)  VALUE SPACE.
             05 xX`FbNv               PIC N(1)  VALUE SPACE.
             05 {x`FbNv             PIC N(1)  VALUE SPACE.
007750*    03 Rgv.
007760*        05 RgPv                PIC X(36)  VALUE SPACE.
007770*        05 RgQv                PIC X(36)  VALUE SPACE.
007780*        05 RgRv                PIC X(36)  VALUE SPACE.
007790*        05 RgSv                PIC N(18)  VALUE SPACE.
007750    03 Rgv.
007760        05 RgPv                PIC X(36)  VALUE SPACE.
007770        05 RgQv                PIC X(36)  VALUE SPACE.
007780        05 RgRv                PIC X(36)  VALUE SPACE.
007790        05 RgSv                PIC X(36)  VALUE SPACE.
007800    03 {phcv                    PIC X(15)  VALUE SPACE.
007810    03 s{phcv                PIC X(15)  VALUE SPACE.
007820**************
007830* fҏ *
007840**************
007850 01 fҏv.
      */C/20190408
          03 {pav                      PIC 9(1)   VALUE ZERO.
007860    03 {pNv.
007870       05 {pNv                     PIC 9(2)   VALUE ZERO.
007880       05 {pv                     PIC 9(2)   VALUE ZERO.
007890*    03 Lv                          PIC N(12)  VALUE SPACE.
007570    03 Lv.
007580       05 Lv                   PIC N(12)  VALUE SPACE.
          03 Lԍv.
             05 Lԍwv                 PIC X(40) VALUE SPACE.
007900    03 ԍv.
007910       05 ԍv                   PIC X(15)  VALUE SPACE.
007920       05 FILLER                       PIC X(15)  VALUE SPACE.
007930    03 یҔԍv.
007940       05 یҔԍv             PIC X(8)   VALUE SPACE.
007950       05 FILLER                       PIC X(2)   VALUE SPACE.
007960    03 sԍv.
007970       05 sԍv             PIC X(8)   VALUE SPACE.
007980       05 FILLER                       PIC X(2)   VALUE SPACE.
          03 󋋎Ҕԍv                    PIC X(15) VALUE SPACE.
007990    03 於̂v.
008000       05 於̂v             PIC X(38)  VALUE SPACE.
008010       05 FILLER                       PIC X(38)  VALUE SPACE.
008020    03 یʂv                      PIC 9(2)   VALUE ZERO.
008030    03 یҏv.
008040       05 ی҃Jiv               PIC X(50)  VALUE SPACE.
008050       05 یҎv               PIC X(50)  VALUE SPACE.
008060       05 X֔ԍv.
008070          07 X֔ԍPv              PIC X(3)   VALUE SPACE.
008080          07 X֔ԍQv              PIC X(4)   VALUE SPACE.
008090       05 یҏZPv             PIC X(50)  VALUE SPACE.
008100       05 یҏZQv             PIC X(50)  VALUE SPACE.
008990       05 dbԍv                   PIC X(35)  VALUE SPACE.
008110    03 ҏv.
008120       05 ҃Jiv                   PIC X(50)  VALUE SPACE.
008130       05 Ҏv                   PIC X(50)  VALUE SPACE.
008140       05 ʃ`FbNv.
008150          07 j`FbNv              PIC N(1)  VALUE SPACE.
008160          07 `FbNv              PIC N(1)  VALUE SPACE.
008170       05 Ґʂv.
008180          07 ʂv                    PIC N(1)  VALUE SPACE.
008190       05 a`FbNv.
008200          07 `FbNv            PIC N(1)  VALUE SPACE.
008210          07 吳`FbNv            PIC N(1)  VALUE SPACE.
008220          07 a`FbNv            PIC N(1)  VALUE SPACE.
008230          07 `FbNv            PIC N(1)  VALUE SPACE.
008240          07 v                    PIC N(2)  VALUE SPACE.
      */C/20190408
008210          07 ߘa`FbNv            PIC N(1)  VALUE SPACE.
                07 ߘablv                PIC X(4)  VALUE SPACE.
009110*          07 v                    PIC N(2)  VALUE SPACE.
      */C/20190408
008250       05 ҔNv                     PIC 9(2)  VALUE ZERO.
008260       05 Ҍv                     PIC 9(2)  VALUE ZERO.
008270       05 ғv                     PIC 9(2)  VALUE ZERO.
008280       05 v.
008290          07 v                PIC N(4)  VALUE SPACE.
008300          07 FILLER                    PIC X(4)  VALUE SPACE.
008310       05 Pv                 PIC N(37) VALUE SPACE.
008320       05 Qv                 PIC N(37) VALUE SPACE.
008330       05 Rv                 PIC N(37) VALUE SPACE.
008340       05 Sv                 PIC N(37) VALUE SPACE.
008350       05 Tv                 PIC N(37) VALUE SPACE.
008360*
008370*       05 v                   PIC N(40) OCCURS 29 VALUE SPACE.
      */pΉ/110421
             05 v OCCURS 29.
                07 wv              PIC X(80)  VALUE SPACE.
008380*
008390*       05 ۋ敪`FbNv.
008400*          07 ۃ`FbNv            PIC N(1)  VALUE SPACE.
008410*          07 ۑg`FbNv        PIC N(1)  VALUE SPACE.
008420    03 v                        PIC N(1)  VALUE SPACE.
008430    03 ʃRgv                  PIC X(16) VALUE SPACE.
007390    03 یʃ`FbNv.
007400       05 Еۃ`FbNv               PIC N(1)  VALUE SPACE.
007410       05 D`FbNv               PIC N(1)  VALUE SPACE.
007420       05 g`FbNv               PIC N(1)  VALUE SPACE.
007430       05 ۃ`FbNv               PIC N(1)  VALUE SPACE.
             05 σ`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv                 PIC N(1)  VALUE SPACE.
             05 ސE`FbNv               PIC N(1)  VALUE SPACE.
             05 `FbNv               PIC N(1)  VALUE SPACE.
          03 {l`FbNv                  PIC N(1)  VALUE SPACE.
          03 Ƒ`FbNv                  PIC N(1)  VALUE SPACE.
          03 Pƃ`FbNv                  PIC N(1)  VALUE SPACE.
          03 Q`FbNv                  PIC N(1)  VALUE SPACE.
          03 `FbNv                  PIC N(1)  VALUE SPACE.
          03 V`FbNv                  PIC N(1)  VALUE SPACE.
          03 U΃`FbNv                  PIC N(1)  VALUE SPACE.
          03 t`FbNv.
             05 V`FbNv               PIC N(1)  VALUE SPACE.
             05 W`FbNv               PIC N(1)  VALUE SPACE.
             05 X`FbNv               PIC N(1)  VALUE SPACE.
             05 PO`FbNv             PIC N(1)  VALUE SPACE.
008440*
008450****************
008460* f[^e *
008470****************
008480 01 v.
008490    03 ʐv                        PIC 9(1)  VALUE ZERO.
008500    03 ʏv  OCCURS   9.
008510       05 ʂbmsv                 PIC 9(1)  VALUE ZERO.
008520       05 ʃR[hv.
008530          07 ʂv                PIC 9(2)  VALUE ZERO.
008540          07 ʂv                    PIC 9(2)  VALUE ZERO.
008550          07 E敪v                PIC 9(1)  VALUE ZERO.
008560          07 ʒuԍv            PIC 9(2)  VALUE ZERO.
008570       05 v                     PIC N(18) VALUE SPACE.
008580       05 Nv.
008590          07 Nv                  PIC 9(2)  VALUE ZERO.
008600          07 v                  PIC 9(2)  VALUE ZERO.
008610          07 v                  PIC 9(2)  VALUE ZERO.
008620       05 Nv.
008630          07 Nv                  PIC 9(2)  VALUE ZERO.
008640          07 v                  PIC 9(2)  VALUE ZERO.
008650          07 v                  PIC 9(2)  VALUE ZERO.
008660       05 JnNv.
008670          07 JnNv                  PIC 9(2)  VALUE ZERO.
008680          07 Jnv                  PIC 9(2)  VALUE ZERO.
008690          07 Jnv                  PIC 9(2)  VALUE ZERO.
008700       05 INv.
008710          07 INv                  PIC 9(2)  VALUE ZERO.
008720          07 Iv                  PIC 9(2)  VALUE ZERO.
008730          07 Iv                  PIC 9(2)  VALUE ZERO.
008740       05 v                     PIC 9(2)  VALUE ZERO.
008750       05 ]A敪v                   PIC 9(1)  VALUE ZERO.
008760       05 ]A敪`FbNv.
008770          07 `FbNv            PIC N(1)  VALUE SPACE.
008780          07 ~`FbNv            PIC N(1)  VALUE SPACE.
008790          07 ]`FbNv            PIC N(1)  VALUE SPACE.
008800       05 JnN擾tO         PIC X(3)  VALUE SPACE.
008810       05 ʋ؂v                   PIC X(1)  VALUE SPACE.
008820       05 oߗ̂v.
008830          07 oߗ̂v            PIC N(5)  VALUE SPACE.
008840          07 FILLER                    PIC X(2)  VALUE SPACE.
008850    03 oߕʂv                      PIC N(1)  VALUE SPACE.
009030    03 o߂bl                        PIC N(4)  VALUE SPACE.
008860    03 VK`FbNv                  PIC N(1)  VALUE SPACE.
008870    03 p`FbNv                  PIC N(1)  VALUE SPACE.
          03 {pv.
             05 {p`FbNv   OCCURS 31 PIC N(1)  VALUE SPACE.
008880****************
008890* nbqR[h *
008900****************
008910* 01 nbqR[hv.
008920*    03 nbqԍv                PIC X(6)    VALUE ZERO.
008930*    03 nbq{pNv                PIC 9(4)    VALUE ZERO.
008940*    03 nbqیʂv                PIC 9(2)    VALUE ZERO.
008950*    03 nbqeЂhcv                PIC 9(2)    VALUE ZERO.
008960*    03 nbqecAԂv.
008970*       05 ecAԊҔԍv           PIC 9(6)    VALUE ZERO.
008980*       05 ecAԌۂhcv           PIC 9(1)    VALUE ZERO.
008990*    03 nbqzv                PIC 9(6)    VALUE ZERO.
009000*    03 nbqSv                PIC 9(1)    VALUE ZERO.
009010*    03 nbqڍtԍv        PIC 9(10)   VALUE ZERO.
009020*
009030************
009040*  *
009050************
009060 01 v.
009070    03 Zv.
009080       05 ԊO`FbNv                PIC N(1) VALUE SPACE.
009090       05 x`FbNv                  PIC N(1) VALUE SPACE.
009100       05 [`FbNv                  PIC N(1) VALUE SPACE.
009110    03 ÉZv.
009120       05 ԃ`FbNv                  PIC N(1) VALUE SPACE.
009130       05 \J`FbNv              PIC N(1) VALUE SPACE.
009140    03 q`FbNv.
009150       05 `FbNv                    PIC N(1) VALUE SPACE.
009160       05 `FbNv                    PIC N(1) VALUE SPACE.
009170       05 `FbNv                    PIC N(1) VALUE SPACE.
009180    03 vv                             PIC 9(7) VALUE ZERO.
009190    03 񏈒uvv                   PIC 9(6) VALUE ZERO.
009200    03 񏈒u`FbNv.
009210       05 `FbNv                PIC N(1) VALUE SPACE.
009220       05 Œ藿`FbNv                PIC N(1) VALUE SPACE.
009230       05 {×`FbNv                PIC N(1) VALUE SPACE.
      */qE^Â̕ύXEǉ/1805
          03 񐔂v                         PIC 9(2)  VALUE ZERO.
          03 ^v                           PIC 9(4)  VALUE ZERO.
009240************
009250* l *
009260************
009270 01 lv.
009280    03 KpPv                        PIC N(38) VALUE SPACE.
009290    03 KpQv                        PIC N(38) VALUE SPACE.
009300*    03 KpRv                        PIC N(38) VALUE SPACE.
009310*    03 KpSv                        PIC N(38) VALUE SPACE.
009320    03 o߃Rgv                  PIC N(60) VALUE SPACE.
      *
       01 {pv                       PIC X(150) VALUE SPACE.
       01 {pvq.
          03 {pvo                  PIC X(4)  VALUE SPACE OCCURS 31.
       01 vo                             PIC Z9    VALUE ZERO.
       01 {pv                     PIC 9(3)  VALUE ZERO.
009330*
009340*****************
009350* Zvgя *
009360*****************
009370 01 ԌŒv                         PIC N(1) VALUE SPACE.
009380 01 Ԃv                             PIC 9(4) VALUE ZERO.
009390*
       01 Ev{pv                       PIC X(100) VALUE SPACE.
       01 {pv.
          03 {pQv                      PIC X(1)  VALUE SPACE.
          03 {pPv                      PIC X(1)  VALUE SPACE.
      *
002790** Sp
002800 01 Sv                         PIC 9(2)  VALUE ZERO.
002810 01 tv                         PIC 9(2)  VALUE ZERO.
009400*******************************************************************
009410 01 .
009420     03 `̖o                     PIC X(8) VALUE SPACE.
009430     03 ڌQo                     PIC X(8) VALUE SPACE.
009440     03 ʂo                     PIC X(2) VALUE SPACE.
009450     03 go.
009460         05 [o.
009470             07 ړo             PIC X(1) VALUE SPACE.
009480             07 ړso             PIC 9(3) VALUE ZERO.
009490         05 ڍאo                 PIC X(2) VALUE SPACE.
009500     03 ʒmo                     PIC X(2) VALUE SPACE.
009510     03 jbgo                   PIC X(8) VALUE SPACE.
009520*
009530 01 vZ@Nv                     PIC 9(2) VALUE ZERO.
009540* tvnqj
009550 01 aINv                       PIC 9(4) VALUE ZERO.
009560 01 vZ@.
009570    03 vZ@N                    PIC 9(4) VALUE ZERO.
009580    03 vZ@                  PIC 9(4) VALUE ZERO.
009590 01 vZ@q REDEFINES vZ@.
009600    03 vZ@I                      PIC 9(2).
009610    03 vZ@t                      PIC 9(6).
009620    03 vZ@tq REDEFINES vZ@t.
009630       05 vZ@N                   PIC 9(4).
009640       05 vZ@Nq REDEFINES vZ@N.
009650         07 vZ@N                   PIC 9(2).
009660         07 vZ@                   PIC 9(2).
009670       05 vZ@                     PIC 9(2).
009680*
       01 vOv     PIC X(8) VALUE "MOJI2".
      *
009690******************************************************************
009700*                          A                              *
009710******************************************************************
009720**  ʓ̓f[^
009730 01 A|̓f[^ϔC IS EXTERNAL.
009740    03 A|ϔC                     PIC 9.
014620*
       01 A|̓f[^db IS EXTERNAL.
          03 A|db                     PIC 9.
009190*
       01 A|vr[ IS EXTERNAL.
          03 A|vr[敪          PIC 9.
009750*
009760** RJ
009770 01 Aԁ|L[ IS EXTERNAL.
009780    03 Aԁ|{pN.
009790       05 Aԁ|{pa               PIC 9.
009800       05 Aԁ|{pN                 PIC 9(2).
009810       05 Aԁ|{p                 PIC 9(2).
009820    03  Aԁ|҃R[h.
009830       05 Aԁ|Ҕԍ               PIC 9(6).
009840       05 Aԁ|}                   PIC X.
009850    03 Aԁ|ΏۃtO                PIC X(3).
009860    03 Aԁ|Ԍv.
009870       05 Aԁ|Ԃv                 PIC 9(2) OCCURS 9.
009880************
009890* L[ *
009900************
009910*
009920*
009930 01 A|Ώۃf[^ IS EXTERNAL.
009940    03 A|{pN.
009950       05 A|{pa                  PIC 9(1).
009960       05 A|{pN                    PIC 9(2).
009970       05 A|{p                    PIC 9(2).
009980    03 A|҃R[h.
009990       05 A|Ҕԍ                  PIC 9(6).
010000       05 A|}                      PIC X(1).
010010    03 A|ی                     PIC 9(2).
010020    03 A|یҔԍ                   PIC X(10).
010030    03 A|                     PIC 9(2).
010040    03 A|pSҔԍ               PIC X(10).
010050    03 A|                     PIC 9(2).
010060    03 A|pSҔԍ           PIC X(10).
010070    03 A|҃Ji                     PIC X(20).
010080    03 A|{lƑ敪                 PIC 9(1).
013510*
013520 01 A|L[ IS EXTERNAL.
013530    03 A|ی                  PIC 9(2).
013540*
013550************************
013560* RZbg     *
013570************************
013580 01 A|L[ IS EXTERNAL.
013590    03 A|{pN.
013600       05 A|{pa               PIC 9.
013610       05 A|{pN                 PIC 9(2).
013620       05 A|{p                 PIC 9(2).
013630    03  A|҃R[h.
013640       05 A|Ҕԍ               PIC 9(6).
013650       05 A|}                   PIC X.
013660    03 A|                    PIC 9(2).
013670    03 A|R                    PIC N(63) OCCURS 15.
013140*
014230************************
014240* EvZbg     *
014250************************
014260 01 AE|L[ IS EXTERNAL.
014270    03 AE|{pN.
014280       05 AE|{pa               PIC 9.
014290       05 AE|{pN                 PIC 9(2).
014300       05 AE|{p                 PIC 9(2).
014310    03  AE|҃R[h.
014320       05 AE|Ҕԍ               PIC 9(6).
014330       05 AE|}                   PIC X.
014340    03 AE|                    PIC 9(2).
014350    03 AE|Ev                    PIC X(126) OCCURS 30.
014340    03 AE|敪                  PIC 9(1).
013680*
013681************************
013682* Z܂Ƃ
013683************************
013684 01 AZ܂Ƃ߁|L[ IS EXTERNAL.
013685    03 AZ܂Ƃ߁|{paN.
013686       05 AZ܂Ƃ߁|{pa               PIC 9.
013687       05 AZ܂Ƃ߁|{pN.
013688          07 AZ܂Ƃ߁|{pN              PIC 9(2).
013689          07 AZ܂Ƃ߁|{p              PIC 9(2).
013690    03 AZ܂Ƃ߁|҃R[h.
013691       05 AZ܂Ƃ߁|Ҕԍ               PIC 9(6).
013692       05 AZ܂Ƃ߁|}                   PIC X(1).
013693**-------------------------------------------------------**
013694*   1:ZvgȂ̖{̂܂Ƃ߂̔
013695*   2:lEp̎ЕۏZ̔
013696    03 AZ܂Ƃ߁|敪                  PIC 9.
013697**-------------------------------------------------------**
013698*  / OUT /@ 0:ΏۊOA1:Ώ
013699    03 AZ܂Ƃ߁|茋                  PIC 9.
013700**
013701*
013702*************
013703* 
013704*************
013705 01 Á|L[ IS EXTERNAL.
013706    03 Á|             PIC 9(2).
013707    03 Á|pSҔԍ   PIC X(10).
013708*   / OUT /
013709    03 Á|̏Wc.
013710       05 Á|P            PIC N.
013711       05 Á|              PIC N(4).
013712       05 Á|          PIC N(10).
013713*
014761*
014762************************
014763* Z
014764************************
014765 01 AZ|L[ IS EXTERNAL.
014766    03 AZ|{pN.
014767       05 AZ|{pa               PIC 9.
014768       05 AZ|{pN                 PIC 9(2).
014769       05 AZ|{p                 PIC 9(2).
014770    03  AZ|҃R[h.
014771       05 AZ|Ҕԍ               PIC 9(6).
014772       05 AZ|}                   PIC X.
014773    03 AZ|ΏۃtO                PIC X(3).
014774*
013714*
      * Np
       01 ANQ|L[ IS EXTERNAL.
          03 ANQ|{paN.
             05 ANQ|{pa      PIC 9.
             05 ANQ|{pN.
               07 ANQ|{pN      PIC 9(2).
               07 ANQ|{p      PIC 9(2).
          03 ANQ|aN.
             05 ANQ|a          PIC 9.
             05 ANQ|N            PIC 9(2).
             05 ANQ|            PIC 9(2).
             05 ANQ|            PIC 9(2).
          03 ANQ|یN         PIC 9(3).
          03 ANQ|c       PIC 9.
          03 ANQ|Vl         PIC 9.
006510*
000540************************************
000550* v^t@C쐬p           *
000560************************************
000570 01 gAoqse|쐬f[^ IS EXTERNAL.
000580     03 gAoqse|t@C           PIC X(8).
000590     03 gAoqse|vr[敪       PIC 9.
000600     03 gAoqse|[vO     PIC X(8).
000610     03 gAoqse|I[oC         PIC X(8).
000993************************************
000994* v^t@C쐬p       *
000995************************************
000996 01 gAoqse|쐬f[^ IS EXTERNAL.
000997     03 gAoqse|p         PIC X(8).
006490*
      * C Agp
       01  Pv        PIC X(4096).
       01  Qv        PIC X(512).
       01  vOv  PIC X(8)  VALUE "strmoji2".
      *
      * Íp
       01 AÍ|Í IS EXTERNAL.
          03 AÍ|͏.
             05 AÍ|L               PIC X(24).
             05 AÍ|ԍ               PIC X(30).
             05 AÍ|Í.
               07 AÍ|ÍҔԍ     PIC X(6).
               07 AÍ|ÍL     PIC X.
               07 AÍ|Íԍ     PIC X.
               07 AÍ|ÍL         PIC X(24).
               07 AÍ|Íԍ         PIC X(30).
          03 AÍ|o͏.
             05 AÍ|L       PIC X(24).
             05 AÍ|ԍ       PIC X(30).
      * 
      */qE^Â̕ύXEǉ/1805
       01 A^|L[ IS EXTERNAL.
          03 A^|{paN.
             05 A^|{pa                  PIC 9(1).
             05 A^|{pN.
                07 A^|{pN                 PIC 9(2).
                07 A^|{p                 PIC 9(2).
          03 A^|҃R[h.
             05 A^|Ҕԍ                  PIC 9(6).
             05 A^|}                      PIC X(1).
          03 A^|ی                     PIC 9(2).
          03 A^|R[h                     PIC 9(2).
          03 A^|p                     PIC 9(1).
          03 A^|q.
             05 A^|qbl              PIC X(200).
             05 A^|q              OCCURS 5.
                07 A^|qaN     OCCURS 3.
                   09 A^|qaN.
                      11 A^|qa     PIC 9(1).
                      11 A^|qN.
                         13 A^|qN    PIC 9(2).
                         13 A^|q    PIC 9(2).
                   09 A^|q          PIC 9(2).
          03 A^|^.
             05 A^|^Âbl              PIC X(100).
             05 A^|^                    PIC 9(2)    OCCURS 5.
      *
       01 A^Q|L[ IS EXTERNAL.
           03 A^Q|qbl.
               05 A^Q|qblP        PIC X(130).
               05 A^Q|qblQ        PIC X(170).
      *
013715******************************************************************
013716*                      PROCEDURE  DIVISION                       *
013717******************************************************************
013720 PROCEDURE               DIVISION.
013730************
013740*           *
013750*    *
013760*           *
013770************
002570     PERFORM v^t@C쐬.
013780     PERFORM .
013790     PERFORM 擾.
013800************
013810*           *
013820* 又     *
013830*           *
013840************
013850* 
013860     PERFORM AڑҔ.
013870     PERFORM Zbg.
013880     PERFORM .
013890************
013900*           *
013910* I   *
013920*           *
013930************
013940     PERFORM f҈敪XV.
013950     PERFORM I.
013960*     PERFORM x.
013970     MOVE ZERO  TO PROGRAM-STATUS.
013980     EXIT PROGRAM.
013990*
014000*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
002860*================================================================*
002870 v^t@C쐬 SECTION.
002880*================================================================*
002890*   /  /
002900     MOVE SPACE TO gAoqse|쐬f[^.
002910     INITIALIZE gAoqse|쐬f[^.
002225     MOVE SPACE TO gAoqse|쐬f[^.
002226     INITIALIZE gAoqse|쐬f[^.
002920*
002930*
002940*-- ύXӏ --------------------------------------*
002230*   gppʃZbg
           MOVE "RECE"                TO gAoqse|p.
002970*   gpv^t@CZbg
002971     MOVE "PRTF002"             TO gAoqse|t@C.
002972*
002973*   gp钠[vOZbg
002974     MOVE "YCH6125"             TO gAoqse|[vO.
002975*
002976*-------------------------------------------------------*
002980*
002990*   / vr[敪Zbg /
003000     MOVE A|vr[敪  TO gAoqse|vr[敪.
003010*
003020     CALL   "CRTPRTF".
003030     CANCEL "CRTPRTF".
003040*
014010*================================================================*
014020  SECTION.
014030*
014040     PERFORM t@CI[v.
014050*    /* ݓt擾 */
014060     ACCEPT vZ@t FROM DATE.
014070*    /* 1980`2079N̊ԂŐݒ */
014080     IF ( vZ@N > 80 )
014090         MOVE 19 TO vZ@I
014100     ELSE
014110         MOVE 20 TO vZ@I
014120     END-IF.
014130     PERFORM Jg擾.
014140     PERFORM aIN擾.
014150     COMPUTE vZ@Nv = vZ@N - aINv.
014160*================================================================*
014170 Jg擾 SECTION.
014180*
014190     MOVE ZEROS TO |敪.
014200     READ }X^
014210     NOT INVALID KEY
014220         MOVE |Jg         TO Jgv
014230         MOVE |Z敪 TO 敪v
014240         MOVE |ZR敪 TO R敪v
014250         MOVE |Zvgt敪     TO Zvgt敪v
014260         MOVE |Zvgғt敪 TO Zvgғt敪v
014261         MOVE |S_eoc敪       TO S_eoc敪v
015320         MOVE |ۃZ             TO pʂv
014270     END-READ.
014280*
014290*================================================================*
014300 aIN擾 SECTION.
014310*
014320*     DISPLAY NC"Jgv"  Jgv UPON MSGBOX.
014330     MOVE Jgv TO |敪.
014340     READ }X^
014350     INVALID KEY
014360         DISPLAY NC"wao^Ă܂" UPON CONS
014370         DISPLAY NC"P͂dmsdqL[Ă"
014380                                                  UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
014390         ACCEPT  L[ FROM CONS
014400         PERFORM I
014410         EXIT PROGRAM
014420     NOT INVALID KEY
014430         COMPUTE Oav = Jgv - 1
014440         MOVE Oav TO |敪
014450         READ }X^
014460         INVALID KEY
014470             DISPLAY NC"wao^Ă܂" UPON CONS
014480             DISPLAY NC"P͂dmsdqL[Ă"
014490                                                      UPON CONS
000080*-----------------------------------------*
000090             CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
014500             ACCEPT  L[ FROM CONS
014510             PERFORM I
014520             EXIT PROGRAM
014530         NOT INVALID KEY
014540             MOVE |IN TO aINv
014550         END-READ
014560     END-READ.
014570*
014580*================================================================*
014590 t@CI[v SECTION.
014600*
014610     OPEN INPUT   ی҃}X^
014620         MOVE NC"ی" TO t@C.
014630         PERFORM I[v`FbN.
014640     OPEN INPUT   }X^
014650         MOVE NC"" TO t@C.
014660         PERFORM I[v`FbN.
014670     OPEN INPUT   ̃}X^
014680         MOVE NC"" TO t@C.
014690         PERFORM I[v`FbN.
007560     OPEN INPUT   Zvge
007570         MOVE NC"Z" TO t@C.
007580         PERFORM I[v`FbN.
014730     OPEN INPUT   }X^
014740         MOVE NC"" TO t@C.
014750         PERFORM I[v`FbN.
014760     OPEN INPUT   {p}X^
014770         MOVE NC"{" TO t@C.
014780         PERFORM I[v`FbN.
014790     OPEN INPUT   }X^
014800         MOVE NC"" TO t@C.
014810         PERFORM I[v`FbN.
014820     OPEN INPUT   o߃}X^
014830         MOVE NC"o" TO t@C.
014840         PERFORM I[v`FbN.
014850     OPEN INPUT   {pL^e.
014860         MOVE NC"{Le" TO t@C.
014870         PERFORM I[v`FbN.
014880     OPEN INPUT   f[^e.
014890         MOVE NC"" TO t@C.
014900         PERFORM I[v`FbN.
014910     OPEN INPUT   e.
014920         MOVE NC"" TO t@C.
014930         PERFORM I[v`FbN.
014940     OPEN INPUT   }X^.
014950         MOVE NC"}X^" TO t@C.
014960         PERFORM I[v`FbN.
014970     OPEN INPUT   hcǗ}X^
014980         MOVE NC"hc" TO t@C.
014990         PERFORM I[v`FbN.
015000     OPEN INPUT s}X^.
015010         MOVE NC"s" TO t@C.
015020         PERFORM I[v`FbN.
015030     OPEN INPUT t@C.
015040         MOVE NC"" TO t@C.
015050         PERFORM I[v`FbN.
015060     OPEN INPUT  ƃt@CS.
015170         IF ( ԃL[  NOT =  "00" )
015060            OPEN OUTPUT  ƃt@CS
                  CLOSE ƃt@CS
015060            OPEN INPUT  ƃt@CS
               END-IF.
015090     OPEN I-O   fҏe.
015100         MOVE NC"" TO t@C.
015110         PERFORM I[v`FbN.
015120     OPEN I-O   t@C
015130         PERFORM G[o.
015140*================================================================*
015150 I[v`FbN SECTION.
015160*
015170     IF ( ԃL[  NOT =  "00" )
015180         DISPLAY t@C NC"eI[vG[" UPON CONS
015190         DISPLAY NC"ԃL[F" ԃL[         UPON CONS
015200         DISPLAY NC"P͂dmsdqL[Ă"
015210                                                 UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
015220         ACCEPT  L[ FROM CONS
015230         PERFORM t@C
015240         EXIT PROGRAM.
015250*================================================================*
015260 擾 SECTION.
015270*
015280     MOVE ZERO TO |敪
015290     READ }X^
015300     NOT INVALID KEY
015310         MOVE |őo^ʐ TO őo^v
015320         MOVE |Ao^   TO Ao^v
015330         MOVE |x       TO x񐔂v
015340     END-READ.
015350*
015360*================================================================*
015370 x SECTION.
015380*
015390     PERFORM VARYING xbms FROM 1 BY 1
015400                                UNTIL xbms > x񐔂v
015410         MOVE SPACE TO xtO
015420     END-PERFORM.
015430*
015440*================================================================*
015450 AڑҔ SECTION.
015460*
015470     MOVE A|{pa           TO {pavq.
015480     MOVE A|{pN             TO {pNvq.
015490     MOVE A|{p             TO {pvq.
015500     MOVE A|ی           TO یʂvq.
015510     MOVE A|یҔԍ         TO یҔԍvq.
015520     MOVE A|           TO ʂvq.
015530     MOVE A|pSҔԍ     TO pSҔԍvq.
015540     MOVE A|           TO ʂvq.
015550     MOVE A|pSҔԍ TO pSҔԍvq.
015560     MOVE A|{lƑ敪       TO {lƑ敪vq.
015570     MOVE A|҃Ji           TO ҃Jivq.
015580     MOVE A|Ҕԍ           TO Ҕԍvq.
015590     MOVE A|}               TO }Ԃvq.
015600*================================================================*
015610 Zbg SECTION.
015620*
015630     PERFORM ڏ.
014800     PERFORM Ǎ.
015680     PERFORM 擾.
015640     PERFORM {p擾.
015650     PERFORM 擾.
015660     PERFORM fҏ擾.
015670     PERFORM f[^擾.
015690     PERFORM {pL^擾.
015700     PERFORM Zvgя擾.
015710**     PERFORM nbq擾.
015720**     PERFORM 擾.
015730**     PERFORM ȑÕf[^.
015740     PERFORM Z擾.
015750     PERFORM 擾.
015760     PERFORM ϔCN擾.
           PERFORM {p擾.
015770*
016791*-----------------------------------------------*
016800     IF ( 敪v  NOT = 1 ) AND ( Z敪v NOT = 1 )
016813        IF ( 敪v = 3 OR 4 )
016815           PERFORM Ώ۔菈
016817        ELSE
016820           PERFORM 擾
016821        END-IF
016830     END-IF.
      *//160816
      **/tdxSgQÔ
      *     IF (| = "53" ) AND (|pSҔԍ(1:4) = "8112" )
      *         MOVE NC"dS"         TO dS
      *         MOVE NC""           TO dS
      *     END-IF.
015900*
015910**********************
015920* nbqR[hZbg *
015930**********************
015940*
015950*     MOVE nbqڍtԍv     TO nbqԍ.
015960*     MOVE nbq{pNv     TO nbq{pN.
015970*     MOVE nbqیʂv     TO nbqی.
015980*     MOVE nbqeЂhcv     TO nbqeЂhc.
015990*     MOVE nbqecAԂv     TO nbqecA.
016000*     MOVE nbqzv     TO nbqz.
016010*     MOVE nbqSv     TO nbqS.
016020*
016030********************
016040* fҏZbg *
016050********************
016060     MOVE {pNv            TO {pN.
016070     MOVE {pv            TO {p.
016080*
016090*     IF ( Lv(1:1) = NC"" )
016100*        MOVE  SPACE    TO  L
016110*     ELSE
016120*        MOVE Lv    TO  L
016130*     END-IF.
016140*     IF ( ԍv(1:1) = "*"  ) OR
016150*        ( ԍv(1:2) = "" )
016160*        MOVE  SPACE      TO  ԍ
016170*     ELSE
016180*        MOVE ԍv  TO  ԍ
016190*     END-IF.
           IF ( Lv(1:1) = NC"" )
              MOVE  SPACE          TO  Lv
           END-IF.
           IF ( ԍv(1:1) = "*"  ) OR
              ( ԍv(1:2) = "" )
              MOVE  SPACE          TO  ԍv
           END-IF.
      *
           INSPECT Lv  REPLACING ALL "@" BY "  ".
           EVALUATE TRUE
           WHEN (Lv NOT = SPACE) AND (ԍv NOT = SPACE)
               MOVE SPACE TO ItOQ
               PERFORM VARYING JE^ FROM 24 BY -1
                 UNTIL (JE^ <= ZERO) OR (ItOQ NOT = SPACE)
                   IF Lv(JE^:1) NOT = SPACE
                       MOVE Lv TO Lԍv
                       MOVE "E"   TO Lԍv(JE^ + 1:2)
                       MOVE ԍv TO Lԍv(JE^ + 3:40 - JE^ - 2)
                       MOVE "YES"  TO ItOQ
                   END-IF
               END-PERFORM
               MOVE Lԍv TO Lԍ
           WHEN Lv NOT = SPACE
               MOVE Lv TO Lԍ
           WHEN ԍv NOT = SPACE
               MOVE ԍv TO Lԍ
           END-EVALUATE.
016200*
016210     MOVE یҔԍv    TO یҔԍ.
016220*     MOVE 於̂v        TO یҖ.
016230*     MOVE ی҃Jiv      TO ی҃Ji.
016240     MOVE یҎv      TO یҎ.
      */ X֔ԍEdbԍǉ /42505
           IF ({paNvq >= 42505) AND (A|db = 1)
              IF (|_X֓dbԍ = 0 OR 2) AND
                 ((X֔ԍPv NOT = SPACE) OR (X֔ԍQv NOT = SPACE))
017280           MOVE ""          TO X
017260           MOVE X֔ԍPv  TO X֔ԍP
017270           MOVE X֔ԍQv  TO X֔ԍQ
017280           MOVE "-"           TO X֋
              END-IF
              IF |_X֓dbԍ = 0 OR 3
017260           MOVE dbԍv    TO dbԍ
              END-IF
           END-IF.
016280     MOVE یҏZPv    TO ZP.
016290     MOVE یҏZQv    TO ZQ.
016300*     MOVE ҃Jiv          TO ҃Ji.
016310     MOVE Ҏv          TO Ҏ.
016320     MOVE j`FbNv        TO j`FbN.
016330     MOVE `FbNv        TO `FbN.
016340*     MOVE ʂv               TO .
016350*     MOVE `FbNv      TO `FbN.
016360*     MOVE 吳`FbNv      TO 吳`FbN.
016370     MOVE a`FbNv      TO a`FbN.
016380     MOVE `FbNv      TO `FbN.
      */C/20190408
           MOVE ߘablv         TO ߘabl.
023070     MOVE ߘa`FbNv     TO ߘa`FbN.
017390*     MOVE v              TO Ҙa.
      */C/20190408
016390*     MOVE v              TO .
016400     MOVE ҔNv            TO ҔN.
016410     MOVE Ҍv            TO Ҍ.
016420     MOVE ғv            TO ғ.
016430*     MOVE v          TO .
016440     MOVE v(1)       TO P.
016450     MOVE v(2)       TO Q.
016460     MOVE v(3)       TO R.
016470     MOVE v(4)       TO S.
016480     MOVE v(5)       TO T.
016480     MOVE v(6)       TO U.
016490*
016500     MOVE v            TO .
016510*
016520*     MOVE ۃ`FbNv      TO ۃ`FbN.
016530*     MOVE ۑg`FbNv  TO ۑg`FbN.
016540*
015190     MOVE Еۃ`FbNv     TO Еۃ`FbN.
015210     MOVE g`FbNv     TO g`FbN.
015220     MOVE ۃ`FbNv     TO ۃ`FbN.
           MOVE σ`FbNv     TO σ`FbN.
           MOVE `FbNv       TO `FbN.
           MOVE ސE`FbNv     TO ސE`FbN.
           MOVE `FbNv     TO `FbN.
015230     MOVE V`FbNv     TO V`FbN.
015240     MOVE W`FbNv     TO W`FbN.
015250     MOVE X`FbNv     TO X`FbN.
015260     MOVE PO`FbNv   TO PO`FbN.
      *
           MOVE {l`FbNv     TO {l`FbN.
           MOVE Ƒ`FbNv     TO Ƒ`FbN.
           MOVE Pƃ`FbNv     TO Pƃ`FbN.
           MOVE Q`FbNv     TO Q`FbN.
           MOVE `FbNv     TO `FbN.
           MOVE V`FbNv     TO V`FbN.
           MOVE U΃`FbNv     TO U΃`FbN.
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
              MOVE {pav         TO |敪
037380        READ }X^
037390        NOT INVALID KEY
037400            MOVE |   TO {pa
037410        END-READ
      *        MOVE "===="             TO {pa
           END-IF.
      */C/20190408
      */{̍ۑސE{̏ꍇ͕SҎ󋋎ҔԍLڂ
           IF (|ی = 01      ) AND (|یҔԍ(1:2) = "27") OR
              (|ی = 05 OR 08) AND (|یҔԍ(3:2) = "27")
               IF ( sԍv(1:2) NOT = "99" )
                   MOVE sԍv TO SҔԍ
               END-IF
               IF ( 󋋎Ҕԍv(1:1) = "*"  ) OR
                  ( 󋋎Ҕԍv(1:2) = "" )
                   MOVE SPACE        TO 󋋎Ҕԍ
               ELSE
                   MOVE 󋋎Ҕԍv TO 󋋎Ҕԍ
               END-IF
           END-IF.
      */{錧̍ہ{c̏ꍇ͕SҎ󋋎ҔԍLڂ/160609
           IF (|ی = 01) AND
              (| = 55) AND (sԍv(3:2) = "04")
               IF ( sԍv(1:2) NOT = "99" )
                   MOVE sԍv         TO SҔԍ
               END-IF
               IF ( 󋋎Ҕԍv(1:1) = "*"  ) OR
                  ( 󋋎Ҕԍv(1:2) = "" )
                  MOVE  SPACE                TO 󋋎Ҕԍ
               ELSE
                  MOVE 󋋎Ҕԍv     TO 󋋎Ҕԍ
               END-IF
           END-IF.
016550********************
016560* RZbg *
016570********************
016580*     MOVE A|R(1)    TO RP.
016590*     MOVE A|R(2)    TO RQ.
016600*     MOVE A|R(3)    TO RR.
016610*     MOVE A|R(4)    TO RS.
016620*     MOVE A|R(5)    TO RT.
016630*     MOVE A|R(6)    TO RU.
016640*     MOVE A|R(7)    TO RV.
016650*     IF ( A|R(1)  NOT = SPACE )
016660*        MOVE NC"iRj"  TO RŒ
016670*     END-IF.
016680*
016690********************
016700* f[^Zbg *
016710********************
016720* P *
016730**********
016740     MOVE v(1)       TO P.
016750     MOVE Nv(1)       TO NP.
016760     MOVE v(1)       TO P.
016770     MOVE v(1)       TO P.
016780     MOVE Nv(1)       TO NP.
016790     MOVE v(1)       TO P.
016800     MOVE v(1)       TO P.
016810     MOVE JnNv(1)       TO JnNP.
016820     MOVE Jnv(1)       TO JnP.
016830     MOVE Jnv(1)       TO JnP.
016840     MOVE INv(1)       TO INP.
016850     MOVE Iv(1)       TO IP.
016860     MOVE Iv(1)       TO IP.
016870     MOVE v(1)       TO P.
016880     MOVE `FbNv(1) TO `FbNP.
016890     MOVE ~`FbNv(1) TO ~`FbNP.
016900     MOVE ]`FbNv(1) TO ]`FbNP.
016910**********
016920* Q *
016930**********
016940     MOVE v(2)       TO Q.
016950     MOVE Nv(2)       TO NQ.
016960     MOVE v(2)       TO Q.
016970     MOVE v(2)       TO Q.
016980     MOVE Nv(2)       TO NQ.
016990     MOVE v(2)       TO Q.
017000     MOVE v(2)       TO Q.
017010     MOVE JnNv(2)       TO JnNQ.
017020     MOVE Jnv(2)       TO JnQ.
017030     MOVE Jnv(2)       TO JnQ.
017040     MOVE INv(2)       TO INQ.
017050     MOVE Iv(2)       TO IQ.
017060     MOVE Iv(2)       TO IQ.
017070     MOVE v(2)       TO Q.
017080     MOVE `FbNv(2) TO `FbNQ.
017090     MOVE ~`FbNv(2) TO ~`FbNQ.
017100     MOVE ]`FbNv(2) TO ]`FbNQ.
017110**********
017120* R *
017130**********
017140     MOVE v(3)       TO R.
017150     MOVE Nv(3)       TO NR.
017160     MOVE v(3)       TO R.
017170     MOVE v(3)       TO R.
017180     MOVE Nv(3)       TO NR.
017190     MOVE v(3)       TO R.
017200     MOVE v(3)       TO R.
017210     MOVE JnNv(3)       TO JnNR.
017220     MOVE Jnv(3)       TO JnR.
017230     MOVE Jnv(3)       TO JnR.
017240     MOVE INv(3)       TO INR.
017250     MOVE Iv(3)       TO IR.
017260     MOVE Iv(3)       TO IR.
017270     MOVE v(3)       TO R.
017280     MOVE `FbNv(3) TO `FbNR.
017290     MOVE ~`FbNv(3) TO ~`FbNR.
017300     MOVE ]`FbNv(3) TO ]`FbNR.
017310**********
017320* S *
017330**********
017340     MOVE v(4)       TO S.
017350     MOVE Nv(4)       TO NS.
017360     MOVE v(4)       TO S.
017370     MOVE v(4)       TO S.
017380     MOVE Nv(4)       TO NS.
017390     MOVE v(4)       TO S.
017400     MOVE v(4)       TO S.
017410     MOVE JnNv(4)       TO JnNS.
017420     MOVE Jnv(4)       TO JnS.
017430     MOVE Jnv(4)       TO JnS.
017440     MOVE INv(4)       TO INS.
017450     MOVE Iv(4)       TO IS.
017460     MOVE Iv(4)       TO IS.
017470     MOVE v(4)       TO S.
017480     MOVE `FbNv(4) TO `FbNS.
017490     MOVE ~`FbNv(4) TO ~`FbNS.
017500     MOVE ]`FbNv(4) TO ]`FbNS.
017510**********
017520* T *
017530**********
017540     MOVE v(5)       TO T.
017550     MOVE Nv(5)       TO NT.
017560     MOVE v(5)       TO T.
017570     MOVE v(5)       TO T.
017580     MOVE Nv(5)       TO NT.
017590     MOVE v(5)       TO T.
017600     MOVE v(5)       TO T.
017610     MOVE JnNv(5)       TO JnNT.
017620     MOVE Jnv(5)       TO JnT.
017630     MOVE Jnv(5)       TO JnT.
017640     MOVE INv(5)       TO INT.
017650     MOVE Iv(5)       TO IT.
017660     MOVE Iv(5)       TO IT.
017670     MOVE v(5)       TO T.
017680     MOVE `FbNv(5) TO `FbNT.
017690     MOVE ~`FbNv(5) TO ~`FbNT.
017700     MOVE ]`FbNv(5) TO ]`FbNT.
017710**************
017720* o߃Zbg *
017730**************
017740     PERFORM VARYING ʂbms FROM 1 BY 1
016870             UNTIL ( ʂbms > ʐv ) OR
016880                   ( ʂbms > 5 )
017770*         MOVE ʂbmsv(ʂbms)   TO oߕʂbms(ʂbms)
017780*         MOVE ʋ؂v(ʂbms)     TO ʋ(ʂbms)
017790         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
017800     END-PERFORM.
017810*****************************************
017820*     VKEp`FbNɂ        *
017830*   VK...L p...Ȃ *
017840*****************************************
017850     MOVE VK`FbNv    TO VK`FbN.
017860     MOVE p`FbNv    TO p`FbN.
017870********************
017880* f[^Zbg *
017890********************
017900*    ****************************************************************
017910*    * ijijijɂĂ͘AڂZbg *
017920*    ****************************************************************
017930     MOVE vq                   TO  .
017940     MOVE ԊO`FbNv             TO  ԊO`FbN.
017950     MOVE x`FbNv               TO  x`FbN.
017960     MOVE [`FbNv               TO  [`FbN.
017970     MOVE Zvq               TO  Z.
      *
           IF ((ԊO`FbNv NOT = SPACE) OR ([`FbNv NOT = SPACE) OR
              (x`FbNv NOT = SPACE)) AND
              ((Zv NOT = ZERO) OR (Zv NOT = ZERO))
              MOVE Zv                 TO  Z
              MOVE Z؂v               TO  Z
              MOVE Zv                 TO  Z
           END-IF.
      *
           MOVE kvq             TO  k.
017980     MOVE Čvq                   TO  Č.
017990     MOVE Ëvq                 TO  Ë.
018000     MOVE É񐔂vq                 TO  É.
018010     MOVE ×vq                   TO  ×.
018020     MOVE ԃ`FbNv               TO  ԃ`FbN.
018030     MOVE \J`FbNv           TO  \J`FbN.
018040     MOVE ÉZvq               TO  ÉZ.
      */qE^Â̕ύXEǉ/1805
           IF pʂv < 2
              IF ( {paNvq < 43006 )
018050           MOVE `FbNv              TO  `FbN
018060           MOVE `FbNv              TO  `FbN
018070           MOVE `FbNv              TO  `FbN
              ELSE
                 MOVE ALL NC""                TO  
              END-IF
           END-IF.
           IF ( {paNvq >= 43006 ) AND ( qZvq NOT = ZERO )
              MOVE 񐔂v                TO  
              MOVE NC""                    TO  
           END-IF.
018080     MOVE qZvq           TO  qZ.
018090     MOVE {p񋟗vq           TO  {p񋟗.
018100     MOVE vv                       TO v.
018110********************
018120* 񏈒uZbg *
018130********************
018140     PERFORM VARYING ʂbms FROM 1 BY 1
016870             UNTIL ( ʂbms > ʐv ) OR
016880                   ( ʂbms > 5 )
018170         MOVE 񏈒uvq(ʂbms) TO 񏈒u(ʂbms)
018180     END-PERFORM.
018190     MOVE 񏈒uvv         TO 񏈒uv
018200*
018210     MOVE {×`FbNv            TO {×`FbN.
018220     MOVE `FbNv            TO `FbN.
018230     MOVE Œ藿`FbNv            TO Œ藿`FbN.
018240********************
018250* Zbg *
018260********************
018270*    **********
018280*    * P *
018290*    **********
018300     MOVE ÒPPvq             TO ÒPP.
018310     MOVE É񐔂Pvq             TO É񐔂P.
018320     MOVE ×Pvq               TO ×P.
018330     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
018340     MOVE 㪖@Pvq             TO 㪖@P.
018350     MOVE 㪖@񐔂Pvq           TO 㪖@񐔂P.
018360     MOVE 㪖@Pvq             TO 㪖@P.
018370     MOVE dÉ񐔂Pvq             TO dÉ񐔂P.
018380     MOVE d×Pvq               TO d×P.
018390     MOVE vPvq                 TO vP.
018400     IF ( Pvq NOT = ZERO )
018410         COMPUTE P = Pvq / 100
018420     END-IF.
018430     MOVE vPvq           TO vP.
018440*    **********
018450*    * Q *
018460*    **********
018470     MOVE ÒPQvq             TO ÒPQ.
018480     MOVE É񐔂Qvq             TO É񐔂Q.
018490     MOVE ×Qvq               TO ×Q.
018500     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
018510     MOVE 㪖@Qvq             TO 㪖@Q.
018520     MOVE 㪖@񐔂Qvq           TO 㪖@񐔂Q.
018530     MOVE 㪖@Qvq             TO 㪖@Q.
018540     MOVE dÉ񐔂Qvq             TO dÉ񐔂Q.
018550     MOVE d×Qvq               TO d×Q.
018560     MOVE vQvq                 TO vQ.
018570     IF ( Qvq NOT = ZERO )
018580         COMPUTE Q = Qvq / 100
018590     END-IF.
018600     MOVE vQvq           TO vQ.
018610*    ****************
018620*    * Rʁ^W *
018630*    ****************
018640     MOVE ÒPRWvq             TO ÒPRW.
018650     MOVE É񐔂RWvq             TO É񐔂RW.
018660     MOVE ×RWvq               TO ×RW.
018670     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
018680     MOVE 㪖@RWvq             TO 㪖@RW.
018690     MOVE 㪖@񐔂RWvq           TO 㪖@񐔂RW.
018700     MOVE 㪖@RWvq             TO 㪖@RW.
018710     MOVE dÉ񐔂RWvq             TO dÉ񐔂RW.
018720     MOVE d×RWvq               TO d×RW.
018730     MOVE vRWvq                 TO vRW.
018740     MOVE ʍvRWvq         TO ʍvRW.
018750     IF ( RWvq NOT = ZERO )
018760         COMPUTE RW = RWvq / 100
018770     END-IF.
018780     MOVE vRWvq           TO vRW.
      */  0.70.6 /42505
           IF ({paNvq >= 42505)
              MOVE "60"                      TO RW
              MOVE "0.6"                     TO ʂRW
           END-IF.
018790*    ****************
018800*    * Rʁ^10 *
018810*    ****************
018820     MOVE JnROvq           TO JnRO.
018830     MOVE JnROvq           TO JnRO.
018840     MOVE ÒPROvq             TO ÒPRO.
018850     MOVE É񐔂ROvq             TO É񐔂RO.
018860     MOVE ×ROvq               TO ×RO.
018870     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
018880     MOVE 㪖@ROvq             TO 㪖@RO.
018890     MOVE 㪖@񐔂ROvq           TO 㪖@񐔂RO.
018900     MOVE 㪖@ROvq             TO 㪖@RO.
018910     MOVE dÉ񐔂ROvq             TO dÉ񐔂RO.
018920     MOVE d×ROvq               TO d×RO.
018930     MOVE vROvq                 TO vRO.
018940     IF ( ROvq NOT = ZERO )
018950         COMPUTE RO = ROvq / 100
018960     END-IF.
018970     MOVE vROvq           TO vRO.

018980*    ****************
018990*    * Sʁ^T *
019000*    ****************
019010*     MOVE ÒPSTvq             TO ÒPST.
019020*     MOVE É񐔂STvq             TO É񐔂ST.
019030*     MOVE ×STvq               TO ×ST.
019040*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
019050*     MOVE 㪖@STvq             TO 㪖@ST.
019060*     MOVE 㪖@񐔂STvq           TO 㪖@񐔂ST.
019070*     MOVE 㪖@STvq             TO 㪖@ST.
019080*     MOVE dÉ񐔂STvq             TO dÉ񐔂ST.
019090*     MOVE d×STvq               TO d×ST.
019100*     MOVE vSTvq                 TO vST.
019110*     MOVE ʍvSTvq         TO ʍvST.
019120*     IF ( STvq NOT = ZERO )
019130*         COMPUTE ST = STvq / 100
019140*     END-IF.
019150*     MOVE vSTvq           TO vST.
019160*    ****************
019170*    * Sʁ^W *
019180*    ****************
019190     MOVE JnSWvq           TO JnSW.
019200     MOVE JnSWvq           TO JnSW.
019210     MOVE ÒPSWvq             TO ÒPSW.
019220     MOVE É񐔂SWvq             TO É񐔂SW.
019230     MOVE ×SWvq               TO ×SW.
019240     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
019250     MOVE 㪖@SWvq             TO 㪖@SW.
019260     MOVE 㪖@񐔂SWvq           TO 㪖@񐔂SW.
019270     MOVE 㪖@SWvq             TO 㪖@SW.
019280     MOVE dÉ񐔂SWvq             TO dÉ񐔂SW.
019290     MOVE d×SWvq               TO d×SW.
019300     MOVE vSWvq                 TO vSW.
019310     MOVE ʍvSWvq         TO ʍvSW.
019320     IF ( SWvq NOT = ZERO )
019330         COMPUTE SW = SWvq / 100
019340     END-IF.
019350     MOVE vSWvq           TO vSW.
      */  0.70.6 /42505
           IF ({paNvq >= 42505)
              MOVE "60"                      TO SW
              MOVE "0.6"                     TO ʂSW
           END-IF.
019360*    ****************
019370*    * Sʁ^10 *
019380*    ****************
019390     MOVE JnSOvq           TO JnSO.
019400     MOVE JnSOvq           TO JnSO.
019410     MOVE ÒPSOvq             TO ÒPSO.
019420     MOVE É񐔂SOvq             TO É񐔂SO.
019430     MOVE ×SOvq               TO ×SO.
019440     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
019450     MOVE 㪖@SOvq             TO 㪖@SO.
019460     MOVE 㪖@񐔂SOvq           TO 㪖@񐔂SO.
019470     MOVE 㪖@SOvq             TO 㪖@SO.
019480     MOVE dÉ񐔂SOvq             TO dÉ񐔂SO.
019490     MOVE d×SOvq               TO d×SO.
019500     MOVE vSOvq                 TO vSO.
019510     IF ( SOvq NOT = ZERO )
019520         COMPUTE SO = SOvq / 100
019530     END-IF.
019540     MOVE vSOvq           TO vSO.
019550*
019560************************************************************************
019570* Tʁ^2.5̈󎚂͕KvȂB
019580*------------------------------------------------------------------------*
019590*    *****************
019600*    * Tʁ^2.5 *
019610*    *****************
019620*     MOVE ÒPTQvq             TO ÒPTQ.
019630*     MOVE É񐔂TQvq             TO É񐔂TQ.
019640*     MOVE ×TQvq               TO ×TQ.
019650*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
019660*     MOVE 㪖@TQvq             TO 㪖@TQ.
019670*     MOVE 㪖@񐔂TQvq           TO 㪖@񐔂TQ.
019680*     MOVE 㪖@TQvq             TO 㪖@TQ.
019690*     MOVE dÉ񐔂TQvq             TO dÉ񐔂TQ.
019700*     MOVE d×TQvq               TO d×TQ.
019710*     MOVE vTQvq                 TO vTQ.
019720*     MOVE ʍvTQvq         TO ʍvTQ.
019730*     IF ( TQvq NOT = ZERO )
019740*         COMPUTE TQ = TQvq / 100
019750*     END-IF.
019760*     MOVE vTQvq           TO vTQ.
019770************************************************************************
019780*
019790*    ****************
019800*    * Tʁ^T *
019810*    ****************
019820*     MOVE JnTTvq           TO JnTT.
019830*     MOVE JnTTvq           TO JnTT.
019840*     MOVE ÒPTTvq             TO ÒPTT.
019850*     MOVE É񐔂TTvq             TO É񐔂TT.
019860*     MOVE ×TTvq               TO ×TT.
019870*     MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT.
019880*     MOVE 㪖@TTvq             TO 㪖@TT.
019890*     MOVE 㪖@񐔂TTvq           TO 㪖@񐔂TT.
019900*     MOVE 㪖@TTvq             TO 㪖@TT.
019910*     MOVE dÉ񐔂TTvq             TO dÉ񐔂TT.
019920*     MOVE d×TTvq               TO d×TT.
019930*     MOVE vTTvq                 TO vTT.
019940*     MOVE ʍvTTvq         TO ʍvTT.
019950*     IF ( TTvq NOT = ZERO )
019960*         COMPUTE TT = TTvq / 100
019970*     END-IF.
019980*     MOVE vTTvq           TO vTT.
019990*    ****************
020000*    * Tʁ^W *
020010*    ****************
020020*     MOVE JnTWvq           TO JnTW.
020030*     MOVE JnTWvq           TO JnTW.
020040*     MOVE ÒPTWvq             TO ÒPTW.
020050*     MOVE É񐔂TWvq             TO É񐔂TW.
020060*     MOVE ×TWvq               TO ×TW.
020070*     MOVE 㪖@񐔂TWvq           TO 㪖@񐔂TW.
020080*     MOVE 㪖@TWvq             TO 㪖@TW.
020090*     MOVE 㪖@񐔂TWvq           TO 㪖@񐔂TW.
020100*     MOVE 㪖@TWvq             TO 㪖@TW.
020110*     MOVE dÉ񐔂TWvq             TO dÉ񐔂TW.
020120*     MOVE d×TWvq               TO d×TW.
020130*     MOVE vTWvq                 TO vTW.
020140*     MOVE ʍvTWvq         TO ʍvTW.
020150*     IF ( TWvq NOT = ZERO )
020160*         COMPUTE TW = TWvq / 100
020170*     END-IF.
020180*     MOVE vTWvq           TO vTW.
021220     MOVE SPACE TO ʂTv.
021230     IF vTWvq NOT = ZERO
      */t
021560        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTWvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TWvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTWvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TWvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TWvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TWvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TWvq / 㪖@񐔂TWvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TWvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TWvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TWvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TWvq / dÉ񐔂TWvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TWvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TWvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
              MOVE "x"                          TO ZLTv
      */  0.70.6 /42505
              IF ({paNvq >= 42505)
021290           MOVE "0.6 "                    TO ʗTv
              ELSE
021290           MOVE "0.7 "                    TO ʗTv
              END-IF
      */
021680        IF TWvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TWvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTWvq           TO vTv
021720        MOVE ʂTv                     TO ʂTW
021490     END-IF.
020190*    ****************
020200*    * Tʁ^10 *
020210*    ****************
020220*     MOVE JnTOvq           TO JnTO.
020230*     MOVE JnTOvq           TO JnTO.
020240*     MOVE ÒPTOvq             TO ÒPTO.
020250*     MOVE É񐔂TOvq             TO É񐔂TO.
020260*     MOVE ×TOvq               TO ×TO.
020270*     MOVE 㪖@񐔂TOvq           TO 㪖@񐔂TO.
020280*     MOVE 㪖@TOvq             TO 㪖@TO.
020290*     MOVE 㪖@񐔂TOvq           TO 㪖@񐔂TO.
020300*     MOVE 㪖@TOvq             TO 㪖@TO.
020310*     MOVE dÉ񐔂TOvq             TO dÉ񐔂TO.
020320*     MOVE d×TOvq               TO d×TO.
020330*     MOVE vTOvq                 TO vTO.
020340*     MOVE TOvq           TO TO.
020350*     IF ( TOvq NOT = ZERO )
020360*         COMPUTE TO = TOvq / 100
020370*     END-IF.
020380*     MOVE vTOvq           TO vTO.
021530     MOVE SPACE TO ʂTv.
021540     IF vTOvq NOT = ZERO
      */t
021560        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
021570        MOVE JnTOvq           TO JnTv
              MOVE ""                         TO bl
              MOVE "("                          TO ʂPv
      */×
              IF ×TOvq NOT = ZERO
                  MOVE "("                      TO ʂQv
021580            MOVE ÒPTOvq         TO ÒPTv
                  MOVE "x"                      TO ZLPv
021590            MOVE É񐔂TOvq         TO É񐔂Tv
                  MOVE "="                      TO CR[Pv
021600            MOVE ×TOvq           TO ×Tv
                  MOVE ")"                      TO ʂRv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLPv
                  MOVE "("                      TO ʂSv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLQv
021610            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Qv
021620            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂTv
              END-IF
      */㪖@
              IF 㪖@TOvq NOT = ZERO
                  MOVE "+"                      TO ZLQv
                  MOVE "("                      TO ʂUv
                  COMPUTE 㪖@PTv        =  㪖@TOvq / 㪖@񐔂TOvq
                  MOVE "x"                      TO ZLRv
021630            MOVE 㪖@񐔂TOvq       TO 㪖@񐔂Tv
                  MOVE "="                      TO CR[Rv
021640            MOVE 㪖@TOvq         TO 㪖@Tv
                  MOVE ")"                      TO ʂVv
              END-IF
      */d×
              IF d×TOvq NOT = ZERO
                  MOVE "+"                      TO ZLRv
                  MOVE "("                      TO ʂWv
                  COMPUTE dÒPTv          =  d×TOvq / dÉ񐔂TOvq
                  MOVE "x"                      TO ZLSv
021650            MOVE dÉ񐔂TOvq         TO dÉ񐔂Tv
                  MOVE "="                      TO CR[Sv
021660            MOVE d×TOvq           TO d×Tv
                  MOVE ")"                      TO ʂXv
              END-IF
      *
              MOVE ")"                          TO ʂPOv
      */
      *        ZLTv ʗTv
      */
021680        IF TOvq NOT = ZERO
                 MOVE "x"                       TO ZLUv
021690           COMPUTE Tv = TOvq / 100
021700        END-IF
      */v
              MOVE "="                          TO CR[Tv
021710        MOVE vTOvq           TO vTv
021720        MOVE ʂTv                     TO ʂTO
021730     END-IF.
020381*
020390****
020400     MOVE KpPv                       TO KpP.
020410     MOVE KpQv                       TO KpQ.
020420*     MOVE KpRv                       TO KpR.
020430*     MOVE KpSv                       TO KpS.
      *
      */qE^Â̕ύXEǉ/1805
           IF ( {paNvq >= 43006 )
              INITIALIZE A^|L[
019550        MOVE {pavq TO A^|{pa
019560        MOVE {pNvq   TO A^|{pN
019570        MOVE {pvq   TO A^|{p
019580        MOVE Ҕԍvq TO A^|Ҕԍ
019590        MOVE }Ԃvq     TO A^|}
              MOVE یʂvq TO A^|ی
              MOVE 13           TO A^|R[h
              MOVE ZERO         TO A^|p
              CALL "KINUNRYO"
              CANCEL "KINUNRYO"
              MOVE A^Q|qblP       TO qblP
              MOVE A^Q|qblQ       TO qblQ
              MOVE A^|^Âbl           TO ^Âbl
              IF ( qZvq NOT = ZERO )
                 MOVE qblP              TO qP
                 MOVE qblQ              TO qQ
              END-IF
              IF ( ^v NOT = ZERO )
                 MOVE ^Âbl                TO ^
              END-IF
           END-IF.
      *
020440     MOVE Z|v                     TO v.
      */͏܂Ƃ߂̋zLڂ/120209
020450*     MOVE Z|ZSz           TO ꕔS.
020460*     MOVE Z|Zz           TO z.
           MOVE Z|ꕔS               TO ꕔS.
           MOVE Z|z                 TO z.
020470*
      *//160816
      **/t̏dxSgQÔ/150703
      *     IF ((ʂvq = 53) AND (pSҔԍvq(1:4) =  "8112"))
021370*         MOVE Z|󋋎ҕSz        TO 󋋎ҕSz
021380*         MOVE Z|z        TO z
      *         MOVE "ȕSzF"          TO ꕔSbl
      *         MOVE "SzF"          TO zbl
      *         MOVE "~" TO ꕔS~bl z~bl
      *     END-IF.
020480*------------------------------------------------------------------------------------*
020490* ʁiZȂŁA{̃Zɂ܂Ƃ߂鎞Az͏݁EKpQɏʈ󎚁j
020500*     IF ( Z܂Ƃ߃tO = "YES" )
020510*         PERFORM vZ
020520*         MOVE Z|v          TO v
020530*         MOVE Z|󋋎ҕSz  TO ꕔS
020540*     / Z/
020550*         COMPUTE z = Z|v - Z|Z󋋎ҕSz
020560*
020570*/[Q̋󔒂ɃXgOĂ܂NOT SPACE͍̎Ōɓ]LB
020571*         IF ʗ̂v NOT = SPACE
020580*            IF ( KpQv NOT = SPACE )
020590*                MOVE SPACE TO ʗ̂vQ
020600*                STRING NC""             DELIMITED BY SIZE
020610*                       ʗ̂v     DELIMITED BY SPACE
020620*                       INTO ʗ̂vQ
020630*                END-STRING
020640*                MOVE ʗ̂vQ TO KpQ(35:4)
020650*            ELSE
020660*                STRING KpQv           DELIMITED BY SPACE
020670*                       NC""             DELIMITED BY SIZE
020680*                       ʗ̂v     DELIMITED BY SPACE
020690*                       INTO KpQ
020700*                END-STRING
020710*            END-IF
020711*         END-IF
020720*     END-IF.
      */쌧̍ۏŏʂ"60"̎A󋋎ҕSzo/2106
           IF (یʂvq = 01 OR 08) AND (|pSҔԍ(3:2) = "20") AND
              (ʂvq = 60)
021370         MOVE Z|Z󋋎ҕSz       TO z
               MOVE "󋋎ҕS"                   TO zbl
               MOVE "~" TO z~bl
               IF ( 󋋎Ҕԍv(1:1) = "*"  ) OR
                  ( 󋋎Ҕԍv(1:2) = "" )
                   MOVE  SPACE           TO 󋋎Ҕԍ
               ELSE
                   MOVE 󋋎Ҕԍv     TO 󋋎Ҕԍ
               END-IF
               MOVE SPACE                TO 󋋎ҔԍP
               MOVE SPACE                TO 󋋎ҔԍR
           END-IF.
      */QۘA̍یn{iEEqj{̂܂Ƃ߂Ŏ󋋎ҕSzo/220601
           IF (((|ی     = 01) AND (|یҔԍ(1:2) = "38")) OR
               ((|ی     = 05 OR 08) AND (|یҔԍ(3:2) = "38"))) AND
              (| NOT = ZERO)
              IF | = 52 OR 53 OR 55
021370           MOVE Z|ZSz           TO ꕔS
021370           MOVE Z|Zz           TO z
021370           MOVE Z|Zz     TO 󋋎ҕSzQ
037781           MOVE |pSҔԍ         TO SҔԍ 
                 IF ( 󋋎Ҕԍv(1:1) = "*"  ) OR
                    ( 󋋎Ҕԍv(1:2) = "" )
                    MOVE  SPACE               TO 󋋎Ҕԍ
                 ELSE
                    MOVE 󋋎Ҕԍv      TO 󋋎Ҕԍ
                 END-IF
                 MOVE SPACE                TO 󋋎ҔԍP
                 MOVE SPACE                TO 󋋎ҔԍR
                 PERFORM {p擾
                 MOVE {pv       TO {p
              END-IF
           END-IF.
020968*
020969**********************
020970* {pf[^Zbg *
020971**********************
           MOVE s{ihrv       TO s{ԍ.
020972     MOVE _tԍv           TO _tԍ.
020973*     MOVE z󗝔ԍv       TO z󗝔ԍ.
020974     MOVE {pX֔ԍPv     TO {pX֔ԍP.
020975     MOVE {pX֔ԍQv     TO {pX֔ԍQ.
      **/{pZAꍇ͏łQsɈ/0905
      *     IF {pZv(45:1) = SPACE
020976*         MOVE {pZv       TO {pZP
      *     ELSE
      *         MOVE {pZPv     TO {pZQ
      *         MOVE {pZQv     TO {pZR
      *     END-IF.
020977     MOVE {pZPv         TO {pZP.
020978     MOVE {pZQv         TO {pZQ.
020979*     MOVE ڍtԍv     TO ڍtԍ.
020980     MOVE \҃Jiv           TO \҃Ji.
020981     MOVE \Җv             TO \Җ.
020982     MOVE ڍtԍv     TO ڍtԍ.
020983     MOVE {pdbԍv       TO {pdbԍ.
020984*
020985     MOVE ڍ@v             TO ڍ@.
020986*
020987*     MOVE sxXv         TO sxX.
020988*     MOVE aʃRgv     TO a.
020989     MOVE ԍv             TO ԍ.
020990     MOVE `lJiv       TO `lJi.
020991*     MOVE `lƃJiv     TO `l.
           MOVE `lv           TO `l.
020992     MOVE RgPv           TO RgP.
020993     MOVE RgQv           TO RgQ.
021000     MOVE RgRv           TO RgR.
021000     MOVE RgSv           TO RgS.
           MOVE Z@֖Pv         TO Z@֖P.
           MOVE Z@֖Qv         TO Z@֖Q.
      *     MOVE Z@֖Rv         TO Z@֖R.
      *     MOVE Z@֖Sv         TO Z@֖S.
           MOVE xXPv             TO xXP.
           MOVE xXQv             TO xXQ.
      *     MOVE xXRv             TO xXR.
      *     MOVE xXSv             TO xXS.
           MOVE U`FbNv         TO U`FbN.
           MOVE ʃ`FbNv         TO ʃ`FbN.
           MOVE `FbNv         TO `FbN.
           MOVE s`FbNv         TO s`FbN.
           MOVE Ƀ`FbNv         TO Ƀ`FbN.
           MOVE _`FbNv         TO _`FbN.
           MOVE {X`FbNv         TO {X`FbN.
           MOVE xX`FbNv         TO xX`FbN.
           MOVE {x`FbNv       TO {x`FbN.
021010*
021020* / _tE҈ϔC /
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
               MOVE {pav         TO |敪
037380         READ }X^
037390         NOT INVALID KEY
037400             MOVE |   TO 󗝘a
037410         END-READ
      *         MOVE "===="             TO 󗝘a
           END-IF.
      */C/20190408
021030     MOVE _tNv             TO 󗝔N.
021040     MOVE _tv             TO 󗝌.
021050     MOVE _tv             TO 󗝓.
021060* ( ϔCN 邩 )
021070     IF ( A|ϔC  = ZERO )
      */C/20190408
037370     IF ({pav > 4) OR (pʂv > 1)
                   MOVE {pav         TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE |   TO ϔCa
037410             END-READ
      *             MOVE "===="             TO ϔCa
               END-IF
      */C/20190408
021080         MOVE ҈ϔCNv       TO ϔCN
021090         MOVE ҈ϔCv       TO ϔC
021100         MOVE ҈ϔCv       TO ϔC
021110     END-IF.
021120*
021130* {pID
021140     MOVE {phcv           TO {phc.
021150*
021160************************
021170* ZvgяZbg *
021180************************
021190     MOVE ԌŒv          TO ԌŒ.
021200     MOVE Ԃv              TO .
021210     MOVE Ҕԍvq        TO Ҕԍ.
021220     MOVE }Ԃvq            TO }.
021230*
021240*
021250* ʃRg
021260*     MOVE ʃRgv      TO ʃRg.
021270*
021280*     PERFORM eXg󎚏.
021310*-------------------------------------------------------------------------*
021320*---  ZEvăZbǵÄZbgSECTION ̍Ōɂ邱ƁI -----*
021330     PERFORM ZEvăZbg.
021340*-------------------------------------------------------------------------*
021341*
021342*-------------------------------------------------------------------------*
021343*---  nĹÄZbgSECTION ̍Ōɂ邱ƁI   @-----*
021344     PERFORM nL.
021345*-------------------------------------------------------------------------*
021346*
021350*
021360*================================================================*
021370 ڏ SECTION.
021380*
021390     INITIALIZE {pv.
021400     INITIALIZE fҏv.
021410     INITIALIZE v.
021420     INITIALIZE lv.
021430*     INITIALIZE nbqR[hv.
021440     INITIALIZE Pvq.
021450     INITIALIZE Qvq.
021460     INITIALIZE Rvq.
021480     INITIALIZE YCH6125P.
021470     MOVE SPACE TO YCH6125P.
021490*================================================================*
021500 擾 SECTION.
021510*
           MOVE 1            TO Z|Z.
019550     MOVE {pavq TO Z|{pa.
019560     MOVE {pNvq   TO Z|{pN.
019570     MOVE {pvq   TO Z|{p.
019580     MOVE Ҕԍvq TO Z|Ҕԍ.
019590     MOVE }Ԃvq     TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
021520********************
021530* f[^Zbg *
021540********************
021550*    ****************************************************************
021560*    * ijijijɂĂ͘AڂZbg *
021570*    ****************************************************************
021580     MOVE Z|                 TO vq.
021590     IF ( Z|ԊO = 1 )
021600         MOVE NC""                   TO ԊO`FbNv
021610     END-IF.
021620     IF ( Z|x = 1 )
021630         MOVE NC""                   TO x`FbNv
021640     END-IF.
021650     IF ( Z|[ = 1 )
021660         MOVE NC""                   TO [`FbNv
021670     END-IF.
021680*
021690     MOVE Z|Z             TO  Zvq.
           MOVE Z|k           TO  kvq.
021700     MOVE Z|Č                 TO  Čvq.
021710     MOVE Z|Ë               TO  Ëvq.
021720     MOVE Z|É               TO  É񐔂vq.
021730     MOVE Z|×                 TO  ×vq.
021740     MOVE Z|ÉZ             TO  ÉZvq.
021750*
021760     IF ( Z| = 1 )
021770         MOVE NC""                   TO ԃ`FbNv
021780     END-IF.
021790     IF ( Z|\J = 1 )
021800         MOVE NC""                   TO \J`FbNv
021810     END-IF.
021820*
021830     MOVE Z|qZ         TO  qZvq.
021840*
      */qE^Â̕ύXEǉ/1805
021850     IF ( Z| >= 1 )
021860         MOVE NC""                   TO `FbNv
021870     END-IF.
021880     IF ( Z| >= 1 )
021890         MOVE NC""                   TO `FbNv
021900     END-IF.
021910     IF ( Z| >= 1 )
021920         MOVE NC""                   TO `FbNv
021930     END-IF.
           IF ( {paNvq >= 43006 )
              MOVE Z|q        TO 񐔂v
           END-IF.
           MOVE Z|^×              TO ^v.
      *
021940*
021950     MOVE Z|{p񋟗          TO  {p񋟗vq.
021960* v
021970     MOVE Z|v                    TO vv.
021980********************
021990* 񏈒uZbg *
022000********************
022010     PERFORM VARYING ʂbms FROM 1 BY 1
022020             UNTIL ( ʂbms > ʐv )
022030         MOVE Z|񏈒u(ʂbms) TO 񏈒uvq(ʂbms)
022040         IF ( Z|񏈒u(ʂbms) NOT = ZERO )
022050            EVALUATE |(ʂbms)
022060* PEŖoE
022070            WHEN 1
022080            WHEN 2
022090            WHEN 3
022100                MOVE NC""       TO {×`FbNv
022110* EPE܁E܍Sk
022120            WHEN 4
022130            WHEN 5
022140            WHEN 7
022150                MOVE NC""       TO `FbNv
022160* sS܁EsS܍Sk
022170            WHEN 6
022180            WHEN 8
022190                MOVE NC""       TO Œ藿`FbNv
022200            END-EVALUATE
022210         END-IF
022220     END-PERFORM.
022230*
022240     MOVE Z|񏈒uv         TO 񏈒uvv.
022250********************
022260* Zbg *
022270********************
022280*    **********
022290*    * P *
022300*    **********
022310     MOVE Z|ÒPP             TO ÒPPvq.
022320     MOVE Z|É񐔂P             TO É񐔂Pvq.
022330     MOVE Z|×P               TO ×Pvq.
022340     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
022350     MOVE Z|㪖@P             TO 㪖@Pvq.
022360     MOVE Z|㪖@񐔂P           TO 㪖@񐔂Pvq.
022370     MOVE Z|㪖@P             TO 㪖@Pvq.
022380     MOVE Z|dÉ񐔂P             TO dÉ񐔂Pvq.
022390     MOVE Z|d×P               TO d×Pvq.
022400     MOVE Z|vP                 TO vPvq.
022410     MOVE Z|P           TO Pvq.
022420     MOVE Z|vP           TO vPvq.
022430*    **********
022440*    * Q *
022450*    **********
022460     MOVE Z|ÒPQ             TO ÒPQvq.
022470     MOVE Z|É񐔂Q             TO É񐔂Qvq.
022480     MOVE Z|×Q               TO ×Qvq.
022490     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
022500     MOVE Z|㪖@Q             TO 㪖@Qvq.
022510     MOVE Z|㪖@񐔂Q           TO 㪖@񐔂Qvq.
022520     MOVE Z|㪖@Q             TO 㪖@Qvq.
022530     MOVE Z|dÉ񐔂Q             TO dÉ񐔂Qvq.
022540     MOVE Z|d×Q               TO d×Qvq.
022550     MOVE Z|vQ                 TO vQvq.
022560     MOVE Z|Q           TO Qvq.
022570     MOVE Z|vQ           TO vQvq.
022580*    ****************
022590*    * Rʁ^W *
022600*    ****************
022610     MOVE Z|ÒPRW             TO ÒPRWvq.
022620     MOVE Z|É񐔂RW             TO É񐔂RWvq.
022630     MOVE Z|×RW               TO ×RWvq.
022640     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
022650     MOVE Z|㪖@RW             TO 㪖@RWvq.
022660     MOVE Z|㪖@񐔂RW           TO 㪖@񐔂RWvq.
022670     MOVE Z|㪖@RW             TO 㪖@RWvq.
022680     MOVE Z|dÉ񐔂RW             TO dÉ񐔂RWvq.
022690     MOVE Z|d×RW               TO d×RWvq.
022700     MOVE Z|vRW                 TO vRWvq.
022710     MOVE Z|ʍvRW         TO ʍvRWvq.
022720     MOVE Z|RW           TO RWvq.
022730     MOVE Z|vRW           TO vRWvq.
022740*    ****************
022750*    * Rʁ^10 *
022760*    ****************
022770     MOVE Z|JnRO           TO JnROvq.
022780     MOVE Z|JnRO           TO JnROvq.
022790     MOVE Z|ÒPRO             TO ÒPROvq.
022800     MOVE Z|É񐔂RO             TO É񐔂ROvq.
022810     MOVE Z|×RO               TO ×ROvq.
022820     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
022830     MOVE Z|㪖@RO             TO 㪖@ROvq.
022840     MOVE Z|㪖@񐔂RO           TO 㪖@񐔂ROvq.
022850     MOVE Z|㪖@RO             TO 㪖@ROvq.
022860     MOVE Z|dÉ񐔂RO             TO dÉ񐔂ROvq.
022870     MOVE Z|d×RO               TO d×ROvq.
022880     MOVE Z|vRO                 TO vROvq.
022890     MOVE Z|RO           TO ROvq.
022900     MOVE Z|vRO           TO vROvq.
022910*    ****************
022920*    * Sʁ^T *
022930*    ****************
022940     MOVE Z|ÒPST             TO ÒPSTvq.
022950     MOVE Z|É񐔂ST             TO É񐔂STvq.
022960     MOVE Z|×ST               TO ×STvq.
022970     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
022980     MOVE Z|㪖@ST             TO 㪖@STvq.
022990     MOVE Z|㪖@񐔂ST           TO 㪖@񐔂STvq.
023000     MOVE Z|㪖@ST             TO 㪖@STvq.
023010     MOVE Z|dÉ񐔂ST             TO dÉ񐔂STvq.
023020     MOVE Z|d×ST               TO d×STvq.
023030     MOVE Z|vST                 TO vSTvq.
023040     MOVE Z|ʍvST         TO ʍvSTvq.
023050     MOVE Z|ST           TO STvq.
023060     MOVE Z|vST           TO vSTvq.
023070*    ****************
023080*    * Sʁ^W *
023090*    ****************
023100     MOVE Z|JnSW           TO JnSWvq.
023110     MOVE Z|JnSW           TO JnSWvq.
023120     MOVE Z|ÒPSW             TO ÒPSWvq.
023130     MOVE Z|É񐔂SW             TO É񐔂SWvq.
023140     MOVE Z|×SW               TO ×SWvq.
023150     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
023160     MOVE Z|㪖@SW             TO 㪖@SWvq.
023170     MOVE Z|㪖@񐔂SW           TO 㪖@񐔂SWvq.
023180     MOVE Z|㪖@SW             TO 㪖@SWvq.
023190     MOVE Z|dÉ񐔂SW             TO dÉ񐔂SWvq.
023200     MOVE Z|d×SW               TO d×SWvq.
023210     MOVE Z|vSW                 TO vSWvq.
023220     MOVE Z|ʍvSW         TO ʍvSWvq.
023230     MOVE Z|SW           TO SWvq.
023240     MOVE Z|vSW           TO vSWvq.
023250*    ****************
023260*    * Sʁ^10 *
023270*    ****************
023280     MOVE Z|JnSO           TO JnSOvq.
023290     MOVE Z|JnSO           TO JnSOvq.
023300     MOVE Z|ÒPSO             TO ÒPSOvq.
023310     MOVE Z|É񐔂SO             TO É񐔂SOvq.
023320     MOVE Z|×SO               TO ×SOvq.
023330     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
023340     MOVE Z|㪖@SO             TO 㪖@SOvq.
023350     MOVE Z|㪖@񐔂SO           TO 㪖@񐔂SOvq.
023360     MOVE Z|㪖@SO             TO 㪖@SOvq.
023370     MOVE Z|dÉ񐔂SO             TO dÉ񐔂SOvq.
023380     MOVE Z|d×SO               TO d×SOvq.
023390     MOVE Z|vSO                 TO vSOvq.
023400     MOVE Z|SO           TO SOvq.
023410     MOVE Z|vSO           TO vSOvq.
023420*    *****************
023430*    * Tʁ^2.5 *
023440*    *****************
023450     MOVE Z|ÒPTQ             TO ÒPTQvq.
023460     MOVE Z|É񐔂TQ             TO É񐔂TQvq.
023470     MOVE Z|×TQ               TO ×TQvq.
023480     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
023490     MOVE Z|㪖@TQ             TO 㪖@TQvq.
023500     MOVE Z|㪖@񐔂TQ           TO 㪖@񐔂TQvq.
023510     MOVE Z|㪖@TQ             TO 㪖@TQvq.
023520     MOVE Z|dÉ񐔂TQ             TO dÉ񐔂TQvq.
023530     MOVE Z|d×TQ               TO d×TQvq.
023540     MOVE Z|vTQ                 TO vTQvq.
023550     MOVE Z|ʍvTQ         TO ʍvTQvq.
023560     MOVE Z|TQ           TO TQvq.
023570     MOVE Z|vTQ           TO vTQvq.
023580*    ****************
023590*    * Tʁ^T *
023600*    ****************
023610     MOVE Z|JnTT           TO JnTTvq.
023620     MOVE Z|JnTT           TO JnTTvq.
023630     MOVE Z|ÒPTT             TO ÒPTTvq.
023640     MOVE Z|É񐔂TT             TO É񐔂TTvq.
023650     MOVE Z|×TT               TO ×TTvq.
023660     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
023670     MOVE Z|㪖@TT             TO 㪖@TTvq.
023680     MOVE Z|㪖@񐔂TT           TO 㪖@񐔂TTvq.
023690     MOVE Z|㪖@TT             TO 㪖@TTvq.
023700     MOVE Z|dÉ񐔂TT             TO dÉ񐔂TTvq.
023710     MOVE Z|d×TT               TO d×TTvq.
023720     MOVE Z|vTT                 TO vTTvq.
023730     MOVE Z|ʍvTT         TO ʍvTTvq.
023740     MOVE Z|TT           TO TTvq.
023750     MOVE Z|vTT           TO vTTvq.
023760*    ****************
023770*    * Tʁ^W *
023780*    ****************
023790     MOVE Z|JnTW           TO JnTWvq.
023800     MOVE Z|JnTW           TO JnTWvq.
023810     MOVE Z|ÒPTW             TO ÒPTWvq.
023820     MOVE Z|É񐔂TW             TO É񐔂TWvq.
023830     MOVE Z|×TW               TO ×TWvq.
023840     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
023850     MOVE Z|㪖@TW             TO 㪖@TWvq.
023860     MOVE Z|㪖@񐔂TW           TO 㪖@񐔂TWvq.
023870     MOVE Z|㪖@TW             TO 㪖@TWvq.
023880     MOVE Z|dÉ񐔂TW             TO dÉ񐔂TWvq.
023890     MOVE Z|d×TW               TO d×TWvq.
023900     MOVE Z|vTW                 TO vTWvq.
023910     MOVE Z|ʍvTW         TO ʍvTWvq.
023920     MOVE Z|TW           TO TWvq.
023930     MOVE Z|vTW           TO vTWvq.
023940*    ****************
023950*    * Tʁ^10 *
023960*    ****************
023970     MOVE Z|JnTO           TO JnTOvq.
023980     MOVE Z|JnTO           TO JnTOvq.
023990     MOVE Z|ÒPTO             TO ÒPTOvq.
024000     MOVE Z|É񐔂TO             TO É񐔂TOvq.
024010     MOVE Z|×TO               TO ×TOvq.
024020     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
024030     MOVE Z|㪖@TO             TO 㪖@TOvq.
024040     MOVE Z|㪖@񐔂TO           TO 㪖@񐔂TOvq.
024050     MOVE Z|㪖@TO             TO 㪖@TOvq.
024060     MOVE Z|dÉ񐔂TO             TO dÉ񐔂TOvq.
024070     MOVE Z|d×TO               TO d×TOvq.
024080     MOVE Z|vTO                 TO vTOvq.
024090     MOVE Z|TO           TO TOvq.
024100     MOVE Z|vTO           TO vTOvq.
024110*
024120*================================================================*
024130 {p擾 SECTION.
024140*
024150**************************************************
024160* {@f[^gpAȉ̏擾           *
024170*  _tԍ.. _tԍvɊi[             *
024180*  ԍ ... ڍtԍvɊi[       *
024190*  \Җ ... \ҖvɊi[               *
024200*  Z1,2   ...{pZ1,2vɊi[          *
024210*  dbԍ ... {pdbԍvɊi[         *
024220**************************************************
024230     MOVE ZERO  TO {|{pԍ.
024240     READ {p}X^
024250     INVALID KEY
024260         CONTINUE
024270     NOT INVALID KEY
024280*
               MOVE {|s{ihr     TO s{ihrv
024320         MOVE {|V_tԍ       TO _tԍv
024340*
024350*         MOVE {|ڍtԍ  TO nbqڍtԍv
024360*
024370         STRING "-"                DELIMITED BY SIZE
024380                {|ڍtԍ DELIMITED BY SPACE
024390           INTO ڍtԍv
024400         END-STRING
024410*
024420         MOVE {|X֔ԍP        TO {pX֔ԍPv
024430         MOVE {|X֔ԍQ        TO {pX֔ԍQv
024440         MOVE {|\҃Ji        TO \҃Jiv
024450         MOVE {|\Җ          TO \Җv
024460         MOVE {|ڍ@          TO ڍ@v
024470*
024480         MOVE {|ZP            TO {pZPv
024490         MOVE {|ZQ            TO {pZQv
024500*         STRING {|ZP  DELIMITED BY SPACE
024510*                {|ZQ  DELIMITED BY SPACE
024520*           INTO {pZv
024530*         END-STRING
024540*
024550         MOVE {|dbԍ          TO {pdbԍv
024560**
024570** U
024580         EVALUATE یʂvq 
024590* 
024600         WHEN 01
024610            MOVE یҔԍvq       TO یҔԍrv
024620* ސE
024630         WHEN 08
024640            MOVE یҔԍvq(3:6)  TO یҔԍrv
024650         END-EVALUATE
024660**
024670** یҔԍ 13XXXX ̎A}X^
024680         IF ( یҔԍrv(1:2) = "13" )
024700             MOVE ZERO             TO  |_I敪
024690             MOVE 13               TO  |R[h
024700             MOVE ZERO             TO  |ی
024710             MOVE {paNvq TO  |ύXaN
024720             START }X^ KEY IS <  |_I敪
034410                                          |R[h
                                                |ی
                                                |ύXaN
034420                                          REVERSED
034430             END-START
034440             IF ( ԃL[ = "00" )
034450                 MOVE SPACE  TO ItOR
034460                 READ }X^ NEXT
                       END-READ
024740                 MOVE |s      TO sv
024750                 MOVE |sxX  TO sxXv
024760                 MOVE |a          TO aʂv
024770                 MOVE |ԍ          TO ԍv
024780*                 MOVE |`l        TO `lƃJiv
024780                 MOVE |`l        TO `lv
024790                 MOVE |`lJi    TO `lJiv
024800*                 EVALUATE aʂv
024810*                 WHEN 1
024820*                     MOVE "()"  TO aʃRgwv
024830*                 WHEN 2
024840*                     MOVE "()"  TO aʃRgwv
024850*                 WHEN OTHER
024860*                     MOVE SPACE   TO aʃRgwv
024870*                 END-EVALUATE
024880*
024890*                 STRING sv       DELIMITED BY SPACE
024900*                        " "                  DELIMITED BY SIZE
024910*                        sxXv   DELIMITED BY SPACE
024920*                        "  "                 DELIMITED BY SIZE
024930*                        aʃRgwv DELIMITED BY SPACE
024940*                        " "                  DELIMITED BY SIZE
024950*                        |ԍ       DELIMITED BY SPACE
024960*                        INTO sxXv
024970*                 END-STRING
024980             END-IF
024990* Œ
025000*             MOVE NC"܂A擾Lz"   TO  RgPv
025010*             MOVE NC"̎̂𒆉ڍt@"   TO  RgQv
025020*             MOVE |ڍt   TO v
025030*             STRING v             DELIMITED BY SIZE
025040*                    NC"ɈϔC܂B"   DELIMITED BY SIZE
025050*                    INTO RgSv
025060*             END-STRING
025070*
025080*             MOVE "܂A擾Lz̎̂A" TO  RgPv
025090*             MOVE "L()ڍtɈϔC"   TO  RgQv
025100*             MOVE "܂B"                             TO  RgRv
025080             MOVE "܂A擾Lz̎̂A" TO  RgPv
025090             MOVE "()ڍt  i"       TO  RgQv
025100             MOVE "(s搬2-9-5)ɈϔC"        TO  RgRv
025100             MOVE "܂B"                             TO  RgSv
025110*
025120** یҔԍ 13XXXX ȊO
025130         ELSE
025140             MOVE {|s      TO sv
025150             MOVE {|sxX  TO sxXv
025160             MOVE {|a          TO aʂv
025170             MOVE {|ԍ          TO ԍv
025180             MOVE {|`l        TO `lv
                   MOVE {|`lJi    TO `lJiv
025190             STRING sv     DELIMITED BY SPACE
025200                    " "                DELIMITED BY SIZE
025210                    sxXv DELIMITED BY SPACE
025220                    INTO sxXv
025230             END-STRING
025240*             STRING `lv           DELIMITED BY SPACE
025250*                    "  "                   DELIMITED BY SIZE
025260*                    {|`lJi   DELIMITED BY SIZE
025270*                    INTO `lƃJiv
025280*             END-STRING
025290             EVALUATE aʂv
025300             WHEN 1
025310                 MOVE NC"ij" TO aʃRgv
025320             WHEN 2
025330                 MOVE NC"ij" TO aʃRgv
025340             WHEN OTHER
025350                 MOVE SPACE      TO aʃRgv
025360             END-EVALUATE
025370         END-IF
025380*
      */͐ÛݑΉ
               MOVE NC"" TO U`FbNv
      *
               EVALUATE aʂv
               WHEN 1
                   MOVE NC"" TO ʃ`FbNv
               WHEN 2
                   MOVE NC"" TO `FbNv
               END-EVALUATE
      *
009745         IF sv NOT = SPACE
009746            PERFORM VARYING JE^ FROM 40 BY -1
009747                      UNTIL (sv(JE^:1) NOT = SPACE) OR
009748                            (JE^ <= ZERO)
009749                CONTINUE
009750            END-PERFORM
009751            IF JE^ > 4
009752               IF sv(JE^ - 3 : 4)  = "s"
009753                  MOVE  sv(1:JE^ - 4)   TO Z@֖v
009754                  MOVE NC"" TO s`FbNv
009755               ELSE
009756                  IF sv(JE^ - 3 : 4)  = ""
009757                     MOVE  sv(1:JE^ - 4)   TO Z@֖v
009758                     MOVE NC"" TO Ƀ`FbNv
009759                  ELSE
009760                     IF sv(JE^ - 3 : 4)  = "_"
009761                        MOVE  sv(1:JE^ - 4)   TO Z@֖v
009762                        MOVE NC"" TO _`FbNv
009763                     ELSE
009764                        MOVE  sv  TO Z@֖v
009765                     END-IF
009766                  END-IF
009767               END-IF
009768            ELSE
009769               MOVE  sv  TO Z@֖v
009770            END-IF
009771         END-IF
009779*
009780         IF sxXv NOT = SPACE
009781            PERFORM VARYING JE^ FROM 40 BY -1
009782                      UNTIL (sxXv(JE^:1) NOT = SPACE) OR
009783                            (JE^ <= ZERO)
009784                CONTINUE
009785            END-PERFORM
009786            IF JE^ >= 4
009787               IF sxXv(JE^ - 3 : 4)  = "{X"
009788                  MOVE  sxXv(1:JE^ - 4)   TO xXv
009789                  MOVE NC"" TO {X`FbNv
009790               ELSE
009791                  IF sxXv(JE^ - 3 : 4)  = "xX"
009792                     MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                     MOVE NC"" TO xX`FbNv
009794                  ELSE
009791                     IF sxXv(JE^ - 3 : 4)  = "x"
009792                        MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                        MOVE NC"" TO {x`FbNv
009794                     ELSE
009791                         IF sxXv(JE^ - 3 : 4)  = "{"
009792                            MOVE  sxXv(1:JE^ - 4)   TO xXv
009793                            MOVE NC"" TO {x`FbNv
009794                         ELSE
009800                             MOVE  sxXv  TO xXv
009801                         END-IF
009804                     END-IF
009805                  END-IF
009806               END-IF
009807            ELSE
009808               MOVE  sxXv  TO xXv
009809            END-IF
009810         END-IF
      *
025390*********************************************
025400** hcǗ}X^@{phc擾B
025410*   (ۑǵAΏۊO@@ΏہI2005/09 )
025420*********************************************
025430**   / {pID /
025440***         IF ( یҔԍrv(3:1)  NOT = "3" )
025450            MOVE 01                     TO hcǁ|hc敪
025460            MOVE ZERO                   TO hcǁ|{pԍ
025470            MOVE یҔԍrv(1:2)  TO hcǁ|ی
025480            MOVE SPACE                  TO hcǁ|یҔԍ
025490            READ hcǗ}X^
025500            NOT INVALID KEY
025510                MOVE hcǁ|{phcԍ   TO {phcv
025520            END-READ
025530***         END-IF
025550*
025560     END-READ.
025570*
025580*================================================================*
025590 fҏ擾 SECTION.
025600*
025610**************************************************
025620* Af[^fҏeȉ̏擾 *
025630*  {pN ..... {pNvɊi[                 *
025640*  {p ..... {pvɊi[                 *
025650*  Ҕԍ.... ҔԍvɊi[ecAԗp   *
025660*  L ....... LvɊi[                   *
025670*  ԍ ....... ԍvɊi[                   *
025680*  یҔԍ . یҔԍvɊi[             *
025690*  ی ... یʂvɊi[               *
025700*  ی҃Ji.ی҃JivɊi[           *
025710*  یҎ.یҎvɊi[           *
025720*  ZP ......یҏZPvɊi[         *
025730*  ZQ ......یҏZQvɊi[         *
025740*  ҃Ji ....҃JivɊi[               *
025750*  Ҏ ....ҎvɊi[               *
025760*  Ґ ....敪ɂ`FbN""i[ *
025770*  Ҙa ....aɂ`FbN""i[ *
025780*  ҔN ......ҔNvɊi[                 *
025790*  Ҍ ......ҌvɊi[                 *
025800*  ғ ......ғvɊi[                 *
025810*   ........̃}X^葱vɎ擾     *
025820**************************************************
025830     MOVE {pavq       TO |{pa.
025840     MOVE {pNvq         TO |{pN.
025850     MOVE {pvq         TO |{p.
025860     MOVE ҃R[hvq     TO |҃R[h.
025870     READ fҏe
025880     INVALID KEY
025890         CONTINUE
025900*            /* 肦Ȃ */
025910     NOT INVALID KEY
022660         EVALUATE |ی
022670         WHEN 01
022690            MOVE NC""        TO ۃ`FbNv
022700         WHEN 02
022710         WHEN 06
022750         WHEN 07
022720            MOVE NC""        TO Еۃ`FbNv
022730         WHEN 03
022740            MOVE NC""        TO g`FbNv
022750*         WHEN 07
022760*            MOVE NC""        TO D`FbNv
               WHEN 04
                  MOVE NC""        TO σ`FbNv
               WHEN 09
                  MOVE NC""        TO `FbNv
               WHEN 08
                  MOVE NC""        TO ސE`FbNv
               WHEN 05
                  MOVE NC""        TO `FbNv
022770         END-EVALUATE
      *
               IF | = ZERO
                   MOVE NC"" TO Pƃ`FbNv
               ELSE
                   MOVE NC"" TO Q`FbNv
               END-IF
      */QۘA̍یn{Ŗ{̃Z͒PƂɁ/20201029
               IF (((|ی     = 01) AND (|یҔԍ(1:2) = "38")) OR
                   ((|ی     = 05 OR 08) AND (|یҔԍ(3:2) = "38"))) AND
                  (| NOT = ZERO)
      */QۘA̍یn{iEEqj͖{̂܂Ƃ߂łQɁ/220601
                  IF | = 52 OR 53 OR 55
                     MOVE SPACE  TO Pƃ`FbNv
                     MOVE NC"" TO Q`FbNv
                  ELSE
                     MOVE NC"" TO Pƃ`FbNv
                     MOVE SPACE  TO Q`FbNv
                  END-IF
               END-IF
      */{Ƌ敪͂ǂꂩPɁB
               IF |ی = 05
                   EVALUATE |ʋ敪
                   WHEN 1
                   WHEN 2
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
                   END-EVALUATE
               ELSE
028984             EVALUATE |ʋ敪
                   WHEN 1
                   WHEN 2
                       MOVE NC"" TO `FbNv
                   WHEN 3
                       MOVE NC"" TO V`FbNv
028991             WHEN 6
                       MOVE NC"" TO U΃`FbNv
                   WHEN OTHER
                       IF |{lƑ敪 = 1
                           MOVE NC"" TO {l`FbNv
                       ELSE
                           MOVE NC"" TO Ƒ`FbNv
                       END-IF
028999             END-EVALUATE
               END-IF
      */SĂ̕یʂŋtɁt/130719
      *         IF |ی = 01 OR 08
                   EVALUATE Z|t
                   WHEN 10
                       MOVE NC"" TO PO`FbNv
                   WHEN 9
                       MOVE NC"" TO X`FbNv
      */̑OP͂WtɁ/110721
                       IF (|ی NOT = 05 ) AND (|ʋ敪 = 1)
                           MOVE SPACE  TO X`FbNv
                           MOVE NC"" TO W`FbNv
                       END-IF
                   WHEN 8
                       MOVE NC"" TO W`FbNv
                   WHEN 7
                       MOVE NC"" TO V`FbNv
                   END-EVALUATE
      *         END-IF
      */C/20190408
               MOVE |{pa     TO {pav
025920         MOVE |{pN       TO {pNv
025930         MOVE |{p       TO {pv
025940         MOVE |Ҕԍ     TO Ҕԍv
025950*         MOVE |L         TO Lv
025960*         MOVE |ԍ         TO ԍv
      *-----------------------------------------------------------------*
               MOVE SPACE TO AÍ|Í
      *
      *        / AÍ|͏Zbg /
               MOVE |L       TO AÍ|L
               MOVE |ԍ       TO AÍ|ԍ
               MOVE |Í TO AÍ|Í
      *
               CALL   vOv
               CANCEL vOv
      *
               MOVE AÍ|L TO Lv
               MOVE AÍ|ԍ TO ԍv
      *
      *-----------------------------------------------------------------*
025970         MOVE |یҔԍ   TO یҔԍv
025980         MOVE |ی     TO یʂv
025990** Sy؂̎}ԍ폜
026000         IF ( |ی = 01 ) AND ( |یҔԍ(1:6) = "133033" )
026010            MOVE |یҔԍ(1:6)  TO یҔԍv
026020         END-IF
026030**
026040         MOVE |ی҃Ji TO ی҃Jiv
026050         MOVE |یҎ TO یҎv
026060         MOVE |X֔ԍP   TO X֔ԍPv
026070         MOVE |X֔ԍQ   TO X֔ԍQv
026080         MOVE |ZP       TO یҏZPv
026090         MOVE |ZQ       TO یҏZQv
      */ dbԍǉ /42505
               IF |dbԍ NOT = SPACE
                  STRING "db:"        DELIMITED BY SIZE
                         |dbԍ   DELIMITED BY SPACE
                    INTO dbԍv
                  END-STRING
               ELSE
                  IF |ғdbԍ NOT = SPACE
                     STRING "db:"            DELIMITED BY SIZE
                            |ғdbԍ   DELIMITED BY SPACE
                       INTO dbԍv
                     END-STRING
                  END-IF
               END-IF
026100         MOVE |҃Ji     TO ҃Jiv
026110         MOVE |Ҏ     TO Ҏv
026120         MOVE |pSҔԍ TO sԍv
               MOVE |vҔԍ     TO 󋋎Ҕԍv
026130*
026140         EVALUATE |Ґ
026150         WHEN 1
026160             MOVE NC"j"  TO ʂv
026170             MOVE NC""  TO j`FbNv
026180         WHEN 2
026190             MOVE NC""  TO ʂv
026200             MOVE NC""  TO `FbNv
026210         END-EVALUATE
026220         EVALUATE |Ҙa
026230         WHEN 1
026240             MOVE NC""  TO v
026250             MOVE NC""    TO `FbNv
026260         WHEN 2
026270             MOVE NC"吳"  TO v
026280             MOVE NC""    TO 吳`FbNv
026290         WHEN 3
026300             MOVE NC"a"  TO v
026310             MOVE NC""    TO a`FbNv
026320         WHEN 4
026330             MOVE NC""  TO v
026340             MOVE NC""    TO `FbNv
      */C/20190408
023060         WHEN 5
                   MOVE "5"   TO ߘablv
023070             MOVE NC""  TO ߘa`FbNv
026350         END-EVALUATE
026360*
      */C/20190408
029310         IF |Ҙa > 4
037370             MOVE |Ҙa     TO |敪
037380             READ }X^
037390             NOT INVALID KEY
037400                 MOVE | TO v
037410             END-READ
029330         END-IF
      */C/20190408
026370         MOVE |ҔN  TO ҔNv
026380         MOVE |Ҍ  TO Ҍv
026390         MOVE |ғ  TO ғv
026400*
026410* ݒ
026420         IF ( {lƑ敪vq = 1 )
026430            MOVE NC"{l"    TO v
026440         ELSE
026450            MOVE 05          TO |敪R[h
026460            MOVE |    TO |̃R[h
026470            READ ̃}X^
026480            INVALID KEY
026490                MOVE SPACE    TO v
026500            NOT INVALID KEY
026510                MOVE | TO v
026520            END-READ
026530         END-IF
026540**
026550         IF ( | NOT = ZERO )
026560            PERFORM Z܂Ƃߔ
026570         ELSE
026580            MOVE SPACE TO Z܂Ƃ߃tO
026590         END-IF
      */픚{19`̏ꍇ{̂ɌSҔԍA󋋎ҔԍLڂB
               IF (| = 54) AND (|pSҔԍ(1:2) = "19")
                   MOVE |pSҔԍ TO SҔԍ 
                   MOVE |vҔԍ     TO 󋋎Ҕԍ
               END-IF
031450* 15/7`@@
031460         IF |{paN >= 41507
031470            IF ( | = 52 OR 53 OR 55 OR 60 ) AND
031480               ( |{ = 20 ) AND
031490               ( |iؖ敪 NOT = 1 ) AND
031500               ( Z|ꕔS NOT = ZERO )
031510*
031520*               MOVE |vҔԍ(1:3)   TO 󋋎ҔԍҏWvP
031530*               MOVE |vҔԍ(4:2)   TO 󋋎ҔԍҏWvQ
031540*               MOVE |vҔԍ(6:10)  TO 󋋎ҔԍҏWvR
031550*               MOVE "-"  TO 󋋎ҋ؂P 󋋎ҋ؂Q
016580               IF ( |pSҔԍ(1:2) NOT = "99" )
042910                  MOVE |pSҔԍ    TO SҔԍ 
016620               END-IF
                     IF |vҔԍ(9:7) NOT = SPACE
                        MOVE |vҔԍ(1:8)  TO 󋋎ҔԍP
                        MOVE |vҔԍ(9:7)  TO 󋋎ҔԍR
                     ELSE
                        MOVE |vҔԍ(1:7)  TO 󋋎Ҕԍ
                     END-IF
031560            END-IF
031570         END-IF
026600**
026610** 14/10`@ʋ敪Rg
026620*         IF ( |{paN >= 41410 )
026630*             IF ( | = ZERO )
026640*                EVALUATE |ʋ敪
026650*                WHEN 1
026660*                   MOVE "70ˈȏ 1"  TO ʃRgv
026670*                WHEN 2
026680*                   MOVE "70ˈȏ 2"  TO ʃRgv
026681*                WHEN 3
026682*                   MOVE "70ˈȏ 3"  TO ʃRgv
026690*                WHEN 6
026701*                   IF |{paN < 42004
026703*                      MOVE "3˖"        TO ʃRgv
026704*                   ELSE
026705*                      MOVE "`AwO" TO ʃRgv
026706*                   END-IF
026710*                END-EVALUATE
      **/VOΖ̑O҂͓ʃRgNA/100929
      *                IF |ʋ敪 = 1 OR 2 OR 3
      *                     MOVE SPACE TO ANQ|L[
      *                     INITIALIZE    ANQ|L[
      *                     MOVE |{pa TO ANQ|{pa
      *                     MOVE |{pN   TO ANQ|{pN  
      *                     MOVE |{p   TO ANQ|{p  
      *                     MOVE |Ҙa TO ANQ|a
      *                     MOVE |ҔN   TO ANQ|N
      *                     MOVE |Ҍ   TO ANQ|
      *                     MOVE |ғ   TO ANQ|
      *                     CALL   "NENREI2"
      *                     CANCEL "NENREI2"
      *                     IF ANQ|Vl = ZERO
      *                         MOVE SPACE TO ʃRgv
      *                     END-IF
      *                END-IF
026720*             END-IF
026730*         END-IF
026740*
026750     END-READ.
026760*================================================================*
026770 擾 SECTION.
026780*
026790****************************************************
026800* Af[^ی҃}X^萿擾B *
026810* ہ|敪=1̏ꍇ}X^gp   *
026820*  ...... 於̂vɊi[               *
026830****************************************************
026840     MOVE یʂvq   TO ہ|ی.
026850     MOVE یҔԍvq TO ہ|یҔԍ.
026860     READ ی҃}X^
026870     INVALID KEY
026880         MOVE SPACE           TO 於̂v
026890     NOT INVALID KEY
026900         MOVE ہ|یҖ  TO 於̂v
026910     END-READ.
026920*
026930** ۂŕیҔԍ XX3XXX ̎
026940*     IF ( یʂvq = 01 ) AND
026950*        ( یҔԍvq(3:1) = "3" )
026960*        MOVE NC"" TO ۑg`FbNv
026970** ȊO
026980*     ELSE
026990*        MOVE NC"" TO ۃ`FbNv
027000*     END-IF.
027010* 
027590*================================================================*
027600 Ǎ SECTION.
027610*
027790     MOVE {pavq       TO |{pa.
027800     MOVE {pNvq         TO |{pN.
027810     MOVE {pvq         TO |{p.
027820     MOVE ҃R[hvq     TO |҃R[h.
027830     READ f[^e
027870     NOT INVALID KEY
027900         MOVE |ʐ                   TO ʐv
           END-READ.
027020*================================================================*
027030 f[^擾 SECTION.
027040*
027050**************************************************
027060* Af[^畉f[^eȉ̏擾 *
027070*  ...ʁ{ʂɂĉHĊi[     *
027080*  N.......Nv                       *
027090*  .......v                       *
027100*  .......v                       *
027110*  JnN.......Nv                       *
027120*  Jn.......v                       *
027130*  Jn.......v                       *
027140*  IN.......INv                       *
027150*  I.......Iv                       *
027160*  I.......Iv                       *
027170*  .......v                       *
027180*  ]A敪 ....敪ɂ`FbN""i[ *
027190*  q ....敪ɂ`FbN""i[ *
027200*  o߃R[h...o߃}X^擾             *
027210**************************************************
027220*     MOVE {pavq       TO |{pa.
027230*     MOVE {pNvq         TO |{pN.
027240*     MOVE {pvq         TO |{p.
027250*     MOVE ҃R[hvq     TO |҃R[h.
027260*     READ f[^e
027270*     INVALID KEY
027280*         CONTINUE
027290**            /* 肦Ȃ */
027300*     NOT INVALID KEY
027310*         MOVE |ʐ                   TO ʐv
027320         PERFORM VARYING ʂbms FROM 1 BY 1
027330                 UNTIL ( ʂbms > ʐv ) OR
                             ( ʂbms > 5 )
027340             MOVE |(ʂbms) TO ʂv(ʂbms)
027350             MOVE |(ʂbms)     TO ʂv(ʂbms)
027360             MOVE |E敪(ʂbms) TO E敪v(ʂbms)
027370             MOVE |ʒuԍ(ʂbms)
027380                                           TO ʒuԍv(ʂbms)
027390*********************************************
027400* jS_...ʁ{ʂɂĉHĊi[ *
027410*********************************************
027420* 
027430             MOVE SPACE                     TO ̂v
027440             MOVE 03                        TO |敪R[h
027450             MOVE |(ʂbms)  TO |̃R[h
027460             READ ̃}X^
027470             INVALID KEY
027480                 MOVE SPACE        TO ̂v
027490             NOT INVALID KEY
027500                 MOVE | TO ̂v
027510             END-READ
027520* 
020710             MOVE SPACE                    TO v(ʂbms)
028160*
028170             PERFORM ʖ̖
027590*
027720             MOVE |N(ʂbms)   TO Nv(ʂbms)
027730             MOVE |(ʂbms)   TO v(ʂbms)
027740             MOVE |(ʂbms)   TO v(ʂbms)
027750             MOVE |JnN(ʂbms)   TO Nv(ʂbms)
027760             MOVE |Jn(ʂbms)   TO v(ʂbms)
027770             MOVE |Jn(ʂbms)   TO v(ʂbms)
027780             IF ( |]A敪(ʂbms) = 9 )
027790                 MOVE 99                   TO INv(ʂbms)
027800                 MOVE 99                   TO Iv(ʂbms)
027810                 MOVE 99                   TO Iv(ʂbms)
027820             ELSE
027830                 MOVE |IN(ʂbms)   TO INv(ʂbms)
027840                 MOVE |I(ʂbms)   TO Iv(ʂbms)
027850                 MOVE |I(ʂbms)   TO Iv(ʂbms)
027860             END-IF
027870* oߗ̎擾
027880             MOVE 01                         TO o|敪R[h
027890             MOVE |o߃R[h(ʂbms) TO o|o߃R[h
027900             READ o߃}X^
027910             INVALID KEY
027920                 MOVE ZERO            TO ʂbmsv(ʂbms)
027930                 MOVE SPACE           TO ʋ؂v(ʂbms)
027940                 MOVE SPACE           TO oߗ̂v(ʂbms)
027950             NOT INVALID KEY
027960*
027970                 EVALUATE ʂbms
027980                 WHEN 1
027990                     MOVE NC"@" TO oߕʂv
028000                 WHEN 2
028010                     MOVE NC"A" TO oߕʂv
028020                 WHEN 3
028030                     MOVE NC"B" TO oߕʂv
028040                 WHEN 4
028050                     MOVE NC"C" TO oߕʂv
028060                 WHEN 5
028070                     MOVE NC"D" TO oߕʂv
028080                 END-EVALUATE
028090                 STRING  oߕʂv     DELIMITED BY SPACE
028100                         o|oߗ   DELIMITED BY SPACE
028110                        INTO oߗ̂v(ʂbms)
028120                 END-STRING
028130*
028140             END-READ
028150*
028160             MOVE |]A敪(ʂbms) TO ]A敪v(ʂbms)
028170             EVALUATE |]A敪(ʂbms)
028180             WHEN 1
028190             WHEN 2
028200                 MOVE NC""               TO `FbNv(ʂbms)
028210             WHEN 3
028220                 MOVE NC""               TO ~`FbNv(ʂbms)
028230             WHEN 4
028240                 MOVE NC""               TO ]`FbNv(ʂbms)
028250             END-EVALUATE
028260*
      */̓Z|ʎ]L/160816
031230             MOVE Z|ʎ(ʂbms) TO v(ʂbms)
028270         END-PERFORM.
028280* VK/p `FbN
033380         EVALUATE Z|Z敪
               WHEN 1
033390             MOVE NC""                   TO VK`FbNv
               WHEN 2
033410             MOVE NC""                   TO p`FbNv
033400         WHEN 3
033390             MOVE NC""                   TO VK`FbNv
033410             MOVE NC""                   TO p`FbNv
               WHEN OTHER
033410             MOVE NC""                   TO p`FbNv
033420         END-EVALUATE.
028340*
028350* }Ԕp
028360         MOVE |JnfÓ蓮敪   TO JnfÓ蓮敪v.
028370* 敪
028380         MOVE |Z敪 TO Z敪v.
028370* R敪
027880         MOVE |ZR敪     TO R敪e.
028390*
028400*     END-READ.
028410*================================================================*
028420*================================================================*
028430 {pL^擾 SECTION.
028440*
028450************************************************************
028460* Pf[^畉f[^eȉ̏擾           *
028470*  Z .....敪ɂ`FbN""i[... *
028480*  ÉZ .....敪ɂ`FbN""i[... *
028490************************************************************
028500     MOVE  SPACE  TO  ČtO.
028510     PERFORM VARYING ʂbms FROM 1 BY 1 UNTIL ʂbms > ʐv
028520         IF ( {pNv = Nv(ʂbms) ) AND
028530            ( {pv = v(ʂbms) )
028540             MOVE Ҕԍvq          TO {L|Ҕԍ
028550             MOVE }Ԃvq              TO {L|}
028560             MOVE {pavq          TO {L|{pa
028570             MOVE Nv(ʂbms)  TO JnNv(ʂbms) {L|{pN
028580             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
028590             MOVE v(ʂbms)  TO Jnv(ʂbms) {L|{p
028600         ELSE
028610             MOVE Ҕԍvq          TO {L|Ҕԍ
028620             MOVE }Ԃvq              TO {L|}
028630             MOVE {pavq          TO {L|{pa
028640             MOVE {pNvq            TO {L|{pN
028650             MOVE {pvq            TO {L|{p
028660             MOVE ZERO                  TO {L|{p
028670         END-IF
028680         START {pL^e   KEY IS >= {L|҃R[h
028690                                      {L|{paN
028700         END-START
028710         IF ( ԃL[ = "00" )
      */̓Z|ʎ]L/160816
028720*             MOVE ZERO  TO v(ʂbms)
028730             MOVE ZERO  TO INvs
028740             MOVE ZERO  TO Ivs
028750             MOVE ZERO  TO Ivs
028760             MOVE SPACE TO ItOQ
028770             PERFORM {pL^eǍ
028780             IF ( ItOQ      = SPACE   ) AND
028790                ( {L|҃R[h  = ҃R[hvq ) AND
028800                ( {L|{pa    = {pavq   ) AND
028810                ( {L|{pN      = {pNvq     ) AND
028820                ( {L|{p      = {pvq     ) 
028830*
028840*        *****************************************************************
028850*        * JnN ( ̕ʂłȂA
028860*                       ł}Ԃ鎞́Aŏ̎{pJn)*
028870*        *****************************************************************
028880                 IF ( {pNv NOT = Nv(ʂbms) ) OR
028890                    ( {pv NOT = v(ʂbms) ) OR
028900                    ( JnfÓ蓮敪v = 1 )
028910                     MOVE {L|{pN   TO JnNv(ʂbms)
028920                     MOVE {L|{p   TO Jnv(ʂbms)
028930                     MOVE {L|{p   TO Jnv(ʂbms)
028940                 END-IF
028950             END-IF
028960             PERFORM UNTIL ( ItOQ         = "YES"            ) OR
028970                           ( {L|҃R[h NOT = ҃R[hvq   ) OR
028980                           ( {L|{pa   NOT = {pavq     ) OR
028990                           ( {L|{pN     NOT = {pNvq       ) OR
029000                           ( {L|{p     NOT = {pvq       ) OR
029010                           ( {L|{p         > Iv(ʂbms))
029020*               **********
029030*               *  *
029040*               **********
      */̓Z|ʎ]L/160816
029050*                COMPUTE v(ʂbms) = v(ʂbms) + 1
029060                MOVE {L|{pN               TO INvs
029070                MOVE {L|{p               TO Ivs
029080                MOVE {L|{p               TO Ivs
029090*
029100                PERFORM {pL^eǍ
029110            END-PERFORM
029120        END-IF
029130*       **************************
029140*       * pFINZbg *
029150*       **************************
029160        IF ( ]A敪v(ʂbms) = 9 )
029170            MOVE INvs    TO INv(ʂbms)
029180            MOVE Ivs    TO Iv(ʂbms)
029190            MOVE Ivs    TO Iv(ʂbms)
029200        END-IF
029210        IF ( INv(ʂbms) > 󗝔Nv )
029220            MOVE INv(ʂbms) TO 󗝔Nv
029230            MOVE Iv(ʂbms) TO 󗝌v
029240            MOVE Iv(ʂbms) TO 󗝓v
029250        END-IF
029260     END-PERFORM.
029270*
029280** ----- Ô݂𔻒 -----------*
029290*
029300*     MOVE Ҕԍvq          TO {L|Ҕԍ.
029310*     MOVE }Ԃvq              TO {L|}.
029320*     MOVE {pavq          TO {L|{pa.
029330*     MOVE {pNvq            TO {L|{pN.
029340*     MOVE {pvq            TO {L|{p.
029350*     MOVE ZERO                  TO {L|{p.
029360*     START {pL^e   KEY IS >= {L|҃R[h
029370*                                  {L|{paN
029380*     END-START.
029390*     IF ( ԃL[ = "00" )
029400*             MOVE SPACE TO ItOQ
029410*             PERFORM {pL^eǍ
029420*             IF ( ItOQ      = SPACE   ) AND
029430*                ( {L|҃R[h  = ҃R[hvq ) AND
029440*                ( {L|{pa    = {pavq   ) AND
029450*                ( {L|{pN      = {pNvq     ) AND
029460*                ( {L|{p      = {pvq     ) 
029470** {pJnČǂ
029480*                 IF ( {L|Č = 1 )
029490*                      MOVE "YES"  TO  ČtO
029500*                 END-IF
029510**
029520*             END-IF
029530*     END-IF.
029540*     IF ( ČtO = "YES" )
029550*        PERFORM Ôݔ
029560*     END-IF.
029570*
029580*================================================================*
029590*================================================================*
029600 Zvgя擾 SECTION.
029610*================================================================*
029620     MOVE {pavq       TO S|{pa.
029630     MOVE {pNvq         TO S|{pN.
029640     MOVE {pvq         TO S|{p.
029650     MOVE ҃R[hvq     TO S|҃R[h.
029660     MOVE یʂvq       TO S|ی.
029670     READ ƃt@CS
029680     NOT INVALID KEY
029690          MOVE NC""        TO ԌŒv
029700          MOVE S|    TO Ԃv
029710     END-READ.
029720*
029730*================================================================*
029740*================================================================*
029750* nbq擾 SECTION.
029760*
029770****************************************************************
029780*      ڍtԍ .....{p}X^Ɏ擾    *
029790*      {pN         .....fҏeɎ擾        *
029800*  @@ی         .....S_pۃR[h42Zbg    @*
029810*                              VK}X^ɂΉ̉\L*
029820*      weЂhc     .....Ђhc"21"Zbg            *
029830*      ecA         .....Q                        *
029840*  @@z         .....Z|zZbg        *
029850* @@ S         .....S = Z|S / 10@*
029860****************************************************************
029870* ڍtԍ
029880*     MOVE nbqڍtԍv TO nbqԍv.
029890* {pN
029900*     MOVE {pNv         TO nbq{pNv.
029910* ی = S_R[h = 42
029920*     MOVE 42                 TO nbqیʂv.
029930* weЂhc = Ђhc = 21
029940*     MOVE "21"               TO nbqeЂhcv.
029950* ecA = ecAԊҔԍv + ecAԌۂhcv
029960*     MOVE Ҕԍv         TO ecAԊҔԍv.
029970*     MOVE 1                  TO ecAԌۂhcv.
029980* z
029990*     MOVE Z|z     TO nbqzv.
030000* S
030010*     MOVE Z|S     TO Svq.
030020*     COMPUTE nbqSv = Svq / 10.
030030*================================================================*
030040 {pL^eǍ SECTION.
030050*
030060     READ {pL^e NEXT
030070     AT END
030080         MOVE "YES" TO ItOQ
030090     END-READ.
030100*================================================================*
030110  SECTION.
030120*
030130     MOVE "YCH6125P" TO  `̖o.
030140     MOVE "SCREEN"   TO  ڌQo.
030150     WRITE YCH6125P.
030160***     WRITE R[h.
030170     PERFORM G[o.
030180*================================================================*
030190 G[o SECTION.
030200*
030210     IF ( ʒmo NOT = "00" )
030220         DISPLAY NC"[G["              UPON CONS
030230         DISPLAY NC"ڌQoF" ڌQo UPON CONS
030240         DISPLAY NC"ʒmoF" ʒmo UPON CONS
030250         DISPLAY NC"goF" go UPON CONS
030260         DISPLAY NC"P͂dmsdqL[Ă"
030270                                             UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
030280         ACCEPT  L[ FROM CONS
030290         PERFORM t@C
030300         MOVE 99 TO PROGRAM-STATUS
030310         EXIT PROGRAM
030320     END-IF.
030330*================================================================*
030340 ʖ̖ SECTION.
030350*
006490     STRING Z|ʖ̂P(ʂbms)  DELIMITED BY SPACE
009980            ̂v                    DELIMITED BY SPACE
006500            Z|ʖ̂Q(ʂbms)  DELIMITED BY SPACE
006520       INTO v(ʂbms)
006570     END-STRING.
030550*
030560*================================================================*
030570 ȑÕf[^ SECTION.
030580*
030590*********************************************************************************
030600*  ŏ̏ȑO̓Ɏ{pL^R[h(A~)́A敪
030610*  pɂ`FbNB(VKƌp̗)
030620*********************************************************************************
030630** ŏ̏擾
030640     MOVE SPACE                 TO tO.
030650     MOVE Ҕԍvq          TO {L|Ҕԍ.
030660     MOVE }Ԃvq              TO {L|}.
030670     MOVE {pavq          TO {L|{pa.
030680     MOVE {pNvq            TO {L|{pN.
030690     MOVE {pvq            TO {L|{p.
030700     MOVE ZERO                  TO {L|{p.
030710     START {pL^e   KEY IS >= {L|҃R[h
030720                                  {L|{paN
030730     END-START.
030740     IF ( ԃL[ = "00" )
030750         MOVE ZERO  TO avs
030760         MOVE ZERO  TO Nvs
030770         MOVE ZERO  TO vs
030780         MOVE ZERO  TO vs
030790         MOVE SPACE TO ItOQ
030800         PERFORM {pL^eǍ
030810         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030820                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030830                       ( {L|{pa   NOT = {pavq    ) OR
030840                       ( {L|{pN     NOT = {pNvq      ) OR
030850                       ( {L|{p     NOT = {pvq      ) OR
030860                       ( tO           = "YES"           ) 
030870               IF ( {L|fË敪 = 2 )
030880                   MOVE {L|{pa           TO avs
030890                   MOVE {L|{pN             TO Nvs
030900                   MOVE {L|{p             TO vs
030910                   MOVE {L|{p             TO vs
030920                   MOVE "YES"                    TO tO
030930               END-IF
030940               PERFORM {pL^eǍ
030950         END-PERFORM
030960     END-IF.
030970*
030980* ȑÕf[^
030990     IF ( tO = "YES" )
031000        MOVE Ҕԍvq          TO {L|Ҕԍ
031010        MOVE }Ԃvq              TO {L|}
031020        MOVE avs          TO {L|{pa
031030        MOVE Nvs            TO {L|{pN
031040        MOVE vs            TO {L|{p
031050        MOVE vs            TO {L|{p
031060        START {pL^e   KEY IS <  {L|҃R[h
031070                                     {L|{paN
031080                                     REVERSED
031090        END-START
031100        IF ( ԃL[ = "00" )
031110           MOVE SPACE  TO ItOQ
031120           PERFORM {pL^eǍ
031130           IF ( ItOQ    = SPACE        ) AND
031140              ( {L|Ҕԍ  = Ҕԍvq ) AND
031150              ( {L|}      = }Ԃvq     ) AND
031160              ( {L|{pa  = avs ) AND
031170              ( {L|{pN    = Nvs   ) AND
031180              ( {L|{p    = vs   )
031190*  ȑO̓Ɏ{pL^R[h
031200                IF ( p`FbNv = SPACE )
031210                   MOVE NC""    TO p`FbNv
031220                END-IF
031230           END-IF
031240         END-IF
031250     END-IF.
031260*
031270*================================================================*
031280 擾 SECTION.
031290*
031300* RJȏ̒ "CHOUKI" Ă. 
031310     MOVE  SPACE TO  Aԁ|L[.
031320     INITIALIZE      Aԁ|L[.
031330     MOVE {pavq  TO  Aԁ|{pa.
031340     MOVE {pNvq    TO  Aԁ|{pN.
031350     MOVE {pvq    TO  Aԁ|{p.
031360     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
031370     MOVE }Ԃvq      TO  Aԁ|}.
031380*
031390     CALL   "CHOUKI".
031400     CANCEL "CHOUKI".
031410*
031420**** KpPgp (uÔ݁v鎞́A)
031430     IF ( Aԁ|ΏۃtO  = "YES" )
031440        IF ( KpPv  = SPACE )
031450           MOVE NC"{ppRʂɋL"  TO KpPv
031460        ELSE
031470           STRING KpPv           DELIMITED BY SPACE
031480                  NC"C"             DELIMITED BY SIZE
031490                  NC"{ppRʂɋL"   DELIMITED BY SIZE
031500                  INTO KpPv
031510           END-STRING
031520        END-IF
031530     END-IF.
031540*
031550*================================================================*
031560 Z擾 SECTION.
031570*****************************************************************
031580** ZԊOƐ[̎AKpɁutԁv󎚂B
031590**   ̈󎚂͌3܂ŉ\
031600*****************************************************************
031610     IF ( Z|ԊO = 1 ) OR ( Z|[ = 1 ) OR ( Z|x = 1 )
031620*
031630         MOVE Ҕԍvq          TO {L|Ҕԍ
031640         MOVE }Ԃvq              TO {L|}
031650         MOVE {pavq          TO {L|{pa
031660         MOVE {pNvq            TO {L|{pN
031670         MOVE {pvq            TO {L|{p
031680         MOVE ZERO                  TO {L|{p
031690         START {pL^e   KEY IS >= {L|҃R[h
031700                                      {L|{paN
031710         END-START
031720         IF ( ԃL[ = "00" )
031730             MOVE ZERO  TO ZJEg
031740             MOVE SPACE TO ItOQ
032630             PERFORM {pL^eǍ
031750             PERFORM UNTIL ( ItOQ         = "YES"           ) OR
031760                           ( {L|҃R[h NOT = ҃R[hvq  ) OR
031770                           ( {L|{pa   NOT = {pavq    ) OR
031780                           ( {L|{pN     NOT = {pNvq      ) OR
031790                           ( {L|{p     NOT = {pvq      ) 
031800               IF ( {L|Z = 1 OR 2 OR 3 ) AND ( {L|fË敪 = 2 )
031810                  COMPUTE ZJEg = ZJEg  + 1
031820                  IF ( ZJEg <= 3 )
031830                     MOVE {L|Z TO Z敪vs(ZJEg)
031840                     MOVE {L|t   TO Zvs(ZJEg)
031850                     MOVE {L|t   TO Zvs(ZJEg)
031860                  END-IF
031870               END-IF
031880               PERFORM {pL^eǍ
031890            END-PERFORM
031900** Z̎KpɃZbg
033380            IF ( Zvs(1) NOT = ZERO ) OR ( Zvs(1) NOT = ZERO ) 
                      MOVE Zvs(1) TO Zv
                      MOVE ":"               TO Z؂v
                      MOVE Zvs(1) TO Zv
                  END-IF
033380            IF ( Zvs(2) NOT = ZERO ) OR ( Zvs(2) NOT = ZERO ) 
031910                PERFORM ZKpZbg
                  END-IF
031920         END-IF
031930*
031940     END-IF.
031950*
031960*================================================================*
031970 ZKpZbg SECTION.
031980*
031990     PERFORM VARYING ԍJE^ FROM 1 BY 1
032000              UNTIL  ԍJE^ > 3
032010         IF ( Zvs(ԍJE^)  = ZERO )  AND 
032020            ( Zvs(ԍJE^)  = ZERO ) 
032030             CONTINUE
032040         ELSE
032050* Œ荀
032060             EVALUATE Z敪vs(ԍJE^) 
032070             WHEN 1
032080                MOVE NC"ԊO"   TO Zev(ԍJE^)
033320             WHEN 2
033330                MOVE NC"x@"   TO Zev(ԍJE^)
032090             WHEN 3
032100                MOVE NC"[@"   TO Zev(ԍJE^)
032110             END-EVALUATE
032120*
032130             MOVE NC"F"          TO Z؂v(ԍJE^)
032140             MOVE NC""          TO Œv(ԍJE^)
032150             MOVE NC""          TO Œv(ԍJE^)
032160*
032170**** {ϊ
032180* 
032190             MOVE Zvs(ԍJE^)  TO  v
032200             IF ( v >= 10 )
032210                 MOVE vP    TO ԍvP
032220                 PERFORM {ϊ
032230                 MOVE Spԍv  TO ZmvP(ԍJE^)
032240                 MOVE vQ    TO ԍvP
032250                 PERFORM {ϊ
032260                 MOVE Spԍv  TO ZmvQ(ԍJE^)
032270             ELSE
032280                 MOVE vQ    TO ԍvP
032290                 PERFORM {ϊ
032300                 MOVE Spԍv  TO ZmvQ(ԍJE^)
032310             END-IF
032320* 
032330             MOVE Zvs(ԍJE^)  TO  v
032340             MOVE vP    TO ԍvP
032350             PERFORM {ϊ
032360             MOVE Spԍv  TO ZmvP(ԍJE^)
032370             MOVE vQ    TO ԍvP
032380             PERFORM {ϊ
032390             MOVE Spԍv  TO ZmvQ(ԍJE^)
032400** 
032410        END-IF
032420     END-PERFORM.
032430*
032440     MOVE  ZWcmv(1)   TO ZPv. 
032450     MOVE  ZWcmv(2)   TO ZQv. 
032460     MOVE  ZWcmv(3)   TO ZRv. 
032470*
032480**** KpPQgpiRLڂœKpPgĂ鎞́AKpQj
032490     IF ( Zvs(2)  = ZERO ) AND ( Zvs(2)  = ZERO ) 
032500         CONTINUE
032510     ELSE
032520         IF ( KpPv  = SPACE )
032530               STRING NC"Z"       DELIMITED BY SIZE
032540                      ZPv   DELIMITED BY SIZE
032550                      ZQv   DELIMITED BY SIZE
032560                      ZRv   DELIMITED BY SIZE
032570                      INTO KpPv
032580               END-STRING
032590         ELSE
032600               STRING NC"Z"       DELIMITED BY SIZE
032610                      ZPv   DELIMITED BY SIZE
032620                      ZQv   DELIMITED BY SIZE
032630                      ZRv   DELIMITED BY SIZE
032640                      INTO KpQv
032650               END-STRING
032660         END-IF
032670     END-IF.
032680*
032690*================================================================*
032700 {ϊ SECTION.
032710*
032720     MOVE NC"O"     TO Spԍv.
032730     CALL "htoz" WITH C LINKAGE
032740                        USING ԍvP SpԍvP.
032750*
032760*================================================================*
032770*================================================================*
032780 擾 SECTION.
032790*
032800********************************************************************
032810*  R[ĥ́A1sɂ܂Ƃ߂Ĉ󎚂B
032820*  : @A Ƃœ].
032830*     R[ĥ܂Ƃ߁Ae[uɃZbg
032840*     (Aʂœ̂́A2sɂȂ)
032850********************************************************************
032860     MOVE  ZERO   TO  JE^ JE^Q.
032870     PERFORM VARYING ʂbms FROM 1 BY 1
032880             UNTIL ( ʂbms > ʐv )
032890*
032900****        IF ( |Ҕԍ(ʂbms)  NOT = ZERO )  AND
032910        IF ( |A(ʂbms)      NOT = ZERO )
032920*
032930           IF ( JE^ = ZERO )
032940               MOVE 1   TO  JE^ JE^Q
032950               MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
032960               MOVE |A(ʂbms)     TO AԂv(JE^)   AԂbv
032970               MOVE ʂbms                   TO ʂv(JE^ JE^Q)
032980           ELSE
032990              IF ( |Ҕԍ(ʂbms)  = Ҕԍbv )  AND
033000                 ( |A(ʂbms)      = AԂbv     )
033010                 COMPUTE JE^Q = JE^Q  +  1
033020                 MOVE ʂbms                  TO ʂv(JE^ JE^Q)
033030              ELSE
033040                 COMPUTE JE^ = JE^  +  1
033050                 MOVE 1   TO  JE^Q
033060                 MOVE |Ҕԍ(ʂbms) TO Ҕԍv(JE^)  Ҕԍbv
033070                 MOVE |A(ʂbms)     TO AԂv(JE^)  AԂbv
033080                 MOVE ʂbms                   TO ʂv(JE^ JE^Q)
033090              END-IF
033100           END-IF
033110        END-IF
033120     END-PERFORM.
033130**************************************************************************
033140*  }X^蕶͎擾
033150**************************************************************************
033160     MOVE  ZERO   TO  JE^ JE^Q.
033170     PERFORM VARYING JE^ FROM 1 BY 1
033180             UNTIL ( JE^ > 9 )  OR ( AԂv(JE^) = ZERO )
033190** ۂ 敪 01
033200         MOVE 01                        TO |敪R[h
033210         MOVE Ҕԍv(JE^)  TO |Ҕԍ
033220         MOVE AԂv(JE^)      TO |A
033230         READ e
033240         NOT INVALID KEY
033250             INITIALIZE vs
033260             MOVE |bl(1) TO  Pvs
033270             MOVE |bl(2) TO  Qvs
033280             MOVE |bl(3) TO  Rvs
033290             MOVE |bl(4) TO  Svs
033300             MOVE |bl(5) TO  Tvs
033310             PERFORM VARYING JE^Q FROM 1 BY 1
033320                     UNTIL ( JE^Q > 9 )  OR 
033330                           ( ʂv(JE^ JE^Q) = ZERO )
033340                EVALUATE ʂv(JE^ JE^Q)
033350                WHEN 1
033360                   MOVE "@"  TO  io[vP(JE^Q)
033370                WHEN 2
033380                   MOVE "A"  TO  io[vP(JE^Q)
033390                WHEN 3
033400                   MOVE "B"  TO  io[vP(JE^Q)
033410                WHEN 4
033420                   MOVE "C"  TO  io[vP(JE^Q)
033430                WHEN 5
033440                   MOVE "D"  TO  io[vP(JE^Q)
033410                WHEN 6
033420                   MOVE "E"  TO  io[vP(JE^Q)
033430                WHEN 7
033440                   MOVE "F"  TO  io[vP(JE^Q)
033450                WHEN OTHER
033460                   CONTINUE
033470                END-EVALUATE
033480             END-PERFORM
033490*
033572             IF |͋敪 = 1
033573                 STRING io[mv  DELIMITED BY SPACE
033574                        Pvs  DELIMITED BY SIZE
033575                        Qvs  DELIMITED BY SIZE
033576                        Rvs  DELIMITED BY SIZE
033577                        Svs  DELIMITED BY SIZE
033578                        Tvs  DELIMITED BY SIZE
033579                        INTO ev(JE^)
033580                 END-STRING
033581             ELSE
005946                 INSPECT vs REPLACING ALL Sp BY p
                       MOVE SPACE TO Pv Qv
                       MOVE io[mv TO Pv
                       MOVE Pvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Qvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Rvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Svs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                       MOVE Tvs       TO Qv
                       CALL vOv WITH C LINKAGE
                            USING BY REFERENCE Pv
                                  BY REFERENCE Qv
                        MOVE Pv TO ev(JE^)
033590             END-IF
033591*
033592         END-READ
033593     END-PERFORM.
033600*
033610     PERFORM Zbg.
033620*
033630*================================================================*
033640 Zbg SECTION.
033650*
033660**************************************************************************
033670*  ͂1s𒴂鎞́AsɕB
033680**************************************************************************
033690     MOVE  ZERO   TO  JE^ JE^Q.
033700     PERFORM VARYING JE^ FROM 1 BY 1
033710             UNTIL ( JE^ > 9 )  OR ( ev(JE^) = SPACE )
033720*
033730          INITIALIZE ewv
033740          MOVE ev(JE^)   TO ewv
033750          IF ( ePwv  NOT = SPACE )
033760              COMPUTE JE^Q = JE^Q  +  1
033770              MOVE ePwv  TO v(JE^Q)
033780          END-IF
033790          IF ( eQwv  NOT = SPACE )
033800              COMPUTE JE^Q = JE^Q  +  1
033810              MOVE eQwv  TO v(JE^Q)
033820          END-IF
033830          IF ( eRwv  NOT = SPACE )
033840              COMPUTE JE^Q = JE^Q  +  1
033850              MOVE eRwv  TO v(JE^Q)
033860          END-IF
033830          IF ( eSwv  NOT = SPACE )
033840              COMPUTE JE^Q = JE^Q  +  1
033850              MOVE eSwv  TO v(JE^Q)
033860          END-IF
033870*
033880     END-PERFORM.
033890*================================================================*
033900 擾 SECTION.
033910*
033911* 2006/04 ύX
033912*  "JOSEIMEI" Ă. 
033913     MOVE SPACE TO  Á|L[.
033914     INITIALIZE     Á|L[.
033915     MOVE ʂvq           TO Á|.
033916     MOVE pSҔԍvq TO Á|pSҔԍ.
033917*
033918     CALL   "JOSEIMEI".
033919     CANCEL "JOSEIMEI".
033920*
033921     MOVE Á|P TO v.
033922*
033923***
034290*
034300*================================================================*
034310 Ôݔ SECTION.
034320*
034330*** O̒ʉ@ 
034340     MOVE  SPACE            TO OtO.
034350     MOVE |҃R[h    TO {L|҃R[h.
034360     MOVE |{pa      TO {L|{pa.
034370     MOVE |{pN        TO {L|{pN.
034380     MOVE |{p        TO {L|{p.
034390     MOVE 1                 TO {L|{p.
034400     START {pL^e   KEY IS <  {L|҃R[h
034410                                  {L|{paN
034420                                  REVERSED
034430     END-START.
034440     IF ( ԃL[ = "00" )
034450         MOVE SPACE  TO ItOQ
034460         PERFORM {pL^eǍ
034470         IF ( ItOQ      = SPACE  ) AND
034480            ( {L|҃R[h  = |҃R[h ) AND
034490            ( {L|fË敪    = 2 ) 
034500*
034510            PERFORM O
034520**** KpPgp
034530            IF ( OtO = "YES" )
034540               MOVE NC"Ô"    TO  KpPv
034550            END-IF
034560**
034570         END-IF
034580     END-IF.
034590*
034600*================================================================*
034610 O  SECTION.
034620* 
034630*** ǂݍ񂾎{pL^̔NAOǂ (N̍ 1 ?)
034640      MOVE  SPACE  TO  OtO.
034650      INITIALIZE  vZNv JnNQv INQv.
034660**
034670      MOVE |{pa    TO IaQv.
034680      MOVE |{pN      TO INQv.
034690      MOVE |{p      TO IQv.
034700      MOVE {L|{pa  TO JnaQv.
034710      MOVE {L|{pN    TO JnNQv.
034720      MOVE {L|{p    TO JnQv.
034730*
034740      EVALUATE TRUE
034750       WHEN (JnaQv = IaQv) AND (JnNQv = INQv)
034760            PERFORM  Or
034770       WHEN (JnaQv = IaQv) AND (JnNQv NOT = INQv)
034780            PERFORM  OrN
034790       WHEN  JnaQv NOT = IaQv 
034800            PERFORM  Or
034810      END-EVALUATE.
034820*
034830      IF ( vZv = 1 )
034840         MOVE  "YES"  TO  OtO
034850      END-IF.
034860*
034870*================================================================*
034880 Or  SECTION.
034890*
034900     IF ( IQv >  JnQv )
034910         COMPUTE vZv = IQv - JnQv
034920     ELSE
034930        MOVE ZERO TO vZv
034940     END-IF.
034950*
034960*================================================================*
034970 OrN  SECTION.
034980*
034990     IF ( INQv >  JnNQv )
035000         COMPUTE vZNv = INQv - JnNQv
035010         COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
035020     ELSE
035030        MOVE ZERO TO vZv
035040     END-IF.
035050*
035060*================================================================*
035070 Or  SECTION.
035080*
035090     MOVE JnaQv TO |敪.
035100     READ }X^
035110     NOT INVALID KEY
035120         MOVE |JnN TO JnNv
035130     END-READ.
035140     MOVE IaQv TO |敪.
035150     READ }X^
035160     NOT INVALID KEY
035170         MOVE |JnN TO INv
035180     END-READ.
035190**
035200     IF ( JnNv NOT = ZERO ) AND ( INv NOT = ZERO )
035210        COMPUTE JnNv = JnNv + JnNQv - 1
035220        COMPUTE INv = INv + INQv - 1
035230*
035240        IF ( INv =  JnNv )
035250           PERFORM  Or
035260        ELSE
035270           IF ( INv >  JnNv )
035280               COMPUTE vZNv = INv - JnNv
035290               COMPUTE vZv = (vZNv * 12 + IQv) - JnQv
035300           ELSE
035310               MOVE ZERO TO vZv
035320           END-IF
035330        END-IF
035340     ELSE
035350        MOVE ZERO TO vZv
035360     END-IF.
035540*================================================================*
035550 f҈敪XV SECTION.
035560*
035570** //  fҏë敪ɂPZbgAXVB//  
035580*
035590     MOVE {pavq       TO |{pa.
035600     MOVE {pNvq         TO |{pN.
035610     MOVE {pvq         TO |{p.
035620     MOVE ҃R[hvq     TO |҃R[h.
035630     READ fҏe
035640     NOT INVALID KEY
035650         MOVE  1  TO  |Z敪
035660         REWRITE  |R[h
035670         END-REWRITE
035680         IF ( ԃL[ NOT = "00" )
035690            MOVE NC"f" TO t@C
035700            PERFORM G[\
035710         END-IF
035720     END-READ.
035730*
035740*================================================================*
035750 擾 SECTION.
035760*
035770     MOVE {pNvq   TO 󗝔Nv.
035780     MOVE {pvq   TO 󗝌v.
035790     MOVE {pavq TO |敪.
035800     READ }X^
035810     NOT INVALID KEY
035820         MOVE |JnN TO {pNv
035830     END-READ.
035840     IF ( {pNv NOT = ZERO )
035850        COMPUTE {pNv = {pNv + {pNvq - 1
035860     END-IF.
035870*
035880     EVALUATE {pvq
035890     WHEN 4
035900     WHEN 6
035910     WHEN 9
035920     WHEN 11
035930         MOVE 30 TO 󗝓v
035940     WHEN 2
035950         DIVIDE 4 INTO {pNv GIVING    v
035960                                    REMAINDER ]v
035970         END-DIVIDE
035980         IF ( ]v = ZERO )
035990             MOVE 29 TO 󗝓v
036000         ELSE
036010             MOVE 28 TO 󗝓v
036020         END-IF
036030     WHEN 1
036040     WHEN 3
036050     WHEN 5
036060     WHEN 7
036070     WHEN 8
036080     WHEN 10
036090     WHEN 12
036100         MOVE 31 TO 󗝓v
036110     WHEN OTHER
036120          CONTINUE
036130     END-EVALUATE.
036140*
036150*================================================================*
036160 ϔCN擾 SECTION.
036170*
036180** ---// ̎󗝔Nɂ́AŏIʉ@ĂׁAޔ //----
036190     MOVE 󗝔Nv   TO ŏIʉ@Nv.
036200     MOVE 󗝌v   TO ŏIʉ@v.
036210     MOVE 󗝓v   TO ŏIʉ@v.
036220***
036230* (_t)
036240     EVALUATE Zvgt敪v 
036250*    /  ŏIʉ@ /
036260     WHEN ZERO
036270         MOVE ŏIʉ@Nv TO _tNv
036280         MOVE ŏIʉ@v TO _tv
036290         MOVE ŏIʉ@v TO _tv
036300*    /   /
036310     WHEN 1 
036320         PERFORM 擾
036330         MOVE 󗝔Nv     TO _tNv
036340         MOVE 󗝌v     TO _tv
036350         MOVE 󗝓v     TO _tv
036360*    /  󎚂Ȃ /
036370     WHEN 9
036380         MOVE ZERO         TO _tNv
036390         MOVE ZERO         TO _tv
036400         MOVE ZERO         TO _tv
036410*    /  ̑́AŏIʉ@ /
036420     WHEN OTHER
036430         MOVE ŏIʉ@Nv TO _tNv
036440         MOVE ŏIʉ@v TO _tv
036450         MOVE ŏIʉ@v TO _tv
036460     END-EVALUATE.
036470**
036480* (ґ)
036490     EVALUATE Zvgғt敪v 
036500*    /  ŏIʉ@ /
036510     WHEN ZERO
036520         MOVE ŏIʉ@Nv TO ҈ϔCNv
036530         MOVE ŏIʉ@v TO ҈ϔCv
036540         MOVE ŏIʉ@v TO ҈ϔCv
036550*    /   /
036560     WHEN 1 
036570         PERFORM 擾
036580         MOVE 󗝔Nv     TO ҈ϔCNv
036590         MOVE 󗝌v     TO ҈ϔCv
036600         MOVE 󗝓v     TO ҈ϔCv
036610*    /  󎚂Ȃ /
036620     WHEN 9
036630         MOVE ZERO         TO ҈ϔCNv
036640         MOVE ZERO         TO ҈ϔCv
036650         MOVE ZERO         TO ҈ϔCv
036660*    /  ̑́AŏIʉ@ /
036670     WHEN OTHER
036680         MOVE ŏIʉ@Nv TO ҈ϔCNv
036690         MOVE ŏIʉ@v TO ҈ϔCv
036700         MOVE ŏIʉ@v TO ҈ϔCv
036710     END-EVALUATE.
036720*
036730*================================================================*
036731*================================================================*
036732 Z܂Ƃߔ SECTION.
036733*---------------------------------------------------------------------------*
036734* s}X^ǂ݁AZ܂Ƃߋ敪PłA{̕یہEސE
036735* ̎́AtOYES (z݂ň󎚁j
036736*iFls̏Q́A{̕یiیnj̃ZvgPŐAZ͂Ȃj
036737*---------------------------------------------------------------------------*
036738*
036739     MOVE SPACE TO Z܂Ƃ߃tO.
036740*     MOVE SPACE TO ʗ̂v.
036741*
036742*     MOVE |           TO s|.
036743*     MOVE |pSҔԍ TO s|sԍ.
036744*     READ s}X^
036745*     NOT INVALID KEY
036746*         IF s|Z܂Ƃߋ敪 = 1 
036747*            IF (( |ی = 01 ) AND ( |یҔԍ(3:1) NOT = "3" )) OR
036748*               ( |ی = 08 ) 
036749*                MOVE "YES" TO Z܂Ƃ߃tO
036750*
036751*                MOVE 02            TO |敪R[h
036752*                MOVE |  TO |̃R[h
036753*                READ ̃}X^
036754*                NOT INVALID KEY
036755*                    MOVE |  TO ʗ̂v
036756*                END-READ
036757*            END-IF
036758*         END-IF
036759*     END-READ.
036760*
036761** / CALL JRECEOFF /
036762*     IF Z܂Ƃ߃tO = SPACE
036763*        INITIALIZE AZ܂Ƃ߁|L[
036764*        MOVE {pavq TO AZ܂Ƃ߁|{pa
036765*        MOVE {pNvq   TO AZ܂Ƃ߁|{pN
036766*        MOVE {pvq   TO AZ܂Ƃ߁|{p
036767*        MOVE Ҕԍvq TO AZ܂Ƃ߁|Ҕԍ
036768*        MOVE }Ԃvq     TO AZ܂Ƃ߁|}
036769*       1:ZvgȂ̖{̂܂Ƃ߂̔
036770*        MOVE 1            TO AZ܂Ƃ߁|敪
036771*        CALL   "JRECEOFF"
036772*        CANCEL "JRECEOFF"
036773*
036774*        IF AZ܂Ƃ߁|茋 = 1
           IF ( Z|{̂܂Ƃߋ敪 = 1 )
036775           MOVE "YES" TO Z܂Ƃ߃tO
036776*        END-IF
036777     END-IF.
036778*
036779*----------------------------------------------------------------------*
036780** / _ސ쌧ŗLFEvɕSҔԍƎ󋋎Ҕԍ /
036781     IF ( Z܂Ƃ߃tO = "YES" ) AND
036782        ( |pSҔԍ(3:2) = "14" )
036783        IF |pSҔԍ(1:2) NOT = "99"
036784*            MOVE ALL NC"P"    TO P Q R
036785*            MOVE ALL NC"b"    TO cP cQ
036786*            MOVE NC"b"                    TO cR cS
036787*            MOVE NC"SҔԍ"        TO _ސŒP
036788*            MOVE NC"󋋎Ҕԍ"            TO _ސŒQ
036789*            MOVE NC"^"                    TO _ސŒR
036790            MOVE |pSҔԍ    TO SҔԍ 
036791            MOVE |vҔԍ        TO 󋋎Ҕԍ
036792        END-IF
036793     END-IF.
      */a̎RQcЂƂe/100518
037769     IF ( Z܂Ƃ߃tO = "YES" ) AND
037770        ( |pSҔԍ(3:2) = "30" )
037772        IF |pSҔԍ(1:2) NOT = "99"
037773*            MOVE ALL NC"P"    TO P Q R
037774*            MOVE ALL NC"b"    TO cP cQ
037775*            MOVE NC"b"                    TO cR cS
037776*            MOVE NC"SҔԍ"        TO _ސŒP
037777*            MOVE NC"󋋎Ҕԍ"            TO _ސŒQ
037778*            MOVE NC"^"                    TO _ސŒR
037781            MOVE |pSҔԍ    TO SҔԍ 
037782            MOVE |vҔԍ        TO 󋋎Ҕԍ
036792        END-IF
           END-IF.
      */ꌧ/110806
037769     IF ( Z܂Ƃ߃tO = "YES" ) AND
037770        ( |pSҔԍ(3:2) = "25" )
037772        IF |pSҔԍ(1:2) NOT = "99"
037781            MOVE |pSҔԍ    TO SҔԍ 
037782            MOVE |vҔԍ        TO 󋋎Ҕԍ
036792        END-IF
           END-IF.
036794*
037095*================================================================*
037096*================================================================*
037097 vZ SECTION.
           MOVE 3            TO Z|Z
019550     MOVE |{pa TO Z|{pa.
019560     MOVE |{pN   TO Z|{pN.
019570     MOVE |{p   TO Z|{p.
019580     MOVE |Ҕԍ TO Z|Ҕԍ.
019590     MOVE |}     TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
037290*
037213*================================================================*
037214 ZEvăZbg SECTION.
043230*---------------------------------------------------------------*
043240* Evt@CΒȒOɍăZbgB
043250* iΉȂA܂蒷R͂̂܂܁j
043260*---------------------------------------------------------------*
           PERFORM Ev擾.
           MOVE AE|Ev(1)    TO RP.
           MOVE AE|Ev(2)    TO RQ.
           MOVE AE|Ev(3)    TO RR.
           MOVE AE|Ev(4)    TO RS.
           MOVE AE|Ev(5)    TO RT.
           MOVE AE|Ev(6)    TO RU.
           MOVE AE|Ev(7)    TO RV.
           MOVE AE|Ev(8)    TO RW.
037320*
040580*================================================================*
040590 Ev擾 SECTION.
040600*
040610* Ev擾 "TEKIYBUN" Ă. 
040620     MOVE  SPACE TO  AE|L[.
040630     INITIALIZE      AE|L[.
040640     MOVE {pavq  TO  AE|{pa.
040650     MOVE {pNvq    TO  AE|{pN.
040660     MOVE {pvq    TO  AE|{p.
040670     MOVE Ҕԍvq  TO  AE|Ҕԍ.
040680     MOVE }Ԃvq      TO  AE|}.
040700*     MOVE 63            TO  AE|.
039370     MOVE 56            TO  AE|.
015000     IF (R敪e NOT = 1 )
               MOVE R敪v TO AE|敪
           ELSE
               MOVE 1                  TO AE|敪
015050     END-IF.
040710*
040720     CALL   "TEKIYBUN".
040730     CANCEL "TEKIYBUN".
040740*
044960*================================================================*
044961 Ώ۔菈 SECTION.
044963*------------------------------------------------------------------------------------*
044964* }X^́u敪v 3 iRʈȏj̎ARʈȏォ肵āA
044965* ̎̂݁AB
044966*------------------------------------------------------------------------------------*
044967*
044979     MOVE  SPACE TO  AZ|L[.
044980     INITIALIZE      AZ|L[.
044981     MOVE {pavq  TO  AZ|{pa.
044982     MOVE {pNvq    TO  AZ|{pN.
044983     MOVE {pvq    TO  AZ|{p.
044984     MOVE Ҕԍvq  TO  AZ|Ҕԍ.
044985     MOVE }Ԃvq      TO  AZ|}.
044986     CALL   "RECEHUGE".
044987     CANCEL "RECEHUGE".
044989*
044990     IF AZ|ΏۃtO = "YES"
044991        PERFORM 擾
044992     END-IF.
044993*
037500*================================================================*
037501*================================================================*
037502 nL SECTION.
037503*
037504*--------------------------------------------------------*
037505*  Foߗ̌Œ (S_eoc敪v 1 gp)
037506*  ȊO̕ʂ́Auv
037507*  ̕ʂ́Auɖv
037508*--------------------------------------------------------*
037509*
037510     IF S_eoc敪v = 1
037511*      ܂uvZbg
037512        PERFORM VARYING ʂbms FROM 1 BY 1
016870                UNTIL ( ʂbms > ʐv ) OR
016880                      ( ʂbms > 5 )
037514*
037515                 EVALUATE ʂbms
037516                 WHEN 1
037517                     MOVE NC"@" TO oߕʐv
037518                 WHEN 2
037519                     MOVE NC"A" TO oߕʐv
037520                 WHEN 3
037521                     MOVE NC"B" TO oߕʐv
037522                 WHEN 4
037523                     MOVE NC"C" TO oߕʐv
037524                 WHEN 5
037525                     MOVE NC"D" TO oߕʐv
037526                 END-EVALUATE
037527                 MOVE SPACE TO oߗ(ʂbms)
037528                 STRING  oߕʐv   DELIMITED BY SPACE
037529                         NC""         DELIMITED BY SPACE
037530                        INTO oߗ(ʂbms)
037531                 END-STRING
037532        END-PERFORM
037533*
037534*      ɁARJȏ̒
037535        MOVE  SPACE TO  Aԁ|L[
037536        INITIALIZE      Aԁ|L[
037537        MOVE {pavq  TO  Aԁ|{pa
037538        MOVE {pNvq    TO  Aԁ|{pN
037539        MOVE {pvq    TO  Aԁ|{p
037540        MOVE Ҕԍvq  TO  Aԁ|Ҕԍ
037541        MOVE }Ԃvq      TO  Aԁ|}
037542        CALL   "CHOUKI"
037543        CANCEL "CHOUKI"
037544*
037545        IF Aԁ|ΏۃtO  = "YES"
037546           PERFORM VARYING ʂbms FROM 1 BY 1
016870                   UNTIL ( ʂbms > ʐv ) OR
016880                         ( ʂbms > 5 )
037548*
037549               IF Aԁ|Ԃv(ʂbms)  >  ZERO
037550
037551                   EVALUATE ʂbms
037552                   WHEN 1
037553                       MOVE NC"@" TO oߕʐv
037554                   WHEN 2
037555                       MOVE NC"A" TO oߕʐv
037556                   WHEN 3
037557                       MOVE NC"B" TO oߕʐv
037558                   WHEN 4
037559                       MOVE NC"C" TO oߕʐv
037560                   WHEN 5
037561                       MOVE NC"D" TO oߕʐv
037562                   END-EVALUATE
037563                   MOVE SPACE TO oߗ(ʂbms)
037564                   STRING  oߕʐv   DELIMITED BY SPACE
037565                           NC"ɖ"         DELIMITED BY SPACE
037566                          INTO oߗ(ʂbms)
037567                   END-STRING
037568               END-IF
037569           END-PERFORM
037570        END-IF
037571*
037572     END-IF.
037573*
      */̍ہEސEE㍂̎Ōo߂͂ĂȂ́Ao߂/160610
           IF ((یʂvq = 01) AND (یҔԍvq(1:2) = "20")) OR
              ((یʂvq = 08) AND (یҔԍvq(3:2) = "20")) OR
              ((ʂvq = 05) AND (pSҔԍvq(3:2) = "20"))
016020        PERFORM oߎ擾
           END-IF.
018770     PERFORM VARYING ʂbms FROM 1 BY 1
018790             UNTIL ( ʂbms > 5 )
018820         MOVE oߗ̂v(ʂbms) TO oߗ(ʂbms)
018830     END-PERFORM.
037574*
040820*================================================================*
040830 oߎ擾 SECTION.
040840*
036040     MOVE  SPACE TO  Aԁ|L[.
036050     INITIALIZE      Aԁ|L[.
036060     MOVE {pavq  TO  Aԁ|{pa.
036070     MOVE {pNvq    TO  Aԁ|{pN.
036080     MOVE {pvq    TO  Aԁ|{p.
036090     MOVE Ҕԍvq  TO  Aԁ|Ҕԍ.
036100     MOVE }Ԃvq      TO  Aԁ|}.
036110*
036120     CALL   "CHOUKI".
036130     CANCEL "CHOUKI".
036140*
      */PEŖoE͓]Aɂ炸Rȏ́uǍDvA
      */ȊOׂ͂āuǍDvɂ@@@@@@@@@@@@@@@@/151217
031620     PERFORM VARYING ʂbms FROM 1 BY 1
031630             UNTIL ( ʂbms > ʐv )
               IF  (|o߃R[h(ʂbms) = ZERO)
028850             EVALUATE ʂbms
028860             WHEN 1
028870                 MOVE NC"@" TO oߕʂv
028880             WHEN 2
028890                 MOVE NC"A" TO oߕʂv
028900             WHEN 3
028910                 MOVE NC"B" TO oߕʂv
028920             WHEN 4
028930                 MOVE NC"C" TO oߕʂv
028940             WHEN 5
028950                 MOVE NC"D" TO oߕʂv
028960             END-EVALUATE
                   IF |(ʂbms) = 01 OR 02 OR 03
040850*              IF ( |]A敪(ʂbms) NOT = 1 AND 2)
040900                 IF ( Aԁ|Ԃv(ʂbms)  >= 3 )
040910                    MOVE NC"ǍD" TO  o߂bl
040920                 ELSE
040930                    MOVE NC"ǍD"     TO  o߂bl
040940                 END-IF
                   ELSE
040930                 MOVE NC"ǍD"     TO  o߂bl
040950*              END-IF
                   END-IF
                   MOVE SPACE      TO  oߗ̂v(ʂbms)
028970             STRING  oߕʂv     DELIMITED BY SPACE
028980                     o߂bl       DELIMITED BY SPACE
028990                INTO oߗ̂v(ʂbms)
029000             END-STRING
               END-IF
           END-PERFORM.
040960*
037575*================================================================*
037576*================================================================*
037577*================================================================*
037578 G[\ SECTION.
037579*
037580     DISPLAY NC"t@CG[F" t@C   UPON CONS.
037581     DISPLAY NC"ԃL[" ԃL[                 UPON CONS.
037582     DISPLAY NC"VXeǗ҂ɘAĂ"  UPON CONS.
037583     DISPLAY NC"P͂dmsdqL[Ă"
037590                                                   UPON CONS.
003321*-----------------------------------------*
003322     CALL "actcshm"  WITH C LINKAGE.
003323*-----------------------------------------*
037600     ACCEPT  L[ FROM CONS
037610     PERFORM t@C.
037620     EXIT PROGRAM.
037630*================================================================*
037640*================================================================*
037650 t@C SECTION.
037660*
037670     CLOSE t@C.
037680     CLOSE ی҃}X^     }X^          ̃}X^
037690           Zvge       }X^      {p}X^
037700           }X^     o߃}X^          fҏe
037710           {pL^e       f[^e        e
037720           }X^     hcǗ}X^      s}X^
037730           ƃt@CS   t@C.
037740*================================================================*
037750 I SECTION.
037760*
037770     PERFORM t@C.
037780*================================================================*
037790*================================================================*
037800 eXg󎚏 SECTION.
037810*
           MOVE ALL "9" TO
           {p {pN s{ԍ JnNP JnP JnP INP IP IP
           NP P P NP P P P JnNQ JnQ
           JnQ INQ IQ IQ NQ Q Q NQ Q
           Q Q JnNR JnR JnR INR IR IR NR
           R R NR R R R JnNS JnS JnS 
           INS IS IS NS S S NS S S 
           S JnNT JnT JnT INT IT IT NT T 
           T NT T T T  k Ë Č 
           qZ É × v Z {p񋟗 ÉZ Z 
           Z 񏈒u(1) 񏈒u(2) 񏈒u(3) 񏈒u(4) 񏈒u(5) 
           񏈒uv ÒPP 
      *     㪖@P 㪖@P dÒP 
           É񐔂P ×P 㪖@񐔂P 㪖@P 㪖@񐔂P 㪖@P dÉ񐔂P 
           d×P vP P vP ÒPQ É񐔂Q ×Q 㪖@񐔂Q 
           㪖@Q 㪖@񐔂Q 㪖@Q dÉ񐔂Q d×Q vQ Q vQ
           ÒPRW É񐔂RW ×RW 㪖@񐔂RW 㪖@RW 㪖@񐔂RW 
           㪖@RW dÉ񐔂RW d×RW vRW ʍvRW RW 
           vRW JnRO JnRO ÒPRO É񐔂RO ×RO 
           㪖@񐔂RO 㪖@RO 㪖@񐔂RO 㪖@RO dÉ񐔂RO d×RO 
           vRO RO vRO JnSW JnSW ÒPSW 
           É񐔂SW ×SW 㪖@񐔂SW 㪖@SW 㪖@񐔂SW 㪖@SW 
           dÉ񐔂SW d×SW vSW ʍvSW SW vSW 
           JnSO JnSO ÒPSO É񐔂SO ×SO 㪖@񐔂SO 
           㪖@SO 㪖@񐔂SO 㪖@SO dÉ񐔂SO d×SO vSO 
           SO vSO v ꕔS S z 󗝔N 󗝌 󗝓 
           ϔCN ϔC ϔC
           .
      *
           MOVE ALL "X" TO 
           SҔԍ 󋋎Ҕԍ {phc Lԍ ZP ZQ
      *      X֔ԍP X֔ԍQ X֔ԍ 
           `lJi `l _tԍ ԍ یҖ 
           ϔCRgP ϔCRgQ ϔCRgR {pX֔ԍP  
           {pX֔ԍQ {pZP {pZQ {pdbԍ \҃Ji ڍtԍ
           .
      *
           MOVE ALL NC"m" TO
           P Q R S T oߗ(1) 
           oߗ(2) oߗ(3) oߗ(4) oߗ(5) KpP KpQ ʂTKp 
           .
      *
           MOVE ALL "m" TO
           یҎ Ҏ \Җ ڍ@
           RP RQ RR RS RT RU
           .
      *
           MOVE NC"" TO
           ʃ`FbN U`FbN `FbN {X`FbN xX`FbN {x`FbN 
           s`FbN Ƀ`FbN _`FbN {p`FbNP {p`FbNQ 
           {p`FbNR {p`FbNS {p`FbNT {p`FbNU {p`FbNV 
           {p`FbNW {p`FbNX {p`FbNPO {p`FbNPP {p`FbNPQ 
           {p`FbNPR {p`FbNPS {p`FbNPT {p`FbNPU 
           {p`FbNPV {p`FbNPW {p`FbNPX {p`FbNQO 
           {p`FbNQP {p`FbNQQ {p`FbNQR {p`FbNQS 
           {p`FbNQT {p`FbNQU {p`FbNQV {p`FbNQW 
           {p`FbNQX {p`FbNRO {p`FbNRP [`FbN ԊO`FbN 
           x`FbN Œ藿`FbN `FbN {×`FbN ԃ`FbN \J`FbN 
           H`FbN `FbN `FbN `FbN `FbNP ~`FbNP ]`FbNP 
           `FbNQ ~`FbNQ ]`FbNQ `FbNR ~`FbNR ]`FbNR 
           `FbNS ~`FbNS ]`FbNS `FbNT ~`FbNT ]`FbNT 
           VK`FbN p`FbN j`FbN `FbN 吳`FbN `FbN a`FbN 
           `FbN Pƃ`FbN {l`FbN `FbN σ`FbN `FbN Еۃ`FbN 
           g`FbN PO`FbN X`FbN Q`FbN U΃`FbN W`FbN V`FbN 
           `FbN ސE`FbN ۃ`FbN Ƒ`FbN V`FbN
           .
039120*
039130*================================================================*
       {p擾 SECTION.
      *
      *     MOVE SPACE TO {pv.
028350     MOVE Ҕԍvq          TO {L|Ҕԍ
028360     MOVE }Ԃvq              TO {L|}
028370     MOVE {pavq          TO {L|{pa
028380     MOVE {pNvq            TO {L|{pN
028390     MOVE {pvq            TO {L|{p
028400     MOVE ZERO                  TO {L|{p
028420     START {pL^e   KEY IS >= {L|҃R[h
028430                                  {L|{paN
028440     END-START
028450     IF ԃL[ = "00"
030910         MOVE SPACE TO ItOQ
030920         PERFORM {pL^eǍ
030930         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030940                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030950                       ( {L|{pa   NOT = {pavq    ) OR
030960                       ( {L|{pN     NOT = {pNvq      ) OR
030970                       ( {L|{p     NOT = {pvq      )
                   MOVE NC"" TO {p`FbNv({L|{p)
                   PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
           MOVE {p`FbNv(1)  TO {p`FbNP.
           MOVE {p`FbNv(2)  TO {p`FbNQ.
           MOVE {p`FbNv(3)  TO {p`FbNR.
           MOVE {p`FbNv(4)  TO {p`FbNS.
           MOVE {p`FbNv(5)  TO {p`FbNT.
           MOVE {p`FbNv(6)  TO {p`FbNU.
           MOVE {p`FbNv(7)  TO {p`FbNV.
           MOVE {p`FbNv(8)  TO {p`FbNW.
           MOVE {p`FbNv(9)  TO {p`FbNX.
           MOVE {p`FbNv(10) TO {p`FbNPO.
           MOVE {p`FbNv(11) TO {p`FbNPP.
           MOVE {p`FbNv(12) TO {p`FbNPQ.
           MOVE {p`FbNv(13) TO {p`FbNPR.
           MOVE {p`FbNv(14) TO {p`FbNPS.
           MOVE {p`FbNv(15) TO {p`FbNPT.
           MOVE {p`FbNv(16) TO {p`FbNPU.
           MOVE {p`FbNv(17) TO {p`FbNPV.
           MOVE {p`FbNv(18) TO {p`FbNPW.
           MOVE {p`FbNv(19) TO {p`FbNPX.
           MOVE {p`FbNv(20) TO {p`FbNQO.
           MOVE {p`FbNv(21) TO {p`FbNQP.
           MOVE {p`FbNv(22) TO {p`FbNQQ.
           MOVE {p`FbNv(23) TO {p`FbNQR.
           MOVE {p`FbNv(24) TO {p`FbNQS.
           MOVE {p`FbNv(25) TO {p`FbNQT.
           MOVE {p`FbNv(26) TO {p`FbNQU.
           MOVE {p`FbNv(27) TO {p`FbNQV.
           MOVE {p`FbNv(28) TO {p`FbNQW.
           MOVE {p`FbNv(29) TO {p`FbNQX.
           MOVE {p`FbNv(30) TO {p`FbNRO.
           MOVE {p`FbNv(31) TO {p`FbNRP.
042680**================================================================*
       {p擾 SECTION.
      *
           MOVE 3              TO Z|Z.
019550     MOVE {pavq   TO Z|{pa.
019560     MOVE {pNvq     TO Z|{pN.
019570     MOVE {pvq     TO Z|{p.
019580     MOVE Ҕԍvq   TO Z|Ҕԍ.
019590     MOVE }Ԃvq       TO Z|}.
019600     READ Zvge
019630     INVALID KEY
              MOVE SPACE     TO Z|R[h
              INITIALIZE        Z|R[h
           END-READ.
028350     MOVE Ҕԍvq          TO {L|Ҕԍ.
028360     MOVE }Ԃvq              TO {L|}.
028370     MOVE {pavq          TO {L|{pa.
028380     MOVE {pNvq            TO {L|{pN.
028390     MOVE {pvq            TO {L|{p.
      *------------------------------------------------------------------------*
           IF ( Z|rΏ = 1 )
               MOVE |rJn  TO {L|{p
           ELSE
               MOVE ZERO                  TO {L|{p
           END-IF.
      *------------------------------------------------------------------------*
028420     START {pL^e   KEY IS >= {L|҃R[h
028430                                  {L|{paN
028440     END-START.
028450     IF ԃL[ = "00"
030910         MOVE SPACE TO ItOQ
               MOVE ZERO  TO JE^
030920         PERFORM {pL^eǍ
030930         PERFORM UNTIL ( ItOQ         = "YES"           ) OR
030940                       ( {L|҃R[h NOT = ҃R[hvq  ) OR
030950                       ( {L|{pa   NOT = {pavq    ) OR
030960                       ( {L|{pN     NOT = {pNvq      ) OR
030970                       ( {L|{p     NOT = {pvq      )
                   COMPUTE JE^ = JE^ + 1
                   MOVE {L|{p TO vo
                   STRING vo                DELIMITED BY SIZE
                          "E"                  DELIMITED BY SIZE
                     INTO {pvo(JE^)
                   END-STRING
                   PERFORM {pL^eǍ
               END-PERFORM
           END-IF.
           MOVE JE^ TO vo
           COMPUTE {pv = JE^ * 4 - 2
           STRING "m{pn"                     DELIMITED BY SPACE
                  {pvq(1:{pv) DELIMITED BY SIZE
                  "mn"                     DELIMITED BY SIZE
                  vo                           DELIMITED BY SIZE
                  ""                             DELIMITED BY SIZE
             INTO {pv
           END-STRING.
      *================================================================*
039140******************************************************************
039150 END PROGRAM YCH6125.
039160******************************************************************
