000010******************************************************************
000020*            IDENTIFICATION      DIVISION                        *
000030******************************************************************
000040 IDENTIFICATION          DIVISION.
000050 PROGRAM-ID.             YCK101.
000060 AUTHOR.                 池田　幸子
000070*
000080*----------------------------------------------------------------*
000090*      提出FPD作成【ﾃﾞｰﾀ作成】柔+ｳｨﾝﾄﾞｳｽﾞ版
000100* 請求年月Ver.
000110*      MED = YCK580 
000120*----------------------------------------------------------------*
000130 DATE-WRITTEN.           2012-11-29
000140 DATE-COMPILED.          2012-11-29
000150*----------------------------------------------------------------*
000160******************************************************************
000170*            ENVIRONMENT         DIVISION                        *
000180******************************************************************
000190 ENVIRONMENT             DIVISION.
000200 CONFIGURATION           SECTION.
000210 SOURCE-COMPUTER.        FMV-DESKPOWER-TS.
000220 OBJECT-COMPUTER.        FMV-DESKPOWER.
000230 SPECIAL-NAMES.          CONSOLE  IS  CONS
000240                         SYSERR   IS  MSGBOX.
000250 INPUT-OUTPUT            SECTION.
000260 FILE-CONTROL.
000530     SELECT  名称マスタ      ASSIGN      TO        MEISYOL
000540                             ORGANIZATION             IS  INDEXED
000550                             ACCESS MODE              IS  DYNAMIC
000560                             RECORD KEY               IS  名−区分コード
000570                                                          名−名称コード
000580                             FILE STATUS              IS  状態キー
000590                             LOCK        MODE         IS  AUTOMATIC.
000600     SELECT  施術所情報マスタ ASSIGN      TO        SEJOHOL
000610                             ORGANIZATION             IS  INDEXED
000620                             ACCESS MODE              IS  DYNAMIC
000630                             RECORD KEY               IS 施情−施術所番号
000640                             FILE STATUS              IS  状態キー
000650                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  レセプトＦ      ASSIGN      TO        RECEPTL
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  レセ−施術和暦年月
000170                                                          レセ−患者コード
000180                                                          レセ−レセ種別
000190                             ALTERNATE RECORD KEY     IS  レセ−患者コード
000200                                                          レセ−施術和暦年月
000210                                                          レセ−レセ種別
000220                             ALTERNATE RECORD KEY     IS  レセ−請求和暦年月
000230                                                          レセ−施術和暦年月
000240                                                          レセ−患者コード
000250                                                          レセ−レセ種別
000260                             ALTERNATE RECORD KEY     IS  レセ−請求和暦年月
000270                                                          レセ−レセ種別
000280                                                          レセ−請求保険者番号
000290                                                          レセ−患者コード
000300                                                          レセ−施術和暦年月
000310                             ALTERNATE RECORD KEY     IS  レセ−請求和暦年月
000320                                                          レセ−請求保険者番号
000330                                                          レセ−患者コード
000340                                                          レセ−レセ種別
000350                                                          レセ−施術和暦年月
000360                             FILE STATUS              IS  状態キー
000370                             LOCK        MODE         IS  AUTOMATIC.
000130     SELECT  作業レセプトＦ  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W1012L.DAT"
000140                             ORGANIZATION             IS  INDEXED
000150                             ACCESS MODE              IS  DYNAMIC
000160                             RECORD KEY               IS  作レセ−請求和暦年月
000170                                                          作レセ−患者コード
000180                                                          作レセ−レセ種別
000170                                                          作レセ−施術和暦年月
000190                             ALTERNATE RECORD KEY     IS  作レセ−患者コード
000200                                                          作レセ−施術和暦年月
000210                                                          作レセ−レセ種別
000220                             ALTERNATE RECORD KEY     IS  作レセ−請求和暦年月
000230                                                          作レセ−施術和暦年月
000240                                                          作レセ−患者コード
000250                                                          作レセ−レセ種別
000260                             ALTERNATE RECORD KEY     IS  作レセ−請求和暦年月
000270                                                          作レセ−レセ種別
000280                                                          作レセ−請求保険者番号
000290                                                          作レセ−患者コード
000300                                                          作レセ−施術和暦年月
000310                             ALTERNATE RECORD KEY     IS  作レセ−請求和暦年月
000320                                                          作レセ−請求保険者番号
000330                                                          作レセ−患者コード
000340                                                          作レセ−レセ種別
000350                                                          作レセ−施術和暦年月
000360                             FILE STATUS              IS  状態キー
000370                             LOCK        MODE         IS  AUTOMATIC.
000750     SELECT  受診者情報Ｆ    ASSIGN      TO        JUSINJL
000760                             ORGANIZATION             IS  INDEXED
000770                             ACCESS MODE              IS  DYNAMIC
000780                             RECORD KEY               IS 受−施術和暦年月
000790                                                          受−患者コード
000800                             ALTERNATE RECORD KEY     IS 受−施術和暦年月
000810                                                          受−患者カナ
000820                                                          受−患者コード
000830                             ALTERNATE RECORD KEY     IS  受−患者コード
000840                                                         受−施術和暦年月
000850                             ALTERNATE RECORD KEY     IS 受−施術和暦年月
000860                                                          受−保険種別
000870                                                          受−保険者番号
000880                                                          受−患者コード
000890                             ALTERNATE RECORD KEY     IS 受−施術和暦年月
000900                                                          受−公費種別
000910                                                     受−費用負担者番号
000920                                                          受−患者コード
000930                             ALTERNATE RECORD KEY     IS 受−施術和暦年月
000940                                                          受−助成種別
000950                                                  受−費用負担者番号助成
000960                                                          受−患者コード
000970                             ALTERNATE RECORD KEY  IS 受−請求和暦年月
000980                                                      受−施術和暦年月
000990                                                      受−患者コード
001000                             FILE STATUS              IS  状態キー
001010                             LOCK        MODE         IS  AUTOMATIC.
001020     SELECT  負傷データＦ    ASSIGN      TO        HUSYOUL
001030                             ORGANIZATION             IS  INDEXED
001040                             ACCESS MODE              IS  DYNAMIC
001050                             RECORD KEY               IS 負−施術和暦年月
001060                                                         負−患者コード
001070                             ALTERNATE RECORD KEY     IS 負−患者コード
001080                                                         負−施術和暦年月
001090                             FILE STATUS              IS  状態キー
001100                             LOCK        MODE         IS  AUTOMATIC.
001101     SELECT  作業ファイル１  ASSIGN      TO        "C:\MAKISHISYS\YAWOBJ\TEMP\W1011L.DAT"
001102                             ORGANIZATION             IS  INDEXED
001103                             ACCESS                   IS  DYNAMIC
001104                             RECORD      KEY          IS  作１−請求和暦年月
001105                                                          作１−施術和暦年月
001106                                                          作１−保険区分
001107                                                          作１−費用負担者番号
001108                                                          作１−保険者番号
001109                                                          作１−患者カナ
001110                                                          作１−患者コード
001111                             FILE        STATUS       IS  状態キー
001112                             LOCK        MODE         IS  AUTOMATIC.
001122*
001230******************************************************************
001240*                      DATA DIVISION                             *
001250******************************************************************
001260 DATA                    DIVISION.
001270 FILE                    SECTION.
001370*                           ［ＲＬ＝  １２８］
001380 FD  名称マスタ          BLOCK   CONTAINS   1   RECORDS.
001390     COPY MEISYO          OF  XFDLIB  JOINING   名   AS  PREFIX.
001400*
001410 FD  施術所情報マスタ    BLOCK   CONTAINS   1   RECORDS.
001420     COPY SEJOHO         OF  XFDLIB  JOINING   施情   AS  PREFIX.
001460*                           ［ＲＬ＝  ３２０］
001470 FD  受診者情報Ｆ        BLOCK   CONTAINS   1   RECORDS.
001480     COPY JUSINJ          OF  XFDLIB  JOINING   受   AS  PREFIX.
001490*                           ［ＲＬ＝  １２８］
001500 FD  負傷データＦ        BLOCK   CONTAINS   1   RECORDS.
001510     COPY HUSYOU          OF  XFDLIB  JOINING   負   AS  PREFIX.
      *                          ［ＲＬ＝  １５３６］
       FD  レセプトＦ          BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   レセ  AS  PREFIX.
      *                          ［ＲＬ＝  １５３６］
       FD  作業レセプトＦ      BLOCK   CONTAINS   1   RECORDS.
           COPY RECEPT          OF  XFDLIB  JOINING   作レセ  AS  PREFIX.
001520*
001530*
001540 FD  作業ファイル１ RECORD  CONTAINS 512 CHARACTERS.
001550 01  作１−レコード.
001560     03  作１−レコードヘッダ.
001570         05  作１−請求和暦年月.
001580             07  作１−請求和暦            PIC 9.
001590             07  作１−請求年              PIC 9(2).
001600             07  作１−請求月              PIC 9(2).
001610         05  作１−保険区分                PIC 99.
001620         05  作１−保険者番号              PIC X(10).
001630         05  作１−本人家族区分            PIC 9.
001640         05  作１−施術和暦年月.
001650             07  作１−施術和暦            PIC 9.
001660             07  作１−施術年              PIC 9(2).
001670             07  作１−施術月              PIC 9(2).
001680         05  作１−被保険者カナ            PIC X(20).
001690         05  作１−患者コード.
001700             07 作１−患者番号             PIC 9(6).
001710             07 作１−枝番                 PIC X(1).
001720     03  作１−レコードデータ.
001730         05  作１−会員番号                PIC X(5).
001740         05  作１−老人助成                PIC 99.
001750         05  作１−公費併用.
001760             07  作１−費用負担者番号      PIC X(10).
001770             07  作１−受益者番号          PIC X(10).
001780         05  作１−患者氏名.
001790             07  作１−患者漢字            PIC N(10).
001800             07  作１−患者カナ            PIC X(20).
001810         05  作１−患者性別                PIC 9.
001820         05  作１−患者生年月日.
001830             07  作１−患者和暦            PIC 9(1).
001840             07  作１−患者年              PIC 9(2).
001850             07  作１−患者月              PIC 9(2).
001860             07  作１−患者日              PIC 9(2).
001870         05  作１−続柄                    PIC N(2).
001880         05  作１−被保険者氏名.
001890             07  作１−被保険者漢字        PIC N(10).
001900         05  作１−被保険者性別            PIC 9.
001910         05  作１−被保険者生年月日.
001920             07  作１−被保険者和暦        PIC 9(1).
001930             07  作１−被保険者年          PIC 9(2).
001940             07  作１−被保険者月          PIC 9(2).
001950             07  作１−被保険者日          PIC 9(2).
001960         05  作１−記号                    PIC N(12).
001970         05  作１−番号                    PIC X(12).
001980         05  作１−資格取得年月日.
001990             07  作１−資格和暦            PIC 9(1).
002000             07  作１−資格年              PIC 9(2).
002010             07  作１−資格月              PIC 9(2).
002020             07  作１−資格日              PIC 9(2).
002030         05  作１−有効年月日.
002040             07  作１−有効和暦            PIC 9(1).
002050             07  作１−有効年              PIC 9(2).
002060             07  作１−有効月              PIC 9(2).
002070             07  作１−有効日              PIC 9(2).
002080         05  作１−助成自己負担金未払      PIC 9.
002090         05  作１−転帰区分総合            PIC 9.
002100         05  FILLER                        PIC 9(2).
002110         05  作１−通院回数                PIC 9(2).
002120         05  作１−初診料.
002130             07  作１−初診基本料          PIC 9(4).
002140             07  作１−初診加算料          PIC 9(4).
002150         05  作１−往療料.
002160             07  作１−加算                PIC 9.
002170             07  作１−回数                PIC 9(2).
002180             07  作１−往療料金額          PIC 9(6).
002190         05  作１−金属副子加算.
002200             07  作１−使用枚数.
002210                 09  作１−大              PIC 9.
002220                 09  作１−中              PIC 9.
002230                 09  作１−小              PIC 9.
002240             07  作１−金額                PIC 9(6).
002250         05  作１−情報提供料              PIC 9(6).
002260         05  作１−文書料                  PIC 9(6).
002270         05  作１−一般費用金額.
002280             07  作１−費用合計金額        PIC 9(6).
002290             07  作１−負担率              PIC 9.
002300             07  作１−負担金額            PIC 9(6).
002310             07  作１−請求金額            PIC 9(6).
002320         05  作１−老人助成金額.
002330             07  作１−自己負担金額        PIC 9(6).
002340             07  作１−差引請求金額        PIC 9(6).
002350             07  作１−合計請求金額        PIC 9(6).
002360         05  作１−部位データ              OCCURS 5.
002370             07  作１−負傷コード.
002380                 09  作１−種別            PIC 9.
002390                 09  作１−部位コード      PIC 99.
002400             07  作１−冷罨療法.
002410                 09  作１−冷罨回数        PIC 99.
002420                 09  作１−冷罨金額        PIC 9(6).
002430             07  作１−施術料              PIC 9(6).
002440             07  作１−罨法料.
002450                 09  作１−罨法回数        PIC 99.
002460                 09  作１−罨法金額        PIC 9(6).
002470             07  作１−電療料.
002480                 09  作１−電療回数        PIC 99.
002490                 09  作１−電療金額        PIC 9(6).
002500             07  作１−後療料.
002510                 09  作１−後療回数        PIC 99.
002520                 09  作１−後療金額        PIC 9(6).
002530             07  作１−転帰区分            PIC 9.
002540         05  FILLER                        PIC X(13).
002550*
002560*----------------------------------------------------------------*
002570******************************************************************
002580*                WORKING-STORAGE SECTION                         *
002590******************************************************************
002600 WORKING-STORAGE         SECTION.
002610 01 キー入力                           PIC X    VALUE SPACE.
002620 01 状態キー                           PIC X(2) VALUE SPACE.
002630 01 終了フラグ                         PIC X(3) VALUE SPACE.
002640 01 終了フラグ２                       PIC X(3) VALUE SPACE.
002650 01 実行キーＷ                         PIC X(3)  VALUE SPACE.
002660 01 施術記録有Ｗ                       PIC X(3) VALUE SPACE.
002670 01 ファイル名                         PIC N(8) VALUE SPACE.
002671 01 継続フラグ                         PIC X(3) VALUE SPACE.
002680**
002690 01 保険種別ＷＲ                       PIC 9(2) VALUE ZERO.
002691 01 患者コードＷＲ.
002692    03 患者番号ＷＲ                    PIC 9(6) VALUE ZERO.
002693    03 枝番ＷＲ                        PIC X    VALUE SPACE.
002694*
002710 01 印刷形式ＷＲ                       PIC 9    VALUE ZERO.
002720 01 保険者番号ＷＲ                     PIC X(10) VALUE SPACE.
002730 01 レセプト種類ＷＲ                   PIC X(4) VALUE SPACE.
002740 01 本人家族区分ＷＲ                   PIC 9    VALUE ZERO.
002750 01 続柄Ｗ                             PIC N(2) VALUE SPACE.
002760 01 施術和暦年月ＷＲ.
002770    03 施術和暦ＷＲ                    PIC 9    VALUE ZERO.
002780    03 施術年ＷＲ                      PIC 9(2) VALUE ZERO.
002790    03 施術月ＷＲ                      PIC 9(2) VALUE ZERO.
002800 01 請求和暦年月ＷＲ.
002810    03 請求和暦ＷＲ                    PIC 9    VALUE ZERO.
002820    03 請求年ＷＲ                      PIC 9(2) VALUE ZERO.
002830    03 請求月ＷＲ                      PIC 9(2) VALUE ZERO.
002840**
002850 01 部位ＣＮＴ                         PIC 9     VALUE ZERO.
002860 01 カウンタ                           PIC 9(2)  VALUE ZERO.
002870 01 カウンタ２                         PIC 9(3)  VALUE ZERO.
002880 01 カウンタ３                         PIC 9(2)  VALUE ZERO.
002890 01 全角空白                           PIC X(2)  VALUE X"8140".
002900 01 半角空白                           PIC X(2)  VALUE X"2020".
002910**
002920** エラーメッセージ用
002930 01 エラーメッセージＷ.
002940    03 エラー患者コードＷ              PIC X(7) VALUE SPACE.
002950    03 エラー区切りＷ                  PIC X(1) VALUE SPACE.
002960    03 エラー保険種別Ｗ                PIC X(2) VALUE SPACE.
002970    03 FILLER                          PIC X(10) VALUE SPACE.
002980** 保険者番号右詰め用
002990 01 保険者番号ＷＴ.
003000    03 保険者番号左詰めＷ.
003010      05 保険者番号左詰めＷ１          PIC X OCCURS 8 VALUE SPACE.
003020    03 保険者番号右詰めＷ.
003030      05 保険者番号右詰めＷ１          PIC X OCCURS 8 VALUE ZERO.
003040    03 保険者番号数字Ｗ                PIC 9(8)  VALUE ZERO.
003050    03 保険者番号Ｗ                    PIC X(8)  VALUE SPACE.
003060** 会員番号右詰め用
003070 01 会員番号ＷＴ.
003080    03 会員番号左詰めＷ.
003090      05 会員番号左詰めＷ１            PIC X OCCURS 7 VALUE SPACE.
003100    03 会員番号右詰めＷ.
003110      05 会員番号右詰めＷ１            PIC X OCCURS 7 VALUE ZERO.
003120    03 会員番号数字Ｗ                  PIC 9(7)  VALUE ZERO.
003130    03 会員番号Ｗ                      PIC X(7)  VALUE SPACE.
003140** 西暦日付ワーク用
003150 01 西暦年月Ｗ.
003160    03 西暦年Ｗ                        PIC 9(4) VALUE ZERO.
003170    03 西暦月Ｗ                        PIC 9(2) VALUE ZERO.
003180** 西暦請求年月用
003190 01 西暦請求年月Ｗ.
003200    03 西暦請求年Ｗ                    PIC 9(4) VALUE ZERO.
003210    03 西暦請求月Ｗ                    PIC 9(2) VALUE ZERO.
003220** 西暦施術年月用
003230 01 西暦施術年月Ｗ.
003240    03 西暦施術年Ｗ                    PIC 9(4) VALUE ZERO.
003250    03 西暦施術月Ｗ                    PIC 9(2) VALUE ZERO.
003260** 記号左詰め用
003270 01 記号ＷＴ.
003280    03 記号元Ｗ.
003290      05 記号元Ｗ１                    PIC N OCCURS 12 VALUE SPACE.
003300    03 記号左詰めＷ.
003310      05 記号左詰めＷ１                PIC N OCCURS 12 VALUE SPACE.
003320    03 記号Ｗ.
003330      05 記号ＮＷ                      PIC N(12) VALUE SPACE.
003340    03 記号ＰＷ.
003350      05 記号ＰＮＷ                    PIC X(24) VALUE SPACE.
003380*
003591**********************************************************************************
003592*
003593 01 退避項目ＧＷ.
003594   03 レセプト種類Ｗ                   PIC X(4).
003595   03 レセプト種類ＧＷ                 PIC X(4).
003596   03 レセプト種別ＧＷ                 PIC 9(2).
003599*
003600****************
003610* 負傷データＦ *
003620****************
003630 01 負傷情報Ｗ.
003640    03 部位数Ｗ                        PIC 9(1)  VALUE ZERO.
003650    03 部位情報Ｗ  OCCURS   9.
003660       05 部位ＣＮＴＷ                 PIC 9(1)  VALUE ZERO.
003670       05 部位コードＷ.
003680          07 負傷種別Ｗ                PIC 9(2)  VALUE ZERO.
003690          07 部位Ｗ                    PIC 9(2)  VALUE ZERO.
003700       05 転帰区分Ｗ                   PIC 9(1)  VALUE ZERO.
003710*    ************
003720*    * 料金情報 *
003730*    ************
003740*    月毎の料金
003750***********************
003760 01 料金１ＷＲ.
003770   03 初検ＷＲ.
003780      05 負担割合ＷＲ               PIC 9(3)    VALUE ZERO.
003790      05 初検料ＷＲ                 PIC 9(5)    VALUE ZERO.
003800      05 初検加算料ＷＲ             PIC 9(5)    VALUE ZERO.
003810   03 再検料ＷＲ                    PIC 9(5)    VALUE ZERO.
003820   03 往療ＷＲ.
003830      05 往療回数ＷＲ               PIC 9(2)    VALUE ZERO.
003840      05 往療料ＷＲ                 PIC 9(5)    VALUE ZERO.
003850      05 往療加算料ＷＲ             PIC 9(5)    VALUE ZERO.
003860   03 金属副子加算料ＷＲ            PIC 9(5)    VALUE ZERO.
003870   03 大Ｗ                          PIC 9(1)    VALUE ZERO.
003880   03 中Ｗ                          PIC 9(1)    VALUE ZERO.
003890   03 小Ｗ                          PIC 9(1)    VALUE ZERO.
003900   03 施術情報提供料ＷＲ            PIC 9(5)    VALUE ZERO.
003910   03 一部負担金ＷＲ                PIC 9(6)    VALUE ZERO.
003920   03 請求金額ＷＲ                  PIC 9(6)    VALUE ZERO.
003930   03 給付割合ＷＲ                  PIC 9(1)    VALUE ZERO.
003940   03 受給者負担額ＷＲ              PIC 9(6)    VALUE ZERO.
003950   03 助成請求金額ＷＲ              PIC 9(6)    VALUE ZERO.
003960*
003970* 負傷部位毎の料金
003980***********************
003990 01 料金２ＷＲ.
004000   03 初回処置ＷＲ    OCCURS   9.
004010      05 初回処置料ＷＲ             PIC 9(5)    VALUE ZERO.
004020*
004030* 逓減毎の料金
004040***********************
004050 01 料金３ＷＲ.
004060**********
004070* １部位 *
004080**********
004090   03 部位１ＷＲ.
004100      05 後療１ＷＲ.
004110         07 後療回数１ＷＲ              PIC 9(2)    VALUE ZERO.
004120         07 後療料１ＷＲ                PIC 9(5)    VALUE ZERO.
004130      05 冷罨法１ＷＲ.
004140         07 冷罨法回数１ＷＲ            PIC 9(2)    VALUE ZERO.
004150         07 冷罨法料１ＷＲ              PIC 9(4)    VALUE ZERO.
004160      05 温罨法１ＷＲ.
004170         07 温罨法回数１ＷＲ            PIC 9(2)    VALUE ZERO.
004180         07 温罨法料１ＷＲ              PIC 9(4)    VALUE ZERO.
004190      05 電療１ＷＲ.
004200         07 電療回数１ＷＲ              PIC 9(2)    VALUE ZERO.
004210         07 電療料１ＷＲ                PIC 9(4)    VALUE ZERO.
004220**********
004230* ２部位 *
004240**********
004250   03 部位２ＷＲ.
004260      05 後療２ＷＲ.
004270         07 後療回数２ＷＲ              PIC 9(2)    VALUE ZERO.
004280         07 後療料２ＷＲ                PIC 9(5)    VALUE ZERO.
004290      05 冷罨法２ＷＲ.
004300         07 冷罨法回数２ＷＲ            PIC 9(2)    VALUE ZERO.
004310         07 冷罨法料２ＷＲ              PIC 9(4)    VALUE ZERO.
004320      05 温罨法２ＷＲ.
004330         07 温罨法回数２ＷＲ            PIC 9(2)    VALUE ZERO.
004340         07 温罨法料２ＷＲ              PIC 9(4)    VALUE ZERO.
004350      05 電療２ＷＲ.
004360         07 電療回数２ＷＲ              PIC 9(2)    VALUE ZERO.
004370         07 電療料２ＷＲ                PIC 9(4)    VALUE ZERO.
004380******************
004390* ３部位／８割 *
004400******************
004410   03 部位３８ＷＲ.
004420      05 後療３８ＷＲ.
004430         07 後療回数３８ＷＲ              PIC 9(2)  VALUE ZERO.
004440         07 後療料３８ＷＲ                PIC 9(5)  VALUE ZERO.
004450      05 冷罨法３８ＷＲ.
004460         07 冷罨法回数３８ＷＲ            PIC 9(2)  VALUE ZERO.
004470         07 冷罨法料３８ＷＲ              PIC 9(4)  VALUE ZERO.
004480      05 温罨法３８ＷＲ.
004490         07 温罨法回数３８ＷＲ            PIC 9(2)  VALUE ZERO.
004500         07 温罨法料３８ＷＲ              PIC 9(4)  VALUE ZERO.
004510      05 電療３８ＷＲ.
004520         07 電療回数３８ＷＲ              PIC 9(2)  VALUE ZERO.
004530         07 電療料３８ＷＲ                PIC 9(4)  VALUE ZERO.
004540******************
004550* ３部位／１０割 *
004560******************
004570   03 部位３０ＷＲ.
004580      05 後療３０ＷＲ.
004590         07 後療回数３０ＷＲ              PIC 9(2)  VALUE ZERO.
004600         07 後療料３０ＷＲ                PIC 9(5)  VALUE ZERO.
004610      05 冷罨法３０ＷＲ.
004620         07 冷罨法回数３０ＷＲ            PIC 9(2)  VALUE ZERO.
004630         07 冷罨法料３０ＷＲ              PIC 9(4)  VALUE ZERO.
004640      05 温罨法３０ＷＲ.
004650         07 温罨法回数３０ＷＲ            PIC 9(2)  VALUE ZERO.
004660         07 温罨法料３０ＷＲ              PIC 9(4)  VALUE ZERO.
004670      05 電療３０ＷＲ.
004680         07 電療回数３０ＷＲ              PIC 9(2)  VALUE ZERO.
004690         07 電療料３０ＷＲ                PIC 9(4)  VALUE ZERO.
004700******************
004710* ３部位／合計　 *
004720******************
004730   03 部位３ＷＲ.
004740      05 後療３ＷＲ.
004750         07 後療回数３ＷＲ                PIC 9(2)  VALUE ZERO.
004760         07 後療料３ＷＲ                  PIC 9(6)  VALUE ZERO.
004770      05 冷罨法３ＷＲ.
004780         07 冷罨法回数３ＷＲ              PIC 9(2)  VALUE ZERO.
004790         07 冷罨法料３ＷＲ                PIC 9(6)  VALUE ZERO.
004800      05 温罨法３ＷＲ.
004810         07 温罨法回数３ＷＲ              PIC 9(2)  VALUE ZERO.
004820         07 温罨法料３ＷＲ                PIC 9(6)  VALUE ZERO.
004830      05 電療３ＷＲ.
004840         07 電療回数３ＷＲ                PIC 9(2)  VALUE ZERO.
004850         07 電療料３ＷＲ                  PIC 9(6)  VALUE ZERO.
004860****************
004870* ４部位／５割 *
004880****************
004890   03 部位４５ＷＲ.
004900      05 後療４５ＷＲ.
004910         07 後療回数４５ＷＲ              PIC 9(2)  VALUE ZERO.
004920         07 後療料４５ＷＲ                PIC 9(5)  VALUE ZERO.
004930      05 冷罨法４５ＷＲ.
004940         07 冷罨法回数４５ＷＲ            PIC 9(2)  VALUE ZERO.
004950         07 冷罨法料４５ＷＲ              PIC 9(4)  VALUE ZERO.
004960      05 温罨法４５ＷＲ.
004970         07 温罨法回数４５ＷＲ            PIC 9(2)  VALUE ZERO.
004980         07 温罨法料４５ＷＲ              PIC 9(4)  VALUE ZERO.
004990      05 電療４５ＷＲ.
005000         07 電療回数４５ＷＲ              PIC 9(2)  VALUE ZERO.
005010         07 電療料４５ＷＲ                PIC 9(4)  VALUE ZERO.
005020****************
005030* ４部位／８割 *
005040****************
005050   03 部位４８ＷＲ.
005060      05 後療４８ＷＲ.
005070         07 後療回数４８ＷＲ              PIC 9(2)  VALUE ZERO.
005080         07 後療料４８ＷＲ                PIC 9(5)  VALUE ZERO.
005090      05 冷罨法４８ＷＲ.
005100         07 冷罨法回数４８ＷＲ            PIC 9(2)  VALUE ZERO.
005110         07 冷罨法料４８ＷＲ              PIC 9(4)  VALUE ZERO.
005120      05 温罨法４８ＷＲ.
005130         07 温罨法回数４８ＷＲ            PIC 9(2)  VALUE ZERO.
005140         07 温罨法料４８ＷＲ              PIC 9(4)  VALUE ZERO.
005150      05 電療４８ＷＲ.
005160         07 電療回数４８ＷＲ              PIC 9(2)  VALUE ZERO.
005170         07 電療料４８ＷＲ                PIC 9(4)  VALUE ZERO.
005180******************
005190* ４部位／１０割 *
005200******************
005210   03 部位４０ＷＲ.
005220      05 後療４０ＷＲ.
005230         07 後療回数４０ＷＲ              PIC 9(2)  VALUE ZERO.
005240         07 後療料４０ＷＲ                PIC 9(5)  VALUE ZERO.
005250      05 冷罨法４０ＷＲ.
005260         07 冷罨法回数４０ＷＲ            PIC 9(2)  VALUE ZERO.
005270         07 冷罨法料４０ＷＲ              PIC 9(4)  VALUE ZERO.
005280      05 温罨法４０ＷＲ.
005290         07 温罨法回数４０ＷＲ            PIC 9(2)  VALUE ZERO.
005300         07 温罨法料４０ＷＲ              PIC 9(4)  VALUE ZERO.
005310      05 電療４０ＷＲ.
005320         07 電療回数４０ＷＲ              PIC 9(2)  VALUE ZERO.
005330         07 電療料４０ＷＲ                PIC 9(4)  VALUE ZERO.
005340******************
005350* ４部位／合計　 *
005360******************
005370   03 部位４ＷＲ.
005380      05 後療４ＷＲ.
005390         07 後療回数４ＷＲ                PIC 9(2)  VALUE ZERO.
005400         07 後療料４ＷＲ                  PIC 9(6)  VALUE ZERO.
005410      05 冷罨法４ＷＲ.
005420         07 冷罨法回数４ＷＲ              PIC 9(2)  VALUE ZERO.
005430         07 冷罨法料４ＷＲ                PIC 9(6)  VALUE ZERO.
005440      05 温罨法４ＷＲ.
005450         07 温罨法回数４ＷＲ              PIC 9(2)  VALUE ZERO.
005460         07 温罨法料４ＷＲ                PIC 9(6)  VALUE ZERO.
005470      05 電療４ＷＲ.
005480         07 電療回数４ＷＲ                PIC 9(2)  VALUE ZERO.
005490         07 電療料４ＷＲ                  PIC 9(6)  VALUE ZERO.
005500********************
005510* ５部位／２．５割 *
005520********************
005530   03 部位５２ＷＲ.
005540      05 後療５２ＷＲ.
005550         07 後療回数５２ＷＲ              PIC 9(2)  VALUE ZERO.
005560         07 後療料５２ＷＲ                PIC 9(5)  VALUE ZERO.
005570      05 冷罨法５２ＷＲ.
005580         07 冷罨法回数５２ＷＲ            PIC 9(2)  VALUE ZERO.
005590         07 冷罨法料５２ＷＲ              PIC 9(4)  VALUE ZERO.
005600      05 温罨法５２ＷＲ.
005610         07 温罨法回数５２ＷＲ            PIC 9(2)  VALUE ZERO.
005620         07 温罨法料５２ＷＲ              PIC 9(4)  VALUE ZERO.
005630      05 電療５２ＷＲ.
005640         07 電療回数５２ＷＲ              PIC 9(2)  VALUE ZERO.
005650         07 電療料５２ＷＲ                PIC 9(4)  VALUE ZERO.
005660****************
005670* ５部位／５割 *
005680****************
005690   03 部位５５ＷＲ.
005700      05 後療５５ＷＲ.
005710         07 後療回数５５ＷＲ              PIC 9(2)  VALUE ZERO.
005720         07 後療料５５ＷＲ                PIC 9(5)  VALUE ZERO.
005730      05 冷罨法５５ＷＲ.
005740         07 冷罨法回数５５ＷＲ            PIC 9(2)  VALUE ZERO.
005750         07 冷罨法料５５ＷＲ              PIC 9(4)  VALUE ZERO.
005760      05 温罨法５５ＷＲ.
005770         07 温罨法回数５５ＷＲ            PIC 9(2)  VALUE ZERO.
005780         07 温罨法料５５ＷＲ              PIC 9(4)  VALUE ZERO.
005790      05 電療５５ＷＲ.
005800         07 電療回数５５ＷＲ              PIC 9(2)  VALUE ZERO.
005810         07 電療料５５ＷＲ                PIC 9(4)  VALUE ZERO.
005820****************
005830* ５部位／８割 *
005840****************
005850   03 部位５８ＷＲ.
005860      05 後療５８ＷＲ.
005870         07 後療回数５８ＷＲ              PIC 9(2)  VALUE ZERO.
005880         07 後療料５８ＷＲ                PIC 9(5)  VALUE ZERO.
005890      05 冷罨法５８ＷＲ.
005900         07 冷罨法回数５８ＷＲ            PIC 9(2)  VALUE ZERO.
005910         07 冷罨法料５８ＷＲ              PIC 9(4)  VALUE ZERO.
005920      05 温罨法５８ＷＲ.
005930         07 温罨法回数５８ＷＲ            PIC 9(2)  VALUE ZERO.
005940         07 温罨法料５８ＷＲ              PIC 9(4)  VALUE ZERO.
005950      05 電療５８ＷＲ.
005960         07 電療回数５８ＷＲ              PIC 9(2)  VALUE ZERO.
005970         07 電療料５８ＷＲ                PIC 9(4)  VALUE ZERO.
005980******************
005990* ５部位／１０割 *
006000******************
006010   03 部位５０ＷＲ.
006020      05 後療５０ＷＲ.
006030         07 後療回数５０ＷＲ              PIC 9(2)  VALUE ZERO.
006040         07 後療料５０ＷＲ                PIC 9(5)  VALUE ZERO.
006050      05 冷罨法５０ＷＲ.
006060         07 冷罨法回数５０ＷＲ            PIC 9(2)  VALUE ZERO.
006070         07 冷罨法料５０ＷＲ              PIC 9(4)  VALUE ZERO.
006080      05 温罨法５０ＷＲ.
006090         07 温罨法回数５０ＷＲ            PIC 9(2)  VALUE ZERO.
006100         07 温罨法料５０ＷＲ              PIC 9(4)  VALUE ZERO.
006110      05 電療５０ＷＲ.
006120         07 電療回数５０ＷＲ              PIC 9(2)  VALUE ZERO.
006130         07 電療料５０ＷＲ                PIC 9(4)  VALUE ZERO.
006140******************
006150* ５部位／合計　 *
006160******************
006170   03 部位５ＷＲ.
006180      05 後療５ＷＲ.
006190         07 後療回数５ＷＲ                PIC 9(2)  VALUE ZERO.
006200         07 後療料５ＷＲ                  PIC 9(6)  VALUE ZERO.
006210      05 冷罨法５ＷＲ.
006220         07 冷罨法回数５ＷＲ              PIC 9(2)  VALUE ZERO.
006230         07 冷罨法料５ＷＲ                PIC 9(6)  VALUE ZERO.
006240      05 温罨法５ＷＲ.
006250         07 温罨法回数５ＷＲ              PIC 9(2)  VALUE ZERO.
006260         07 温罨法料５ＷＲ                PIC 9(6)  VALUE ZERO.
006270      05 電療５ＷＲ.
006280         07 電療回数５ＷＲ                PIC 9(2)  VALUE ZERO.
006290         07 電療料５ＷＲ                  PIC 9(6)  VALUE ZERO.
006300*
006310*****************************************************************
006320 01 計算機西暦年Ｗ                     PIC 9(2).
006330* 日付ＷＯＲＫ
006340 01 計算機西暦.
006350    03 計算機西暦年                    PIC 9(4).
006360    03 計算機西暦月日                  PIC 9(4).
006370 01 計算機西暦Ｒ REDEFINES 計算機西暦.
006380    03 計算機世紀                      PIC 9(2).
006390    03 計算機日付                      PIC 9(6).
006400    03 計算機日付Ｒ REDEFINES 計算機日付.
006410       05 計算機年月                   PIC 9(4).
006420       05 計算機年月Ｒ REDEFINES 計算機年月.
006430         07 計算機年                   PIC 9(2).
006440         07 計算機月                   PIC 9(2).
006450       05 計算機日                     PIC 9(2).
006460*
       01 複合プログラム名Ｗ     PIC X(8) VALUE "MOJI2".
002230*
006470******************************************************************
006480*                          連結項目                              *
006490******************************************************************
006500*
006510********************
006520* メッセージ表示キー *
006530********************
006540 01 連メ−キー IS EXTERNAL.
006550    03  連メ−メッセージ               PIC N(20).
006560*
006570 01 連メ３−キー IS EXTERNAL.
006580    03  連メ３−メッセージ             PIC N(20).
006590    03  連メ３−メッセージ１           PIC X(20).
006600****************
006610* 画面入力情報 *
006620****************
002287 01 連入−画面情報ＹＣＫ５８０ IS EXTERNAL.
002297    03 連入−印刷形式                  PIC 9.
002307    03 連入−請求和暦年月.
002317       05 連入−請求和暦               PIC 9.
002327       05 連入−請求年月.
002337         07 連入−請求年               PIC 9(2).
002347         07 連入−請求月               PIC 9(2).
          03 連入−プレビュー区分            PIC 9.
009940*
009942 01 連レ−キー IS EXTERNAL.
009943    03 連レ−保険種別                  PIC 9(2).
009950*
      * 暗号複合用
       01 連暗号複合−暗号情報 IS EXTERNAL.
          03 連暗号複合−入力情報.
             05 連暗号複合−記号               PIC X(24).
             05 連暗号複合−番号               PIC X(30).
             05 連暗号複合−暗号化項目.
                07 連暗号複合−暗号患者番号    PIC X(6).
                07 連暗号複合−暗号判定記号    PIC X.
                07 連暗号複合−暗号判定番号    PIC X.
                07 連暗号複合−暗号記号        PIC X(24).
                07 連暗号複合−暗号番号        PIC X(30).
          03 連暗号複合−出力情報.
             05 連暗号複合−複合した記号       PIC X(24).
             05 連暗号複合−複合した番号       PIC X(30).
003322*
009960******************************************************************
009970*                      PROCEDURE  DIVISION                       *
009980******************************************************************
009990 PROCEDURE               DIVISION.
010000************
010010*           *
010020* 初期処理   *
010030*           *
010040************
010050     PERFORM 初期化.
010060     PERFORM 施術所情報取得.
010070************
010080*           *
010090* 主処理     *
010100*           *
010110************
010120     PERFORM 作業ファイル作成.
010130************
010140*           *
010150* 終了処理   *
010160*           *
010170************
010180     PERFORM 終了処理.
010190     MOVE ZERO TO PROGRAM-STATUS.
010200     EXIT PROGRAM.
010210*
010220*<<<<<<<<<<<<<<<<<<<<<<<<< END OF PROGRAM >>>>>>>>>>>>>>>>>>>>>>>>
010230*================================================================*
010240 初期化 SECTION.
010250*
010260     PERFORM ファイルオープン.
010270* 連結項目の待避
010280     MOVE 連入−請求和暦      TO 請求和暦ＷＲ.
010290     MOVE 連入−請求年        TO 請求年ＷＲ.
010300     MOVE 連入−請求月        TO 請求月ＷＲ.
010310*
010590*================================================================*
010600 ファイルオープン SECTION.
010610*
010710     OPEN INPUT 名称マスタ.
010720         MOVE NC"名称マスタ" TO ファイル名.
010730         PERFORM オープンチェック.
010740     OPEN INPUT 施術所情報マスタ
010750         MOVE NC"施情" TO ファイル名.
010760         PERFORM オープンチェック.
010800     OPEN INPUT 受診者情報Ｆ.
010810         MOVE NC"受診者情報Ｆ" TO ファイル名.
010820         PERFORM オープンチェック.
010830     OPEN INPUT 負傷データＦ.
010840         MOVE NC"負傷データＦ" TO ファイル名.
010850         PERFORM オープンチェック.
006630     OPEN INPUT レセプトＦ.
006640         MOVE NC"レセ" TO ファイル名.
006650         PERFORM オープンチェック.
010860*================================================================*
010870 オープンチェック SECTION.
010880*
010890     IF 状態キー  NOT =  "00"
010900         DISPLAY ファイル名 NC"Ｆオープンエラー" UPON CONS
010910         DISPLAY NC"状態キー：" 状態キー         UPON CONS
010920         DISPLAY NC"数字１文字入力しＥＮＴＥＲキーを押してください"
010930                                                 UPON CONS
000080*-----------------------------------------*
000090         CALL "actcshm"  WITH C LINKAGE
000100*-----------------------------------------*
010940         ACCEPT  キー入力 FROM CONS
010950         PERFORM ファイル閉鎖
010960         MOVE 99 TO PROGRAM-STATUS
010970         EXIT PROGRAM.
010980*================================================================*
010990 ファイル閉鎖 SECTION.
011000*
011010     CLOSE 名称マスタ 受診者情報Ｆ 負傷データＦ
011020           施術所情報マスタ レセプトＦ 作業レセプトＦ.
011030*================================================================*
011040 終了処理 SECTION.
011050*
011060     PERFORM ファイル閉鎖.
011070*================================================================*
011080 エラー表示 SECTION.
011090*
011100     DISPLAY NC"状態キー" 状態キー  UPON CONS.
011110     DISPLAY NC"ファイル書込エラー：" ファイル名   UPON CONS.
011120     DISPLAY NC"システム管理者に連絡してください"  UPON CONS.
011130     DISPLAY NC"数字１文字入力しＥＮＴＥＲキーを押してください"                                                                    UPON CONS.
000080*-----------------------------------------*
000090     CALL "actcshm"  WITH C LINKAGE.
000100*-----------------------------------------*
011140     ACCEPT  キー入力 FROM CONS.
011150     PERFORM ファイル閉鎖.
011160     MOVE 99 TO PROGRAM-STATUS.
011170     EXIT PROGRAM.
011180*================================================================*
011190 施術所情報取得 SECTION.
011200*
011210     MOVE ZERO  TO 施情−施術所番号.
011220     READ 施術所情報マスタ
011230     INVALID KEY
011240          MOVE  NC"施術所情報マスタに登録後、実行して下さい" TO 連メ−メッセージ
011250          CALL   "MSG001"
011260          CANCEL "MSG001"
011270          PERFORM ファイル閉鎖
011280          MOVE 99 TO PROGRAM-STATUS
011290          EXIT PROGRAM
011300     NOT INVALID KEY
011310          IF  施情−接骨師会会員番号 = SPACE
011320              MOVE  NC"施術所マスタに会員番号を登録して下さい" TO 連メ−メッセージ
011330              CALL   "MSG001"
011340              CANCEL "MSG001"
011350              PERFORM ファイル閉鎖
011360              MOVE 99 TO PROGRAM-STATUS
011370              EXIT PROGRAM
011380          ELSE
011390              MOVE 施情−接骨師会会員番号  TO 会員番号Ｗ
011400****              PERFORM 会員番号右詰め
011410          END-IF
011420     END-READ.
011430*
011440*================================================================*
011450 作業ファイル作成 SECTION.
011460*
           PERFORM 作業レセプトＦ作成.
011470     OPEN OUTPUT 作業ファイル１.
011480         MOVE NC"作１" TO ファイル名.
011490         PERFORM オープンチェック.
011500*
011510     PERFORM 作業ファイル１作成１
011520*
011530     CLOSE 作業ファイル１.
011540*
011440*================================================================*
011450 作業レセプトＦ作成 SECTION.
011460*
006630     OPEN OUTPUT 作業レセプトＦ.
006640         MOVE NC"作レセ" TO ファイル名.
006650         PERFORM オープンチェック.
      *
           PERFORM レセプトＦ読込.
           PERFORM UNTIL 終了フラグ NOT = SPACE
              MOVE レセ−レコード TO 作レセ−レコード
              WRITE 作レセ−レコード
              PERFORM レセプトＦ読込
           END-PERFORM.
      *
           CLOSE 作業レセプトＦ
006630     OPEN INPUT 作業レセプトＦ.
006640         MOVE NC"作レセ" TO ファイル名.
006650         PERFORM オープンチェック.
011550*================================================================*
011560 作業ファイル１作成１ SECTION.
011570*
011580*********************
011590*       全出力      *
011600*********************
011610*
005610     MOVE 請求和暦ＷＲ  TO レセ−請求和暦.
005620     MOVE 請求年ＷＲ    TO レセ−請求年.
005630     MOVE 請求月ＷＲ    TO レセ−請求月.
005640     MOVE 1             TO レセ−施術和暦.
005650     MOVE ZERO          TO レセ−施術年.
005660     MOVE ZERO          TO レセ−施術月.
005670     MOVE ZERO          TO レセ−患者番号.
005680     MOVE LOW-VALUE     TO レセ−枝番.
013730     MOVE ZERO          TO レセ−レセ種別.
004840     START レセプトＦ   KEY IS >= レセ−請求和暦年月
004850                                  レセ−施術和暦年月
004860                                  レセ−患者コード
000250                                  レセ−レセ種別
011730     END-START.
011740     IF 状態キー = "00"
011750         MOVE SPACE  TO 終了フラグ
011760         PERFORM レセプトＦ読込
               MOVE レセ−レコード TO 作レセ−レコード
011770         PERFORM UNTIL ( 終了フラグ = "YES" ) OR
004920                       ( レセ−請求和暦 NOT = 請求和暦ＷＲ ) OR
004930                       ( レセ−請求年   NOT = 請求年ＷＲ   ) OR
004940                       ( レセ−請求月   NOT = 請求月ＷＲ   )
011810            PERFORM データチェック
011820** 自由は対象外
011830            IF  受−保険種別 = 90
011840                MOVE SPACE  TO 実行キーＷ
011850            END-IF
011851** ///
011860** とりあえず 労災・自賠責は対象外 (レセプト内容が違う為)
011870            IF  受−保険種別 = 70 OR 80
011880                MOVE SPACE  TO 実行キーＷ
011890            END-IF
011900** ///
011910            IF  実行キーＷ = "YES"
011940*
005610               EVALUATE TRUE
011950*            ********
011960*            * 健保 *
011970*            ********
013940               WHEN レセ−レセ種別   = 1
012000*                **********************
012010*                * 作業ファイル作成 *
012020*                **********************
012050                  IF  受−助成種別   = ZERO  OR 50
012060                      PERFORM 作１レコードセット健保
012070                  ELSE
                           MOVE 3              TO 作レセ−レセ種別
                           READ 作業レセプトＦ
                           INVALID KEY
012060                         PERFORM 作１レコードセット健保
                           NOT INVALID KEY
012060                         PERFORM 作１レコードセット健保助成
                           END-READ
012090                  END-IF
012091* 請求がある時出力
012092                  IF ( 作１−請求金額     = ZERO ) AND
012093                     ( 作１−差引請求金額 = ZERO )
012094                      CONTINUE
012095                  ELSE
012100                      PERFORM 作１ファイル書込
012101                  END-IF
012130*            ********
012140*            * 老人 *
012150*            ********
013940               WHEN レセ−レセ種別   = 2
012180*                **********************
012190*                * 作業ファイル作成 *
012200*                **********************
012211                  IF 受−施術和暦年月 < 42004
012212                     PERFORM 作１レコードセット老人
012213                  ELSE
012215                     IF  受−助成種別   = ZERO  OR 50
012216                         PERFORM 作１レコードセット後高
012217                     ELSE
                               MOVE 3              TO 作レセ−レセ種別
                               READ 作業レセプトＦ
                               INVALID KEY
012060                             PERFORM 作１レコードセット後高
                               NOT INVALID KEY
                                   PERFORM 作１レコードセット後高助成
                               END-READ
012219                     END-IF
012220                  END-IF
012221* 請求がある時出力
012222                  IF ( 作１−請求金額     = ZERO ) AND
012223                     ( 作１−差引請求金額 = ZERO )
012224                     CONTINUE
012225                  ELSE
012226                     PERFORM 作１ファイル書込
012227                  END-IF
004220*            ********
004230*            * 助成 *
004240*            ********
                     WHEN レセ−レセ種別   = 3
                        IF 受−公費種別 = ZERO
                           MOVE 1           TO 作レセ−レセ種別
                        ELSE
                           MOVE 2           TO 作レセ−レセ種別
                        END-IF
                        READ 作業レセプトＦ
                        INVALID KEY
012060                     PERFORM 作１レコードセット助成
012226                     PERFORM 作１ファイル書込
                        END-READ
                     END-EVALUATE
                  END-IF
012290            PERFORM レセプトＦ読込
01                MOVE レセ−レコード TO 作レセ−レコード
012300         END-PERFORM
012310     END-IF.
012320*
012330*================================================================*
012340 データチェック SECTION.
012350*
012360     MOVE SPACE  TO 実行キーＷ.
019520* *****************************************************************
019530* * レセプトＦの請求対象区分 = 0 の場合データ作成対象としない *
019540* *****************************************************************
019640     IF ( レセ−請求対象区分 NOT = ZERO ) AND
005778        ( レセ−償還払い区分 NOT = 2 OR 3 )
              IF(レセ−レセ種別 = 3) AND ( レセ−会総括表印刷対象区分 = 1 )
      *        IF(レセ−レセ種別 = 3)
                 CONTINUE
              ELSE
004090           MOVE レセ−施術和暦  TO 受−施術和暦
004100           MOVE レセ−施術年    TO 受−施術年
004110           MOVE レセ−施術月    TO 受−施術月
004120           MOVE レセ−患者番号  TO 受−患者番号
004130           MOVE レセ−枝番      TO 受−枝番
                 READ 受診者情報Ｆ
                 NOT INVALID KEY
005786**      健保のみ
005787              IF 受−保険分類 = 1
019880                 MOVE "YES"  TO 実行キーＷ
022370                 MOVE 受−施術和暦       TO 負−施術和暦
022380                 MOVE 受−施術年         TO 負−施術年
022390                 MOVE 受−施術月         TO 負−施術月
022400                 MOVE 受−患者コード     TO 負−患者コード
022410                 READ 負傷データＦ
                       END-READ
005789              END-IF
019950           END-READ
              END-IF
019960     END-IF.
012820*
012920*================================================================*
012930 レセプトＦ読込 SECTION.
012940*
012950     READ レセプトＦ NEXT
012960     AT END
012970         MOVE "YES" TO 終了フラグ
012980     END-READ.
012990*
013071*================================================================*
013072 作１レコードセット健保 SECTION.
013073*
013074**********/  健保助成なしの時  /**********
013075*
013076     MOVE SPACE TO 作１−レコード.
013077     INITIALIZE 作１−レコード.
013079*
013080     MOVE レセ−レセ実日数       TO 作１−通院回数.
013081     MOVE レセ−合計             TO 作１−費用合計金額.
013082     MOVE レセ−一部負担金       TO 作１−負担金額.
013083     MOVE レセ−請求金額         TO 作１−請求金額.
013084     MOVE ZERO                   TO 作１−老人助成金額.
013085*
013086     MOVE レセ−負担割合         TO 作１−負担率.
013087* 連計 転記の後
013088     PERFORM 共通レコードセット.
013089*
013090*================================================================*
013091 作１レコードセット後高 SECTION.
013092*
013093**********/  後高助成なしの時  /**********
013094*
013095     MOVE SPACE TO 作１−レコード.
013096     INITIALIZE 作１−レコード.
013097*
013080     MOVE レセ−レセ実日数       TO 作１−通院回数.
013081     MOVE レセ−合計             TO 作１−費用合計金額.
013082     MOVE レセ−一部負担金       TO 作１−負担金額.
013083     MOVE レセ−請求金額         TO 作１−請求金額.
013084     MOVE ZERO                   TO 作１−老人助成金額.
013115*
013086     MOVE レセ−負担割合         TO 作１−負担率.
013117* 連計 転記の後
013118     PERFORM 共通レコードセット.
013120*
013121*================================================================*
013122 作１レコードセット老人 SECTION.
013123*
013124**********/ 27老人の時  /**********
013125*
013126     MOVE SPACE TO 作１−レコード.
013127     INITIALIZE 作１−レコード.
013128*
013129     MOVE 受−費用負担者番号 TO 作１−費用負担者番号.
013130     MOVE 受−受益者番号老人 TO 作１−受益者番号.
013131*
013132     MOVE 受−老人負担金免除 TO 作１−助成自己負担金未払.
013133*
013080     MOVE レセ−レセ実日数   TO 作１−通院回数.
013081     MOVE レセ−合計         TO 作１−費用合計金額.
013082     MOVE レセ−一部負担金   TO 作１−負担金額.
013083     MOVE レセ−請求金額     TO 作１−請求金額.
013084     MOVE ZERO               TO 作１−老人助成金額.
013139*
013140     MOVE ZERO               TO 作１−負担率.
013141*
013142* 連計 転記の後
013143     PERFORM 共通レコードセット.
013144*
013145** 15/01 27助成対応（上記転記後、置換え）
013146     IF 受−助成種別 = 53 OR 54
013147         MOVE 受−費用負担者番号助成  TO 作１−保険者番号
013148         EVALUATE 受−助成種別
013149* 身障
013150         WHEN 53
013151             MOVE 14   TO 作１−老人助成
013152* 被爆
013153         WHEN 54
013154             MOVE 15   TO 作１−老人助成
013155         END-EVALUATE
013156* 助成金額
013157         MOVE レセ−受給者負担額   TO 作１−自己負担金額
013158         MOVE レセ−助成請求金額   TO 作１−差引請求金額
013159         COMPUTE 作１−合計請求金額 = 作１−自己負担金額 + 作１−差引請求金額
013160*
013161     END-IF.
013162**
013163*================================================================*
013164 作１レコードセット健保助成 SECTION.
013165*
013166**********/  健保助成ありの時  /**********
013167*
013168     MOVE SPACE TO 作１−レコード.
013169     INITIALIZE 作１−レコード.
013170*
013171* -- 99XXXXXX でも転記する ---
013172     MOVE 受−費用負担者番号助成  TO 作１−費用負担者番号.
013173*
013174     IF ( 受−受益者番号助成(1:1) = "*"  ) OR
013175        ( 受−受益者番号助成(1:2) = "＊" )
013176        MOVE SPACE                TO 作１−受益者番号
013177     ELSE
013178        MOVE 受−受益者番号助成   TO 作１−受益者番号
013179     END-IF.
013180*
013181**     MOVE 受−助成負担金免除 TO 作１−助成自己負担金未払.
013182     MOVE 受−老人負担金免除 TO 作１−助成自己負担金未払.
013183*
013184*
013080     MOVE レセ−レセ実日数   TO 作１−通院回数.
013081     MOVE レセ−合計         TO 作１−費用合計金額.
013082     MOVE レセ−一部負担金   TO 作１−負担金額.
013083     MOVE レセ−請求金額     TO 作１−請求金額.
013189*
013086     MOVE レセ−負担割合     TO 作１−負担率.
013191*
013192* 助成金額
013193     MOVE レセ−受給者負担額 TO 作１−自己負担金額.
013194     MOVE レセ−助成請求金額 TO 作１−差引請求金額.
013195     COMPUTE 作１−合計請求金額 = 作１−自己負担金額 + 作１−差引請求金額.
013196*
013197* 連計 転記の後
013198     PERFORM 共通レコードセット.
013199*
013200*================================================================*
013201 作１レコードセット後高助成 SECTION.
013202*
013203**********/  後高助成ありの時  /**********
013204*
013205     MOVE SPACE TO 作１−レコード.
013206     INITIALIZE 作１−レコード.
013207*
013208* -- 99XXXXXX でも転記する ---
013209     MOVE 受−費用負担者番号助成  TO 作１−費用負担者番号.
013210*
013211     IF ( 受−受益者番号助成(1:1) = "*"  ) OR
013212        ( 受−受益者番号助成(1:2) = "＊" )
013213        MOVE SPACE                TO 作１−受益者番号
013214     ELSE
013215        MOVE 受−受益者番号助成   TO 作１−受益者番号
013216     END-IF.
013217*
013218**     MOVE 受−助成負担金免除 TO 作１−助成自己負担金未払.
013219**     MOVE 受−老人負担金免除 TO 作１−助成自己負担金未払.
013220*
013221*
013080     MOVE レセ−レセ実日数   TO 作１−通院回数.
013081     MOVE レセ−合計         TO 作１−費用合計金額.
013082     MOVE レセ−一部負担金   TO 作１−負担金額.
013083     MOVE レセ−請求金額     TO 作１−請求金額.
013226*
013086     MOVE レセ−負担割合     TO 作１−負担率.
013228*
013229* 助成金額
013230     MOVE レセ−受給者負担額   TO 作１−自己負担金額.
013231     MOVE レセ−助成請求金額   TO 作１−差引請求金額.
013232     COMPUTE 作１−合計請求金額 = 作１−自己負担金額 + 作１−差引請求金額.
013233*
013234* 連計 転記の後
013235     PERFORM 共通レコードセット.
013236*
013200*================================================================*
013201 作１レコードセット助成 SECTION.
013202*
013203**********/  助成のみの時  /**********
013204*
013205     MOVE SPACE TO 作１−レコード.
013206     INITIALIZE 作１−レコード.
013207*
013208* -- 99XXXXXX でも転記する ---
013209     MOVE 受−費用負担者番号助成  TO 作１−費用負担者番号.
013210*
013211     IF ( 受−受益者番号助成(1:1) = "*"  ) OR
013212        ( 受−受益者番号助成(1:2) = "＊" )
013213        MOVE SPACE                TO 作１−受益者番号
013214     ELSE
013215        MOVE 受−受益者番号助成   TO 作１−受益者番号
013216     END-IF.
013217*
013218**     MOVE 受−助成負担金免除 TO 作１−助成自己負担金未払.
013219**     MOVE 受−老人負担金免除 TO 作１−助成自己負担金未払.
013220*
013221*
013080     MOVE レセ−レセ実日数   TO 作１−通院回数.
013081     MOVE ZERO               TO 作１−費用合計金額.
013082     MOVE ZERO               TO 作１−負担金額.
013083     MOVE ZERO               TO 作１−請求金額.
013226*
013086     MOVE レセ−負担割合     TO 作１−負担率.
013228*
013229* 助成金額
013230     MOVE レセ−受給者負担額   TO 作１−自己負担金額.
013231     MOVE レセ−助成請求金額   TO 作１−差引請求金額.
013232     COMPUTE 作１−合計請求金額 = 作１−自己負担金額 + 作１−差引請求金額.
013233*
013234* 連計 転記の後
013235     PERFORM 共通レコードセット.
013236*
013238*================================================================*
013740*================================================================*
013750 共通レコードセット SECTION.
013760*
013770     MOVE レセ−請求和暦     TO 作１−請求和暦.
013780     MOVE レセ−請求年       TO 作１−請求年.
013790     MOVE レセ−請求月       TO 作１−請求月.
013791     MOVE 受−施術和暦       TO 作１−施術和暦 施術和暦ＷＲ.
013792     MOVE 受−施術年         TO 作１−施術年 施術年ＷＲ.
013793     MOVE 受−施術月         TO 作１−施術月 施術月ＷＲ.
013800     MOVE 受−患者コード     TO 作１−患者コード 患者コードＷＲ.
013810****     MOVE 会員番号数字Ｗ     TO 作１−会員番号.
013811     MOVE 会員番号Ｗ         TO 作１−会員番号.
013820*
013830     PERFORM 保険区分取得.
013840*
013850     MOVE 受−保険者番号     TO 作１−保険者番号.
013860     MOVE 受−患者氏名       TO 作１−患者氏名.
013870     MOVE 受−患者カナ       TO 作１−患者カナ.
013880     MOVE 受−患者性別       TO 作１−患者性別.
013890     MOVE 受−患者生年月日   TO 作１−患者生年月日.
013891** 和暦 明治と昭和を逆にする。
013892     EVALUATE 作１−患者和暦
013893     WHEN 1 
013894        MOVE  3  TO 作１−患者和暦
013895     WHEN 3 
013896        MOVE  1  TO 作１−患者和暦
013897     END-EVALUATE.
013898*
013900     MOVE 受−資格取得年月日 TO 作１−資格取得年月日.
013910     MOVE 受−有効年月日     TO 作１−有効年月日.
013920     MOVE 受−本人家族区分   TO 作１−本人家族区分.
013930     IF 受−本人家族区分 = 1
013940         MOVE NC"本人"    TO 続柄Ｗ
013950     ELSE
013960         MOVE 05          TO 名−区分コード
013970         MOVE 受−続柄    TO 名−名称コード
013980         READ 名称マスタ
013990         INVALID KEY
014000             MOVE SPACE     TO 続柄Ｗ
014010         NOT INVALID KEY
014020             MOVE 名−略称  TO 続柄Ｗ
014030         END-READ
014040     END-IF.
014050     MOVE 続柄Ｗ             TO 作１−続柄.
014060*
014070     MOVE 受−被保険者氏名   TO 作１−被保険者氏名.
014080     MOVE 受−被保険者カナ   TO 作１−被保険者カナ.
014090     MOVE 受−被保険者性別   TO 作１−被保険者性別.
014100     MOVE 受−被保険者生年月日   TO 作１−被保険者生年月日.
014101*
014102** 和暦 明治と昭和を逆にする。
014103     EVALUATE 作１−被保険者和暦
014104     WHEN 1 
014105        MOVE  3  TO 作１−被保険者和暦
014106     WHEN 3 
014107        MOVE  1  TO 作１−被保険者和暦
014108     END-EVALUATE.
014109**
      *-----------------------------------------------------------------*
           MOVE SPACE TO 連暗号複合−暗号情報.
      *
      *    / 連暗号複合−入力情報セット /
           MOVE 受−記号       TO 連暗号複合−記号.
           MOVE 受−番号       TO 連暗号複合−番号.
           MOVE 受−暗号化項目 TO 連暗号複合−暗号化項目.
      *
           CALL   複合プログラム名Ｗ.
           CANCEL 複合プログラム名Ｗ.
      *
      *-----------------------------------------------------------------*
014110*
014120*     IF ( 受−番号(1:1) = "*"  ) OR
014130*        ( 受−番号(1:2) = "＊" )
007430     IF ( 連暗号複合−複合した番号(1:1) = "*"  ) OR
007440        ( 連暗号複合−複合した番号(1:2) = "＊" )
014140        MOVE SPACE           TO 作１−番号
014150     ELSE
014160        MOVE 連暗号複合−複合した番号        TO 作１−番号
014170     END-IF.
014180*
014190*     IF 受−記号(1:1)  = NC"＊" 
007530     IF 連暗号複合−複合した記号(1:2)  = "＊" 
014200        MOVE SPACE               TO 記号ＰＮＷ
014210        INSPECT 記号ＰＮＷ  REPLACING ALL 半角空白 BY 全角空白
014220        MOVE 記号ＰＷ            TO 作１−記号
014230     ELSE
014240        PERFORM 記号左詰め
014250        MOVE 記号Ｗ              TO 作１−記号
014260     END-IF.
014270*
014281     PERFORM 負傷データ取得.
014290     PERFORM 料金情報取得.
014310     MOVE 初検料ＷＲ             TO  作１−初診基本料.
014320*
014330     MOVE 初検加算料ＷＲ         TO  作１−初診加算料.
014340     MOVE 往療回数ＷＲ           TO  作１−回数.
014350     MOVE 往療料ＷＲ             TO  作１−往療料金額.
014361*
014362     IF ( レセ−夜間     = 1 ) OR
014363        ( レセ−暴風雨雪 = 1 ) OR
014364        ( レセ−難路     = 1 )
014365         MOVE 1  TO  作１−加算
014366     END-IF.
014380*
014390     MOVE 金属副子加算料ＷＲ     TO 作１−金額.
014400*
014410     MOVE 大Ｗ                   TO 作１−大.
014420     MOVE 中Ｗ                   TO 作１−中.
014430     MOVE 小Ｗ                   TO 作１−小.
014440*
014450     MOVE 施術情報提供料ＷＲ     TO 作１−情報提供料.
014460*
014470     MOVE 負傷種別Ｗ(1)          TO 作１−種別(1).
014480     MOVE 部位Ｗ(1)              TO 作１−部位コード(1).
014490     MOVE 後療回数１ＷＲ         TO 作１−後療回数(1).
014500     MOVE 後療料１ＷＲ           TO 作１−後療金額(1).
014510     MOVE 冷罨法回数１ＷＲ       TO 作１−冷罨回数(1).
014520     MOVE 冷罨法料１ＷＲ         TO 作１−冷罨金額(1).
014530     MOVE 初回処置料ＷＲ(1)      TO 作１−施術料(1).
014540     MOVE 温罨法回数１ＷＲ       TO 作１−罨法回数(1).
014550     MOVE 温罨法料１ＷＲ         TO 作１−罨法金額(1).
014560     MOVE 電療回数１ＷＲ         TO 作１−電療回数(1).
014570     MOVE 電療料１ＷＲ           TO 作１−電療金額(1).
014580     MOVE 転帰区分Ｗ(1)          TO 作１−転帰区分(1).
014590     MOVE 負傷種別Ｗ(2)          TO 作１−種別(2).
014600     MOVE 部位Ｗ(2)              TO 作１−部位コード(2).
014610     MOVE 後療回数２ＷＲ         TO 作１−後療回数(2).
014620     MOVE 後療料２ＷＲ           TO 作１−後療金額(2).
014630     MOVE 冷罨法回数２ＷＲ       TO 作１−冷罨回数(2).
014640     MOVE 冷罨法料２ＷＲ         TO 作１−冷罨金額(2).
014650     MOVE 初回処置料ＷＲ(2)      TO 作１−施術料(2).
014660     MOVE 温罨法回数２ＷＲ       TO 作１−罨法回数(2).
014670     MOVE 温罨法料２ＷＲ         TO 作１−罨法金額(2).
014680     MOVE 電療回数２ＷＲ         TO 作１−電療回数(2).
014690     MOVE 電療料２ＷＲ           TO 作１−電療金額(2).
014700     MOVE 転帰区分Ｗ(2)          TO 作１−転帰区分(2).
014710     MOVE 負傷種別Ｗ(3)          TO 作１−種別(3).
014720     MOVE 部位Ｗ(3)              TO 作１−部位コード(3).
014730     MOVE 後療回数３ＷＲ         TO 作１−後療回数(3).
014740     MOVE 後療料３ＷＲ           TO 作１−後療金額(3).
014750     MOVE 冷罨法回数３ＷＲ       TO 作１−冷罨回数(3).
014760     MOVE 冷罨法料３ＷＲ         TO 作１−冷罨金額(3).
014770     MOVE 初回処置料ＷＲ(3)      TO 作１−施術料(3).
014780     MOVE 温罨法回数３ＷＲ       TO 作１−罨法回数(3).
014790     MOVE 温罨法料３ＷＲ         TO 作１−罨法金額(3).
014800     MOVE 電療回数３ＷＲ         TO 作１−電療回数(3).
014810     MOVE 電療料３ＷＲ           TO 作１−電療金額(3).
014820     MOVE 転帰区分Ｗ(3)          TO 作１−転帰区分(3).
014830     MOVE 負傷種別Ｗ(4)          TO 作１−種別(4).
014840     MOVE 部位Ｗ(4)              TO 作１−部位コード(4).
014850     MOVE 後療回数４ＷＲ         TO 作１−後療回数(4).
014860     MOVE 後療料４ＷＲ           TO 作１−後療金額(4).
014870     MOVE 冷罨法回数４ＷＲ       TO 作１−冷罨回数(4).
014880     MOVE 冷罨法料４ＷＲ         TO 作１−冷罨金額(4).
014890     MOVE 初回処置料ＷＲ(4)      TO 作１−施術料(4).
014900     MOVE 温罨法回数４ＷＲ       TO 作１−罨法回数(4).
014910     MOVE 温罨法料４ＷＲ         TO 作１−罨法金額(4).
014920     MOVE 電療回数４ＷＲ         TO 作１−電療回数(4).
014930     MOVE 電療料４ＷＲ           TO 作１−電療金額(4).
014940     MOVE 転帰区分Ｗ(4)          TO 作１−転帰区分(4).
014950     MOVE 負傷種別Ｗ(5)          TO 作１−種別(5).
014960     MOVE 部位Ｗ(5)              TO 作１−部位コード(5).
014970     MOVE 後療回数５ＷＲ         TO 作１−後療回数(5).
014980     MOVE 後療料５ＷＲ           TO 作１−後療金額(5).
014990     MOVE 冷罨法回数５ＷＲ       TO 作１−冷罨回数(5).
015000     MOVE 冷罨法料５ＷＲ         TO 作１−冷罨金額(5).
015010     MOVE 初回処置料ＷＲ(5)      TO 作１−施術料(5).
015020     MOVE 温罨法回数５ＷＲ       TO 作１−罨法回数(5).
015030     MOVE 温罨法料５ＷＲ         TO 作１−罨法金額(5).
015040     MOVE 電療回数５ＷＲ         TO 作１−電療回数(5).
015050     MOVE 電療料５ＷＲ           TO 作１−電療金額(5).
015060     MOVE 転帰区分Ｗ(5)          TO 作１−転帰区分(5).
015070*
015090* 1つでも継続があれば 9 を転記
015100     IF 継続フラグ = "YES"
015110         MOVE  9                 TO 作１−転帰区分総合
015120     END-IF.
015130*
016220*================================================================*
016230 作１ファイル書込 SECTION.
016240*
016250     WRITE 作１−レコード
016260     INVALID KEY
016270         MOVE NC"作１"  TO ファイル名
016280         PERFORM エラー表示
016290     END-WRITE.
016300*================================================================*
016740*================================================================*
016750 会員番号右詰め SECTION.
016760*
016770     MOVE 会員番号Ｗ      TO  会員番号左詰めＷ.
016780     MOVE ZERO            TO  会員番号右詰めＷ.
016790     MOVE ZERO            TO  会員番号数字Ｗ.
016800*
016810     MOVE  8  TO  カウンタ.
016820*
016830     IF  会員番号左詰めＷ１(7) NOT = SPACE
016840         COMPUTE カウンタ = カウンタ  -  1
016850         MOVE 会員番号左詰めＷ１(7)  TO  会員番号右詰めＷ１(カウンタ)
016860     END-IF.
016870     IF  会員番号左詰めＷ１(6) NOT = SPACE
016880         COMPUTE カウンタ = カウンタ  -  1
016890         MOVE 会員番号左詰めＷ１(6)  TO  会員番号右詰めＷ１(カウンタ)
016900     END-IF.
016910     IF  会員番号左詰めＷ１(5) NOT = SPACE
016920         COMPUTE カウンタ = カウンタ  -  1
016930         MOVE 会員番号左詰めＷ１(5)  TO  会員番号右詰めＷ１(カウンタ)
016940     END-IF.
016950     IF  会員番号左詰めＷ１(4) NOT = SPACE
016960         COMPUTE カウンタ = カウンタ  -  1
016970         MOVE 会員番号左詰めＷ１(4)  TO  会員番号右詰めＷ１(カウンタ)
016980     END-IF.
016990     IF  会員番号左詰めＷ１(3) NOT = SPACE
017000         COMPUTE カウンタ = カウンタ  -  1
017010         MOVE 会員番号左詰めＷ１(3)  TO  会員番号右詰めＷ１(カウンタ)
017020     END-IF.
017030     IF  会員番号左詰めＷ１(2) NOT = SPACE
017040         COMPUTE カウンタ = カウンタ  -  1
017050         MOVE 会員番号左詰めＷ１(2)  TO  会員番号右詰めＷ１(カウンタ)
017060     END-IF.
017070     IF  会員番号左詰めＷ１(1) NOT = SPACE
017080         COMPUTE カウンタ = カウンタ  -  1
017090         MOVE 会員番号左詰めＷ１(1)  TO  会員番号右詰めＷ１(カウンタ)
017100     END-IF.
017110*
017120     MOVE 会員番号右詰めＷ TO 会員番号数字Ｗ.
017130*
017140*================================================================*
017150 記号左詰め SECTION.
017160*
017170***** 記号の無駄なSPACEを取り除いて、左詰めにする。
017180     MOVE SPACE           TO  記号ＮＷ.
017190     MOVE SPACE           TO  記号元Ｗ.
017200     MOVE SPACE           TO  記号左詰めＷ.
017210     MOVE 連暗号複合−複合した記号        TO  記号元Ｗ.
017220*
017230     MOVE  ZERO  TO  カウンタ２.
017240     PERFORM VARYING カウンタ FROM 1 BY 1 UNTIL カウンタ > 12
017250          IF  記号元Ｗ１(カウンタ) NOT = SPACE
017260              COMPUTE カウンタ２ = カウンタ２  +  1
017270              MOVE 記号元Ｗ１(カウンタ)  TO  記号左詰めＷ１(カウンタ２)
017280          END-IF
017290     END-PERFORM.
017300*
017310     MOVE 記号左詰めＷ    TO 記号ＮＷ.
017320*
017330*半角スペースを全角にかえる
017340     INSPECT 記号Ｗ REPLACING ALL 半角空白 BY 全角空白.
017350*
017360*================================================================*
017361*================================================================*
017362 保険区分取得 SECTION.
017363*
017364*
017365     IF ( 受−助成種別 NOT = ZERO ) OR
017366        (( 受−公費種別 = 05 ) AND ( 受−施術和暦年月 < 42004 ))
017368**-- 助成・老人 --
017369         IF ( 受−公費種別 = 05 ) AND ( 受−施術和暦年月 < 42004 )
017371             MOVE 05     TO 作１−保険区分
017372         ELSE
017373             EVALUATE 受−助成種別
017374* 生保
017375             WHEN 50
017376                 MOVE 10     TO 作１−保険区分
017377* ４１老人
017378             WHEN 51
017379                 MOVE 05     TO 作１−保険区分
017380* ひとり親
017381             WHEN 52
017382                 MOVE 13     TO 作１−保険区分
017383* 身障
017384             WHEN 53
017385             WHEN 60
017386                 MOVE 14     TO 作１−保険区分
017387* 被爆
017388             WHEN 54
017389                 MOVE 15     TO 作１−保険区分
017390* 乳幼児
017391             WHEN 55
017392                 MOVE 16     TO 作１−保険区分
017393             END-EVALUATE
017394         END-IF
017395         EVALUATE 受−保険種別
017396* 国保
017397         WHEN 01
017398* 社保
017399         WHEN 02
017400* 組合
017401         WHEN 03
017402* 共済
017403         WHEN 04
017404* 日雇
017405         WHEN 06
017406* 船員
017407         WHEN 07
017408* 退職
017409         WHEN 08
017410             MOVE 受−保険種別 TO 作１−老人助成
017411* 自衛官
017412         WHEN 09
017413             MOVE 4 TO 作１−老人助成
017414* 後期高齢
017415         WHEN 05
017416***             MOVE 30 TO 作１−老人助成
017417             MOVE 05 TO 作１−老人助成
017418*
017419         WHEN OTHER
017420             MOVE SPACE                TO エラーメッセージＷ
017421             MOVE 受−患者コード       TO エラー患者コードＷ
017422             MOVE 受−保険種別         TO エラー保険種別Ｗ
017423             MOVE "-"                  TO エラー区切りＷ
017424             MOVE  NC"保険種別が異常です。患者−保険種別" TO 連メ３−メッセージ
017425             MOVE  エラーメッセージＷ  TO 連メ３−メッセージ１
017426             CALL   "MSG003"
017427             CANCEL "MSG003"
017428         END-EVALUATE
017429     ELSE
017430**-- 健保 --
017431         EVALUATE 受−保険種別
017432* 国保
017433         WHEN 01
017434* 社保
017435         WHEN 02
017436* 組合
017437         WHEN 03
017438* 共済
017439         WHEN 04
017440* 日雇
017441         WHEN 06
017442* 船員
017443         WHEN 07
017444* 退職
017445         WHEN 08
017446             MOVE 受−保険種別 TO 作１−保険区分
017447* 自衛官
017448         WHEN 09
017449             MOVE 4 TO 作１−保険区分
017450* 労災
017451         WHEN 70
017452             MOVE 9 TO 作１−保険区分
017453* 自賠責
017454         WHEN 80
017455             MOVE 12 TO 作１−保険区分
017456* 後期高齢
017457         WHEN 05
017458***             MOVE 30 TO 作１−保険区分
017459             MOVE 05 TO 作１−保険区分
017461*
017462         WHEN OTHER
017463             MOVE SPACE                TO エラーメッセージＷ
017464             MOVE 受−患者コード       TO エラー患者コードＷ
017465             MOVE 受−保険種別         TO エラー保険種別Ｗ
017466             MOVE "-"                  TO エラー区切りＷ
017467             MOVE  NC"保険種別が異常です。患者−保険種別" TO 連メ３−メッセージ
017468             MOVE  エラーメッセージＷ  TO 連メ３−メッセージ１
017469             CALL   "MSG003"
017470             CANCEL "MSG003"
017471         END-EVALUATE
017472     END-IF.
017473*
017474*================================================================*
018800*================================================================*
018810 料金情報取得 SECTION.
018820*
018830***********************************************
018840* 料金データセット                            *
018850***********************************************
018860*    ****************************************************************
018870*    * 料金（月毎）（負傷毎）（逓減毎）については連結項目よりセット *
018880*    ****************************************************************
018890     INITIALIZE 料金１ＷＲ.
018900     INITIALIZE 料金２ＷＲ.
018910     INITIALIZE 料金３ＷＲ.
018920     MOVE レセ−初検料                 TO  初検料ＷＲ.
018930*
018940     MOVE レセ−初検加算料             TO  初検加算料ＷＲ.
018950     MOVE レセ−再検料                 TO  再検料ＷＲ.
018960     MOVE レセ−往療回数               TO  往療回数ＷＲ.
018970     MOVE レセ−往療料                 TO  往療料ＷＲ.
018980     MOVE レセ−往療加算料             TO  往療加算料ＷＲ.
018990*
019000*
019010     MOVE レセ−金属副子加算料         TO  金属副子加算料ＷＲ.
019020*
019030     MOVE レセ−大                     TO 大Ｗ.
019040     MOVE レセ−中                     TO 中Ｗ.
019050     MOVE レセ−小                     TO 小Ｗ.
019060*
019070     MOVE レセ−施術情報提供料         TO  施術情報提供料ＷＲ.
019080********************
019090* 初回処置料セット *
019100********************
019110     PERFORM VARYING 部位ＣＮＴ FROM 1 BY 1
019120             UNTIL ( 部位ＣＮＴ > 部位数Ｗ )
019130         MOVE レセ−初回処置料(部位ＣＮＴ) TO 初回処置料ＷＲ(部位ＣＮＴ)
019140     END-PERFORM.
019150********************
019160* 逓減毎料金セット *
019170********************
019180*    **********
019190*    * １部位 *
019200*    **********
019210     MOVE レセ−後療回数１             TO 後療回数１ＷＲ.
019220     MOVE レセ−後療料１               TO 後療料１ＷＲ.
019230     MOVE レセ−冷罨法回数１           TO 冷罨法回数１ＷＲ.
019240     MOVE レセ−冷罨法料１             TO 冷罨法料１ＷＲ.
019250     MOVE レセ−温罨法回数１           TO 温罨法回数１ＷＲ.
019260     MOVE レセ−温罨法料１             TO 温罨法料１ＷＲ.
019270     MOVE レセ−電療回数１             TO 電療回数１ＷＲ.
019280     MOVE レセ−電療料１               TO 電療料１ＷＲ.
019290*    **********
019300*    * ２部位 *
019310*    **********
019320     MOVE レセ−後療回数２             TO 後療回数２ＷＲ.
019330     MOVE レセ−後療料２               TO 後療料２ＷＲ.
019340     MOVE レセ−冷罨法回数２           TO 冷罨法回数２ＷＲ.
019350     MOVE レセ−冷罨法料２             TO 冷罨法料２ＷＲ.
019360     MOVE レセ−温罨法回数２           TO 温罨法回数２ＷＲ.
019370     MOVE レセ−温罨法料２             TO 温罨法料２ＷＲ.
019380     MOVE レセ−電療回数２             TO 電療回数２ＷＲ.
019390     MOVE レセ−電療料２               TO 電療料２ＷＲ.
019400*    ****************
019410*    * ３部位／８割 *
019420*    ****************
019430     MOVE レセ−後療回数３８             TO 後療回数３８ＷＲ.
019440     MOVE レセ−後療料３８               TO 後療料３８ＷＲ.
019450     MOVE レセ−冷罨法回数３８           TO 冷罨法回数３８ＷＲ.
019460     MOVE レセ−冷罨法料３８             TO 冷罨法料３８ＷＲ.
019470     MOVE レセ−温罨法回数３８           TO 温罨法回数３８ＷＲ.
019480     MOVE レセ−温罨法料３８             TO 温罨法料３８ＷＲ.
019490     MOVE レセ−電療回数３８             TO 電療回数３８ＷＲ.
019500     MOVE レセ−電療料３８               TO 電療料３８ＷＲ.
019510*    ****************
019520*    * ３部位／10割 *
019530*    ****************
019540     MOVE レセ−後療回数３０             TO 後療回数３０ＷＲ.
019550     MOVE レセ−後療料３０               TO 後療料３０ＷＲ.
019560     MOVE レセ−冷罨法回数３０           TO 冷罨法回数３０ＷＲ.
019570     MOVE レセ−冷罨法料３０             TO 冷罨法料３０ＷＲ.
019580     MOVE レセ−温罨法回数３０           TO 温罨法回数３０ＷＲ.
019590     MOVE レセ−温罨法料３０             TO 温罨法料３０ＷＲ.
019600     MOVE レセ−電療回数３０             TO 電療回数３０ＷＲ.
019610     MOVE レセ−電療料３０               TO 電療料３０ＷＲ.
019620*    ****************
019630*    * ３部位／合計 *
019640*    ****************
019650     COMPUTE 後療回数３ＷＲ      = 後療回数３８ＷＲ   + 後療回数３０ＷＲ.
019660     COMPUTE 後療料３ＷＲ        = 後療料３８ＷＲ     + 後療料３０ＷＲ.
019670     COMPUTE 冷罨法回数３ＷＲ    = 冷罨法回数３８ＷＲ + 冷罨法回数３０ＷＲ.
019680     COMPUTE 冷罨法料３ＷＲ      = 冷罨法料３８ＷＲ   + 冷罨法料３０ＷＲ.
019690     COMPUTE 温罨法回数３ＷＲ    = 温罨法回数３８ＷＲ + 温罨法回数３０ＷＲ.
019700     COMPUTE 温罨法料３ＷＲ      = 温罨法料３８ＷＲ   + 温罨法料３０ＷＲ.
019710     COMPUTE 電療回数３ＷＲ      = 電療回数３８ＷＲ   + 電療回数３０ＷＲ.
019720     COMPUTE 電療料３ＷＲ        = 電療料３８ＷＲ     + 電療料３０ＷＲ.
019730*    ****************
019740*    * ４部位／５割 *
019750*    ****************
019760     MOVE レセ−後療回数４５             TO 後療回数４５ＷＲ.
019770     MOVE レセ−後療料４５               TO 後療料４５ＷＲ.
019780     MOVE レセ−冷罨法回数４５           TO 冷罨法回数４５ＷＲ.
019790     MOVE レセ−冷罨法料４５             TO 冷罨法料４５ＷＲ.
019800     MOVE レセ−温罨法回数４５           TO 温罨法回数４５ＷＲ.
019810     MOVE レセ−温罨法料４５             TO 温罨法料４５ＷＲ.
019820     MOVE レセ−電療回数４５             TO 電療回数４５ＷＲ.
019830     MOVE レセ−電療料４５               TO 電療料４５ＷＲ.
019840*    ****************
019850*    * ４部位／８割 *
019860*    ****************
019870     MOVE レセ−後療回数４８             TO 後療回数４８ＷＲ.
019880     MOVE レセ−後療料４８               TO 後療料４８ＷＲ.
019890     MOVE レセ−冷罨法回数４８           TO 冷罨法回数４８ＷＲ.
019900     MOVE レセ−冷罨法料４８             TO 冷罨法料４８ＷＲ.
019910     MOVE レセ−温罨法回数４８           TO 温罨法回数４８ＷＲ.
019920     MOVE レセ−温罨法料４８             TO 温罨法料４８ＷＲ.
019930     MOVE レセ−電療回数４８             TO 電療回数４８ＷＲ.
019940     MOVE レセ−電療料４８               TO 電療料４８ＷＲ.
019950*    ****************
019960*    * ４部位／10割 *
019970*    ****************
019980     MOVE レセ−後療回数４０             TO 後療回数４０ＷＲ.
019990     MOVE レセ−後療料４０               TO 後療料４０ＷＲ.
020000     MOVE レセ−冷罨法回数４０           TO 冷罨法回数４０ＷＲ.
020010     MOVE レセ−冷罨法料４０             TO 冷罨法料４０ＷＲ.
020020     MOVE レセ−温罨法回数４０           TO 温罨法回数４０ＷＲ.
020030     MOVE レセ−温罨法料４０             TO 温罨法料４０ＷＲ.
020040     MOVE レセ−電療回数４０             TO 電療回数４０ＷＲ.
020050     MOVE レセ−電療料４０               TO 電療料４０ＷＲ.
020060*    ****************
020070*    * ４部位／合計 *
020080*    ****************
020090     COMPUTE 後療回数４ＷＲ      = 後療回数４５ＷＲ   + 後療回数４８ＷＲ   + 後療回数４０ＷＲ.
020100     COMPUTE 後療料４ＷＲ        = 後療料４５ＷＲ     + 後療料４８ＷＲ     + 後療料４０ＷＲ.
020110     COMPUTE 冷罨法回数４ＷＲ    = 冷罨法回数４５ＷＲ + 冷罨法回数４８ＷＲ + 冷罨法回数４０ＷＲ.
020120     COMPUTE 冷罨法料４ＷＲ      = 冷罨法料４５ＷＲ   + 冷罨法料４８ＷＲ   + 冷罨法料４０ＷＲ.
020130     COMPUTE 温罨法回数４ＷＲ    = 温罨法回数４５ＷＲ + 温罨法回数４８ＷＲ + 温罨法回数４０ＷＲ.
020140     COMPUTE 温罨法料４ＷＲ      = 温罨法料４５ＷＲ   + 温罨法料４８ＷＲ   + 温罨法料４０ＷＲ.
020150     COMPUTE 電療回数４ＷＲ      = 電療回数４５ＷＲ   + 電療回数４８ＷＲ   + 電療回数４０ＷＲ.
020160     COMPUTE 電療料４ＷＲ        = 電療料４５ＷＲ     + 電療料４８ＷＲ     + 電療料４０ＷＲ.
020170*    *****************
020180*    * ５部位／2.5割 *
020190*    *****************
020200     MOVE レセ−後療回数５２             TO 後療回数５２ＷＲ.
020210     MOVE レセ−後療料５２               TO 後療料５２ＷＲ.
020220     MOVE レセ−冷罨法回数５２           TO 冷罨法回数５２ＷＲ.
020230     MOVE レセ−冷罨法料５２             TO 冷罨法料５２ＷＲ.
020240     MOVE レセ−温罨法回数５２           TO 温罨法回数５２ＷＲ.
020250     MOVE レセ−温罨法料５２             TO 温罨法料５２ＷＲ.
020260     MOVE レセ−電療回数５２             TO 電療回数５２ＷＲ.
020270     MOVE レセ−電療料５２               TO 電療料５２ＷＲ.
020280*    ****************
020290*    * ５部位／５割 *
020300*    ****************
020310     MOVE レセ−後療回数５５             TO 後療回数５５ＷＲ.
020320     MOVE レセ−後療料５５               TO 後療料５５ＷＲ.
020330     MOVE レセ−冷罨法回数５５           TO 冷罨法回数５５ＷＲ.
020340     MOVE レセ−冷罨法料５５             TO 冷罨法料５５ＷＲ.
020350     MOVE レセ−温罨法回数５５           TO 温罨法回数５５ＷＲ.
020360     MOVE レセ−温罨法料５５             TO 温罨法料５５ＷＲ.
020370     MOVE レセ−電療回数５５             TO 電療回数５５ＷＲ.
020380     MOVE レセ−電療料５５               TO 電療料５５ＷＲ.
020390*    ****************
020400*    * ５部位／８割 *
020410*    ****************
020420     MOVE レセ−後療回数５８             TO 後療回数５８ＷＲ.
020430     MOVE レセ−後療料５８               TO 後療料５８ＷＲ.
020440     MOVE レセ−冷罨法回数５８           TO 冷罨法回数５８ＷＲ.
020450     MOVE レセ−冷罨法料５８             TO 冷罨法料５８ＷＲ.
020460     MOVE レセ−温罨法回数５８           TO 温罨法回数５８ＷＲ.
020470     MOVE レセ−温罨法料５８             TO 温罨法料５８ＷＲ.
020480     MOVE レセ−電療回数５８             TO 電療回数５８ＷＲ.
020490     MOVE レセ−電療料５８               TO 電療料５８ＷＲ.
020500*    ****************
020510*    * ５部位／10割 *
020520*    ****************
020530     MOVE レセ−後療回数５０             TO 後療回数５０ＷＲ.
020540     MOVE レセ−後療料５０               TO 後療料５０ＷＲ.
020550     MOVE レセ−冷罨法回数５０           TO 冷罨法回数５０ＷＲ.
020560     MOVE レセ−冷罨法料５０             TO 冷罨法料５０ＷＲ.
020570     MOVE レセ−温罨法回数５０           TO 温罨法回数５０ＷＲ.
020580     MOVE レセ−温罨法料５０             TO 温罨法料５０ＷＲ.
020590     MOVE レセ−電療回数５０             TO 電療回数５０ＷＲ.
020600     MOVE レセ−電療料５０               TO 電療料５０ＷＲ.
020610*    ****************
020620*    * ５部位／合計 *
020630*    ****************
020640     COMPUTE 後療回数５ＷＲ   = 後療回数５２ＷＲ   + 後療回数５５ＷＲ   +
020650                                後療回数５８ＷＲ   + 後療回数５０ＷＲ.
020660     COMPUTE 後療料５ＷＲ     = 後療料５２ＷＲ     + 後療料５５ＷＲ     +
020670                                後療料５８ＷＲ     + 後療料５０ＷＲ.
020680     COMPUTE 冷罨法回数５ＷＲ = 冷罨法回数５２ＷＲ + 冷罨法回数５５ＷＲ +
020690                                冷罨法回数５８ＷＲ + 冷罨法回数５０ＷＲ.
020700     COMPUTE 冷罨法料５ＷＲ   = 冷罨法料５２ＷＲ   + 冷罨法料５５ＷＲ   +
020710                                冷罨法料５８ＷＲ   + 冷罨法料５０ＷＲ.
020720     COMPUTE 温罨法回数５ＷＲ = 温罨法回数５２ＷＲ + 温罨法回数５５ＷＲ +
020730                                温罨法回数５８ＷＲ + 温罨法回数５０ＷＲ.
020740     COMPUTE 温罨法料５ＷＲ   = 温罨法料５２ＷＲ   + 温罨法料５５ＷＲ   +
020750                                温罨法料５８ＷＲ   + 温罨法料５０ＷＲ.
020760     COMPUTE 電療回数５ＷＲ   = 電療回数５２ＷＲ   + 電療回数５５ＷＲ   +
020770                                電療回数５８ＷＲ   + 電療回数５０ＷＲ.
020780     COMPUTE 電療料５ＷＲ     = 電療料５２ＷＲ     + 電療料５５ＷＲ     +
020790                                電療料５８ＷＲ     + 電療料５０ＷＲ.
020800*
020810*================================================================*
020811 負傷データ取得 SECTION.
020812*
020813**************************************************
020814* 連結データから負傷データＦより以下の情報を取得 *
020815* ● 部位＋負傷種別                              *
020816* ● 転帰区分 ....区分によりチェックに"○"を格納 *
020817* ● 金属副子 ....区分によりチェックに"○"を格納 *
020818* ● 経過コード...経過マスタより取得             *
020819**************************************************
020820     INITIALIZE 負傷情報Ｗ.
020821     MOVE SPACE TO 継続フラグ.
020822     MOVE 施術和暦ＷＲ       TO 負−施術和暦.
020823     MOVE 施術年ＷＲ         TO 負−施術年.
020824     MOVE 施術月ＷＲ         TO 負−施術月.
020825     MOVE 患者コードＷＲ     TO 負−患者コード.
020826     READ 負傷データＦ
020827     INVALID KEY
020828         CONTINUE
020829*            /* ありえない */
020830     NOT INVALID KEY
020831         MOVE 負−部位数                   TO 部位数Ｗ
020832         PERFORM VARYING 部位ＣＮＴ FROM 1 BY 1
020833                 UNTIL ( 部位ＣＮＴ > 部位数Ｗ )
020834             MOVE 負−負傷種別(部位ＣＮＴ) TO 負傷種別Ｗ(部位ＣＮＴ)
020835             MOVE 負−部位(部位ＣＮＴ)     TO 部位Ｗ(部位ＣＮＴ)
020836*
020837             MOVE 負−転帰区分(部位ＣＮＴ) TO 転帰区分Ｗ(部位ＣＮＴ)
020838*   --- 継続の部位があるか判定 ---
020839             IF 負−転帰区分(部位ＣＮＴ) = 9
020840                  MOVE "YES" TO 継続フラグ
020841             END-IF
020842*
020843         END-PERFORM
020844     END-READ.
020845*
021110*================================================================*
021120******************************************************************
021130 END PROGRAM YCK101.
021140******************************************************************
